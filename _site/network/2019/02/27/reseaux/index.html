<!DOCTYPE html>
<html lang="en-us">

  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      réseaux &middot; Adel ALLAM
    
  </title>

  
  <link rel="canonical" href="http://localhost:4000/network/2019/02/27/reseaux/">
  

  <link rel="stylesheet" href="http://localhost:4000/public/css/poole.css">
  <link rel="stylesheet" href="http://localhost:4000/public/css/syntax.css">
  <link rel="stylesheet" href="http://localhost:4000/public/css/lanyon.css">

  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4000/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="http://localhost:4000/public/favicon.ico">

  <link rel="alternate" type="application/rss+xml" title="RSS" href="http://localhost:4000/atom.xml">
</head>


  <body>

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
     <input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox" >
<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div style="font-size: 2em;" class="sidebar-item">
    <p>Blog-notes</p>
  </div>

  <hr class="sidebar-separator">

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/">home</a>

    <!-- categories links -->
    
      
        
          
        
      
        
          
        
      
        
      
        
          
            <a class="sidebar-nav-item-sub sidebar-nav-item" href="/category/ctf/">> ctf</a>
          
        
      
        
          
        
      
        
          
            <a class="sidebar-nav-item-sub sidebar-nav-item" href="/category/linux/">> linux</a>
          
        
      
        
          
            <a class="sidebar-nav-item-sub sidebar-nav-item" href="/category/network/">> network</a>
          
        
      
        
          
            <a class="sidebar-nav-item-sub sidebar-nav-item" href="/category/other/">> other</a>
          
        
      
        
          
        
      
        
          
            <a class="sidebar-nav-item-sub sidebar-nav-item" href="/category/reverse/">> reverse</a>
          
        
      

    
    
      
        
          
        
      
    
      
    
      
        
          
        
      
    
      
        
          
        
      
    
      
        
          
        
      
    
      
        
          
        
      
    
      
        
          
        
      
    
      
        
          
        
      
    
      
        
          
            <a class="sidebar-nav-item" href="/privacy/">privacy</a>
          
        
      
    
      
        
          
            <a class="sidebar-nav-item" href="/about/">about</a>
          
        
      
    

  </nav>


    <hr class="sidebar-separator">

    <div id="sidebar-icon-links">
    
  <a class="icon" title="Root-Me profil" aria-label="Root-Me profil" href="https://www.root-me.org/apges01" target="_blank">
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="32px" height="32px" viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve">  <image id="image0" width="32" height="32" x="0" y="0"
    href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAQAAADZc7J/AAAABGdBTUEAALGPC/xhBQAAACBjSFJN
AAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAHdElN
RQfjCwkWHxp+T5UxAAADEklEQVRIx82UX0jdZRjHP7/D4XA4/BCRwyGGmIwlIhLDi00kLGLIGiEx
TCZBFzFG0P6ErCatEUO8iBhD1vAiYsgay5YXMqitM5HlRvRnKY5FFI0Fbph4YSZrk9P5dHGOZ3b8
qUE3PVfv+z7f5/u83/d53gf+owXrOX2ZBJfYwxfB1FqY+BqhGbaxnQbmuc8sQ55mkslg8V8SuItD
3CNLnhiT9HGCHMe474FgekNNpn3Xc9YBWONW8MOiZ4e/ud/YRgRn7LeiIMNRbxovEVR6w8/ds44E
U3QzzQAZF+kmwSkagpxYxSBJLnKJ4wybDz5ZK/tTZg3tc9S99pk2YQIc9G0HPO+YW8BWsyaiw2MO
2Qa+Ym9RxLB3C5pNO+CZIq7XV6MJHnPUNIBxMAbuN1skqHXCpuUSe7mAK3+DncxSbTUQ8yhVvhi8
b4KQBRvp50DwfQEWzJqjnmuF3cqiPM1waT3BFEvAx3RaTT8XgmsrkD+QZrV5wQSYBKtKZ3FH/crm
MuSInZFlJG8zh7zDHz7gCj8R8gYLHAm++0d4nBbORRE8oJ5NhJwPpsAORpjjbHCkLHuS18mxFCXh
oIeNmzFuyt1m7bfOVX/FNsfN+kwUQY1j1triXq87WOiE8uzu8KrtZt20fLZiHljBt/xIkst8xu0g
4pJ208VptpOmK8itfoMUX5LnNfJkyJWFxmnjKC18xDRV5EixsLoPZvmFu0EO2Mo71j3qeBs5wVla
AJjiOT4IFiKqEOS9TSUEee/Z/vuzDxv//DQ5zhIv8fyKNIssMfNoGz3SZoK5uVM3U03vPR6ywM4V
njusZ3a6r7jabNZxT5oxbo9/qQ+9YYcxU140sxZBh0Mmi+tKN5kEK03Y688edjOADU6YXosgaY9Z
S4qN2+4tt5X2lXb6tbvWExHzBcc8WLiHFb7lPtuLvtAhR6zbeKwmvG5r6Q5PLrezb3pydWtHsAVL
zIC1HgdCjhFaZw8Avwa5cnR0GZM0Uc9urxKyhVZq6PIbnuBWRLpIEX00kydknhghi8QImSdFb3CF
/539DagplOU/gNJHAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIwLTA1LTA3VDE5OjAzOjA2KzAyOjAw
95u+EQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOS0xMS0wOVQyMTozMToyNiswMTowMBkgVUYAAAAA
SUVORK5CYII=" />
</svg>

  </a>
  


  <a class="icon" title="Github profil" aria-label="Github profil" href="https://github.com/AdelAlm" target="_blank">
    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 28"><path d="M12 2c6.625 0 12 5.375 12 12 0 5.297-3.437 9.797-8.203 11.391-0.609 0.109-0.828-0.266-0.828-0.578 0-0.391 0.016-1.687 0.016-3.297 0-1.125-0.375-1.844-0.812-2.219 2.672-0.297 5.484-1.313 5.484-5.922 0-1.313-0.469-2.375-1.234-3.219 0.125-0.313 0.531-1.531-0.125-3.187-1-0.313-3.297 1.234-3.297 1.234-0.953-0.266-1.984-0.406-3-0.406s-2.047 0.141-3 0.406c0 0-2.297-1.547-3.297-1.234-0.656 1.656-0.25 2.875-0.125 3.187-0.766 0.844-1.234 1.906-1.234 3.219 0 4.594 2.797 5.625 5.469 5.922-0.344 0.313-0.656 0.844-0.766 1.609-0.688 0.313-2.438 0.844-3.484-1-0.656-1.141-1.844-1.234-1.844-1.234-1.172-0.016-0.078 0.734-0.078 0.734 0.781 0.359 1.328 1.75 1.328 1.75 0.703 2.141 4.047 1.422 4.047 1.422 0 1 0.016 1.937 0.016 2.234 0 0.313-0.219 0.688-0.828 0.578-4.766-1.594-8.203-6.094-8.203-11.391 0-6.625 5.375-12 12-12zM4.547 19.234c0.031-0.063-0.016-0.141-0.109-0.187-0.094-0.031-0.172-0.016-0.203 0.031-0.031 0.063 0.016 0.141 0.109 0.187 0.078 0.047 0.172 0.031 0.203-0.031zM5.031 19.766c0.063-0.047 0.047-0.156-0.031-0.25-0.078-0.078-0.187-0.109-0.25-0.047-0.063 0.047-0.047 0.156 0.031 0.25 0.078 0.078 0.187 0.109 0.25 0.047zM5.5 20.469c0.078-0.063 0.078-0.187 0-0.297-0.063-0.109-0.187-0.156-0.266-0.094-0.078 0.047-0.078 0.172 0 0.281s0.203 0.156 0.266 0.109zM6.156 21.125c0.063-0.063 0.031-0.203-0.063-0.297-0.109-0.109-0.25-0.125-0.313-0.047-0.078 0.063-0.047 0.203 0.063 0.297 0.109 0.109 0.25 0.125 0.313 0.047zM7.047 21.516c0.031-0.094-0.063-0.203-0.203-0.25-0.125-0.031-0.266 0.016-0.297 0.109s0.063 0.203 0.203 0.234c0.125 0.047 0.266 0 0.297-0.094zM8.031 21.594c0-0.109-0.125-0.187-0.266-0.172-0.141 0-0.25 0.078-0.25 0.172 0 0.109 0.109 0.187 0.266 0.172 0.141 0 0.25-0.078 0.25-0.172zM8.937 21.438c-0.016-0.094-0.141-0.156-0.281-0.141-0.141 0.031-0.234 0.125-0.219 0.234 0.016 0.094 0.141 0.156 0.281 0.125s0.234-0.125 0.219-0.219z"></path>
</svg>

  </a>



  <a class="icon" title="Linkedin profil" aria-label="Linkedin profil" href="https://www.linkedin.com/in/adel-allam/" target="_blank">
    <?xml version="1.0" encoding="iso-8859-1"?>
<!-- Generator: Adobe Illustrator 16.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 width="430.117px" height="430.118px" viewBox="0 0 430.117 430.118" style="enable-background:new 0 0 430.117 430.118;"
	 xml:space="preserve">
<g>
	<path id="LinkedIn__x28_alt_x29_" d="M398.355,0H31.782C14.229,0,0.002,13.793,0.002,30.817v368.471
		c0,17.025,14.232,30.83,31.78,30.83h366.573c17.549,0,31.76-13.814,31.76-30.83V30.817C430.115,13.798,415.904,0,398.355,0z
		 M130.4,360.038H65.413V165.845H130.4V360.038z M97.913,139.315h-0.437c-21.793,0-35.92-14.904-35.92-33.563
		c0-19.035,14.542-33.535,36.767-33.535c22.227,0,35.899,14.496,36.331,33.535C134.654,124.415,120.555,139.315,97.913,139.315z
		 M364.659,360.038h-64.966V256.138c0-26.107-9.413-43.921-32.907-43.921c-17.973,0-28.642,12.018-33.327,23.621
		c-1.736,4.144-2.166,9.94-2.166,15.728v108.468h-64.954c0,0,0.85-175.979,0-194.192h64.964v27.531
		c8.624-13.229,24.035-32.1,58.534-32.1c42.76,0,74.822,27.739,74.822,87.414V360.038z M230.883,193.99
		c0.111-0.182,0.266-0.401,0.42-0.614v0.614H230.883z"/>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
</svg>

  </a>



  <a class="icon" title="Twitter profil" aria-label="Twitter profil" href="https://twitter.com/apges01" target="_blank">
    <?xml version="1.0" encoding="iso-8859-1"?>
<!-- Generator: Adobe Illustrator 16.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 width="510px" height="510px" viewBox="0 0 510 510" style="enable-background:new 0 0 510 510;" xml:space="preserve">
<g>
	<g id="post-twitter">
		<path d="M459,0H51C22.95,0,0,22.95,0,51v408c0,28.05,22.95,51,51,51h408c28.05,0,51-22.95,51-51V51C510,22.95,487.05,0,459,0z
			 M400.35,186.15c-2.55,117.3-76.5,198.9-188.7,204C165.75,392.7,132.6,377.4,102,359.55c33.15,5.101,76.5-7.649,99.45-28.05
			c-33.15-2.55-53.55-20.4-63.75-48.45c10.2,2.55,20.4,0,28.05,0c-30.6-10.2-51-28.05-53.55-68.85c7.65,5.1,17.85,7.65,28.05,7.65
			c-22.95-12.75-38.25-61.2-20.4-91.8c33.15,35.7,73.95,66.3,140.25,71.4c-17.85-71.4,79.051-109.65,117.301-61.2
			c17.85-2.55,30.6-10.2,43.35-15.3c-5.1,17.85-15.3,28.05-28.05,38.25c12.75-2.55,25.5-5.1,35.7-10.2
			C425.85,165.75,413.1,175.95,400.35,186.15z"/>
	</g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
</svg>

  </a>



  <a class="icon" title="Cryptis" aria-label="Cryptis" href="http://teamcryptis.fr/" target="_blank">
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="467px" height="484px" viewBox="0 0 467 484" enable-background="new 0 0 467 484" xml:space="preserve">  <image id="image0" width="467" height="484" x="0" y="0"
    xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAdMAAAHkCAMAAABSXzWKAAAABGdBTUEAALGPC/xhBQAAACBjSFJN
AAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAY1BMVEUAAAD/////////////
///////////////////////////////////////////////7x3j8x3j7x3j7yHf8x3j8yHf/x3j8
x3j8x3j9xnn9yHf8yHf8xnn/v4D6xXr////8x3jKFOSNAAAAH3RSTlMAIEBwgI+/799QEK8wn89g
QGCAj7+vIN+fcM/vUBAwb4xV9gAAAAFiS0dEAf8CLd4AAAAHdElNRQfjDB8AOw3TjfrBAAAfs0lE
QVR42u1d62KyuhJVRPAOtfZi+1n7/k/5qa2FQICZyYRMYtavs/c+VsNiJmsumUwmERERERERERER
EREREREREREREREREREREREREREREREREREREREREREREREREREREQFhmiSzNJ1nF+TnNhbX/5Cm
6TJJVq5/akQ/VsnySuQZhUW2TtNk4/q3RzSxWaZbJJdtbudpMnW9kIjJ1TbT9c6MTQXZfJa4XtMD
40rngpHOCrvtLDrj0TEttpzWqbXYdBkV1Fi48GnHPDUGO4+8WsdqPD4rXuMGaw+b1La/7UC+LqIi
toDlNjcnx8Rc0yibOLEq1k75/MViHmnlgRBCI61sWG5d09imNe6tBtjM3e6hXdjNYoRDwmrmSOWC
sF26fj7+IRHnc5tYpNEHI7CajZ1YoGEbsxFATB1HohgsirizDiMxrIOOjTy64AEUfjhdFdvIaidW
qY+MXpHFjVWLVerPNhpZhcBvRiOrbfjPaGRVRRiMRlZrSHxVRlpWY93mgtQ1DcyIkc1EfF4Xj/TB
c0sBUno+5zPXj9UlQnO8d+weVywlrp+9PawfdFtdhaR4m8hT14/XCUL1vL94RAe8CiXV0In5wyng
wM30ivzR2pZC3k3/sH4oU924ftzj4KFMdeb6aY+FBzLVIFNIWjyOqXrWTGaERxHAdp/iLsvmaTpL
brh/5eb2T0Waphl25o7pz3mMGpyVZ5dn6wuRwAc4vQ1UGkl+P0Ren/mZLbK0IM4l2yx5B/Lo8QhS
iZHOdcowZS6ZWZ7lsgjf//I8QOaRN0m6tpixDN7/mouULLWSJd/MrPEauv81S/cu5laDvs3Mji4O
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
MyswMzowMCvbYHQAAAAASUVORK5CYII=" />
</svg>

  </a>






</div>






  <div class="sidebar-item">
    <p style="font-size: 0.9em;">
      2018 - 2020 &copy; Adel ALLAM.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">Adel ALLAM</a>
            <small>@apges01</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="post">
  <h1 class="post-title">réseaux</h1>
  <span class="post-date">27 Feb 2019</span>
  <!--more-->

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ivre</span>
<span class="nv">$ </span>zeek <span class="nt">-r</span> challenge.pcapng
<span class="nv">$ </span>ll
<span class="nt">-rw-r--r--</span>@  1 Adel  staff  36944476 Nov 20 23:05 challenge.pcapng <span class="c"># base</span>
<span class="nt">-rw-r--r--</span>@  1 Adel  staff   9839932 Dec 31 14:27 conn.log
<span class="nt">-rw-r--r--</span>@  1 Adel  staff      2771 Dec 31 14:27 dns.log
<span class="nt">-rw-r--r--</span>@  1 Adel  staff      1745 Dec 31 14:27 files.log
<span class="nt">-rw-r--r--</span>   1 Adel  staff      2378 Dec 31 14:27 http.log
<span class="nt">-rw-r--r--</span>@  1 Adel  staff       254 Dec 31 14:27 packet_filter.log
<span class="nt">-rw-r--r--</span>   1 Adel  staff     13430 Dec 31 14:27 weird.log

</code></pre></div></div>

<hr />
<h2 id="quest-ce-quun-protocole-">Qu’est-ce qu’un protocole ?</h2>
<hr />
<p>Accord entre les parties sur la façon de communiquer :</p>

<ul>
  <li>définit le format des données échangées</li>
  <li>définit l’ordre des messages emis et reçus</li>
  <li>définit les réactions à ces messages</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># example of HTTP protocol</span>
<span class="c"># socat to create TCP socket</span>
<span class="nv">$ </span>socat - tcp:adel-allam.fr:80
<span class="c"># request</span>
GET / HTTP/1.1
Host: adel-allam.fr

<span class="c"># response header</span>
HTTP/1.1 301 Moved Permanently
Server: nginx
Date: Tue, 26 Feb 2019 17:54:42 GMT
Content-Type: text/html
Content-Length: 178
Connection: keep-alive
Location: https://adel-allam.fr/

<span class="c"># response body</span>
&lt;html&gt;
&lt;<span class="nb">head</span><span class="o">&gt;</span>&lt;title&gt;301 Moved Permanently&lt;/title&gt;&lt;/head&gt;
&lt;body <span class="nv">bgcolor</span><span class="o">=</span><span class="s2">"white"</span><span class="o">&gt;</span>
&lt;center&gt;&lt;h1&gt;301 Moved Permanently&lt;/h1&gt;&lt;/center&gt;
&lt;hr&gt;&lt;center&gt;nginx&lt;/center&gt;
&lt;/body&gt;
&lt;/html&gt;

<span class="c"># other way</span>
<span class="nv">$ </span>curl <span class="nt">-vI</span> adel-allam.fr
</code></pre></div></div>

<p>On parle souvent de pile de protocoles, c’est-à-dire que chaque couche est associée à un protocole. L’ensemble des couches a été normalisé par l’ISO en 7 couches. C’est le modèle OSI (Open System Interconnection). Il existe aussi le modèle TCP/IP qui est plus simple (seul ce dernier a été implémenté).</p>

<hr />
<h2 id="pourquoi-un-modèle-en-couches-">Pourquoi un modèle en couches ?</h2>
<hr />
<ul>
  <li>réduire complexité de conception</li>
  <li>chaque couche fournit des services distincts</li>
</ul>

<hr />
<h2 id="modèle-osi">Modèle OSI</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">Layer</th>
      <th style="text-align: center">Number</th>
      <th> </th>
      <th>PDU (Protocol Data Unit)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><code class="highlighter-rouge">Application</code></td>
      <td style="text-align: center">7</td>
      <td>application services (HTTP, Telnet, FTP, SIP)</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="highlighter-rouge">Presentation</code></td>
      <td style="text-align: center">6</td>
      <td>data translation (MIME), encryption (SSL), compression</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="highlighter-rouge">Session</code></td>
      <td style="text-align: center">5</td>
      <td>dialog control, synchronization</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="highlighter-rouge">Transport</code></td>
      <td style="text-align: center">4</td>
      <td>reliable (TCP, UDP, TCP, SCTP)</td>
      <td>Segment</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="highlighter-rouge">Network</code></td>
      <td style="text-align: center">3</td>
      <td>source-to-destination (IP), routing, address resolution</td>
      <td>Packet</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="highlighter-rouge">Data Link</code></td>
      <td style="text-align: center">2</td>
      <td>wireless link (802.11), wired link (802.3)</td>
      <td>Frame</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="highlighter-rouge">Physical</code></td>
      <td style="text-align: center">1</td>
      <td>fiber, radio, bluetooth</td>
      <td>Bits</td>
    </tr>
  </tbody>
</table>

<hr />
<h2 id="modèle-tcpip">Modèle TCP/IP</h2>
<hr />

<table>
  <thead>
    <tr>
      <th>Layer</th>
      <th>Protocols</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">Application</code></td>
      <td>FTP, DNS, SSH, SNMP, SMTP, HTTP, TFTP, DHCP</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">Transport</code></td>
      <td>UDP, TCP</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">Network</code></td>
      <td>IPv4, IPv6, IP NAT, IPSec, routing(RIP, OSPF, BGP)</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">Date Link, Physical</code></td>
      <td>SLIP, PPP</td>
    </tr>
  </tbody>
</table>

<p>Les clients et les serveurs possèdent 7 couches, les routeurs, eux, n’en n’ont besoin que de 3 (<code class="highlighter-rouge">Network</code>, <code class="highlighter-rouge">Data Link</code>, <code class="highlighter-rouge">Physical</code>). Car ces derniers ne sont là que pour réaliser l’action de routage.</p>

<p>Les protocoles dans le monde TCP/IP sont définis par les <code class="highlighter-rouge">RFC</code> (Request For Comment). Ces documents expliquent en détails toutes les caractéristiques d’un protocole donné.</p>

<hr />
<h2 id="types-de-communication-en-tcpip">Types de communication en TCP/IP</h2>
<hr />

<ul>
  <li><code class="highlighter-rouge">mode connecté</code>
    <ul>
      <li>unicast</li>
      <li>données arrivent dans l’ordre</li>
      <li>pas de perte</li>
      <li>communication bi-directionnelle (2 sens) et full-duplex (simultanée)</li>
      <li>demande d’accord entre les 2 intercoluteurs, 2 demi-connexions</li>
      <li>mode offert par <code class="highlighter-rouge">TCP</code>, Transport Control Protocol (mode connecté simulé par TCP sur réseau en mode datagramme)</li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">mode datagramme</code>
    <ul>
      <li>unicast ou multicast</li>
      <li>données dans paquets de taille limitée</li>
      <li>possibles pertes de paquets</li>
      <li>mode offert par <code class="highlighter-rouge">UDP</code>, User Datagram Protocol</li>
    </ul>
  </li>
</ul>

<hr />
<h2 id="modèle-clientserveur">Modèle client/serveur</h2>
<hr />

<p>En TCP/IP, les communications fonctionnent souvent suivant un modèle client/serveur. Un serveur est en attente de la connexion de clients sur un port. Derrière ce dernier, se trouve un service que le client veut contacter. Un serveur peut fournir plusieurs services (ex: web, mail, dns). On utilise la notion de ports afin de différencier (multiplexer) les services. Ces numéros de ports sont standardisés. Sous Linux, on peut les retrouver dans <code class="highlighter-rouge">/etc/services</code>. Ces derniers sont définis sur 16 bits, allant 1 à 65 535.</p>

<p>Une communication est identifiée par un couple de <code class="highlighter-rouge">TSAP</code> (Transport Service Access Point) : (TSAPsrc., TSAPdst.), un TSAP est composé d’une adresse IP et d’un numéro de port: <code class="highlighter-rouge">('10.0.0.10',80)</code>.</p>

<p>Un socket fourni un moyen de communication entre processus, identifié par un TSAP unique.</p>

<hr />
<h2 id="tcp">TCP</h2>
<hr />
<ul>
  <li>protocole de transport fiable, mode connecté, mode full-duplex</li>
  <li>socket TCP peut traiter plusieurs connexions simultanément</li>
  <li>communication = TSAPcli &lt;-&gt; TSAPsrv</li>
  <li>flot continu de données, reçu dans l’ordre</li>
</ul>

<h3 id="udp">UDP</h3>

<ul>
  <li>protocole de transport non-fiable, sans connexion</li>
  <li>manipule des datagrammes, 1 datagramme UDP = 1 datagramme IP</li>
  <li>ordre de réception des paquets non garantie</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># TCP server
</span><span class="n">socket</span>
<span class="n">bind</span>
<span class="n">listen</span>
<span class="n">accept</span> <span class="c1"># return new discussion socket
</span>  <span class="n">recv</span><span class="p">,</span> <span class="n">send</span>
<span class="n">close</span>

<span class="c1"># TCP client
</span><span class="n">socket</span> <span class="c1"># get system port number
</span><span class="n">connect</span> <span class="c1"># connect to server
</span>  <span class="n">recv</span><span class="p">,</span> <span class="n">send</span>
<span class="n">close</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># UDP server
</span><span class="n">socket</span>
<span class="n">bind</span>
  <span class="n">recvfrom</span><span class="p">,</span> <span class="n">sendto</span>
<span class="n">close</span>

<span class="c1"># UDP client
</span><span class="n">socket</span>
  <span class="n">recvfrom</span><span class="p">,</span> <span class="n">sendto</span>
<span class="n">close</span>
</code></pre></div></div>

<p>Les connexions d’une machine sont visibles avec <code class="highlighter-rouge">$ netstat</code> ou <code class="highlighter-rouge">$ ss</code>.</p>

<p><code class="highlighter-rouge">socket()</code>: permet de créer un TSAP, c’est-à-dire un nouveau point d’accès de service de transport. On doit lui fournir 3 paramètres:</p>

<ul>
  <li>famille d’adresses utilisées
    <ul>
      <li><code class="highlighter-rouge">AF_UNIX</code> pour du local</li>
      <li><code class="highlighter-rouge">AF_INET</code> pour de l’IPv4</li>
      <li><code class="highlighter-rouge">AF_INET6</code> pour de l’IPv6</li>
    </ul>
  </li>
  <li>type de service demandé
    <ul>
      <li><code class="highlighter-rouge">SOCK_STREAM</code> flot d’octets (mode connecté)</li>
      <li><code class="highlighter-rouge">SOCK_SGRAM</code> datagramme (mode non connecté)</li>
    </ul>
  </li>
  <li>protocole de transport utilisé
    <ul>
      <li><code class="highlighter-rouge">IPPROTO_TCP</code></li>
      <li><code class="highlighter-rouge">IPPROTO_UDP</code></li>
      <li><code class="highlighter-rouge">IPPROTO_ICMP</code></li>
    </ul>
  </li>
</ul>

<p><code class="highlighter-rouge">bind()</code> : permet d’attribuer un numéro de port au socket.</p>

<p><code class="highlighter-rouge">listen()</code> : utilisé en mode connecté, lorsque plusieurs clients sont susceptibles de demander une ou plusieurs connexions avec le serveur.</p>

<p><code class="highlighter-rouge">accept()</code> : utilisé en mode connecté, permet de se bloquer en attente d’une nouvelle demande de connexion, la connexion devient complète entre les 2 processus. Il renvoie un pointeur sur un nouveau socket de structure identique au précédent, le socket original sert à établir une nouvelle connexion, la nouvelle permet l’échange avec le client associé.</p>

<p><code class="highlighter-rouge">connect()</code>: permet à un client de se connecter à un serveur, ouvre connexion entre les 2, on lui fourni l’adresse IP du serveur.</p>

<p><code class="highlighter-rouge">send()/recv()</code> : permettent l’échange d’informations au travers du socket.</p>

<h3 id="serveur-python">Serveur python</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/env python3
</span>
<span class="kn">import</span> <span class="nn">socket</span>

<span class="n">access_mask</span> <span class="o">=</span> <span class="s">''</span> <span class="c1"># filtre les clients, ici aucun n'est filtre
</span><span class="n">server_port</span> <span class="o">=</span> <span class="mi">6688</span>

<span class="n">my_sock</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">IPPROTO_TCP</span><span class="p">)</span>

<span class="c1"># be able to re-use the port faslty
</span><span class="n">my_sock</span><span class="o">.</span><span class="n">setsockopt</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">SOL_SOCKET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SO_REUSEADDR</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">my_sock</span><span class="o">.</span><span class="n">bind</span><span class="p">((</span><span class="n">access_mask</span><span class="p">,</span> <span class="n">server_port</span><span class="p">))</span>

<span class="c1"># configure the queue
</span><span class="n">my_sock</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">SOMAXCONN</span><span class="p">)</span>

<span class="c1"># return new cocket
</span><span class="p">(</span><span class="n">cli_sock</span><span class="p">,</span> <span class="n">tsap_cli</span><span class="p">)</span> <span class="o">=</span> <span class="n">my_sock</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
<span class="k">print</span> <span class="p">(</span><span class="s">"New connection from: "</span><span class="p">,</span> <span class="n">tsap_cli</span><span class="p">)</span>
<span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
	<span class="n">ligne</span> <span class="o">=</span> <span class="n">cli_sock</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
 	<span class="k">if</span> <span class="ow">not</span> <span class="n">ligne</span> <span class="p">:</span>
		<span class="k">break</span>
	<span class="k">print</span><span class="p">(</span><span class="n">ligne</span><span class="p">)</span>
<span class="n">cli_sock</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">my_sock</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<h3 id="client-python">Client python</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/env python3
</span>
<span class="kn">import</span> <span class="nn">socket</span><span class="p">,</span> <span class="n">sys</span>

<span class="n">server_addr</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">gethostbyname</span><span class="p">(</span><span class="s">'localhost'</span><span class="p">)</span>
<span class="n">server_port</span> <span class="o">=</span> <span class="mi">6688</span>

<span class="n">my_sock</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
	<span class="n">my_sock</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="n">server_addr</span><span class="p">,</span> <span class="n">server_port</span><span class="p">))</span>
<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
	<span class="k">print</span> <span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
	<span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
	<span class="n">cli_input</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">':&gt;'</span><span class="p">)</span>
	<span class="k">if</span> <span class="ow">not</span> <span class="n">cli_input</span><span class="p">:</span>
		<span class="k">break</span>
	<span class="n">my_sock</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="n">cli_input</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span> <span class="o">+</span> <span class="n">b</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>

<span class="n">my_sock</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<h1 id="fondamentaux">Fondamentaux</h1>

<p>Dans Ethernet, Wi-Fi, Bluetooth : chaque carte réseau possède une adresse matérielle MAC (Medium Access Control), qui est unique, sur 6 octets (48 bits). Elle est divisée en 2 parties de 3 octets, la première pour désigner le constructeur (OUI, Organization Unique Identifier), la seconde est un numéro de série définie par le constructeur. L’adresse MAC pour réaliser du broadcast est <code class="highlighter-rouge">ff:ff:ff:ff:ff:ff</code>.</p>

<h3 id="routage-directe-et-indirect">Routage directe et indirect</h3>

<ul>
  <li>routage directe: les 2 machines qui communiquent font partie du même réseau, pas besoin d’intermédiaire, car elles communiquent directement</li>
  <li>routage indirect: les 2 machines ne font pas partie du même réseau local, il faut donc passer par un intermédiaire pour sortir du réseau courant pour aller vers l’extérieur (via passerelle ou gateway)</li>
</ul>

<h3 id="routage---comment-choisir-par-quels-intermédiaires-passer-">Routage -&gt; comment choisir par quels intermédiaires passer ?</h3>

<p>Les réseaux de types diffusion sont définis dans les réseaux de petites tailles comme les LAN (Local Area Network). Les réseaux point à point quant à eux sont souvent utilisés comme réseaux d’interconnexion, constitués uniquement de routeurs. La combinaison de ces 2 types de réseaux forme des WAN (Wide Area Network).</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># broadcast network</span>
<span class="nv">$ </span>ip <span class="nb">link</span>
&lt;BROADCAST,...&gt;

<span class="c"># point to point network</span>
<span class="nv">$ </span>ip <span class="nb">link</span>
&lt;POINTTOPOINT,...&gt;
</code></pre></div></div>

<p>Le datagramme va passer d’intermédiaire en intermédiaire, il fait des sauts (ou hop), décider entre routage direct et indirect. Le routage indirect peut faire le choix entre différentes adresses de routeurs, le routeur détermine l’adresse de prochain saut. On utilise les tables de routages. Chaque routeur prend une décision au mieux, best effort. Pour cela, il utilise des next hop routing algorithms.</p>

<p>Les différents types de réseaux utilisés:</p>

<ul>
  <li><strong>bus</strong> : n’existe plus, réseau à diffusion, collisions d’accès (protection avec collision detection et collision avoidance)</li>
  <li><strong>ring</strong> : utilisé chez ISP (Internet Service Provider ou FAI) pour liaison rapide en fibre optique, système de jeton (token ring) -&gt; pas de collisions</li>
  <li><strong>star</strong> : matériels connectés à un noeud de connexion central</li>
  <li><strong>mesh</strong> : matériel possède une ou plusieurs connexions avec les autres matériels, meilleur résistance (resilience), économie de moyens par rapport à maillage complet</li>
</ul>

<h3 id="matériel-dinterconnexion">Matériel d’interconnexion</h3>

<ul>
  <li><strong>Repeater</strong>
    <ul>
      <li>régénère, réamplifie la transmission vers tous les ports</li>
      <li>augmenter distance</li>
      <li>lutter contre atténuation (ex: fibre sous-marine)</li>
      <li>même domaine de diffusion</li>
      <li>même domaine de collision</li>
    </ul>
  </li>
  <li><strong>Hub</strong>
    <ul>
      <li>répéteur multiports</li>
    </ul>
  </li>
  <li><strong>Bridge</strong>
    <ul>
      <li>relaie trame d’un domaine de collision à un autre, si l’émetteur et le destinataire sont dans deux sous-domaines différents (1 domaine par port)</li>
      <li>apprend le sous-domaine où chaque hôte est localisé grâce à son @mac</li>
      <li>si @mac src. et @mac dest. sont derrières le même port, alors ne forward pas</li>
      <li>même domaine de diffusion</li>
      <li>divise domaine de collision en sous-domaines</li>
    </ul>
  </li>
  <li><strong>Switch</strong>
    <ul>
      <li>bridge multiports, plus rapide et performant</li>
      <li>même domaine de diffusion</li>
      <li>1 port = 1 domaine de collision</li>
    </ul>
  </li>
</ul>

<h3 id="gouvernance-dinternet">Gouvernance d’internet</h3>

<p>Organismes chargés de la gestion des adresses et des noms de domaines :</p>

<ul>
  <li><strong>AfriNIC</strong> (Afrique)</li>
  <li><strong>APNIC</strong> (Asie, Pacifique)</li>
  <li><strong>ARIN</strong> (Amérique du Nord)</li>
  <li><strong>LACNIC</strong> (Amérique dur Sud)</li>
  <li><strong>RIPE NCC</strong> (Europe, Moyen-Orient)</li>
</ul>

<p>Les organismes chargés d’allouer les adresses sont des RIRs, Regional Internet Registries.</p>

<p>Registrar : bureau d’enregistrement, permet dépôt de noms de domaines internet.</p>

<blockquote>
  <p>GIP Renater : Groupement d’intérêt public, réseau de la recherche en grande, réseau National de télécommunication pour le Technologie de l’Enseignement et le Recherche.</p>
</blockquote>

<h3 id="adresses-ipv4">Adresses IPv4</h3>

<p>Chaque routeur et machine d’un réseau doivent posséder une adresse IP.</p>

<p>(les classes : le 0 se fait doubler par des 1 à gauche)</p>

<table>
  <thead>
    <tr>
      <th>Adresse</th>
      <th>Classe</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">0.....</code></td>
      <td>A</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">10....</code></td>
      <td>B</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">110...</code></td>
      <td>C</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">1110..</code></td>
      <td>D (multicast)</td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p>Classe A sont peux utilisées : <code class="highlighter-rouge">3.0.0.0/8</code>AS80 General Electric Company.</p>
</blockquote>

<h3 id="adresses-ip-réservées-pour-des-usages-particuliers">Adresses IP réservées pour des usages particuliers</h3>

<ul>
  <li><code class="highlighter-rouge">224.0.0.0/4</code>: multicast</li>
  <li><code class="highlighter-rouge">127.X.Y.Z</code>: loopback</li>
  <li><code class="highlighter-rouge">0.0.0.0</code>: processus d’amorçage (BOOTP)</li>
  <li><code class="highlighter-rouge">255.255.255.255</code>: broadcast</li>
  <li>private addresses:
    <ul>
      <li><code class="highlighter-rouge">10.0.0.0/8</code></li>
      <li><code class="highlighter-rouge">172.16.0.0/12</code></li>
      <li><code class="highlighter-rouge">192.168.0.0/16</code></li>
    </ul>
  </li>
  <li>APIPA (Automatic Private Internet Protocol Addressiong)
    <ul>
      <li>lorsqu’il n’y a pas de DHCP</li>
      <li><code class="highlighter-rouge">169.254.0.0/16</code></li>
    </ul>
  </li>
</ul>

<p>Réseaux normalement non routés, ni diffusés dans BGP, sauf que…</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>whois <span class="nt">-h</span> rischois.ripe.net 192.168.0.0
route:        192.0.0.0/3
origin:       AS3303
</code></pre></div></div>

<h3 id="arp">ARP</h3>

<ul>
  <li>Address Resolution Protocol</li>
  <li>correspondance entre une @IP et une @MAC</li>
  <li>avant d’envoyer un paquet IP, il faut connaître adresse physique MAC, sinon on utilise ARP pour l’avoir</li>
  <li>ARP Request et ARP Reply</li>
  <li>ARP ne sert quand dans les réseaux locaux !</li>
</ul>

<h3 id="rarp-obsoléte">RARP (obsoléte)</h3>

<ul>
  <li>Reverse Address Resolution Protocol</li>
  <li>machine sans adresse IP envoie RARP pour en obtenir une</li>
  <li>utilisé pour amorcer station sans disque, ou une imprimante, …</li>
</ul>

<h3 id="trame-ethernet">Trame Ethernet</h3>

<table>
  <thead>
    <tr>
      <th style="text-align: center">@MAC dst.</th>
      <th style="text-align: center">@MAC src.</th>
      <th style="text-align: center">EtherType</th>
      <th style="text-align: center">Data</th>
      <th style="text-align: center">Padding</th>
      <th style="text-align: center">FCS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">6 octets</td>
      <td style="text-align: center">6 octets</td>
      <td style="text-align: center">2 octets</td>
      <td style="text-align: center">0 à 1500 octets</td>
      <td style="text-align: center">0 à 46 octets</td>
      <td style="text-align: center">4 octets</td>
    </tr>
  </tbody>
</table>

<ul>
  <li>EtherType :
    <ul>
      <li><code class="highlighter-rouge">0x0800</code> -&gt; IPv4</li>
      <li><code class="highlighter-rouge">0x08DD</code> -&gt; IPv6</li>
      <li><code class="highlighter-rouge">0x0806</code> -&gt; ARP</li>
      <li><code class="highlighter-rouge">0x8100</code> -&gt; VLAN</li>
      <li>…</li>
    </ul>
  </li>
  <li>Data + éventuellement bourrage si len(DATA) &lt; 46 octets</li>
  <li>FCS : Frame Check Sequence ou Checksum, si faux, alors non transmise au système d’exploitation</li>
  <li>trame de 64 à 1518 octets</li>
  <li>1 trame = 1 paquets IP (encapsulation)</li>
</ul>

<p>Modification malveillante de la table ARP:</p>
<ul>
  <li>ARP Spoofing (usurpation d’identité)</li>
  <li>ARP Cache Poisoning (insertion d’association erronée)</li>
</ul>

<h3 id="dns-domain-name-server--principe-de-délégation">DNS, Domain Name Server : Principe de délégation</h3>

<ul>
  <li>système distribué mondial, utilise la délégation de domaines</li>
  <li>tout domaine est associé à une responsabilité administrative (organisation)
    <ul>
      <li>découper le domaine en sous-domaines</li>
      <li>déléguer les sous domaines à d’autres organisations (arbre avec racine le <code class="highlighter-rouge">.</code> ensuite <code class="highlighter-rouge">fr</code> ou <code class="highlighter-rouge">com</code>, ensuite <code class="highlighter-rouge">unilim</code> ou <code class="highlighter-rouge">amazon</code>)</li>
    </ul>
  </li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>whois unilim.fr
</code></pre></div></div>

<p>Un serveur de nom a autorité administrative sur une zone (ex: <code class="highlighter-rouge">.fr</code> ou <code class="highlighter-rouge">amazon.fr</code>).</p>

<h3 id="fonctionnement-du-dns">Fonctionnement du DNS</h3>

<ul>
  <li>application utilise nom de domaine (ex: <code class="highlighter-rouge">bonjour.fr</code>)</li>
  <li>application demande la traduction du nom de domaine auprès d’un serveur de nom (DNS), c’est la “résolution de nom” ou “name resolver”
    <ul>
      <li>s’il fait autorité sur le domaine demandé
        <ul>
          <li>et qu’une association est trouvée entre le domaine et une IP, il renvoi l’IP</li>
          <li>si pas d’association, pas de réponse (la machine n’existe pas)</li>
        </ul>
      </li>
      <li>s’il ne fait pas autorité, le serveur de nom interroge d’autres serveurs de nom (du plus grand suffixe commun) pour trouver, puis la mettre dans son cache une certaine durée et répondre</li>
    </ul>
  </li>
</ul>

<p>Sur les machines, le “resolver” est le processus qui s’occupe de réaliser la traduction.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># DNS requets</span>
<span class="nv">$ </span>dig +trace @164.81.1.5 www.google.fr
<span class="c"># @164.81.1.5: use this specific DNS server</span>
<span class="c"># request to root servers ("."), then ".com", then "google.com", and finally "www.google.com"</span>
<span class="c"># ";; Received 92 bytes from 193.0.14.129#53(k.root-server.net) in ..." show us that a previous server respond us</span>
</code></pre></div></div>

<p>Les root servers sont hard codé dans le système d’exploitation.</p>

<h3 id="résolution-inverse">Résolution inverse</h3>

<p>Consiste à obtenir un domaine à partir d’une @IP.</p>

<p>Ex: On tronspose <code class="highlighter-rouge">164.81.60.43</code> avec <code class="highlighter-rouge">w.x.y.z</code> et on renvoi <code class="highlighter-rouge">z.y.x.w.in-addr.arpa</code>, on obtient alors <code class="highlighter-rouge">43.60.81.164.in-addr.arpa</code>. On fait cela car la résolution de nom de domaine se fait de droite à gauche. <code class="highlighter-rouge">in-addr.arpa</code> a 256 sous-domaines, composé eux même de 256 soud-domaines, etc…</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># reverse dns (-x) of 164.81.60.163 using the server @164.81.1.4</span>
<span class="nv">$ </span>dig +short @164.81.1.4 <span class="nt">-x</span> 164.81.60.163

<span class="nv">$ </span>dig +short <span class="nt">-x</span> 8.8.8.8
</code></pre></div></div>

<p>Un serveur DNS possède une base, composée d’enregistrements, appelé RR, <code class="highlighter-rouge">Rousource Records</code>.</p>

<p>Quelques directives :</p>

<ul>
  <li><code class="highlighter-rouge">A</code> : correspondance nom -&gt; adresse IPv4</li>
  <li><code class="highlighter-rouge">AAAA</code> : correspondance nom -&gt; adresse IPv6</li>
  <li><code class="highlighter-rouge">CNAME</code> : alias ou surnom</li>
  <li><code class="highlighter-rouge">MX</code> : Mail eXchanger, serveur de mails</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># short response</span>
<span class="nv">$ </span>dig +noall +answer adel-allam.fr
adel-allam.fr.   21599   IN   A   W.X.Y.Z

<span class="c"># ipv6 with AAAA</span>
<span class="nv">$ </span>dig +short AAAA www.renater.fr
ix1-pv-lbl-vip-194-57-3-7.renater.fr.

<span class="c"># SOA request</span>
<span class="nv">$ </span>dig soa unilim.fr

<span class="c"># TTL decrease</span>
<span class="nv">$ </span>dig +noall +answer gmail.com
gmail.com.		299	IN	A	216.58.213.165
...
...
<span class="nv">$ </span>dig +noall +answer gmail.com
gmail.com.		274	IN	A	216.58.213.165

<span class="nv">$ </span>dig +short mx unilim.fr
<span class="nv">$ </span>dig +short mx google.com
</code></pre></div></div>

<p>L’ordre des réponses varie afin de ne pas surcharger un serveur, pour cela, on utilise des algorithmes de <code class="highlighter-rouge">Round-Robin</code>.</p>

<p>Obtenir des infos sur une IP avec DNS (remplace la commande <code class="highlighter-rouge">host</code>).</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>dig 4.1.81.164.origin.asn.cymru.com TXT +short <span class="c"># give IP</span>
<span class="s2">"1935 | 164.81.0.0/16 | FR | ripencc | 1993-01-04"</span>
<span class="c"># AS numero, addr block, country, ...</span>

<span class="nv">$ </span>dig AS1935.asn.cymru.com TXT +short <span class="c"># give AS</span>
<span class="s2">"1935 | EU | ripencc | 1993-09-01 | FR-RENATER-LIMOUSIN Reseau Regional Limousin, FR"</span>
</code></pre></div></div>

<h1 id="conception-de-réseaux--la-segmentation">Conception de réseaux : la segmentation</h1>

<h3 id="subnetting">Subnetting</h3>

<ul>
  <li>passer d’un réseau en <code class="highlighter-rouge">/24</code> à 2 réseaux en <code class="highlighter-rouge">/25</code> ou en 4 réseaux <code class="highlighter-rouge">/26</code>,…</li>
</ul>

<h3 id="supernetting">Supernetting</h3>

<ul>
  <li>passer de 2 réseaux en <code class="highlighter-rouge">/25</code> en un réseau <code class="highlighter-rouge">/24</code></li>
</ul>

<h3 id="vlsm">VLSM</h3>

<ul>
  <li>Variable Length Subnet Masks</li>
  <li>plusieurs masques de sous-réseaux compatibles hiérarchiquement</li>
  <li>passer d’un réseau <code class="highlighter-rouge">/24</code> en 1 réseaux <code class="highlighter-rouge">/25</code> et 2 réseaux <code class="highlighter-rouge">/26</code></li>
  <li>le but est de se rapprocher le plus possible des besoins en @ IP</li>
</ul>

<h3 id="cidr">CIDR</h3>

<ul>
  <li>Classless InterDomain Routing</li>
  <li>utiliser la notation <code class="highlighter-rouge">192.168.0.0/16</code> au lieu de <code class="highlighter-rouge">192.168.0.0</code> et <code class="highlighter-rouge">255.255.0.0</code></li>
  <li>on ne parle plus de notion de classe</li>
</ul>

<h3 id="simplification-du-routage">Simplification du routage</h3>

<p>Certains blocs sont associés à des régions du monde. Par exemple, quant un routeur hors d’Europe reçoit une paquet à destination de <code class="highlighter-rouge">194.x.y.z</code> ou <code class="highlighter-rouge">195.x.y.z</code>, il doit l’expédier vers un routeur européen.</p>

<p>CIDR de <code class="highlighter-rouge">/1</code> à <code class="highlighter-rouge">/32</code>, les <code class="highlighter-rouge">/31</code> sont réservés pour connexion <strong>point à point</strong> entre routeurs. On parle de réseaux d’interconnexion: réseaux uniquement composés de routeurs.</p>

<p>Le CIDR est similaire au VLSM:</p>

<ul>
  <li>le VLSM est réalisé à l’intérieur du réseau de l’organisation et il est caché de l’extérieur</li>
  <li>le CIDR est réalisé par les différents organismes, FAI, et il est visible de l’extérieur</li>
</ul>

<h3 id="domaine-de-diffusion-et-de-collision">Domaine de diffusion et de collision</h3>

<p><strong>Domaine de diffusion</strong>: zone de taille maximale où il est possible de recevoir un message envoyé dans une zone, limite de transmission d’une trame.</p>

<p><strong>Domaine de collision</strong>: zone du réseau où il existe une compétition pour l’accès à cette zone, les collisions peuvent provoquer une baisse de débit par rapport à la capacité du réseau.</p>

<h3 id="commutation">Commutation</h3>

<ul>
  <li>couche 3: routeur, , il retransmet, “forward” les datagrammes, il réalise du routage</li>
  <li>couche 2: pont, il retransmet, “forward” des trames, réalise de la commutation</li>
  <li>couche 1: répéteur, ne commute pas, mais allonge les distances, il retransmet les bits</li>
  <li>modes de commutation:
    <ul>
      <li><code class="highlighter-rouge">cut-through switching</code>: commutation le plus rapidement possible.</li>
      <li><code class="highlighter-rouge">store-and-forward"</code>: commutation après réception totale</li>
    </ul>
  </li>
</ul>

<h3 id="switch-vlans">Switch VLANs</h3>
<ul>
  <li>créer plusieurs domaines de diffusion segmentés
    <ul>
      <li>plusieurs ports à un domaine de diffusion</li>
      <li>réaliser travail de pont entre ces différents ports</li>
    </ul>
  </li>
  <li>le switch crée des LANs virtuels, appelés VLANs</li>
</ul>

<p>VLANs :</p>

<ul>
  <li>on a plusieurs domaines de diffusion, broadcast domaines avec un seul matériel</li>
  <li>associer un port à un VLAN</li>
  <li>personne peut rester dans un bureau tout en migrant dans un VLAN différent</li>
  <li>permet de faire de la segmentation</li>
</ul>

<h3 id="table-de-routage">Table de routage</h3>

<p>Chaque entrée contient :</p>
<ul>
  <li>le réseau de destination</li>
  <li>l’adresse du prochain saut
    <ul>
      <li>routage directe : interface du routeur s’il est connecté au réseau de desti.</li>
      <li>routage indirecte : @ du prochain saut pour atteindre desti.</li>
    </ul>
  </li>
  <li>la table contient aussi une route par défaut, pour les desti. inconnues</li>
</ul>

<table>
  <thead>
    <tr>
      <th style="text-align: center">desti.</th>
      <th style="text-align: center">next hop</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><code class="highlighter-rouge">10.10.0.0/16</code></td>
      <td style="text-align: center"><code class="highlighter-rouge">eth0</code></td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="highlighter-rouge">10.20.0.0/16</code></td>
      <td style="text-align: center"><code class="highlighter-rouge">10.10.0.1</code></td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="highlighter-rouge">192.168.0.1</code></td>
      <td style="text-align: center"><code class="highlighter-rouge">10.20.0.1</code></td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="highlighter-rouge">default</code></td>
      <td style="text-align: center"><code class="highlighter-rouge">10.10.0.1</code></td>
    </tr>
  </tbody>
</table>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># suivre routage avec traceroute de scapy</span>
<span class="o">&gt;&gt;</span> sn,unans <span class="o">=</span> traceroute<span class="o">([</span><span class="s1">'www.unilim.fr'</span><span class="o">]</span>, <span class="nv">maxttl</span><span class="o">=</span>10<span class="o">)</span>
</code></pre></div></div>

<h3 id="diffusion-dans-un-réseau">Diffusion dans un réseau</h3>

<ul>
  <li>Unicast : pour un seul desti.</li>
  <li>Broadcast : pour tout le monde</li>
  <li>Multicast : pour un groupe</li>
</ul>

<p>Le multicast dans IPv4 est limité au réseau local, mais peut être retransmis par un routeur s’il est configuré pour le faire.</p>

<p>La classe D est réservée pour le multicast: <code class="highlighter-rouge">224.0.0.0/4</code> de <code class="highlighter-rouge">224.0.0.0</code> à <code class="highlighter-rouge">239.255.255.255</code>. Aussi, il existe des groupes prédéfinies:</p>

<table>
  <thead>
    <tr>
      <th>Address</th>
      <th>Destination</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">224.0.0.1</code></td>
      <td>All hosts on a subnet</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">224.0.0.2</code></td>
      <td>All routers on a subnet</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">224.0.0.5</code></td>
      <td>All OSPF routers</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">224.0.0.9</code></td>
      <td>All RIPv2 routers</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">224.0.0.12</code></td>
      <td>DHCP server</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">224.0.1.1</code></td>
      <td>NTP</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">224.0.0.251</code></td>
      <td>Multicast DNS</td>
    </tr>
  </tbody>
</table>

<p>On associe à ces adresses une @MAC particulière:</p>
<ul>
  <li>commence par <code class="highlighter-rouge">01:00:5e</code></li>
  <li>se termine par les 23 derniers bits de l’IP du groupe</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># join multicast group
</span><span class="n">gestion_mcast</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">"4sl"</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">inet_aton</span><span class="p">(</span><span class="s">"224.0.0.127"</span><span class="p">),</span> <span class="n">socket</span><span class="o">.</span><span class="n">INADDR_ANY</span><span class="p">)</span>
<span class="n">ma_socket</span><span class="o">.</span><span class="n">setsockopt</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">IPPROTO_IP</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">IP_ADD_MEMBERSHIP</span><span class="p">,</span> <span class="n">gestion_mcast</span><span class="p">)</span>
<span class="n">ma_socket</span><span class="o">.</span><span class="n">setsockopt</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">IPPROTO_IP</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">IP_MULTICAST_LOOP</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="c1"># IP_MULTICAST_LOOP : choose if emeter will receive its own paquets
</span></code></pre></div></div>

<h3 id="multicast-et-routeurs">Multicast et routeurs</h3>

<p>Lorsqu’une machine rejoint un groupe multicast, elle diffuse un message au format IGMP, Internet Group Management Protocol. Cela permet de prévenir les routeurs présents dans le réseau, même chose lorsqu’elle quitte le groupe. Les routeurs devront donc relayer vers cette machine les paquets du groupe multicast.</p>

<h3 id="igmp--internet-group-management-protocol">IGMP : Internet Group Management Protocol</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># create a group</span>
<span class="nv">$ </span>socat stdio udp-recvfrom:7182,ip-add-membership<span class="o">=</span>224.0.0.127:eth0,fork

<span class="c"># listen IGMP paquets</span>
<span class="nv">$ </span><span class="nb">sudo </span>tcpdump <span class="nt">-nvveX</span> <span class="nt">-i</span> eth0 igmp
<span class="c"># to_ex {} : quitte l'execlusion donc rejoindre</span>
<span class="c"># to_in {} : terminaison du groupe</span>
</code></pre></div></div>

<p>Les switchs écoutent les ports qui diffusent des messages IGMP pour limiter le multicast des paquets, il réalise de l’IGMP snooping, IGMP : vers <code class="highlighter-rouge">224.0.0.22</code>.</p>

<p>Ex: diffusion d’un flux RTP, Real Time Protocol, pour la diffusion d’un flux vidéo au travers d’un routeur, protocole fourre-tout pour différents types de flux, basé UDP, ports 6970 à 6999.</p>

<h3 id="mdns-localisation-de-services-dans-un-réseau-privé">mDNS: localisation de services dans un réseau privé</h3>

<ul>
  <li>basé sur des paquets DNS traditionnels</li>
  <li>chaque hôte possède sa propre liste d’enregistrements (A, MX, SRV,…)</li>
  <li>chaque hôte diffuse liste des services qu’il offre grâce au champ SRV</li>
  <li>en <code class="highlighter-rouge">.local</code></li>
  <li>en multicast <code class="highlighter-rouge">224.0.0.251</code>, port 5353 en UDP, @MAC = <code class="highlighter-rouge">01:00:5e:00:00:fb</code></li>
</ul>

<h3 id="datagramme-ip">Datagramme IP</h3>

<ul>
  <li><code class="highlighter-rouge">Version</code>: 4 bits, 4 (pour IPv4) ou 6 (pour IPv6)</li>
  <li><code class="highlighter-rouge">Header Length</code>: 4 bits, longueur en nombre de mots 4 octets, souvent à <code class="highlighter-rouge">5</code>, c’est à dire 20 octets car 4*5=20 (en-tête de mini 20 octets (sans option))</li>
  <li><code class="highlighter-rouge">Type of Service</code>: 8 bits, indique la manière dont doit être géré le datagramme par le routeur
    <ul>
      <li>priorité (4 premiers bits) de 0 à 7 (même administration)</li>
      <li>les 4 bits: D, T, R et C spécifient ce que l’on veut privilégier, D : minimiser délai, T : maximiser débit, R : fiabilité, C : coût de transmission, DTRC tout à 1 pour la sécurité, on recycle les bits 6 et 7 pour l’ECN, Explicit Congestion Notification, permet de détecter l’entrée en congestion du réseau, c’est à dire qu’il va bientôt saturer</li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">Total Packet Length</code> : 16 bits, taille en octets du datagramme (en-tête + data)</li>
  <li><code class="highlighter-rouge">Identification</code> : 16 bits, pour regrouper après fragmentation</li>
  <li><code class="highlighter-rouge">Flags</code>: 4 bits, pour fragmentation</li>
  <li><code class="highlighter-rouge">Fragment Offset</code> : 12 bits, pour fragmentation</li>
  <li><code class="highlighter-rouge">TTL</code>: Time To Live, nombre de routeurs que peut traverser le datagramme avant d’être détruit (val défaut: 128), quand routeur détruit paquet avec TTL = 0, envoie ICMP, permet de ne pas avoir de paquets indéfiniment dans un réseau</li>
  <li><code class="highlighter-rouge">Protocol</code>: 8 bits, indique protocole de couche supérieur, 1 : ICMP, 6 : TCP, 2 : IGMP, 17 : UDP</li>
  <li><code class="highlighter-rouge">Header Checksum</code> : 16 bits, assure intégrité de l’en-tête, complément à 1 de la somme des valeurs de l’en-tête, pour détection d’erreur</li>
  <li><code class="highlighter-rouge">Src. Address</code> : 32 bits</li>
  <li><code class="highlighter-rouge">Dest. Address</code> : 32 bits</li>
  <li><code class="highlighter-rouge">Options</code> : liste de longueur variable, mais toujours complétée par bits de bourrage, pour avoir mutliple de 4 octets, très peu utilisées, si Header Length &gt; 20, alors on a des options.</li>
</ul>

<h3 id="icmp">ICMP</h3>

<ul>
  <li>Internet Control Message Protocol</li>
  <li>effectue contrôle des échanges</li>
  <li>permet de debugger un réseau</li>
  <li>différents messages avec signification
    <ul>
      <li>messages d’erreurs</li>
      <li>messages de requêtes</li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">Type</code> : 8 bits</li>
  <li><code class="highlighter-rouge">Code</code> : 8 bits</li>
  <li><code class="highlighter-rouge">Checksum</code> : 16 bits</li>
  <li><code class="highlighter-rouge">Data</code> : 32 bits</li>
</ul>

<h3 id="attaques-utilisant-icmp">Attaques utilisant ICMP</h3>

<ul>
  <li>
    <p>reconnaissance d’un réseau</p>
  </li>
  <li>
    <p>ICMP Sweep, balayer plage d’adresses d’un réseau (ex: nmap)</p>
  </li>
  <li>Traceroute : envoi successif de datagramme avec valeur TTL incrémenté de 1
    <ul>
      <li>lorsque routeur forward datagramme, il décrémente le TTL</li>
      <li>si TTL = 0, routeur répond un ICMP Time Exceed, @src = @routeur</li>
      <li>on a info sur chemin et topologie du réseau traversé</li>
    </ul>
  </li>
  <li>Firewalking : amélioration d’un traceroute classique
    <ul>
      <li>traceroute classique pour déterminer le nombre n de sauts, hops jusqu’au firewall</li>
      <li>envoyer datagramme avec TTL de n+1 et associé à un protocole choisi:
        <ul>
          <li>si ICMP Time Excedeed est reçu, alors le datagramme a réussi à traverser le firewall</li>
          <li>sinon, une règle de firewall a filtré le datagramme</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Inverse Mapping : mapper réseau interne protégé par un firewall
    <ul>
      <li>attaquant envoi paquets ICMP Echo Reply vers plage d’adresses présumées derrière le firewall</li>
      <li>le firewall autorise à passer car il ne maintient pas de liste des requêtes ICMP (sauf bon firewall ou bonne conf.)</li>
      <li>s’il existe un routeur interne, ce dernier retourne ICMP Host Unreachabble pour chaque hôte indisponible du réseau, ce qui informe par déduction, l’attaquant sur les machines présentes dans le réseau</li>
    </ul>
  </li>
  <li>L’OS Fingerprinting : reconnaitre OS d’une machine
    <ul>
      <li>envoi datagramme UDP avec DF à 1 vers cible avec num de port fermé</li>
      <li>cible retourne ICMP Destination Port Unreachable</li>
      <li>en analysant le format du paquet ICMP réponse, on peut avoir des info sur la cible (un Linux ? un mac ? un PC ?)</li>
      <li>autres façon : comparer paquets ping envoyé par un mac et un pc</li>
    </ul>
  </li>
  <li>ICMP Route Redirect : paquet envoyé par un routeur lorsqu’il:
    <ul>
      <li>reçoit du trafic d’un hôte et que le prochain saut de ce trafique (en regardant sa table de routage) est dans le même réseau que celui de l’hôte</li>
      <li>possible de faire du Man-In-The-Middle
        <ul>
          <li>attaquant prend le contrôle du routeur R1</li>
          <li>attaquant envoi ICMP Redirection vers le victime en prenant la place du routeur R2, utilisé par la victime</li>
          <li>cette redirection demande à la victime de modifier sa table de routage pour passer par R1 au lieu de R2</li>
          <li>l’attaquant intercepte le trafic sur R1</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>
    <p>paquets ICMP Oversized : paquet ICMP de taille maximale envoyé vers la victime fait planter sa pile TCP/IP</p>
  </li>
  <li>
    <p>ICMP Router Discovery : paquets transmis dans le réseau pour permettre à un hôte de découvrir les routeurs présents : router solicitation</p>

    <ul>
      <li>attaquant peut répondre par un “Router Advertisement” et prendre la place du routeur par défaut pour la victime</li>
    </ul>
  </li>
  <li>
    <p>ICMP Floods: inonder victimes de messages ICMP, pour ralentir et peut-être l’empêcher de communiquer</p>

    <ul>
      <li>Smurt Attack: envoi de paquets ICMP Echo Request en diffusion sur le réseau, avec adresse de la victime en adresse source</li>
      <li>ne fonctionne plus</li>
    </ul>
  </li>
  <li>Le Tunneling: encapsuler des données dans paquets ICMP (exfiltration), difficile à découvrir, et peut-être chiffré</li>
</ul>

<h1 id="fragmentation">Fragmentation</h1>

<h3 id="encapsulation-dans-ethernet">Encapsulation dans Ethernet</h3>

<p>Si <code class="highlighter-rouge">MTU</code> (Maximum Transmission Unit) est égale à 1500, alors, taille datagramme IP &lt;= 1500 octets. Si supérieur, il faut découper, un datagramme IP est divisé en plusieurs autres datagrammes IP (avec en-tête).</p>

<h3 id="fragmentation-1">Fragmentation</h3>

<p>Datagramme IP ont taille sur 16 bits, dans 65 535 octets max, la MTU peut changer sur les tronçons du réseau. Chaque fragment doit avoir la plus grande taille possible et qui est multiple de 8 octets.</p>

<p>1 fragment = 1 datagramme IP:</p>

<ul>
  <li><code class="highlighter-rouge">Identification</code> : tous les fragments ont le même id</li>
  <li><code class="highlighter-rouge">Fragment Offset</code> : position du début du fragment dans le datagramme initial (mutliple de 8)</li>
  <li><code class="highlighter-rouge">Total Packet Length</code> : recalculé pour chaque fragment</li>
  <li><code class="highlighter-rouge">Flags</code> : 3 bits
    <ul>
      <li>pas utilisé</li>
      <li><code class="highlighter-rouge">DF</code>: Don’t Fragment, indique si datagramme peut-être fragmenté ou non, si routeur doit fragmenter alors que DF = 1, alors datagramme détruit et ICMP d’erreur envoyé</li>
      <li><code class="highlighter-rouge">MF</code>: More Fragment, indique si c’est un fragment
        <ul>
          <li>0: dernier ou pas de fragmentation</li>
          <li>1: sinon</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h3 id="défragmentation">Défragmentation</h3>

<p>À la réception du premier fragment, on déclenche un temporisateur de réassemblage (délai max. d’attente de tous les fragments).</p>

<h3 id="métriques">Métriques</h3>

<ul>
  <li>Latency: temps de A vers B</li>
  <li>RTT, Round Trip Time, temps A-&gt;B + B-&gt;A, latence environ = RTT/2</li>
  <li>Gigue: jitter, variation de la latence au cours du temps, Jitter = latency(t)-latency(t-1), mesure importante pour les communications en “temps réel”
    <ul>
      <li>mieux vaut une forte latence avec gigue stable, qu’une faible latence avec gigue important</li>
      <li>les paquets peuvent arriver dans le désordre à cause de la variation de la latence au cours de l’envoi</li>
      <li>si gigue = 0, alors latence stable, sinon latence varie</li>
    </ul>
  </li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># mesure RTT</span>
<span class="nv">$ </span>ping <span class="nt">-c</span> 5 164.81.1.4
<span class="nv">$ </span>ping6 fe80:1030:5329:6d2c:211:deff:fead:beef <span class="nt">-I</span> eth0
<span class="nt">---</span> 164.81.1.4 ping statistics <span class="nt">---</span>
3 packets transmitted, 3 received, 0% packet loss, <span class="nb">time </span>2003ms
rtt min/avg/max/mdev <span class="o">=</span> 45.614/46.351/47.507/0.827 ms
<span class="c"># mdev est le gigue</span>
</code></pre></div></div>

<ul>
  <li>le débit
    <ul>
      <li>en bits/seconde, en puissance de 10</li>
      <li>quantité d’information par unité de temps remis à son destinataire</li>
    </ul>
  </li>
  <li>occupation du canal: ratio par rapport au débit physique du réseau</li>
  <li>débit utilisateur: ratio des données utiles (sans en-têtes) par rapport à toutes les données transmises</li>
  <li>QoS; Quality of Service, débit pour un type de service (VoIP, Web,…), suppose que les communications peuvent être identifiées</li>
</ul>

<h3 id="circuit-virtuel-vs-datagramme">Circuit virtuel vs Datagramme:</h3>

<ul>
  <li>Circuit virtuel:
    <ul>
      <li>débit obtenu est très proche de celui offert en théorie par le réseau physique</li>
      <li>lors de l’établissement du circuit virtuel, on peut connaître le débit prévisible</li>
      <li>le débit peut-être garanti, QoS</li>
    </ul>
  </li>
  <li>Datagramme:
    <ul>
      <li>capacité partagée entre les utilisateurs</li>
      <li>ne peut pas être garantie (on ne peut pas savoir ce que font les autres utilisateurs)</li>
      <li>contrôle de flux augmente l’utilisation du réseau et diminue son débit</li>
      <li>pertes de paquets peuvent arriver (ex: pendant congestion)</li>
      <li>peu ou pas de QoS, uniquement sur des parties contrôlées par l’entreprise par exemple</li>
    </ul>
  </li>
</ul>

<h3 id="flow-control-vs-congestion-control">Flow control vs Congestion control</h3>

<p><strong>Flow control</strong>: ne s’applique que sur une communication et entre deux interlocuteurs, éviter qu’un émetteur rapide sature (plus de place dans le buffer de réception) un récepteur lent -&gt; le récepteur contrôle l’émetteur via mécanisme de fenêtre.</p>

<p><strong>Congestion control</strong>: dépends de l’état du réseau global, suite à perte de segments, utiliser nouvelle fenêtre d’autorisation d’émission.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># mutliplexag </span>
<span class="nv">$ </span>netstat <span class="nt">-n</span> <span class="nt">--inet</span>
</code></pre></div></div>

<h1 id="segmentation">Segmentation</h1>

<h3 id="tcp-segmentation">TCP Segmentation</h3>

<ul>
  <li>manipule des flux d’octets de longueur variable, données à envoyer sont bufferisées afin d’améliorer les performances:
    <ul>
      <li>à l’envoi: améliorer taux d’occupation du réseau</li>
      <li>à la réception: avertir/réveiller l’application que lorsqu’il y a un volume suffisant de données à traiter</li>
    </ul>
  </li>
  <li>données divisées en segments de taille optimale pour TCP</li>
  <li>1 segment = 1 datagramme IP</li>
</ul>

<h3 id="acheminement">Acheminement</h3>

<ul>
  <li>Taille de fenêtre d’émission (défini par récepteur), buffer d’envoi</li>
  <li>Taille de fenêtre de réception, buffe de réception avec rangement via l’offset du segment</li>
  <li>système d’ACK du suivant et de timeout avant retransmission, RTO, Retransmission TimeOut, calculé en fonction du RTT d’un segment</li>
  <li>amélioration : delayed ACK ou acquittement cumulatif, acquitter plusieurs messages passés</li>
</ul>

<h3 id="tcp-header">TCP Header</h3>

<ul>
  <li><code class="highlighter-rouge">Source Port</code>: 16 bits, identifie le processus associé et défini le TSAP</li>
  <li><code class="highlighter-rouge">Destination Port</code>: 16 bits, same</li>
  <li><code class="highlighter-rouge">Sequence Number</code>: 32 bits, offset à partir d’une valeur initial (ISN, Initial Sequence Number), position du segment dans le flux à recomposer</li>
  <li><code class="highlighter-rouge">Acknowledge Number</code>: 32 bits, num seq. du prochain segment attendu, acquitte les octets précédemment reçus</li>
  <li><code class="highlighter-rouge">Header Length</code>: 4 bits, taille en mutliple de 4 octets</li>
  <li><code class="highlighter-rouge">RESV</code>: 4 bits, réservé pour usage ultérieur</li>
  <li><code class="highlighter-rouge">ECN</code>: 2 bits, Explicit Congestion Notification, avertir le récepteur d’un état de début de congestion, le routeur gérant l’ECN position un bit dans l’en-tête IP ou TCP afin d’informer le récepteur</li>
  <li><code class="highlighter-rouge">Flags</code>: 6 bits
    <ul>
      <li><code class="highlighter-rouge">URG</code>: indique des données urgentes par le Urgent Pointer</li>
      <li><code class="highlighter-rouge">ACK</code>: accusé de réception présent dans Acknowledgement Number</li>
      <li><code class="highlighter-rouge">PSH</code>: segment envoyé sans bufferisation</li>
      <li><code class="highlighter-rouge">RST</code>: réinitialiser la connexion, problème de synchro.</li>
      <li><code class="highlighter-rouge">SYN</code>: synchroniser Sequence Number</li>
      <li><code class="highlighter-rouge">FIN</code>: l’émetteur à fini d’émettre (permet de clore un sens de communication)</li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">Windows Size</code>: 16 bits, pour contrôle de flux par fenêtre glissante, indique nombre d’octets que l’émetteur est prêt à recevoir, le destinataire utilise cette info. pour gérer son débit d’envoi</li>
  <li><code class="highlighter-rouge">TCP Checksum</code>: 16 bits, total de contrôle pour assurer la validité de l’en-tête et des données</li>
  <li><code class="highlighter-rouge">Urgent Pointer</code>: 16 bits, si bit URG, indique début des données urgentes</li>
  <li><code class="highlighter-rouge">Options</code>
    <ul>
      <li>MSS: Maximum Segment Size, indiqué lors de l’établissement de la connexion, le taille max des données d’un segment (sans en-tête) TCP que l’on peut recevoir</li>
    </ul>
  </li>
</ul>

<h3 id="établissement-dune-connexion">Établissement d’une connexion</h3>

<p>Piggybacking: l’ACK d’un paquet A -&gt; B, peut-être transmis dans un paquet allant de B -&gt; A.</p>

<p>Handshake:</p>

<ul>
  <li>3 étapes</li>
  <li>demande d’ouverture de la part de chaque interlocuteur</li>
  <li>permet de synchroniser l’ISN
    <ul>
      <li><code class="highlighter-rouge">connect()</code> -&gt; SYN=1 et ACK=0</li>
      <li><code class="highlighter-rouge">accept()</code> -&gt; SYN=1 et ACK=1</li>
    </ul>
  </li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># tcpdump</span>
<span class="o">[</span>S]  -&gt; SYN
<span class="o">[</span>S.] -&gt; SYN/ACK
<span class="o">[</span>.]  -&gt; ACK
</code></pre></div></div>

<h3 id="fermeture">Fermeture</h3>

<ul>
  <li>FIN -&gt;</li>
  <li>ACK &lt;-</li>
  <li>FIN &lt;-</li>
  <li>ACK -&gt;</li>
</ul>

<p>ou</p>

<ul>
  <li>FIN -&gt;</li>
  <li>ACK &lt;-</li>
  <li>RST &lt;-</li>
</ul>

<h3 id="bit-rst">Bit RST</h3>

<ul>
  <li>demande réinitialisation de la communication</li>
  <li>émis en rapport à une connexion
    <ul>
      <li>nom existante</li>
      <li>existante: segment qui ne correspond pas à celui attendu</li>
    </ul>
  </li>
</ul>

<p><code class="highlighter-rouge">Segments Keep-Alive</code>: garder en vie la connexion en évitant qu’un routeur réalisant du filtrage, supprime la connexion du fait de son inactivité, de tester la présence de l’interlocuteur, et de mettre fin sinon.</p>

<h3 id="calcul-du-timeout">Calcul du Timeout</h3>

<ul>
  <li>plus long que RTT, mais le RTT varie</li>
  <li>si trop court: risque de retransmettre des segments pour rien</li>
  <li>si trop long: réaction trop lente aux pertes de segments</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># conf. de TCP sous Linux</span>
<span class="nv">$ </span><span class="nb">ls</span> /proc/sys/net/ipv4/tcp<span class="k">*</span>
</code></pre></div></div>

<h3 id="udp-1">UDP</h3>

<ul>
  <li>inverse de TCP</li>
  <li>souvent bit DF dans IP</li>
  <li>est stateless</li>
  <li>multicast</li>
  <li>utilisé pour application: demande-réponse, temps réels, NTP, DNS, VoIP, IPTv</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># liste ports en attente</span>
<span class="nv">$ </span>netstat <span class="nt">-lp</span> <span class="nt">--inet</span>
</code></pre></div></div>

<ul>
  <li><code class="highlighter-rouge">Source Port</code>: 16 bits</li>
  <li><code class="highlighter-rouge">Destination Port</code>: 16 bits</li>
  <li><code class="highlighter-rouge">Length</code>: 16 bits, inclus en-tête de 8 à 65353 octets</li>
  <li><code class="highlighter-rouge">Chechsum</code>: 16 bits</li>
  <li><code class="highlighter-rouge">Data</code>: optionel</li>
</ul>

<h1 id="nat-snat-dnat-pat-dmz">NAT, SNAT, DNAT, PAT, DMZ</h1>

<h3 id="nat-network-address-translation">NAT: Network Address Translation</h3>

<ul>
  <li>partage d’une adresse IP publique entre plusieurs machines</li>
  <li>car manque d’adresses en IPv4</li>
  <li>utilise réseaux privées (donc non routable):
    <ul>
      <li><code class="highlighter-rouge">10.0.0.0/8</code></li>
      <li><code class="highlighter-rouge">172.16.0.0/12</code></li>
      <li><code class="highlighter-rouge">192.168.0.0/16</code></li>
    </ul>
  </li>
</ul>

<p>Le routeur NAT doit changer l’adresse IP privée du paquet en la sienne, différencier les paquets de machines différentes, garder une trace de toutes les connexions TCP et UDP qui le traverse, Connection Tracking, principe des stateful firewalls.</p>

<ul>
  <li>static NAT: plusieurs privées vers une publique</li>
  <li>dynamic NAT: plusieurs privées vers plusieurs publiques</li>
  <li>masquerading: comme static NAT, mais sans spécifier d’adresse</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>conntrack <span class="nt">-L</span>
<span class="c"># tcp ou udp (mémorise l'envoi et on attend paquet avec TSAP inverse)</span>
</code></pre></div></div>

<h3 id="snat-source-nat">SNAT: Source NAT</h3>

<ul>
  <li>changer adresse source d’un paquet</li>
  <li>utilisé pour aller sur internet à partir d’un réseau privé</li>
</ul>

<h3 id="dnat-destination-nat">DNAT: Destination NAT</h3>

<ul>
  <li>adresse publique vers privée</li>
  <li>port forwarding: public vers privée en fonction du numéro de port</li>
</ul>

<h3 id="pat-port-address-translation">PAT: Port Address Translation</h3>

<ul>
  <li>faire du SNAT en mode masquerading (many-to-one) en changeant au besoin le port d’origine</li>
  <li>faire du DNAT en fonction d’un numéro de port choisi qui peut être différent du port de destination final.</li>
</ul>

<h3 id="dmz-demilitarized-zone">DMZ: Demilitarized Zone</h3>

<ul>
  <li>redirige tout le trafic en provenance de l’extérieur vers une machine du réseau privée en plus de faire du masquerading en sortie.</li>
  <li>SNAT + DNAT = full NAT</li>
</ul>

<hr />
<h1 id="qos-quality-of-service">QoS: Quality of Service</h1>
<hr />

<p>La qualité de service (QdS) ou Quality of service (QoS) est la capacité à véhiculer dans de bonnes conditions un type de trafic donné, en termes de disponibilité, débit, délais de transmission, gigue, taux de perte de paquets…</p>

</div>


<div class="related">
  <h2>Related posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/linux/2019/12/23/ctf-santhacklaus/">
            santhacklaus ctf v2
            <small>23 Dec 2019</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/ctf/2019/12/05/sigsegv2/">
            sigsegv2
            <small>05 Dec 2019</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/ctf/2019/07/29/linux/">
            linux
            <small>29 Jul 2019</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>


      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script src='/public/js/script.js'></script>
  </body>
</html>
